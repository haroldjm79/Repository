{"data": {"log_version": 3, "version": "=1.7.18"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "Running with dbt=1.7.18", "name": "MainReportVersion", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:39.287085Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --select fqn:dfb_data.mart.dim_dfb_nfl_teams_data", "log_cache_events": "False", "log_format": "json", "log_path": "C:\\Users\\harol\\Documents\\GitHub\\Repository\\dbt_dailyfantasybuzz\\dfb_data\\target\\dbtlearn_dbt_assets-1f140de-eba694e", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "C:\\Users\\harol\\.dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target\\dbtlearn_dbt_assets-1f140de-eba694e", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\\\Users\\\\harol\\\\.dbt', 'log_path': 'C:\\\\Users\\\\harol\\\\Documents\\\\GitHub\\\\Repository\\\\dbt_dailyfantasybuzz\\\\dfb_data\\\\target\\\\dbtlearn_dbt_assets-1f140de-eba694e', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select fqn:dfb_data.mart.dim_dfb_nfl_teams_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'target\\\\dbtlearn_dbt_assets-1f140de-eba694e', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:39.297606Z"}}
{"data": {"adapter_name": "snowflake", "adapter_version": "=1.7.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "Registered adapter: snowflake=1.7.1", "name": "AdapterRegistered", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:40.240394Z"}}
{"data": {"checksum": "7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08", "profile": "", "target": "", "vars": "{}", "version": "1.7.18"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18", "name": "StateCheckVarsHash", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:40.284034Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:40.656518Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:40.658515Z"}}
{"data": {"stat_line": "7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:40.717719Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "", "name": "Formatting", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:40.720724Z"}}
{"data": {"conn_name": "master", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Acquiring new snowflake connection 'master'", "name": "NewConnection", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:40.722730Z"}}
{"data": {"conn_name": "list_storage", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Acquiring new snowflake connection 'list_storage'", "name": "NewConnection", "pid": 28620, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:24:40.727095Z"}}
{"data": {"conn_name": "list_storage", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Using snowflake connection \"list_storage\"", "name": "ConnectionUsed", "pid": 28620, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:24:40.748Z"}}
{"data": {"conn_name": "list_storage", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"connection_name\": \"list_storage\"} */\nshow terse schemas in database storage\n    limit 10000"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "On list_storage: /* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"connection_name\": \"list_storage\"} */\nshow terse schemas in database storage\n    limit 10000", "name": "SQLQuery", "pid": 28620, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:24:40.748989Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 28620, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:24:40.750030Z"}}
{"data": {"elapsed": 2.0, "status": "SUCCESS 3"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "SQL status: SUCCESS 3 in 2.0 seconds", "name": "SQLQueryStatus", "pid": 28620, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:24:42.885512Z"}}
{"data": {"conn_name": "list_storage"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "On list_storage: Close", "name": "ConnectionClosed", "pid": 28620, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:24:42.890504Z"}}
{"data": {"conn_name": "list_storage_dfb", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Acquiring new snowflake connection 'list_storage_dfb'", "name": "NewConnection", "pid": 28620, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:24:43.301026Z"}}
{"data": {"conn_name": "list_storage_dfb", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Using snowflake connection \"list_storage_dfb\"", "name": "ConnectionUsed", "pid": 28620, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:24:43.338218Z"}}
{"data": {"conn_name": "list_storage_dfb", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"connection_name\": \"list_storage_dfb\"} */\nshow terse objects in storage.dfb limit 10000"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "On list_storage_dfb: /* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"connection_name\": \"list_storage_dfb\"} */\nshow terse objects in storage.dfb limit 10000", "name": "SQLQuery", "pid": 28620, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:24:43.341150Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 28620, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:24:43.343736Z"}}
{"data": {"elapsed": 2.0, "status": "SUCCESS 9"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "SQL status: SUCCESS 9 in 2.0 seconds", "name": "SQLQueryStatus", "pid": 28620, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:24:45.627807Z"}}
{"data": {"conn_name": "list_storage_dfb"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "On list_storage_dfb: Close", "name": "ConnectionClosed", "pid": 28620, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:24:45.634948Z"}}
{"data": {"node_count": 1, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:46.171481Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "", "name": "Formatting", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:46.175523Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "started", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Began running node model.dfb_data.dim_dfb_nfl_teams_data", "name": "NodeStart", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.189158Z"}}
{"data": {"description": "python table model dfb.dim_dfb_nfl_teams_data", "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "started", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "1 of 1 START python table model dfb.dim_dfb_nfl_teams_data ..................... [RUN]", "name": "LogStartLine", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.193148Z"}}
{"data": {"conn_name": "model.dfb_data.dim_dfb_nfl_teams_data", "conn_type": "snowflake", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "started", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Acquiring new snowflake connection 'model.dfb_data.dim_dfb_nfl_teams_data'", "name": "NewConnection", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.199153Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "compiling", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Began compiling node model.dfb_data.dim_dfb_nfl_teams_data", "name": "NodeCompiling", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.203162Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "compiling", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Writing injected SQL for node \"model.dfb_data.dim_dfb_nfl_teams_data\"", "name": "WritingInjectedSQLForNode", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.323978Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "compiling", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}, "timing_info": {"completed_at": "2024-11-08T03:24:46.331524Z", "name": "compile", "started_at": "2024-11-08T03:24:46.205166Z"}}, "info": {"category": "", "code": "Z010", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Timing info for model.dfb_data.dim_dfb_nfl_teams_data (compile): 22:24:46.205166 => 22:24:46.331524", "name": "TimingInfoCollected", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.332525Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Began executing node model.dfb_data.dim_dfb_nfl_teams_data", "name": "NodeExecuting", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.336945Z"}}
{"data": {"msg": "Writing runtime python for node \"model.dfb_data.dim_dfb_nfl_teams_data\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Writing runtime python for node \"model.dfb_data.dim_dfb_nfl_teams_data\"", "name": "JinjaLogDebug", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.469506Z"}}
{"data": {"conn_name": "model.dfb_data.dim_dfb_nfl_teams_data", "conn_type": "snowflake", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Using snowflake connection \"model.dfb_data.dim_dfb_nfl_teams_data\"", "name": "ConnectionUsed", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.482046Z"}}
{"data": {"conn_name": "model.dfb_data.dim_dfb_nfl_teams_data", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"node_id\": \"model.dfb_data.dim_dfb_nfl_teams_data\"} */\nWITH dim_dfb_nfl_teams_data__dbt_sp AS PROCEDURE ()\n\nRETURNS STRING\nLANGUAGE PYTHON\nRUNTIME_VERSION = '3.8'\nPACKAGES = ('snowflake-snowpark-python')\n\nHANDLER = 'main'\nEXECUTE AS CALLER\nAS\n$$\n\nimport sys\nsys._xoptions['snowflake_partner_attribution'].append(\"dbtLabs_dbtPython\")\n\n\n  \n    \nimport snowflake.snowpark.functions as F\r\n\r\ndef model(dbt, session):\r\n    df = dbt.ref('py_nfl_data')\r\n    df1 = dbt.ref('fct_nfl_teams')\r\n    data_df = df.join(df1, df['Game_Info'] == df1['abbrev'])\r\n    return data_df\n\n\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\ndef ref(*args, **kwargs):\n    refs = {\"fct_nfl_teams\": \"storage.dfb.fct_nfl_teams\", \"py_nfl_data\": \"storage.dfb.py_nfl_data\"}\n    key = '.'.join(args)\n    version = kwargs.get(\"v\") or kwargs.get(\"version\")\n    if version:\n        key += f\".v{version}\"\n    dbt_load_df_function = kwargs.get(\"dbt_load_df_function\")\n    return dbt_load_df_function(refs[key])\n\n\ndef source(*args, dbt_load_df_function):\n    sources = {}\n    key = '.'.join(args)\n    return dbt_load_df_function(sources[key])\n\n\nconfig_dict = {}\n\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = \"storage\"\n    schema = \"dfb\"\n    identifier = \"dim_dfb_nfl_teams_data\"\n    \n    def __repr__(self):\n        return 'storage.dfb.dim_dfb_nfl_teams_data'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = False\n\n# COMMAND ----------\n\n# To run this in snowsight, you need to select entry point to be main\n# And you may have to modify the return type to text to get the result back\n# def main(session):\n#     dbt = dbtObj(session.table)\n#     df = model(dbt, session)\n#     return df.collect()\n\n# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python\n# then you can do the following to run model\n# dbt = dbtObj(session.table)\n# df = model(dbt, session)\n\n\ndef materialize(session, df, target_relation):\n    # make sure pandas exists\n    import importlib.util\n    package_name = 'pandas'\n    if importlib.util.find_spec(package_name):\n        import pandas\n        if isinstance(df, pandas.core.frame.DataFrame):\n          session.use_database(target_relation.database)\n          session.use_schema(target_relation.schema)\n          # session.write_pandas does not have overwrite function\n          df = session.createDataFrame(df)\n    \n    df.write.mode(\"overwrite\").save_as_table('storage.dfb.dim_dfb_nfl_teams_data', table_type='transient')\n\ndef main(session):\n    dbt = dbtObj(session.table)\n    df = model(dbt, session)\n    materialize(session, df, dbt.this)\n    return \"OK\"\n\n  \n$$\nCALL dim_dfb_nfl_teams_data__dbt_sp();"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "On model.dfb_data.dim_dfb_nfl_teams_data: /* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"node_id\": \"model.dfb_data.dim_dfb_nfl_teams_data\"} */\nWITH dim_dfb_nfl_teams_data__dbt_sp AS PROCEDURE ()\n\nRETURNS STRING\nLANGUAGE PYTHON\nRUNTIME_VERSION = '3.8'\nPACKAGES = ('snowflake-snowpark-python')\n\nHANDLER = 'main'\nEXECUTE AS CALLER\nAS\n$$\n\nimport sys\nsys._xoptions['snowflake_partner_attribution'].append(\"dbtLabs_dbtPython\")\n\n\n  \n    \nimport snowflake.snowpark.functions as F\r\n\r\ndef model(dbt, session):\r\n    df = dbt.ref('py_nfl_data')\r\n    df1 = dbt.ref('fct_nfl_teams')\r\n    data_df = df.join(df1, df['Game_Info'] == df1['abbrev'])\r\n    return data_df\n\n\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\ndef ref(*args, **kwargs):\n    refs = {\"fct_nfl_teams\": \"storage.dfb.fct_nfl_teams\", \"py_nfl_data\": \"storage.dfb.py_nfl_data\"}\n    key = '.'.join(args)\n    version = kwargs.get(\"v\") or kwargs.get(\"version\")\n    if version:\n        key += f\".v{version}\"\n    dbt_load_df_function = kwargs.get(\"dbt_load_df_function\")\n    return dbt_load_df_function(refs[key])\n\n\ndef source(*args, dbt_load_df_function):\n    sources = {}\n    key = '.'.join(args)\n    return dbt_load_df_function(sources[key])\n\n\nconfig_dict = {}\n\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = \"storage\"\n    schema = \"dfb\"\n    identifier = \"dim_dfb_nfl_teams_data\"\n    \n    def __repr__(self):\n        return 'storage.dfb.dim_dfb_nfl_teams_data'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = False\n\n# COMMAND ----------\n\n# To run this in snowsight, you need to select entry point to be main\n# And you may have to modify the return type to text to get the result back\n# def main(session):\n#     dbt = dbtObj(session.table)\n#     df = model(dbt, session)\n#     return df.collect()\n\n# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python\n# then you can do the following to run model\n# dbt = dbtObj(session.table)\n# df = model(dbt, session)\n\n\ndef materialize(session, df, target_relation):\n    # make sure pandas exists\n    import importlib.util\n    package_name = 'pandas'\n    if importlib.util.find_spec(package_name):\n        import pandas\n        if isinstance(df, pandas.core.frame.DataFrame):\n          session.use_database(target_relation.database)\n          session.use_schema(target_relation.schema)\n          # session.write_pandas does not have overwrite function\n          df = session.createDataFrame(df)\n    \n    df.write.mode(\"overwrite\").save_as_table('storage.dfb.dim_dfb_nfl_teams_data', table_type='transient')\n\ndef main(session):\n    dbt = dbtObj(session.table)\n    df = model(dbt, session)\n    materialize(session, df, dbt.this)\n    return \"OK\"\n\n  \n$$\nCALL dim_dfb_nfl_teams_data__dbt_sp();", "name": "SQLQuery", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.487042Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:46.491054Z"}}
{"data": {"elapsed": 5.0, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}, "status": "SUCCESS 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "SQL status: SUCCESS 1 in 5.0 seconds", "name": "SQLQueryStatus", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:51.590463Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}, "timing_info": {"completed_at": "2024-11-08T03:24:51.671794Z", "name": "execute", "started_at": "2024-11-08T03:24:46.340962Z"}}, "info": {"category": "", "code": "Z010", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Timing info for model.dfb_data.dim_dfb_nfl_teams_data (execute): 22:24:46.340962 => 22:24:51.671794", "name": "TimingInfoCollected", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:51.672794Z"}}
{"data": {"conn_name": "model.dfb_data.dim_dfb_nfl_teams_data", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "On model.dfb_data.dim_dfb_nfl_teams_data: Close", "name": "ConnectionClosed", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:51.675794Z"}}
{"data": {"description": "python table model dfb.dim_dfb_nfl_teams_data", "execution_time": 5.7056684, "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-08T03:24:51.901821", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "success", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}, "status": "SUCCESS 1", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "1 of 1 OK created python table model dfb.dim_dfb_nfl_teams_data ................ [\u001b[32mSUCCESS 1\u001b[0m in 5.71s]", "name": "LogModelResult", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:51.902823Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-08T03:24:51.901821", "node_name": "dim_dfb_nfl_teams_data", "node_path": "mart\\dim_dfb_nfl_teams_data.py", "node_relation": {"alias": "dim_dfb_nfl_teams_data", "database": "storage", "relation_name": "storage.dfb.dim_dfb_nfl_teams_data", "schema": "dfb"}, "node_started_at": "2024-11-08T03:24:46.188151", "node_status": "success", "resource_type": "model", "unique_id": "model.dfb_data.dim_dfb_nfl_teams_data"}, "run_result": {"adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "query_id": "01b839ac-0102-2dcc-0006-b1e60004100a", "rows_affected": 1.0}, "execution_time": 5.7056684, "message": "SUCCESS 1", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-08T03:24:46.331524Z", "name": "compile", "started_at": "2024-11-08T03:24:46.205166Z"}, {"completed_at": "2024-11-08T03:24:51.671794Z", "name": "execute", "started_at": "2024-11-08T03:24:46.340962Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Finished running node model.dfb_data.dim_dfb_nfl_teams_data", "name": "NodeFinished", "pid": 28620, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:24:51.906822Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:51.919130Z"}}
{"data": {"conn_name": "list_storage"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Connection 'list_storage' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:51.922619Z"}}
{"data": {"conn_name": "list_storage_dfb"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Connection 'list_storage_dfb' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:51.926202Z"}}
{"data": {"conn_name": "model.dfb_data.dim_dfb_nfl_teams_data"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Connection 'model.dfb_data.dim_dfb_nfl_teams_data' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:51.928211Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "", "name": "Formatting", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:51.931739Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 11.21 seconds", "execution_time": 11.208999, "stat_line": "1 table model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "Finished running 1 table model in 0 hours 0 minutes and 11.21 seconds (11.21s).", "name": "FinishedRunningStats", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:51.935737Z"}}
{"data": {"elapsed_time": 11.208999, "generated_at": "2024-11-08T03:24:51Z", "results": [{"adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "query_id": "01b839ac-0102-2dcc-0006-b1e60004100a", "rows_affected": 1.0}, "execution_time": 5.7056684, "message": "SUCCESS 1", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-08T03:24:46.331524Z", "name": "compile", "started_at": "2024-11-08T03:24:46.205166Z"}, {"completed_at": "2024-11-08T03:24:51.671794Z", "name": "execute", "started_at": "2024-11-08T03:24:46.340962Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:51.941349Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "", "name": "Formatting", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:52.005Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:52.008945Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "", "name": "Formatting", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:52.012950Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:52.015940Z"}}
{"data": {"command": "dbt build", "completed_at": "2024-11-08T03:24:52.019990Z", "elapsed": 12.900225, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Command `dbt build` succeeded at 22:24:52.019990 after 12.90 seconds", "name": "CommandCompleted", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:52.020990Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "8959ff5b-8b68-44fd-af53-a550a6dcfd50", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 28620, "thread": "MainThread", "ts": "2024-11-08T03:24:52.025033Z"}}
