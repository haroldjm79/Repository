{"data": {"log_version": 3, "version": "=1.7.18"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "Running with dbt=1.7.18", "name": "MainReportVersion", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:07.174303Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --vars {\"start_date\": \"2022-01-24T00:00:00+00:00\", \"end_date\": \"2024-11-08T00:00:00+00:00\"} --select fct_nfl_teams", "log_cache_events": "False", "log_format": "json", "log_path": "C:\\Users\\harol\\Documents\\GitHub\\Repository\\dbt_dailyfantasybuzz\\dfb_data\\target\\dbtlearn_partitioned_dbt_assets-45bd42f-25b71e9", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "C:\\Users\\harol\\.dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target\\dbtlearn_partitioned_dbt_assets-45bd42f-25b71e9", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\\\Users\\\\harol\\\\Documents\\\\GitHub\\\\Repository\\\\dbt_dailyfantasybuzz\\\\dfb_data\\\\target\\\\dbtlearn_partitioned_dbt_assets-45bd42f-25b71e9', 'profiles_dir': 'C:\\\\Users\\\\harol\\\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'json', 'introspect': 'True', 'target_path': 'target\\\\dbtlearn_partitioned_dbt_assets-45bd42f-25b71e9', 'invocation_command': 'dbt build --vars {\"start_date\": \"2022-01-24T00:00:00+00:00\", \"end_date\": \"2024-11-08T00:00:00+00:00\"} --select fct_nfl_teams', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:07.185813Z"}}
{"data": {"adapter_name": "snowflake", "adapter_version": "=1.7.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "Registered adapter: snowflake=1.7.1", "name": "AdapterRegistered", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:08.067582Z"}}
{"data": {"checksum": "8662103cb7f309c3002a4c77e66e234bd9e24a354be799324c15d89be7de2b26", "profile": "", "target": "", "vars": "{'end_date': '2024-11-08T00:00:00+00:00',\n 'start_date': '2022-01-24T00:00:00+00:00'}", "version": "1.7.18"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "checksum: 8662103cb7f309c3002a4c77e66e234bd9e24a354be799324c15d89be7de2b26, vars: {'end_date': '2024-11-08T00:00:00+00:00',\n 'start_date': '2022-01-24T00:00:00+00:00'}, profile: , target: , version: 1.7.18", "name": "StateCheckVarsHash", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:08.089290Z"}}
{"data": {"reason": "config vars, config profile, or config target have changed"}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "Unable to do partial parsing because config vars, config profile, or config target have changed", "name": "UnableToPartialParse", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:08.212595Z"}}
{"data": {"msg": "previous checksum: 8662103cb7f309c3002a4c77e66e234bd9e24a354be799324c15d89be7de2b26, current checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08"}, "info": {"category": "", "code": "Z050", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "previous checksum: 8662103cb7f309c3002a4c77e66e234bd9e24a354be799324c15d89be7de2b26, current checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08", "name": "Note", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:08.212595Z"}}
{"data": {"stat_line": "7 models, 6 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "Found 7 models, 6 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models", "name": "FoundStats", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:11.623866Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "", "name": "Formatting", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:11.623866Z"}}
{"data": {"conn_name": "master", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Acquiring new snowflake connection 'master'", "name": "NewConnection", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:11.629069Z"}}
{"data": {"conn_name": "list_storage", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Acquiring new snowflake connection 'list_storage'", "name": "NewConnection", "pid": 32692, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:17:11.629069Z"}}
{"data": {"conn_name": "list_storage", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Using snowflake connection \"list_storage\"", "name": "ConnectionUsed", "pid": 32692, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:17:11.648006Z"}}
{"data": {"conn_name": "list_storage", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"connection_name\": \"list_storage\"} */\nshow terse schemas in database storage\n    limit 10000"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "On list_storage: /* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"connection_name\": \"list_storage\"} */\nshow terse schemas in database storage\n    limit 10000", "name": "SQLQuery", "pid": 32692, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:17:11.653611Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 32692, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:17:11.655723Z"}}
{"data": {"elapsed": 2.0, "status": "SUCCESS 3"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "SQL status: SUCCESS 3 in 2.0 seconds", "name": "SQLQueryStatus", "pid": 32692, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:17:13.651876Z"}}
{"data": {"conn_name": "list_storage"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "On list_storage: Close", "name": "ConnectionClosed", "pid": 32692, "thread": "ThreadPoolExecutor-0_0", "ts": "2024-11-08T03:17:13.651876Z"}}
{"data": {"conn_name": "list_storage_dfb", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Acquiring new snowflake connection 'list_storage_dfb'", "name": "NewConnection", "pid": 32692, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:17:14.065774Z"}}
{"data": {"conn_name": "list_storage_dfb", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Using snowflake connection \"list_storage_dfb\"", "name": "ConnectionUsed", "pid": 32692, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:17:14.081832Z"}}
{"data": {"conn_name": "list_storage_dfb", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"connection_name\": \"list_storage_dfb\"} */\nshow terse objects in storage.dfb limit 10000"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "On list_storage_dfb: /* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"connection_name\": \"list_storage_dfb\"} */\nshow terse objects in storage.dfb limit 10000", "name": "SQLQuery", "pid": 32692, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:17:14.081832Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 32692, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:17:14.081832Z"}}
{"data": {"elapsed": 2.0, "status": "SUCCESS 9"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "SQL status: SUCCESS 9 in 2.0 seconds", "name": "SQLQueryStatus", "pid": 32692, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:17:15.593591Z"}}
{"data": {"conn_name": "list_storage_dfb"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "On list_storage_dfb: Close", "name": "ConnectionClosed", "pid": 32692, "thread": "ThreadPoolExecutor-2_0", "ts": "2024-11-08T03:17:15.593591Z"}}
{"data": {"node_count": 1, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:15.799857Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "", "name": "Formatting", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:15.815445Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "started", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Began running node model.dfb_data.fct_nfl_teams", "name": "NodeStart", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:15.815445Z"}}
{"data": {"description": "python table model dfb.fct_nfl_teams", "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "started", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "1 of 1 START python table model dfb.fct_nfl_teams .............................. [RUN]", "name": "LogStartLine", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:15.815445Z"}}
{"data": {"conn_name": "model.dfb_data.fct_nfl_teams", "conn_type": "snowflake", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "started", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Acquiring new snowflake connection 'model.dfb_data.fct_nfl_teams'", "name": "NewConnection", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:15.832649Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "compiling", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Began compiling node model.dfb_data.fct_nfl_teams", "name": "NodeCompiling", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:15.835068Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "compiling", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Writing injected SQL for node \"model.dfb_data.fct_nfl_teams\"", "name": "WritingInjectedSQLForNode", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:15.895369Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "compiling", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}, "timing_info": {"completed_at": "2024-11-08T03:17:15.935906Z", "name": "compile", "started_at": "2024-11-08T03:17:15.836489Z"}}, "info": {"category": "", "code": "Z010", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Timing info for model.dfb_data.fct_nfl_teams (compile): 22:17:15.836489 => 22:17:15.935906", "name": "TimingInfoCollected", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:15.938452Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Began executing node model.dfb_data.fct_nfl_teams", "name": "NodeExecuting", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:15.938452Z"}}
{"data": {"msg": "Writing runtime python for node \"model.dfb_data.fct_nfl_teams\"", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Writing runtime python for node \"model.dfb_data.fct_nfl_teams\"", "name": "JinjaLogDebug", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:15.998927Z"}}
{"data": {"conn_name": "model.dfb_data.fct_nfl_teams", "conn_type": "snowflake", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Using snowflake connection \"model.dfb_data.fct_nfl_teams\"", "name": "ConnectionUsed", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:16.006764Z"}}
{"data": {"conn_name": "model.dfb_data.fct_nfl_teams", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"node_id\": \"model.dfb_data.fct_nfl_teams\"} */\nWITH fct_nfl_teams__dbt_sp AS PROCEDURE ()\n\nRETURNS STRING\nLANGUAGE PYTHON\nRUNTIME_VERSION = '3.8'\nPACKAGES = ('snowflake-snowpark-python')\n\nHANDLER = 'main'\nEXECUTE AS CALLER\nAS\n$$\n\nimport sys\nsys._xoptions['snowflake_partner_attribution'].append(\"dbtLabs_dbtPython\")\n\n\n  \n    \nimport snowflake.snowpark.functions as F\r\n\r\ndef model(dbt, session):\r\n    data_df = dbt.ref('stg_nfl_teams')\r\n    return data_df\n\n\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\ndef ref(*args, **kwargs):\n    refs = {\"stg_nfl_teams\": \"storage.dfb.stg_nfl_teams\"}\n    key = '.'.join(args)\n    version = kwargs.get(\"v\") or kwargs.get(\"version\")\n    if version:\n        key += f\".v{version}\"\n    dbt_load_df_function = kwargs.get(\"dbt_load_df_function\")\n    return dbt_load_df_function(refs[key])\n\n\ndef source(*args, dbt_load_df_function):\n    sources = {}\n    key = '.'.join(args)\n    return dbt_load_df_function(sources[key])\n\n\nconfig_dict = {}\n\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = \"storage\"\n    schema = \"dfb\"\n    identifier = \"fct_nfl_teams\"\n    \n    def __repr__(self):\n        return 'storage.dfb.fct_nfl_teams'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = False\n\n# COMMAND ----------\n\n# To run this in snowsight, you need to select entry point to be main\n# And you may have to modify the return type to text to get the result back\n# def main(session):\n#     dbt = dbtObj(session.table)\n#     df = model(dbt, session)\n#     return df.collect()\n\n# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python\n# then you can do the following to run model\n# dbt = dbtObj(session.table)\n# df = model(dbt, session)\n\n\ndef materialize(session, df, target_relation):\n    # make sure pandas exists\n    import importlib.util\n    package_name = 'pandas'\n    if importlib.util.find_spec(package_name):\n        import pandas\n        if isinstance(df, pandas.core.frame.DataFrame):\n          session.use_database(target_relation.database)\n          session.use_schema(target_relation.schema)\n          # session.write_pandas does not have overwrite function\n          df = session.createDataFrame(df)\n    \n    df.write.mode(\"overwrite\").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')\n\ndef main(session):\n    dbt = dbtObj(session.table)\n    df = model(dbt, session)\n    materialize(session, df, dbt.this)\n    return \"OK\"\n\n  \n$$\nCALL fct_nfl_teams__dbt_sp();"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "On model.dfb_data.fct_nfl_teams: /* {\"app\": \"dbt\", \"dbt_version\": \"1.7.18\", \"profile_name\": \"dfb_data\", \"target_name\": \"dev\", \"node_id\": \"model.dfb_data.fct_nfl_teams\"} */\nWITH fct_nfl_teams__dbt_sp AS PROCEDURE ()\n\nRETURNS STRING\nLANGUAGE PYTHON\nRUNTIME_VERSION = '3.8'\nPACKAGES = ('snowflake-snowpark-python')\n\nHANDLER = 'main'\nEXECUTE AS CALLER\nAS\n$$\n\nimport sys\nsys._xoptions['snowflake_partner_attribution'].append(\"dbtLabs_dbtPython\")\n\n\n  \n    \nimport snowflake.snowpark.functions as F\r\n\r\ndef model(dbt, session):\r\n    data_df = dbt.ref('stg_nfl_teams')\r\n    return data_df\n\n\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\ndef ref(*args, **kwargs):\n    refs = {\"stg_nfl_teams\": \"storage.dfb.stg_nfl_teams\"}\n    key = '.'.join(args)\n    version = kwargs.get(\"v\") or kwargs.get(\"version\")\n    if version:\n        key += f\".v{version}\"\n    dbt_load_df_function = kwargs.get(\"dbt_load_df_function\")\n    return dbt_load_df_function(refs[key])\n\n\ndef source(*args, dbt_load_df_function):\n    sources = {}\n    key = '.'.join(args)\n    return dbt_load_df_function(sources[key])\n\n\nconfig_dict = {}\n\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = \"storage\"\n    schema = \"dfb\"\n    identifier = \"fct_nfl_teams\"\n    \n    def __repr__(self):\n        return 'storage.dfb.fct_nfl_teams'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = False\n\n# COMMAND ----------\n\n# To run this in snowsight, you need to select entry point to be main\n# And you may have to modify the return type to text to get the result back\n# def main(session):\n#     dbt = dbtObj(session.table)\n#     df = model(dbt, session)\n#     return df.collect()\n\n# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python\n# then you can do the following to run model\n# dbt = dbtObj(session.table)\n# df = model(dbt, session)\n\n\ndef materialize(session, df, target_relation):\n    # make sure pandas exists\n    import importlib.util\n    package_name = 'pandas'\n    if importlib.util.find_spec(package_name):\n        import pandas\n        if isinstance(df, pandas.core.frame.DataFrame):\n          session.use_database(target_relation.database)\n          session.use_schema(target_relation.schema)\n          # session.write_pandas does not have overwrite function\n          df = session.createDataFrame(df)\n    \n    df.write.mode(\"overwrite\").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')\n\ndef main(session):\n    dbt = dbtObj(session.table)\n    df = model(dbt, session)\n    materialize(session, df, dbt.this)\n    return \"OK\"\n\n  \n$$\nCALL fct_nfl_teams__dbt_sp();", "name": "SQLQuery", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:16.006764Z"}}
{"data": {"connection_state": "init", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:16.006764Z"}}
{"data": {"elapsed": 4.0, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}, "status": "SUCCESS 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "SQL status: SUCCESS 1 in 4.0 seconds", "name": "SQLQueryStatus", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:19.693314Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}, "timing_info": {"completed_at": "2024-11-08T03:17:19.756306Z", "name": "execute", "started_at": "2024-11-08T03:17:15.938452Z"}}, "info": {"category": "", "code": "Z010", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Timing info for model.dfb_data.fct_nfl_teams (execute): 22:17:15.938452 => 22:17:19.756306", "name": "TimingInfoCollected", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:19.756306Z"}}
{"data": {"conn_name": "model.dfb_data.fct_nfl_teams", "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "executing", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "On model.dfb_data.fct_nfl_teams: Close", "name": "ConnectionClosed", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:19.756306Z"}}
{"data": {"description": "python table model dfb.fct_nfl_teams", "execution_time": 4.2887416, "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-08T03:17:20.104187", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "success", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}, "status": "SUCCESS 1", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "1 of 1 OK created python table model dfb.fct_nfl_teams ......................... [\u001b[32mSUCCESS 1\u001b[0m in 4.29s]", "name": "LogModelResult", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:20.104187Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_finished_at": "2024-11-08T03:17:20.104187", "node_name": "fct_nfl_teams", "node_path": "fct\\fct_nfl_teams.py", "node_relation": {"alias": "fct_nfl_teams", "database": "storage", "relation_name": "storage.dfb.fct_nfl_teams", "schema": "dfb"}, "node_started_at": "2024-11-08T03:17:15.815445", "node_status": "success", "resource_type": "model", "unique_id": "model.dfb_data.fct_nfl_teams"}, "run_result": {"adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "query_id": "01b839a5-0102-2dcc-0006-b1e60003fff6", "rows_affected": 1.0}, "execution_time": 4.2887416, "message": "SUCCESS 1", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-08T03:17:15.935906Z", "name": "compile", "started_at": "2024-11-08T03:17:15.836489Z"}, {"completed_at": "2024-11-08T03:17:19.756306Z", "name": "execute", "started_at": "2024-11-08T03:17:15.938452Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Finished running node model.dfb_data.fct_nfl_teams", "name": "NodeFinished", "pid": 32692, "thread": "Thread-1 (worker)", "ts": "2024-11-08T03:17:20.104187Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.121667Z"}}
{"data": {"conn_name": "list_storage"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Connection 'list_storage' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.123591Z"}}
{"data": {"conn_name": "list_storage_dfb"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Connection 'list_storage_dfb' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.125970Z"}}
{"data": {"conn_name": "model.dfb_data.fct_nfl_teams"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Connection 'model.dfb_data.fct_nfl_teams' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.128049Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "", "name": "Formatting", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.130263Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 8.51 seconds", "execution_time": 8.506396, "stat_line": "1 table model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "Finished running 1 table model in 0 hours 0 minutes and 8.51 seconds (8.51s).", "name": "FinishedRunningStats", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.131915Z"}}
{"data": {"elapsed_time": 8.506396, "generated_at": "2024-11-08T03:17:20Z", "results": [{"adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "query_id": "01b839a5-0102-2dcc-0006-b1e60003fff6", "rows_affected": 1.0}, "execution_time": 4.2887416, "message": "SUCCESS 1", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2024-11-08T03:17:15.935906Z", "name": "compile", "started_at": "2024-11-08T03:17:15.836489Z"}, {"completed_at": "2024-11-08T03:17:19.756306Z", "name": "execute", "started_at": "2024-11-08T03:17:15.938452Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.131915Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "", "name": "Formatting", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.179634Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.179634Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "", "name": "Formatting", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.183592Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.183592Z"}}
{"data": {"command": "dbt build", "completed_at": "2024-11-08T03:17:20.187294Z", "elapsed": 13.107669, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Command `dbt build` succeeded at 22:17:20.187294 after 13.11 seconds", "name": "CommandCompleted", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.187294Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "ef00388c-fd18-4623-94ea-4a2599c20834", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 32692, "thread": "MainThread", "ts": "2024-11-08T03:17:20.189310Z"}}
