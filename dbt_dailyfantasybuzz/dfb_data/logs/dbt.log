[0m12:16:40.498110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594BEACD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594BB02210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594BF1B090>]}


============================== 12:16:40.524872 | 65ed3129-ba71-4947-a244-5231f793aa4d ==============================
[0m12:16:40.524872 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:16:40.532888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init dfb_data', 'send_anonymous_usage_stats': 'True'}
[0m12:16:40.533730 [info ] [MainThread]: Setting up your profile.
[0m12:18:40.932338 [error] [MainThread]: Encountered an error:

[0m12:18:41.232548 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 516, in init
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\init.py", line 318, in run
    self.setup_profile(profile_name)
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\init.py", line 264, in setup_profile
    self.create_profile_from_target(adapter, profile_name=profile_name)
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\init.py", line 181, in create_profile_from_target
    self.create_profile_from_profile_template(profile_template, profile_name)
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\init.py", line 165, in create_profile_from_profile_template
    target = self.generate_target_from_input(prompts, initial_target)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\init.py", line 131, in generate_target_from_input
    target[key] = click.prompt(
                  ^^^^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\click\termui.py", line 164, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\click\termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m12:18:41.249238 [debug] [MainThread]: Command `dbt init` failed at 12:18:41.249238 after 121.09 seconds
[0m12:18:41.249238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015945021F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594BEDF950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001594BEDE190>]}
[0m12:18:41.260545 [debug] [MainThread]: Flushing usage events
[0m12:18:48.747410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF584CD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF584D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF58996D0>]}


============================== 12:18:48.762978 | 11516dcc-2b48-48a2-adfc-8cb8b6845244 ==============================
[0m12:18:48.762978 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:18:48.762978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt init dfb_data', 'send_anonymous_usage_stats': 'True'}
[0m12:18:48.762978 [info ] [MainThread]: Setting up your profile.
[0m12:20:31.663379 [error] [MainThread]: Encountered an error:

[0m12:20:31.673241 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 516, in init
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\init.py", line 318, in run
    self.setup_profile(profile_name)
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\init.py", line 264, in setup_profile
    self.create_profile_from_target(adapter, profile_name=profile_name)
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\init.py", line 181, in create_profile_from_target
    self.create_profile_from_profile_template(profile_template, profile_name)
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\init.py", line 165, in create_profile_from_profile_template
    target = self.generate_target_from_input(prompts, initial_target)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\init.py", line 131, in generate_target_from_input
    target[key] = click.prompt(
                  ^^^^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\click\termui.py", line 164, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\harol\AppData\Local\Programs\Python\Python311\Lib\site-packages\click\termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m12:20:31.689676 [debug] [MainThread]: Command `dbt init` failed at 12:20:31.689676 after 103.03 seconds
[0m12:20:31.699683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF5883A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFEE9A1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFF4C8A090>]}
[0m12:20:31.702428 [debug] [MainThread]: Flushing usage events
[0m12:20:39.517504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C52617B2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C526149550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C526149ED0>]}


============================== 12:20:39.517504 | 9b3c1ba5-d5d8-4714-94cc-b5ff2b1f8bd4 ==============================
[0m12:20:39.517504 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:20:39.517504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt init dfb_data', 'send_anonymous_usage_stats': 'True'}
[0m12:20:39.524770 [info ] [MainThread]: Setting up your profile.
[0m12:22:00.535093 [info ] [MainThread]: Profile dfb_data written to C:\Users\harol\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m12:22:00.549228 [debug] [MainThread]: Command `dbt init` succeeded at 12:22:00.545774 after 81.14 seconds
[0m12:22:00.550835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5261236D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C51F221F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C52617E390>]}
[0m12:22:00.550835 [debug] [MainThread]: Flushing usage events
[0m12:22:15.382604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223ECCBD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EC7AC190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EC7AC0D0>]}


============================== 12:22:15.382604 | 7ade08ac-c953-4d23-a28a-92c4d139a71c ==============================
[0m12:22:15.382604 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:22:15.382604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:22:15.382604 [info ] [MainThread]: dbt version: 1.7.18
[0m12:22:15.391662 [info ] [MainThread]: python version: 3.11.0
[0m12:22:15.391662 [info ] [MainThread]: python path: C:\Users\harol\AppData\Local\Programs\Python\Python311\python.exe
[0m12:22:15.391662 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m12:22:15.797553 [info ] [MainThread]: Using profiles dir at C:\Users\harol\.dbt
[0m12:22:15.797553 [info ] [MainThread]: Using profiles.yml file at C:\Users\harol\.dbt\profiles.yml
[0m12:22:15.797553 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\harol\PycharmProjects\pythonProject\dbt_course\dfb_data\dbt_project.yml
[0m12:22:15.797553 [info ] [MainThread]: adapter type: snowflake
[0m12:22:15.797553 [info ] [MainThread]: adapter version: 1.7.1
[0m12:22:15.998086 [info ] [MainThread]: Configuration:
[0m12:22:15.998086 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:22:15.998086 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:22:16.002305 [info ] [MainThread]: Required dependencies:
[0m12:22:16.002305 [debug] [MainThread]: Executing "git --help"
[0m12:22:16.209982 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:22:16.209982 [debug] [MainThread]: STDERR: "b''"
[0m12:22:16.209982 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:22:16.209982 [info ] [MainThread]: Connection:
[0m12:22:16.220015 [info ] [MainThread]:   account: jeafyje-yz77125
[0m12:22:16.220015 [info ] [MainThread]:   user: haroldjm79
[0m12:22:16.220015 [info ] [MainThread]:   database: NFL
[0m12:22:16.228726 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:22:16.230168 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:22:16.235068 [info ] [MainThread]:   schema: dfb_data
[0m12:22:16.235068 [info ] [MainThread]:   authenticator: None
[0m12:22:16.235068 [info ] [MainThread]:   private_key_path: None
[0m12:22:16.235068 [info ] [MainThread]:   token: None
[0m12:22:16.241809 [info ] [MainThread]:   oauth_client_id: None
[0m12:22:16.243317 [info ] [MainThread]:   query_tag: None
[0m12:22:16.243317 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:22:16.243317 [info ] [MainThread]:   host: None
[0m12:22:16.243317 [info ] [MainThread]:   port: None
[0m12:22:16.250916 [info ] [MainThread]:   proxy_host: None
[0m12:22:16.252085 [info ] [MainThread]:   proxy_port: None
[0m12:22:16.252085 [info ] [MainThread]:   protocol: None
[0m12:22:16.252085 [info ] [MainThread]:   connect_retries: 1
[0m12:22:16.257414 [info ] [MainThread]:   connect_timeout: None
[0m12:22:16.258994 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:22:16.259840 [info ] [MainThread]:   retry_all: False
[0m12:22:16.259840 [info ] [MainThread]:   insecure_mode: False
[0m12:22:16.259840 [info ] [MainThread]:   reuse_connections: None
[0m12:22:16.264159 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:22:16.266906 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:22:16.266906 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:22:16.266906 [debug] [MainThread]: On debug: select 1 as id
[0m12:22:16.266906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:20.205142 [debug] [MainThread]: SQL status: SUCCESS 1 in 4.0 seconds
[0m12:22:20.205142 [debug] [MainThread]: On debug: Close
[0m12:22:20.814848 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:22:20.822852 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:22:20.822852 [debug] [MainThread]: Command `dbt debug` succeeded at 12:22:20.822852 after 5.57 seconds
[0m12:22:20.831031 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:22:20.831031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E5E71FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223EC89DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223E6147D90>]}
[0m12:22:20.831031 [debug] [MainThread]: Flushing usage events
[0m12:22:30.055849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DAC4B490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DAC1D650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DA8352D0>]}


============================== 12:22:30.061119 | 12c60945-07d1-49b8-901c-506966c60644 ==============================
[0m12:22:30.061119 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:22:30.064312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:31.769896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12c60945-07d1-49b8-901c-506966c60644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DC80E650>]}
[0m12:22:31.928468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12c60945-07d1-49b8-901c-506966c60644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DC79C750>]}
[0m12:22:31.944172 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:22:32.060208 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:22:32.061256 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:22:32.061256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12c60945-07d1-49b8-901c-506966c60644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DC7D3E10>]}
[0m12:22:35.475232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dfb_data.dim
[0m12:22:35.525885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12c60945-07d1-49b8-901c-506966c60644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DCA43B10>]}
[0m12:22:35.549587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12c60945-07d1-49b8-901c-506966c60644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DCB0DE90>]}
[0m12:22:35.552185 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:22:35.552185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c60945-07d1-49b8-901c-506966c60644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D670B4D0>]}
[0m12:22:35.552185 [info ] [MainThread]: 
[0m12:22:35.556349 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:22:35.556349 [debug] [MainThread]: Command end result
[0m12:22:35.572101 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:35.567584 after 5.61 seconds
[0m12:22:35.572101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D3D71FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1DA7CDD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1D4047D90>]}
[0m12:22:35.572101 [debug] [MainThread]: Flushing usage events
[0m12:27:35.072159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3ABBCCF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3ABBCE7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3ABBCD490>]}


============================== 12:27:35.072159 | 755a2584-d768-4c70-b8dd-ad3cb28e27d5 ==============================
[0m12:27:35.072159 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:27:35.072159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:27:35.772920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '755a2584-d768-4c70-b8dd-ad3cb28e27d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3AD77D590>]}
[0m12:27:35.898365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '755a2584-d768-4c70-b8dd-ad3cb28e27d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3AC72ECD0>]}
[0m12:27:35.898365 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:27:35.918837 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:27:36.214769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:27:36.214769 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\dim\dim_dfb_nfl_data.sql
[0m12:27:36.581080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '755a2584-d768-4c70-b8dd-ad3cb28e27d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3AD844CD0>]}
[0m12:27:36.595585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '755a2584-d768-4c70-b8dd-ad3cb28e27d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3ADC1AB90>]}
[0m12:27:36.595585 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:27:36.595585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '755a2584-d768-4c70-b8dd-ad3cb28e27d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3ADA8D1D0>]}
[0m12:27:36.610088 [info ] [MainThread]: 
[0m12:27:36.613200 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:27:36.615221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NFL'
[0m12:27:36.628767 [debug] [ThreadPool]: Using snowflake connection "list_NFL"
[0m12:27:36.629635 [debug] [ThreadPool]: On list_NFL: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_NFL"} */
show terse schemas in database NFL
    limit 10000
[0m12:27:36.630684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:39.357442 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b80fbb-0102-278a-0006-b1e600030d16
[0m12:27:39.357442 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:27:39.357442 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m12:27:39.357442 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:27:39.357442 [debug] [ThreadPool]: On list_NFL: Close
[0m12:27:39.562888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:39.562888 [debug] [MainThread]: Connection 'list_NFL' was properly closed.
[0m12:27:39.572895 [info ] [MainThread]: 
[0m12:27:39.572895 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m12:27:39.576925 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "NFL"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m12:27:39.583538 [debug] [MainThread]: Command `dbt run` failed at 12:27:39.583538 after 4.61 seconds
[0m12:27:39.586838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3A4D91FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3ABBCD290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3ABBCEB10>]}
[0m12:27:39.589286 [debug] [MainThread]: Flushing usage events
[0m12:30:21.140401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384116B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384114D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023841172A50>]}


============================== 12:30:21.140401 | 79667e7b-8bb1-443e-be11-4b4ae8488752 ==============================
[0m12:30:21.140401 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:30:21.151376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:21.744594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79667e7b-8bb1-443e-be11-4b4ae8488752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023842D56A50>]}
[0m12:30:21.854928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79667e7b-8bb1-443e-be11-4b4ae8488752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023842D56A50>]}
[0m12:30:21.854928 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:30:21.878712 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:30:21.916359 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:30:21.931245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79667e7b-8bb1-443e-be11-4b4ae8488752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023842F2F150>]}
[0m12:30:23.156996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79667e7b-8bb1-443e-be11-4b4ae8488752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002384303F5D0>]}
[0m12:30:23.172631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79667e7b-8bb1-443e-be11-4b4ae8488752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023843106590>]}
[0m12:30:23.180668 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:30:23.180668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79667e7b-8bb1-443e-be11-4b4ae8488752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023842F5B4D0>]}
[0m12:30:23.180668 [info ] [MainThread]: 
[0m12:30:23.180668 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:30:23.180668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:30:23.199517 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:30:23.199517 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:30:23.199517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:25.373053 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:30:25.373053 [debug] [ThreadPool]: On list_storage: Close
[0m12:30:25.651746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:30:25.666758 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:30:25.666758 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:30:25.666758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:26.809011 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:30:26.809011 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:30:27.087026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79667e7b-8bb1-443e-be11-4b4ae8488752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238430AE250>]}
[0m12:30:27.087026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:30:27.087026 [info ] [MainThread]: 
[0m12:30:27.123134 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:30:27.123134 [info ] [Thread-1 (]: 1 of 1 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:30:27.133093 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.dim_dfb_nfl_data'
[0m12:30:27.135439 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:30:27.155123 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:30:27.155123 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:30:27.174765 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:30:27.135439 => 12:30:27.174765
[0m12:30:27.176117 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:30:27.231234 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:30:27.234597 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:30:27.234597 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (

), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)Select * from A
  );
[0m12:30:27.234597 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:30:28.948869 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b80fbe-0102-278a-0006-b1e600030d4e
[0m12:30:28.963893 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected ')'.
syntax error line 12 at position 1 unexpected 'Select'.
[0m12:30:28.963893 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:30:27.176117 => 12:30:28.963893
[0m12:30:28.967700 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:30:29.338098 [debug] [Thread-1 (]: Database Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected ')'.
  syntax error line 12 at position 1 unexpected 'Select'.
  compiled Code at target\run\dfb_data\models\dim\dim_dfb_nfl_data.sql
[0m12:30:29.353759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79667e7b-8bb1-443e-be11-4b4ae8488752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023842ECF4D0>]}
[0m12:30:29.353759 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dfb.dim_dfb_nfl_data ...................... [[31mERROR[0m in 2.22s]
[0m12:30:29.353759 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:30:29.353759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:29.353759 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:30:29.369368 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:30:29.371919 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_data' was properly closed.
[0m12:30:29.373071 [info ] [MainThread]: 
[0m12:30:29.376123 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.19 seconds (6.19s).
[0m12:30:29.376123 [debug] [MainThread]: Command end result
[0m12:30:29.393407 [info ] [MainThread]: 
[0m12:30:29.399867 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:29.401946 [info ] [MainThread]: 
[0m12:30:29.401946 [error] [MainThread]:   Database Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected ')'.
  syntax error line 12 at position 1 unexpected 'Select'.
  compiled Code at target\run\dfb_data\models\dim\dim_dfb_nfl_data.sql
[0m12:30:29.405573 [info ] [MainThread]: 
[0m12:30:29.408087 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:30:29.408087 [debug] [MainThread]: Command `dbt run` failed at 12:30:29.408087 after 8.40 seconds
[0m12:30:29.408087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002383A211FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002383A257650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023840D623D0>]}
[0m12:30:29.408087 [debug] [MainThread]: Flushing usage events
[0m12:32:24.763306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD10F9EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD10F9F750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD10F9EB10>]}


============================== 12:32:24.763306 | 8db5cafe-b135-4065-9e59-33504a5b27bd ==============================
[0m12:32:24.763306 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:32:24.763306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:32:25.514964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8db5cafe-b135-4065-9e59-33504a5b27bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD11AFF390>]}
[0m12:32:25.624673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8db5cafe-b135-4065-9e59-33504a5b27bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD12B4CD10>]}
[0m12:32:25.624673 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:32:25.624673 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:32:25.857590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:32:25.857590 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\dim_dfb_nfl_data.sql
[0m12:32:25.857590 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\src\src_dfb_Nfl_data.sql
[0m12:32:26.195717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8db5cafe-b135-4065-9e59-33504a5b27bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD12E73250>]}
[0m12:32:26.206114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8db5cafe-b135-4065-9e59-33504a5b27bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD12D82E90>]}
[0m12:32:26.213769 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:32:26.214895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db5cafe-b135-4065-9e59-33504a5b27bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD12CED710>]}
[0m12:32:26.215906 [info ] [MainThread]: 
[0m12:32:26.215906 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:26.221755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:32:26.232542 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:32:26.232542 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:32:26.232542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:27.705413 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:32:27.721586 [debug] [ThreadPool]: On list_storage: Close
[0m12:32:28.561020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:32:28.607861 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:32:28.607861 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:32:28.607861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:30.466277 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:32:30.466277 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:32:31.086116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db5cafe-b135-4065-9e59-33504a5b27bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD12E63C50>]}
[0m12:32:31.086116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:31.086116 [info ] [MainThread]: 
[0m12:32:31.101833 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:32:31.101833 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:32:31.101833 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:32:31.135969 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:32:31.139485 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:32:31.101833 => 12:32:31.139485
[0m12:32:31.139485 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:32:31.145643 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:32:31.145643 [info ] [Thread-1 (]: 1 of 1 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:32:31.151127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m12:32:31.151127 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:32:31.151127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:32:31.151127 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:32:31.151127 => 12:32:31.151127
[0m12:32:31.151127 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:32:31.200794 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:32:31.200794 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:32:31.216467 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
    select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.nfl
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m12:32:31.216467 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:32.613691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:32.676132 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:32:31.151127 => 12:32:32.676132
[0m12:32:32.676132 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:32:32.882975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8db5cafe-b135-4065-9e59-33504a5b27bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD12F74890>]}
[0m12:32:32.882975 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.73s]
[0m12:32:32.882975 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:32:32.898004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:32.901000 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:32:32.901000 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:32:32.904241 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_data' was properly closed.
[0m12:32:32.905987 [info ] [MainThread]: 
[0m12:32:32.905987 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m12:32:32.905987 [debug] [MainThread]: Command end result
[0m12:32:32.940853 [info ] [MainThread]: 
[0m12:32:32.947870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:32.950669 [info ] [MainThread]: 
[0m12:32:32.950669 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:32:32.956078 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:32.956078 after 8.29 seconds
[0m12:32:32.956078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD0A091FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD0A367D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD103CAA90>]}
[0m12:32:32.956078 [debug] [MainThread]: Flushing usage events
[0m12:38:45.665136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021206739BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021206739A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120677B190>]}


============================== 12:38:45.672158 | 96a296f6-977e-40ca-9d0b-fb08f9b44c73 ==============================
[0m12:38:45.672158 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:38:45.681556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:46.420056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96a296f6-977e-40ca-9d0b-fb08f9b44c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021207306F50>]}
[0m12:38:46.578240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96a296f6-977e-40ca-9d0b-fb08f9b44c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212067ABE10>]}
[0m12:38:46.578240 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:38:46.600486 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:38:46.763943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:46.763943 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:46.776954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96a296f6-977e-40ca-9d0b-fb08f9b44c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021207262350>]}
[0m12:38:46.790610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96a296f6-977e-40ca-9d0b-fb08f9b44c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120845DDD0>]}
[0m12:38:46.792618 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:38:46.793752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a296f6-977e-40ca-9d0b-fb08f9b44c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212022CB4D0>]}
[0m12:38:46.794676 [info ] [MainThread]: 
[0m12:38:46.794676 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:38:46.797974 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:38:46.816854 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:38:46.816854 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:38:46.816854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:48.701584 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:38:48.701584 [debug] [ThreadPool]: On list_storage: Close
[0m12:38:49.250814 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:38:49.282197 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:38:49.282197 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:38:49.282197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:50.283278 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:38:50.283278 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:38:50.493453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96a296f6-977e-40ca-9d0b-fb08f9b44c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212084BE950>]}
[0m12:38:50.493453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:38:50.493453 [info ] [MainThread]: 
[0m12:38:50.514997 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:38:50.517957 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:38:50.517957 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:38:50.536984 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:38:50.539308 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:38:50.517957 => 12:38:50.536984
[0m12:38:50.540058 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:38:50.542111 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:38:50.542111 [info ] [Thread-1 (]: 1 of 1 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:38:50.542111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m12:38:50.542111 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:38:50.551119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:38:50.551119 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:38:50.542111 => 12:38:50.551119
[0m12:38:50.551119 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:38:50.589933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:38:50.589933 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:38:50.589933 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
    select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.nfl
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m12:38:50.589933 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:38:52.073916 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b80fc6-0102-278c-0006-b1e60002fd4e
[0m12:38:52.073916 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STORAGE.DFB.NFL' does not exist or not authorized.
[0m12:38:52.073916 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:38:50.551119 => 12:38:52.073916
[0m12:38:52.073916 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:38:52.743635 [debug] [Thread-1 (]: Database Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL' does not exist or not authorized.
  compiled Code at target\run\dfb_data\models\dim\dim_dfb_nfl_data.sql
[0m12:38:52.743635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96a296f6-977e-40ca-9d0b-fb08f9b44c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120842EAD0>]}
[0m12:38:52.743635 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dfb.dim_dfb_nfl_data ...................... [[31mERROR[0m in 2.20s]
[0m12:38:52.762483 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:38:52.762483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:52.762483 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:38:52.772010 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:38:52.772010 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_data' was properly closed.
[0m12:38:52.775035 [info ] [MainThread]: 
[0m12:38:52.779445 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m12:38:52.784764 [debug] [MainThread]: Command end result
[0m12:38:52.802521 [info ] [MainThread]: 
[0m12:38:52.802521 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:38:52.805590 [info ] [MainThread]: 
[0m12:38:52.807423 [error] [MainThread]:   Database Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL' does not exist or not authorized.
  compiled Code at target\run\dfb_data\models\dim\dim_dfb_nfl_data.sql
[0m12:38:52.808429 [info ] [MainThread]: 
[0m12:38:52.810231 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:38:52.810764 [debug] [MainThread]: Command `dbt run` failed at 12:38:52.810764 after 7.33 seconds
[0m12:38:52.810764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127F8F1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127F936A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127F936A10>]}
[0m12:38:52.810764 [debug] [MainThread]: Flushing usage events
[0m12:39:52.694978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B39B9AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B339E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B3A24210>]}


============================== 12:39:52.694978 | 64ca2f84-54a9-4ebb-99e2-c7353f54a3d2 ==============================
[0m12:39:52.694978 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:39:52.700988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:53.289246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64ca2f84-54a9-4ebb-99e2-c7353f54a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B458EE10>]}
[0m12:39:53.393543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64ca2f84-54a9-4ebb-99e2-c7353f54a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B3A08210>]}
[0m12:39:53.396696 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:39:53.398028 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:39:53.537194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:39:53.537194 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\src\src_dfb_Nfl_data.sql
[0m12:39:53.932520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64ca2f84-54a9-4ebb-99e2-c7353f54a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B5906B50>]}
[0m12:39:53.963846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64ca2f84-54a9-4ebb-99e2-c7353f54a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B59E7150>]}
[0m12:39:53.963846 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:39:53.963846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64ca2f84-54a9-4ebb-99e2-c7353f54a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B571B510>]}
[0m12:39:53.979450 [info ] [MainThread]: 
[0m12:39:53.986109 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:53.988080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:39:54.000734 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:39:54.000734 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:39:54.000734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:56.025935 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:39:56.025935 [debug] [ThreadPool]: On list_storage: Close
[0m12:39:56.229875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:39:56.245492 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:39:56.245492 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:39:56.261109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:57.456349 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:39:57.459370 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:39:57.602240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64ca2f84-54a9-4ebb-99e2-c7353f54a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B5625810>]}
[0m12:39:57.602240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:57.602240 [info ] [MainThread]: 
[0m12:39:57.619036 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:39:57.619036 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:39:57.619036 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:39:57.651613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:39:57.651613 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:39:57.619036 => 12:39:57.651613
[0m12:39:57.651613 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:39:57.658273 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:39:57.658273 [info ] [Thread-1 (]: 1 of 1 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:39:57.658273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m12:39:57.658273 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:39:57.667635 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:39:57.667635 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:39:57.658273 => 12:39:57.667635
[0m12:39:57.667635 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:39:57.701631 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:39:57.701631 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:39:57.701631 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
    select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.nflraw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m12:39:57.707230 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:59.924936 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b80fc7-0102-278c-0006-b1e60002fd56
[0m12:39:59.924936 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STORAGE.DFB.NFLRAW_DFB_NFL_DATA' does not exist or not authorized.
[0m12:39:59.924936 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:39:57.667635 => 12:39:59.924936
[0m12:39:59.924936 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:40:00.527874 [debug] [Thread-1 (]: Database Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFLRAW_DFB_NFL_DATA' does not exist or not authorized.
  compiled Code at target\run\dfb_data\models\dim\dim_dfb_nfl_data.sql
[0m12:40:00.527874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64ca2f84-54a9-4ebb-99e2-c7353f54a3d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B5C84C90>]}
[0m12:40:00.543520 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dfb.dim_dfb_nfl_data ...................... [[31mERROR[0m in 2.87s]
[0m12:40:00.543520 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:40:00.543520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:00.543520 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:40:00.543520 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:40:00.559149 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_data' was properly closed.
[0m12:40:00.559149 [info ] [MainThread]: 
[0m12:40:00.563798 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m12:40:00.567131 [debug] [MainThread]: Command end result
[0m12:40:00.582114 [info ] [MainThread]: 
[0m12:40:00.588422 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:40:00.589690 [info ] [MainThread]: 
[0m12:40:00.631394 [error] [MainThread]:   Database Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFLRAW_DFB_NFL_DATA' does not exist or not authorized.
  compiled Code at target\run\dfb_data\models\dim\dim_dfb_nfl_data.sql
[0m12:40:00.632727 [info ] [MainThread]: 
[0m12:40:00.635506 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:40:00.638243 [debug] [MainThread]: Command `dbt run` failed at 12:40:00.638243 after 8.06 seconds
[0m12:40:00.639779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B39D0BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260ACB01FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260B39F0B10>]}
[0m12:40:00.639779 [debug] [MainThread]: Flushing usage events
[0m12:40:36.464252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001529702D1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015296D64790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001529702E090>]}


============================== 12:40:36.470286 | 31a059cc-234e-439d-9f97-4ce761fc8417 ==============================
[0m12:40:36.470286 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:40:36.473297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:40:37.150983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31a059cc-234e-439d-9f97-4ce761fc8417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001529702F210>]}
[0m12:40:37.252656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31a059cc-234e-439d-9f97-4ce761fc8417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015298C77450>]}
[0m12:40:37.260682 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:40:37.271626 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:40:37.455597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:37.455597 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\src\src_dfb_Nfl_data.sql
[0m12:40:37.771578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31a059cc-234e-439d-9f97-4ce761fc8417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015298EEBB90>]}
[0m12:40:37.777585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31a059cc-234e-439d-9f97-4ce761fc8417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015299062BD0>]}
[0m12:40:37.789816 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:40:37.789816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31a059cc-234e-439d-9f97-4ce761fc8417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015298D7D7D0>]}
[0m12:40:37.793392 [info ] [MainThread]: 
[0m12:40:37.794058 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:37.794058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:40:37.812125 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:40:37.812125 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:40:37.812125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:39.847343 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:40:39.847343 [debug] [ThreadPool]: On list_storage: Close
[0m12:40:40.060477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:40:40.074518 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:40:40.074518 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:40:40.074518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:41.318349 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:40:41.318349 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:40:41.586894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31a059cc-234e-439d-9f97-4ce761fc8417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015299230510>]}
[0m12:40:41.586894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:41.602542 [info ] [MainThread]: 
[0m12:40:41.602542 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:40:41.602542 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:40:41.602542 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:40:41.636992 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:40:41.639609 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:40:41.602542 => 12:40:41.639609
[0m12:40:41.639609 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:40:41.639609 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:40:41.649879 [info ] [Thread-1 (]: 1 of 1 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:40:41.653287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m12:40:41.653287 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:40:41.653287 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:40:41.653287 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:40:41.653287 => 12:40:41.653287
[0m12:40:41.653287 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:40:41.701022 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:40:41.713446 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:40:41.715103 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
    select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m12:40:41.715103 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:43.428941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:40:43.492371 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:40:41.664722 => 12:40:43.492371
[0m12:40:43.492371 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:40:43.842953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a059cc-234e-439d-9f97-4ce761fc8417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015299017D90>]}
[0m12:40:43.842953 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.19s]
[0m12:40:43.853927 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:40:43.860414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:43.862564 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:40:43.863711 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:40:43.867377 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_data' was properly closed.
[0m12:40:43.867377 [info ] [MainThread]: 
[0m12:40:43.873239 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m12:40:43.874274 [debug] [MainThread]: Command end result
[0m12:40:43.904770 [info ] [MainThread]: 
[0m12:40:43.908342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:43.911024 [info ] [MainThread]: 
[0m12:40:43.912847 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:43.919036 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:43.919036 after 7.58 seconds
[0m12:40:43.919036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015290131FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015296454610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015290407D90>]}
[0m12:40:43.919036 [debug] [MainThread]: Flushing usage events
[0m21:17:15.294870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F452D7F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F452D7F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F452D7FCD0>]}


============================== 21:17:15.342765 | 036411ca-ae31-4d67-b218-3e5a821d5fa5 ==============================
[0m21:17:15.342765 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:17:15.351673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:17:20.890842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '036411ca-ae31-4d67-b218-3e5a821d5fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45492D410>]}
[0m21:17:21.125416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '036411ca-ae31-4d67-b218-3e5a821d5fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F451639310>]}
[0m21:17:21.125416 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:17:21.193160 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:17:23.762264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:17:23.762264 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\dim\py_nfl_data.py
[0m21:17:24.029697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '036411ca-ae31-4d67-b218-3e5a821d5fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45385E690>]}
[0m21:17:24.189601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '036411ca-ae31-4d67-b218-3e5a821d5fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F454C6D210>]}
[0m21:17:24.189601 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:17:24.189601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036411ca-ae31-4d67-b218-3e5a821d5fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F454C518D0>]}
[0m21:17:24.202862 [info ] [MainThread]: 
[0m21:17:24.206852 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:17:24.206852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:17:24.225660 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:17:24.225660 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:17:24.225660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:26.850582 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m21:17:26.866120 [debug] [ThreadPool]: On list_storage: Close
[0m21:17:27.496222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:17:27.526019 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:17:27.526019 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:17:27.526019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:28.922260 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:17:28.936353 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:17:29.140911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036411ca-ae31-4d67-b218-3e5a821d5fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F45499D6D0>]}
[0m21:17:29.140911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:17:29.140911 [info ] [MainThread]: 
[0m21:17:29.240406 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:17:29.244085 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:17:29.244085 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:17:29.255111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:17:29.319581 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:17:29.244085 => 21:17:29.319581
[0m21:17:29.334103 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:17:29.334103 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:17:29.341067 [info ] [Thread-1 (]: 1 of 2 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m21:17:29.341067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m21:17:29.341067 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:17:29.361089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:17:29.369704 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:17:29.341067 => 21:17:29.369704
[0m21:17:29.373797 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:17:29.423314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:17:29.472468 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:17:29.472468 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
    select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m21:17:29.472468 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:17:31.193784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:17:31.239635 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:17:29.377775 => 21:17:31.239635
[0m21:17:31.239635 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:17:31.494350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036411ca-ae31-4d67-b218-3e5a821d5fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4549D6BD0>]}
[0m21:17:31.506285 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.15s]
[0m21:17:31.511710 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:17:31.511710 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:17:31.514724 [info ] [Thread-1 (]: 2 of 2 START python table model dfb.py_nfl_data ................................ [RUN]
[0m21:17:31.516472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.py_nfl_data)
[0m21:17:31.521382 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:17:31.575184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:17:31.575184 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:17:31.522620 => 21:17:31.575184
[0m21:17:31.575184 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:17:31.613383 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:17:31.613383 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:17:31.613383 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
with __dbt__cte__src_dfb_Nfl_data as (
With A as (
    select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
) import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('src_dfb_Nfl_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"src_dfb_Nfl_data": "__dbt__cte__src_dfb_Nfl_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:17:31.613383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:37.450292 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b811cd-0102-278c-0006-b1e60002fdc2
[0m21:17:37.450292 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
  File "_udf_code.py", line 10
    With A as (
         ^
SyntaxError: invalid syntax
 in function PY_NFL_DATA__DBT_SP with handler main
[0m21:17:37.450292 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:17:31.589224 => 21:17:37.450292
[0m21:17:37.450292 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:17:37.814978 [debug] [Thread-1 (]: Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
    File "_udf_code.py", line 10
      With A as (
           ^
  SyntaxError: invalid syntax
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m21:17:37.814978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036411ca-ae31-4d67-b218-3e5a821d5fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F454D747D0>]}
[0m21:17:37.814978 [error] [Thread-1 (]: 2 of 2 ERROR creating python table model dfb.py_nfl_data ....................... [[31mERROR[0m in 6.30s]
[0m21:17:37.814978 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:17:37.814978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:37.830638 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:17:37.830638 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:17:37.834734 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m21:17:37.838242 [info ] [MainThread]: 
[0m21:17:37.841779 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 13.63 seconds (13.63s).
[0m21:17:37.846901 [debug] [MainThread]: Command end result
[0m21:17:37.893276 [info ] [MainThread]: 
[0m21:17:37.893276 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:17:37.893276 [info ] [MainThread]: 
[0m21:17:37.893276 [error] [MainThread]:   Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
    File "_udf_code.py", line 10
      With A as (
           ^
  SyntaxError: invalid syntax
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m21:17:37.901577 [info ] [MainThread]: 
[0m21:17:37.901577 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:17:37.907255 [debug] [MainThread]: Command `dbt run` failed at 21:17:37.907255 after 22.94 seconds
[0m21:17:37.909770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F452D8EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F44BE81FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F451BFDDD0>]}
[0m21:17:37.912285 [debug] [MainThread]: Flushing usage events
[0m21:21:57.612278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633C98BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633CEDFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633CEDD710>]}


============================== 21:21:57.616348 | 49a7d82b-2357-4f1a-9a24-8ccc3693807f ==============================
[0m21:21:57.616348 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:21:57.616348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:21:58.304772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49a7d82b-2357-4f1a-9a24-8ccc3693807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633EA7B010>]}
[0m21:21:58.414705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49a7d82b-2357-4f1a-9a24-8ccc3693807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633DA02310>]}
[0m21:21:58.414705 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:21:58.442153 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:21:58.633104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:21:58.633104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:21:58.648801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49a7d82b-2357-4f1a-9a24-8ccc3693807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633ECB2090>]}
[0m21:21:58.664355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49a7d82b-2357-4f1a-9a24-8ccc3693807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633EBFE7D0>]}
[0m21:21:58.664355 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:21:58.664355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49a7d82b-2357-4f1a-9a24-8ccc3693807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633EB0B710>]}
[0m21:21:58.664355 [info ] [MainThread]: 
[0m21:21:58.681486 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:21:58.683028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:21:58.696860 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:21:58.704941 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:21:58.704941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:00.700312 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m21:22:00.714326 [debug] [ThreadPool]: On list_storage: Close
[0m21:22:01.060218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:22:01.075815 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:22:01.075815 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:22:01.075815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:02.949241 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m21:22:02.964892 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:22:03.315337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49a7d82b-2357-4f1a-9a24-8ccc3693807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633EC3BB10>]}
[0m21:22:03.315337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:22:03.315337 [info ] [MainThread]: 
[0m21:22:03.333115 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:22:03.334090 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:22:03.339719 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:22:03.363402 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:22:03.363402 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:22:03.342958 => 21:22:03.363402
[0m21:22:03.363402 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:22:03.372858 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:22:03.376763 [info ] [Thread-1 (]: 1 of 2 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m21:22:03.376763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m21:22:03.376763 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:22:03.392423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:22:03.392423 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:22:03.376763 => 21:22:03.392423
[0m21:22:03.397117 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:22:03.441624 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:22:03.457369 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:22:03.457369 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
    select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m21:22:03.457369 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:22:04.908518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:22:04.946890 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:22:03.397117 => 21:22:04.946890
[0m21:22:04.946890 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:22:05.114736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49a7d82b-2357-4f1a-9a24-8ccc3693807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633EAC1950>]}
[0m21:22:05.122123 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.74s]
[0m21:22:05.122709 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:22:05.122709 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:22:05.122709 [info ] [Thread-1 (]: 2 of 2 START python table model dfb.py_nfl_data ................................ [RUN]
[0m21:22:05.135695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.py_nfl_data)
[0m21:22:05.137910 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:22:05.183186 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:22:05.191409 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:22:05.138932 => 21:22:05.189757
[0m21:22:05.191409 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:22:05.215649 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:22:05.215649 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:22:05.215649 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
with __dbt__cte__src_dfb_Nfl_data as (
With A as (
    select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
) import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('src_dfb_Nfl_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"src_dfb_Nfl_data": "__dbt__cte__src_dfb_Nfl_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:22:05.215649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:07.314946 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b811d2-0102-278c-0006-b1e60002fdd2
[0m21:22:07.314946 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
  File "_udf_code.py", line 10
    With A as (
         ^
SyntaxError: invalid syntax
 in function PY_NFL_DATA__DBT_SP with handler main
[0m21:22:07.314946 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:22:05.191409 => 21:22:07.314946
[0m21:22:07.314946 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:22:07.925088 [debug] [Thread-1 (]: Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
    File "_udf_code.py", line 10
      With A as (
           ^
  SyntaxError: invalid syntax
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m21:22:07.925088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49a7d82b-2357-4f1a-9a24-8ccc3693807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633EC5DB90>]}
[0m21:22:07.925088 [error] [Thread-1 (]: 2 of 2 ERROR creating python table model dfb.py_nfl_data ....................... [[31mERROR[0m in 2.80s]
[0m21:22:07.925088 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:22:07.939601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:07.939601 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:22:07.939601 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:22:07.939601 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m21:22:07.939601 [info ] [MainThread]: 
[0m21:22:07.939601 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 9.26 seconds (9.26s).
[0m21:22:07.958251 [debug] [MainThread]: Command end result
[0m21:22:07.989440 [info ] [MainThread]: 
[0m21:22:07.992039 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:22:07.992039 [info ] [MainThread]: 
[0m21:22:07.997676 [error] [MainThread]:   Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
    File "_udf_code.py", line 10
      With A as (
           ^
  SyntaxError: invalid syntax
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m21:22:07.999430 [info ] [MainThread]: 
[0m21:22:07.999430 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:22:08.010761 [debug] [MainThread]: Command `dbt run` failed at 21:22:08.010761 after 10.56 seconds
[0m21:22:08.010761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016335FA1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633C9049D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001633EA67510>]}
[0m21:22:08.014276 [debug] [MainThread]: Flushing usage events
[0m21:22:56.564045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFA7C9D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFA7BF050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFA7BD250>]}


============================== 21:22:56.564045 | 912a91a0-6613-4488-aa58-edfdd37046cf ==============================
[0m21:22:56.564045 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:22:56.564045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:22:57.342148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '912a91a0-6613-4488-aa58-edfdd37046cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFB403010>]}
[0m21:22:57.453048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '912a91a0-6613-4488-aa58-edfdd37046cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFB3EE290>]}
[0m21:22:57.453048 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:22:57.474998 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:22:57.656225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:22:57.656225 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\src\src_dfb_Nfl_data.sql
[0m21:22:57.656225 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\py_nfl_data.py
[0m21:22:58.065816 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dfb_data.py_nfl_data' (models\dim\py_nfl_data.py) depends on a node named 'dfb.raw_dfb_nfl_data' which was not found
[0m21:22:58.065816 [debug] [MainThread]: Command `dbt run` failed at 21:22:58.065816 after 1.61 seconds
[0m21:22:58.065816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBF38F1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFA7BFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFA7BD310>]}
[0m21:22:58.065816 [debug] [MainThread]: Flushing usage events
[0m21:24:02.895503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF2C3F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF2CB78D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF2C3EB10>]}


============================== 21:24:02.911208 | f434b399-0598-4c9f-b792-d257d72757c2 ==============================
[0m21:24:02.911208 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:24:02.911208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:24:03.660812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f434b399-0598-4c9f-b792-d257d72757c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF480DA10>]}
[0m21:24:03.786406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f434b399-0598-4c9f-b792-d257d72757c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF2C4F650>]}
[0m21:24:03.786406 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:24:03.808348 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:24:03.923180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:24:03.923180 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\src\src_dfb_Nfl_data.sql
[0m21:24:04.363654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f434b399-0598-4c9f-b792-d257d72757c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF4C22890>]}
[0m21:24:04.379273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f434b399-0598-4c9f-b792-d257d72757c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF4A4FE10>]}
[0m21:24:04.394887 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:24:04.394887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f434b399-0598-4c9f-b792-d257d72757c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF491DD50>]}
[0m21:24:04.394887 [info ] [MainThread]: 
[0m21:24:04.394887 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:24:04.394887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:24:04.423361 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:24:04.424446 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:24:04.424446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:05.733760 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:24:05.749418 [debug] [ThreadPool]: On list_storage: Close
[0m21:24:05.940293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:24:05.971734 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:24:05.971734 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:24:05.971734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:07.788765 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m21:24:07.788765 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:24:08.264707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f434b399-0598-4c9f-b792-d257d72757c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF480E850>]}
[0m21:24:08.264707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:24:08.272896 [info ] [MainThread]: 
[0m21:24:08.282857 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:24:08.288377 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:24:08.291327 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:24:08.308251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:24:08.320284 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:24:08.295556 => 21:24:08.308251
[0m21:24:08.323028 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:24:08.323028 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:24:08.323028 [info ] [Thread-1 (]: 1 of 2 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m21:24:08.328615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m21:24:08.328615 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:24:08.336759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:24:08.340924 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:24:08.328615 => 21:24:08.340924
[0m21:24:08.340924 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:24:08.375129 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:24:08.375129 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:24:08.385190 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m21:24:08.385190 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:24:10.136370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:24:10.192653 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:24:08.340924 => 21:24:10.192653
[0m21:24:10.192653 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:24:10.437886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f434b399-0598-4c9f-b792-d257d72757c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF4E9B050>]}
[0m21:24:10.453530 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.11s]
[0m21:24:10.453530 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:24:10.453530 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:24:10.453530 [info ] [Thread-1 (]: 2 of 2 START python table model dfb.py_nfl_data ................................ [RUN]
[0m21:24:10.453530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.py_nfl_data)
[0m21:24:10.468818 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:24:10.558229 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:24:10.558229 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:24:10.471388 => 21:24:10.558229
[0m21:24:10.565871 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:24:10.620775 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:24:10.620775 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:24:10.620775 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
with __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
) import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('src_dfb_Nfl_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"src_dfb_Nfl_data": "__dbt__cte__src_dfb_Nfl_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:24:10.620775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:12.860254 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b811d4-0102-278a-0006-b1e600030f4a
[0m21:24:12.860254 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
  File "_udf_code.py", line 10
    With A as (
         ^
SyntaxError: invalid syntax
 in function PY_NFL_DATA__DBT_SP with handler main
[0m21:24:12.860254 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:24:10.565871 => 21:24:12.860254
[0m21:24:12.860254 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:24:13.573851 [debug] [Thread-1 (]: Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
    File "_udf_code.py", line 10
      With A as (
           ^
  SyntaxError: invalid syntax
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m21:24:13.573851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f434b399-0598-4c9f-b792-d257d72757c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF503B050>]}
[0m21:24:13.581382 [error] [Thread-1 (]: 2 of 2 ERROR creating python table model dfb.py_nfl_data ....................... [[31mERROR[0m in 3.12s]
[0m21:24:13.581382 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:24:13.589680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:13.589680 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:24:13.589680 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:24:13.589680 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m21:24:13.589680 [info ] [MainThread]: 
[0m21:24:13.589680 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m21:24:13.609397 [debug] [MainThread]: Command end result
[0m21:24:13.635951 [info ] [MainThread]: 
[0m21:24:13.639542 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:24:13.642031 [info ] [MainThread]: 
[0m21:24:13.644423 [error] [MainThread]:   Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
    File "_udf_code.py", line 10
      With A as (
           ^
  SyntaxError: invalid syntax
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m21:24:13.645021 [info ] [MainThread]: 
[0m21:24:13.647425 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:24:13.647425 [debug] [MainThread]: Command `dbt run` failed at 21:24:13.647425 after 10.85 seconds
[0m21:24:13.647425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEBD91FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEF0141A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEEBDD6A10>]}
[0m21:24:13.647425 [debug] [MainThread]: Flushing usage events
[0m21:40:00.455142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309041A910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308FDAE450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230903BEB10>]}


============================== 21:40:00.455142 | 838ba586-b864-446e-8ac3-63be7d184546 ==============================
[0m21:40:00.455142 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:40:00.455142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:40:01.083053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '838ba586-b864-446e-8ac3-63be7d184546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023091F8C7D0>]}
[0m21:40:01.208518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '838ba586-b864-446e-8ac3-63be7d184546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023091F84150>]}
[0m21:40:01.208518 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:40:01.232897 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:40:01.537269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:40:01.537269 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\staging\stg_dfb_data.sql
[0m21:40:01.543331 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\py_nfl_data.py
[0m21:40:01.978596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '838ba586-b864-446e-8ac3-63be7d184546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230921293D0>]}
[0m21:40:01.995188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '838ba586-b864-446e-8ac3-63be7d184546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230921DE790>]}
[0m21:40:01.995444 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:40:01.996748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '838ba586-b864-446e-8ac3-63be7d184546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230921DCF50>]}
[0m21:40:01.998702 [info ] [MainThread]: 
[0m21:40:01.998702 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:40:01.998702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:40:02.014835 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:40:02.014835 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:40:02.014835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:04.118364 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m21:40:04.123628 [debug] [ThreadPool]: On list_storage: Close
[0m21:40:04.458099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:40:04.488777 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:40:04.488777 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:40:04.488777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:06.257301 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m21:40:06.265392 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:40:06.887365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '838ba586-b864-446e-8ac3-63be7d184546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023092377F90>]}
[0m21:40:06.887365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:40:06.887365 [info ] [MainThread]: 
[0m21:40:06.901601 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:40:06.901601 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:40:06.901601 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:40:06.901601 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:40:06.901601 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:40:06.901601 => 21:40:06.901601
[0m21:40:06.901601 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:40:06.901601 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:40:06.917234 [info ] [Thread-1 (]: 1 of 3 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m21:40:06.919982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m21:40:06.921293 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:40:06.925331 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:40:06.925331 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:40:06.921293 => 21:40:06.925331
[0m21:40:06.925331 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:40:06.960109 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:40:06.973157 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:40:06.975528 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m21:40:06.975528 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:40:09.126240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:40:09.173354 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:40:06.925331 => 21:40:09.173354
[0m21:40:09.188993 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:40:09.320188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '838ba586-b864-446e-8ac3-63be7d184546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023092195350>]}
[0m21:40:09.320188 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.40s]
[0m21:40:09.320188 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:40:09.333621 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:40:09.333621 [info ] [Thread-1 (]: 2 of 3 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m21:40:09.339515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:40:09.340548 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:40:09.348640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:40:09.357263 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:40:09.340548 => 21:40:09.356023
[0m21:40:09.357957 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:40:09.360985 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:40:09.379137 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:40:09.379137 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m21:40:09.379137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:11.023767 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:40:11.023767 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:40:09.360985 => 21:40:11.023767
[0m21:40:11.041212 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:40:11.603965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '838ba586-b864-446e-8ac3-63be7d184546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309219D690>]}
[0m21:40:11.603965 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 2.27s]
[0m21:40:11.603965 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:40:11.603965 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:40:11.603965 [info ] [Thread-1 (]: 3 of 3 START python table model dfb.py_nfl_data ................................ [RUN]
[0m21:40:11.621388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.py_nfl_data)
[0m21:40:11.622762 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:40:11.659325 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:40:11.668908 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:40:11.625734 => 21:40:11.667863
[0m21:40:11.668908 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:40:11.730872 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:40:11.730872 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:40:11.738891 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:40:11.738891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:30.891055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 19.0 seconds
[0m21:40:30.895070 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:40:11.668908 => 21:40:30.895070
[0m21:40:30.895070 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:40:31.492387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '838ba586-b864-446e-8ac3-63be7d184546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309266AFD0>]}
[0m21:40:31.492387 [info ] [Thread-1 (]: 3 of 3 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 19.87s]
[0m21:40:31.492387 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:40:31.510375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:31.510375 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:40:31.510375 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:40:31.517395 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m21:40:31.517395 [info ] [MainThread]: 
[0m21:40:31.517395 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 29.52 seconds (29.52s).
[0m21:40:31.528180 [debug] [MainThread]: Command end result
[0m21:40:31.553911 [info ] [MainThread]: 
[0m21:40:31.556136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:40:31.561731 [info ] [MainThread]: 
[0m21:40:31.565152 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:40:31.565152 [debug] [MainThread]: Command `dbt run` succeeded at 21:40:31.565152 after 31.21 seconds
[0m21:40:31.565152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308EC6EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230894D1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230897A7D90>]}
[0m21:40:31.565152 [debug] [MainThread]: Flushing usage events
[0m18:28:49.768297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281BE5FD0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281BE64C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281BE64FBD0>]}


============================== 18:28:49.849325 | 2e9b3f0f-872f-4066-ad80-077f363e0f18 ==============================
[0m18:28:49.849325 [info ] [MainThread]: Running with dbt=1.7.18
[0m18:28:49.853217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:28:58.656004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e9b3f0f-872f-4066-ad80-077f363e0f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C0247490>]}
[0m18:28:58.851565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e9b3f0f-872f-4066-ad80-077f363e0f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281BE677C50>]}
[0m18:28:58.856299 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:28:58.995950 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m18:29:04.812587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:29:04.812587 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\schema.yml
[0m18:29:05.015446 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_dfb_nfl_data.sql' in the 'models' section of file 'models\schema.yml'
[0m18:29:05.311513 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.not_null_dim_dfb_nfl_data.sql_date.2ff0affbd0' (models\schema.yml) depends on a node named 'dim_dfb_nfl_data.sql' in package '' which was not found
[0m18:29:05.311513 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.not_null_dim_dfb_nfl_data.sql_name.42b89b9528' (models\schema.yml) depends on a node named 'dim_dfb_nfl_data.sql' in package '' which was not found
[0m18:29:05.311513 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.unique_dim_dfb_nfl_data.sql_name.a7b5523cc3' (models\schema.yml) depends on a node named 'dim_dfb_nfl_data.sql' in package '' which was not found
[0m18:29:05.311513 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.accepted_values_dim_dfb_nfl_data.sql_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.17e3c81e57' (models\schema.yml) depends on a node named 'dim_dfb_nfl_data.sql' in package '' which was not found
[0m18:29:05.348842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e9b3f0f-872f-4066-ad80-077f363e0f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C0554790>]}
[0m18:29:05.983090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e9b3f0f-872f-4066-ad80-077f363e0f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C0419E50>]}
[0m18:29:05.983090 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:29:05.983090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e9b3f0f-872f-4066-ad80-077f363e0f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C0533510>]}
[0m18:29:05.999765 [info ] [MainThread]: 
[0m18:29:06.004365 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:29:06.006783 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m18:29:06.029989 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m18:29:06.032396 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m18:29:06.032396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:11.979167 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.0 seconds
[0m18:29:11.979167 [debug] [ThreadPool]: On list_storage: Close
[0m18:29:12.151883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m18:29:12.167550 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m18:29:12.167550 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m18:29:12.183154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:13.266045 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:29:13.266045 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m18:29:13.783964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e9b3f0f-872f-4066-ad80-077f363e0f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281BF1683D0>]}
[0m18:29:13.783964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:13.783964 [info ] [MainThread]: 
[0m18:29:13.851921 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m18:29:13.864957 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m18:29:13.864957 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m18:29:13.889583 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m18:29:13.915029 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 18:29:13.864957 => 18:29:13.915029
[0m18:29:13.915029 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m18:29:13.924123 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m18:29:13.924123 [info ] [Thread-1 (]: 1 of 3 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m18:29:13.924123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m18:29:13.929637 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m18:29:13.932442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m18:29:13.965216 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 18:29:13.930730 => 18:29:13.965216
[0m18:29:13.971344 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m18:29:13.998419 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m18:29:14.037568 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m18:29:14.037568 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m18:29:14.037568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:29:16.026871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:29:16.090138 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 18:29:13.972822 => 18:29:16.090138
[0m18:29:16.090138 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m18:29:16.735709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e9b3f0f-872f-4066-ad80-077f363e0f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C05A78D0>]}
[0m18:29:16.751362 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.81s]
[0m18:29:16.757073 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m18:29:16.757073 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m18:29:16.757073 [info ] [Thread-1 (]: 2 of 3 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m18:29:16.767194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m18:29:16.768017 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m18:29:16.771563 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m18:29:16.786265 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 18:29:16.771563 => 18:29:16.784988
[0m18:29:16.788685 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m18:29:16.799293 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m18:29:16.888032 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m18:29:16.888032 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m18:29:16.888032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:18.375176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:29:18.392838 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 18:29:16.788685 => 18:29:18.392838
[0m18:29:18.392838 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m18:29:18.591705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e9b3f0f-872f-4066-ad80-077f363e0f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C066BBD0>]}
[0m18:29:18.596244 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.83s]
[0m18:29:18.596244 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m18:29:18.596244 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m18:29:18.596244 [info ] [Thread-1 (]: 3 of 3 START python table model dfb.py_nfl_data ................................ [RUN]
[0m18:29:18.611746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.py_nfl_data)
[0m18:29:18.614250 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m18:29:18.687676 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m18:29:18.688346 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 18:29:18.614825 => 18:29:18.688346
[0m18:29:18.692451 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m18:29:18.724496 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m18:29:18.740173 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m18:29:18.755746 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m18:29:18.755746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:26.971294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 8.0 seconds
[0m18:29:26.987798 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 18:29:18.692451 => 18:29:26.987798
[0m18:29:26.987798 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m18:29:27.385369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e9b3f0f-872f-4066-ad80-077f363e0f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281C0649010>]}
[0m18:29:27.385369 [info ] [Thread-1 (]: 3 of 3 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 8.79s]
[0m18:29:27.385369 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m18:29:27.394968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:27.399000 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m18:29:27.399000 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m18:29:27.402421 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m18:29:27.407067 [info ] [MainThread]: 
[0m18:29:27.407067 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 21.41 seconds (21.41s).
[0m18:29:27.412776 [debug] [MainThread]: Command end result
[0m18:29:27.630286 [info ] [MainThread]: 
[0m18:29:27.636131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:29:27.636131 [info ] [MainThread]: 
[0m18:29:27.643167 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:29:27.646914 [debug] [MainThread]: Command `dbt run` succeeded at 18:29:27.646914 after 38.45 seconds
[0m18:29:27.650543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281B77A1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281BD21A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281B77E6A10>]}
[0m18:29:27.650543 [debug] [MainThread]: Flushing usage events
[0m20:13:53.447915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020533179850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020533179750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205331D1150>]}


============================== 20:13:53.449432 | d32f6726-7bf9-40d9-8637-17f28bdfe11c ==============================
[0m20:13:53.449432 [info ] [MainThread]: Running with dbt=1.7.18
[0m20:13:53.463046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:13:54.382093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd32f6726-7bf9-40d9-8637-17f28bdfe11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020534D80390>]}
[0m20:13:54.524158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd32f6726-7bf9-40d9-8637-17f28bdfe11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205331D08D0>]}
[0m20:13:54.524158 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:13:54.548169 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m20:13:55.153495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:13:55.153495 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m20:13:55.674820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd32f6726-7bf9-40d9-8637-17f28bdfe11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020534DCB610>]}
[0m20:13:55.690403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd32f6726-7bf9-40d9-8637-17f28bdfe11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020534F90650>]}
[0m20:13:55.690403 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:13:55.690403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd32f6726-7bf9-40d9-8637-17f28bdfe11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020534DEA690>]}
[0m20:13:55.705981 [info ] [MainThread]: 
[0m20:13:55.712970 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:13:55.718499 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m20:13:55.756807 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m20:13:55.757923 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m20:13:55.757923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:57.872417 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m20:13:57.872417 [debug] [ThreadPool]: On list_storage: Close
[0m20:13:58.051361 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m20:13:58.066985 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m20:13:58.066985 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m20:13:58.082627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:59.516467 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:13:59.523505 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m20:14:00.184048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd32f6726-7bf9-40d9-8637-17f28bdfe11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020534F0CA10>]}
[0m20:14:00.199131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:14:00.199131 [info ] [MainThread]: 
[0m20:14:00.215098 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m20:14:00.220679 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m20:14:00.222636 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m20:14:00.248219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m20:14:00.254001 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 20:14:00.222636 => 20:14:00.252516
[0m20:14:00.254001 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m20:14:00.254001 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m20:14:00.254001 [info ] [Thread-1 (]: 1 of 3 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m20:14:00.263027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m20:14:00.264764 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m20:14:00.266517 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m20:14:00.266517 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 20:14:00.264764 => 20:14:00.266517
[0m20:14:00.274022 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m20:14:00.308351 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m20:14:00.314996 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m20:14:00.317277 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m20:14:00.317277 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:14:02.132702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:14:02.189888 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 20:14:00.274022 => 20:14:02.189888
[0m20:14:02.189888 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m20:14:02.473941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd32f6726-7bf9-40d9-8637-17f28bdfe11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020535204A50>]}
[0m20:14:02.473941 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.22s]
[0m20:14:02.490755 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m20:14:02.491614 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m20:14:02.491614 [info ] [Thread-1 (]: 2 of 3 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m20:14:02.493199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m20:14:02.493199 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m20:14:02.493199 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m20:14:02.493199 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 20:14:02.493199 => 20:14:02.493199
[0m20:14:02.501295 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m20:14:02.505309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m20:14:02.509546 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m20:14:02.510770 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m20:14:02.511302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:03.868283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:14:03.883922 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 20:14:02.501295 => 20:14:03.883922
[0m20:14:03.883922 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m20:14:04.042781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd32f6726-7bf9-40d9-8637-17f28bdfe11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020535204890>]}
[0m20:14:04.042781 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.55s]
[0m20:14:04.042781 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m20:14:04.058443 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m20:14:04.058443 [info ] [Thread-1 (]: 3 of 3 START python table model dfb.py_nfl_data ................................ [RUN]
[0m20:14:04.066333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.py_nfl_data)
[0m20:14:04.068750 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m20:14:04.130291 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m20:14:04.133642 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 20:14:04.069612 => 20:14:04.133642
[0m20:14:04.135832 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m20:14:04.162406 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m20:14:04.162406 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m20:14:04.162406 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m20:14:04.162406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:11.309648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m20:14:11.309648 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 20:14:04.135832 => 20:14:11.309648
[0m20:14:11.309648 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m20:14:11.707153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd32f6726-7bf9-40d9-8637-17f28bdfe11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020534F83A90>]}
[0m20:14:11.722162 [info ] [Thread-1 (]: 3 of 3 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 7.65s]
[0m20:14:11.722162 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m20:14:11.722162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:11.722162 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m20:14:11.722162 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m20:14:11.722162 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m20:14:11.722162 [info ] [MainThread]: 
[0m20:14:11.722162 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 16.02 seconds (16.02s).
[0m20:14:11.736903 [debug] [MainThread]: Command end result
[0m20:14:11.741439 [info ] [MainThread]: 
[0m20:14:11.749950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:11.751110 [info ] [MainThread]: 
[0m20:14:11.751110 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:14:11.751110 [debug] [MainThread]: Command `dbt run` succeeded at 20:14:11.751110 after 18.51 seconds
[0m20:14:11.751110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052C215F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052C574C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052C580BD0>]}
[0m20:14:11.751110 [debug] [MainThread]: Flushing usage events
[0m20:42:10.788663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215838A9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215838A9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021583903410>]}


============================== 20:42:10.796426 | 374c7c02-d2d5-45f9-8696-79dac113ffe7 ==============================
[0m20:42:10.796426 [info ] [MainThread]: Running with dbt=1.7.18
[0m20:42:10.796426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:42:11.389506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '374c7c02-d2d5-45f9-8696-79dac113ffe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215843E0150>]}
[0m20:42:11.489772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '374c7c02-d2d5-45f9-8696-79dac113ffe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585442610>]}
[0m20:42:11.489772 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:42:11.498778 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m20:42:11.623659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:42:11.623659 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\fct\fct_nfl_teams.py
[0m20:42:11.623659 [debug] [MainThread]: Partial parsing: added file: dfb_data://seeds\nfl_teams.csv
[0m20:42:12.016544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '374c7c02-d2d5-45f9-8696-79dac113ffe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585996D10>]}
[0m20:42:12.032126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '374c7c02-d2d5-45f9-8696-79dac113ffe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158567B350>]}
[0m20:42:12.032126 [info ] [MainThread]: Found 5 models, 4 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:42:12.032126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '374c7c02-d2d5-45f9-8696-79dac113ffe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585452990>]}
[0m20:42:12.032126 [info ] [MainThread]: 
[0m20:42:12.040761 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:42:12.044606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m20:42:12.046850 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m20:42:12.058598 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m20:42:12.060128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:13.208395 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m20:42:13.208395 [debug] [ThreadPool]: On list_storage: Close
[0m20:42:13.396492 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m20:42:13.412220 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m20:42:13.412220 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m20:42:13.412220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:14.243288 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:42:14.243288 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m20:42:14.399921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '374c7c02-d2d5-45f9-8696-79dac113ffe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215858C8310>]}
[0m20:42:14.399921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:42:14.399921 [info ] [MainThread]: 
[0m20:42:14.415580 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m20:42:14.415580 [info ] [Thread-1 (]: 1 of 4 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m20:42:14.425934 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.fct_nfl_teams'
[0m20:42:14.427896 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m20:42:14.458166 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m20:42:14.459852 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 20:42:14.428000 => 20:42:14.459852
[0m20:42:14.459852 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m20:42:14.496197 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m20:42:14.499251 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m20:42:14.500205 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"nfl_teams": "storage.dfb.nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m20:42:14.500205 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:42:20.345415 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8174a-0102-2a83-0006-b1e6000310c6
[0m20:42:20.345415 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 98, in main
    materialize(session, df, dbt.this)
  File "_udf_code.py", line 93, in materialize
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
    result = func(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
    snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
    result = self.do_resolve(logical_plan)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
    res = self.do_resolve_with_resolved_children(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
    child_attributes=resolved_child.attributes,
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
    val = self.func(instance)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
    output = analyze_attributes(self.schema_query, self.session)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
    return session._get_result_attributes(sql)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
    return self._conn.get_result_attributes(query)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
    raise ne.with_traceback(tb) from None
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
    self._run_new_describe(self._cursor, query), self.max_string_size
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
    result_metadata = run_new_describe(cursor, query)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
    return cursor._describe_internal(query)  # pyright: ignore
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
    self.execute(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b8174a-0102-2a83-0006-b1e6000310ce: 002003 (42S02): SQL compilation error:
Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
 in function FCT_NFL_TEAMS__DBT_SP with handler main
[0m20:42:20.345415 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 20:42:14.459852 => 20:42:20.345415
[0m20:42:20.345415 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m20:42:20.546640 [debug] [Thread-1 (]: Database Error in model fct_nfl_teams (models\fct\fct_nfl_teams.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 98, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 93, in materialize
      df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
      val = self.func(instance)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
      output = analyze_attributes(self.schema_query, self.session)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
      return session._get_result_attributes(sql)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
      return self._conn.get_result_attributes(query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
      self._run_new_describe(self._cursor, query), self.max_string_size
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
      result_metadata = run_new_describe(cursor, query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
      return cursor._describe_internal(query)  # pyright: ignore
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b8174a-0102-2a83-0006-b1e6000310ce: 002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
   in function FCT_NFL_TEAMS__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\fct\fct_nfl_teams.py
[0m20:42:20.546640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374c7c02-d2d5-45f9-8696-79dac113ffe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585C34B10>]}
[0m20:42:20.546640 [error] [Thread-1 (]: 1 of 4 ERROR creating python table model dfb.fct_nfl_teams ..................... [[31mERROR[0m in 6.13s]
[0m20:42:20.546640 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m20:42:20.546640 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m20:42:20.546640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.src_dfb_Nfl_data)
[0m20:42:20.546640 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m20:42:20.546640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m20:42:20.562261 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 20:42:20.546640 => 20:42:20.546640
[0m20:42:20.564660 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m20:42:20.567314 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m20:42:20.569322 [info ] [Thread-1 (]: 2 of 4 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m20:42:20.571872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m20:42:20.572886 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m20:42:20.576452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m20:42:20.576452 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 20:42:20.573867 => 20:42:20.576452
[0m20:42:20.576452 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m20:42:20.594973 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m20:42:20.610041 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m20:42:20.611117 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m20:42:20.613017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:21.644034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:42:21.675222 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 20:42:20.576452 => 20:42:21.675222
[0m20:42:21.675222 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m20:42:21.816853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374c7c02-d2d5-45f9-8696-79dac113ffe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585E664D0>]}
[0m20:42:21.816853 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.25s]
[0m20:42:21.832390 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m20:42:21.832390 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m20:42:21.832390 [info ] [Thread-1 (]: 3 of 4 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m20:42:21.837700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m20:42:21.839589 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m20:42:21.843587 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m20:42:21.843587 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 20:42:21.840648 => 20:42:21.843587
[0m20:42:21.843587 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m20:42:21.855974 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m20:42:21.859968 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m20:42:21.861128 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m20:42:21.861128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:22.744114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:42:22.744114 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 20:42:21.843587 => 20:42:22.744114
[0m20:42:22.744114 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m20:42:22.900564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374c7c02-d2d5-45f9-8696-79dac113ffe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158567AF10>]}
[0m20:42:22.900564 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.05s]
[0m20:42:22.900564 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m20:42:22.900564 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m20:42:22.900564 [info ] [Thread-1 (]: 4 of 4 START python table model dfb.py_nfl_data ................................ [RUN]
[0m20:42:22.911202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.py_nfl_data)
[0m20:42:22.912852 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m20:42:22.917912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m20:42:22.917912 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 20:42:22.913684 => 20:42:22.917912
[0m20:42:22.917912 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m20:42:22.924734 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m20:42:22.929358 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m20:42:22.929358 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m20:42:22.930360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:25.988180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:42:25.988180 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 20:42:22.917912 => 20:42:25.988180
[0m20:42:25.988180 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m20:42:26.129692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '374c7c02-d2d5-45f9-8696-79dac113ffe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021585C7CED0>]}
[0m20:42:26.129692 [info ] [Thread-1 (]: 4 of 4 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 3.23s]
[0m20:42:26.129692 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m20:42:26.145330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:26.145330 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m20:42:26.145330 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m20:42:26.145330 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m20:42:26.145330 [info ] [MainThread]: 
[0m20:42:26.145330 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 14.11 seconds (14.11s).
[0m20:42:26.155575 [debug] [MainThread]: Command end result
[0m20:42:26.166146 [info ] [MainThread]: 
[0m20:42:26.166146 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:42:26.166146 [info ] [MainThread]: 
[0m20:42:26.173880 [error] [MainThread]:   Database Error in model fct_nfl_teams (models\fct\fct_nfl_teams.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 98, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 93, in materialize
      df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
      val = self.func(instance)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
      output = analyze_attributes(self.schema_query, self.session)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
      return session._get_result_attributes(sql)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
      return self._conn.get_result_attributes(query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
      self._run_new_describe(self._cursor, query), self.max_string_size
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
      result_metadata = run_new_describe(cursor, query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
      return cursor._describe_internal(query)  # pyright: ignore
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b8174a-0102-2a83-0006-b1e6000310ce: 002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
   in function FCT_NFL_TEAMS__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\fct\fct_nfl_teams.py
[0m20:42:26.190315 [info ] [MainThread]: 
[0m20:42:26.193325 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:42:26.196161 [debug] [MainThread]: Command `dbt run` failed at 20:42:26.196161 after 15.59 seconds
[0m20:42:26.197121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215834D5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FC971FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021582709390>]}
[0m20:42:26.198226 [debug] [MainThread]: Flushing usage events
[0m20:52:28.277068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEC8D9B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEC8CFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEC8CD2D0>]}


============================== 20:52:28.323766 | 2d558632-b873-49d1-a21e-34c55c2e956e ==============================
[0m20:52:28.323766 [info ] [MainThread]: Running with dbt=1.7.18
[0m20:52:28.323766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:31.256756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEE4CFF50>]}
[0m20:52:31.358326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEE496810>]}
[0m20:52:31.358326 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:52:31.381456 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m20:52:31.742068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:52:31.745080 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\staging\stg_nfl_teams.sql
[0m20:52:32.076185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEE854610>]}
[0m20:52:32.096385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEE6F3510>]}
[0m20:52:32.096385 [info ] [MainThread]: Found 6 models, 4 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:52:32.096385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEE527ED0>]}
[0m20:52:32.096385 [info ] [MainThread]: 
[0m20:52:32.107297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:52:32.110314 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m20:52:32.126306 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m20:52:32.126809 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m20:52:32.126809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:34.031718 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m20:52:34.031718 [debug] [ThreadPool]: On list_storage: Close
[0m20:52:34.189033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m20:52:34.189033 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m20:52:34.189033 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m20:52:34.204628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:34.900116 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:52:34.900116 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m20:52:35.052116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEE962090>]}
[0m20:52:35.066154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:35.066154 [info ] [MainThread]: 
[0m20:52:35.097434 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m20:52:35.097434 [info ] [Thread-1 (]: 1 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m20:52:35.097434 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.fct_nfl_teams'
[0m20:52:35.097434 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m20:52:35.128057 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m20:52:35.128057 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 20:52:35.097434 => 20:52:35.128057
[0m20:52:35.140832 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m20:52:35.176443 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m20:52:35.191781 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m20:52:35.192741 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"nfl_teams": "storage.dfb.nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m20:52:35.193693 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:52:42.654191 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b81754-0102-2a7c-0006-b1e6000320fe
[0m20:52:42.654191 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 98, in main
    materialize(session, df, dbt.this)
  File "_udf_code.py", line 93, in materialize
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
    result = func(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
    snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
    result = self.do_resolve(logical_plan)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
    res = self.do_resolve_with_resolved_children(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
    child_attributes=resolved_child.attributes,
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
    val = self.func(instance)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
    output = analyze_attributes(self.schema_query, self.session)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
    return session._get_result_attributes(sql)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
    return self._conn.get_result_attributes(query)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
    raise ne.with_traceback(tb) from None
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
    self._run_new_describe(self._cursor, query), self.max_string_size
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
    result_metadata = run_new_describe(cursor, query)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
    return cursor._describe_internal(query)  # pyright: ignore
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
    self.execute(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b81754-0102-2a7c-0006-b1e600032106: 002003 (42S02): SQL compilation error:
Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
 in function FCT_NFL_TEAMS__DBT_SP with handler main
[0m20:52:42.654191 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 20:52:35.141844 => 20:52:42.654191
[0m20:52:42.654191 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m20:52:42.905469 [debug] [Thread-1 (]: Database Error in model fct_nfl_teams (models\fct\fct_nfl_teams.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 98, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 93, in materialize
      df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
      val = self.func(instance)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
      output = analyze_attributes(self.schema_query, self.session)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
      return session._get_result_attributes(sql)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
      return self._conn.get_result_attributes(query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
      self._run_new_describe(self._cursor, query), self.max_string_size
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
      result_metadata = run_new_describe(cursor, query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
      return cursor._describe_internal(query)  # pyright: ignore
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b81754-0102-2a7c-0006-b1e600032106: 002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
   in function FCT_NFL_TEAMS__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\fct\fct_nfl_teams.py
[0m20:52:42.905469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEE630F10>]}
[0m20:52:42.905469 [error] [Thread-1 (]: 1 of 5 ERROR creating python table model dfb.fct_nfl_teams ..................... [[31mERROR[0m in 7.81s]
[0m20:52:42.905469 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m20:52:42.905469 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m20:52:42.905469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.src_dfb_Nfl_data)
[0m20:52:42.921090 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m20:52:42.925286 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m20:52:42.928007 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 20:52:42.922340 => 20:52:42.927012
[0m20:52:42.928091 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m20:52:42.928091 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m20:52:42.928091 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m20:52:42.935117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m20:52:42.936128 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m20:52:42.941315 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m20:52:42.941315 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 20:52:42.936128 => 20:52:42.941315
[0m20:52:42.941315 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m20:52:42.974756 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m20:52:42.974756 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m20:52:42.974756 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m20:52:42.974756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:44.174306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:52:44.193567 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 20:52:42.941315 => 20:52:44.193567
[0m20:52:44.193567 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m20:52:44.318618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEEC586D0>]}
[0m20:52:44.318618 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.39s]
[0m20:52:44.318618 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m20:52:44.318618 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m20:52:44.318618 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m20:52:44.318618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m20:52:44.318618 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m20:52:44.335630 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m20:52:44.337551 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 20:52:44.318618 => 20:52:44.337005
[0m20:52:44.338803 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m20:52:44.345859 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m20:52:44.348847 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m20:52:44.348847 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m20:52:44.349934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:45.242021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:52:45.257551 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 20:52:44.339860 => 20:52:45.257551
[0m20:52:45.257551 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m20:52:45.398777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEE471150>]}
[0m20:52:45.398777 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.08s]
[0m20:52:45.398777 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m20:52:45.398777 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m20:52:45.398777 [info ] [Thread-1 (]: 4 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m20:52:45.398777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m20:52:45.398777 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m20:52:45.414407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m20:52:45.414407 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 20:52:45.398777 => 20:52:45.414407
[0m20:52:45.414407 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m20:52:45.414407 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m20:52:45.414407 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m20:52:45.414407 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
select * from __dbt__cte__src_dfb_Nfl_data
)select * from source
  );
[0m20:52:45.414407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:46.450059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:52:46.450059 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 20:52:45.414407 => 20:52:46.450059
[0m20:52:46.450059 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m20:52:46.591115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEE92F810>]}
[0m20:52:46.591115 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.19s]
[0m20:52:46.606137 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m20:52:46.606137 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m20:52:46.606137 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m20:52:46.612148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.py_nfl_data)
[0m20:52:46.613739 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m20:52:46.617345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m20:52:46.617345 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 20:52:46.614360 => 20:52:46.617345
[0m20:52:46.617345 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m20:52:46.628096 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m20:52:46.630109 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m20:52:46.631148 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m20:52:46.632104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:49.634009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:52:49.651254 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 20:52:46.617345 => 20:52:49.651254
[0m20:52:49.651254 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m20:52:49.796531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d558632-b873-49d1-a21e-34c55c2e956e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEEB77E10>]}
[0m20:52:49.798532 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 3.19s]
[0m20:52:49.800599 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m20:52:49.803595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:49.803595 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m20:52:49.804601 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m20:52:49.805588 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m20:52:49.805588 [info ] [MainThread]: 
[0m20:52:49.807736 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 17.71 seconds (17.71s).
[0m20:52:49.810889 [debug] [MainThread]: Command end result
[0m20:52:49.813158 [info ] [MainThread]: 
[0m20:52:49.825789 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:52:49.826815 [info ] [MainThread]: 
[0m20:52:49.829387 [error] [MainThread]:   Database Error in model fct_nfl_teams (models\fct\fct_nfl_teams.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 98, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 93, in materialize
      df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
      val = self.func(instance)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
      output = analyze_attributes(self.schema_query, self.session)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
      return session._get_result_attributes(sql)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
      return self._conn.get_result_attributes(query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
      self._run_new_describe(self._cursor, query), self.max_string_size
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
      result_metadata = run_new_describe(cursor, query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
      return cursor._describe_internal(query)  # pyright: ignore
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b81754-0102-2a7c-0006-b1e600032106: 002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
   in function FCT_NFL_TEAMS__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\fct\fct_nfl_teams.py
[0m20:52:49.842818 [info ] [MainThread]: 
[0m20:52:49.845836 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:52:49.848593 [debug] [MainThread]: Command `dbt run` failed at 20:52:49.848593 after 21.82 seconds
[0m20:52:49.849884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE5A61FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEC94D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBEC522110>]}
[0m20:52:49.849884 [debug] [MainThread]: Flushing usage events
[0m20:55:50.215044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132BC74C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132BC740D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132BC778D0>]}


============================== 20:55:50.240252 | da652f77-8e50-40e7-8bfa-e7d316403fc4 ==============================
[0m20:55:50.240252 [info ] [MainThread]: Running with dbt=1.7.18
[0m20:55:50.240252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:55:52.795106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132C74A510>]}
[0m20:55:52.904870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132BC43CD0>]}
[0m20:55:52.904870 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:55:52.904870 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m20:55:53.202181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:55:53.202181 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\sources.yml
[0m20:55:53.265711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D92D850>]}
[0m20:55:53.280232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D962610>]}
[0m20:55:53.280232 [info ] [MainThread]: Found 6 models, 4 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:55:53.280232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D986C90>]}
[0m20:55:53.280232 [info ] [MainThread]: 
[0m20:55:53.294564 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:55:53.297851 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m20:55:53.315414 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m20:55:53.315414 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m20:55:53.316562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:54.695617 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m20:55:54.699561 [debug] [ThreadPool]: On list_storage: Close
[0m20:55:54.818186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m20:55:54.833723 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m20:55:54.833723 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m20:55:54.833723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:55.633433 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:55:55.633433 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m20:55:55.774974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D9A55D0>]}
[0m20:55:55.774974 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:55.790041 [info ] [MainThread]: 
[0m20:55:55.893153 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m20:55:55.894217 [info ] [Thread-1 (]: 1 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m20:55:55.896157 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.fct_nfl_teams'
[0m20:55:55.896157 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m20:55:55.929049 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m20:55:55.930057 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 20:55:55.897218 => 20:55:55.930057
[0m20:55:55.931319 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m20:55:55.959371 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m20:55:55.968934 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m20:55:55.968934 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"nfl_teams": "storage.dfb.nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m20:55:55.968934 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:55:57.861838 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b81757-0102-2a83-0006-b1e6000310ee
[0m20:55:57.861838 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 98, in main
    materialize(session, df, dbt.this)
  File "_udf_code.py", line 93, in materialize
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
    result = func(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
    snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
    result = self.do_resolve(logical_plan)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
    res = self.do_resolve_with_resolved_children(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
    child_attributes=resolved_child.attributes,
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
    val = self.func(instance)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
    output = analyze_attributes(self.schema_query, self.session)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
    return session._get_result_attributes(sql)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
    return self._conn.get_result_attributes(query)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
    raise ne.with_traceback(tb) from None
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
    self._run_new_describe(self._cursor, query), self.max_string_size
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
    result_metadata = run_new_describe(cursor, query)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
    return cursor._describe_internal(query)  # pyright: ignore
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
    self.execute(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b81757-0102-2a83-0006-b1e6000310f6: 002003 (42S02): SQL compilation error:
Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
 in function FCT_NFL_TEAMS__DBT_SP with handler main
[0m20:55:57.867492 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 20:55:55.931319 => 20:55:57.867492
[0m20:55:57.868383 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m20:55:58.016693 [debug] [Thread-1 (]: Database Error in model fct_nfl_teams (models\fct\fct_nfl_teams.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 98, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 93, in materialize
      df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
      val = self.func(instance)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
      output = analyze_attributes(self.schema_query, self.session)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
      return session._get_result_attributes(sql)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
      return self._conn.get_result_attributes(query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
      self._run_new_describe(self._cursor, query), self.max_string_size
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
      result_metadata = run_new_describe(cursor, query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
      return cursor._describe_internal(query)  # pyright: ignore
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b81757-0102-2a83-0006-b1e6000310f6: 002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
   in function FCT_NFL_TEAMS__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\fct\fct_nfl_teams.py
[0m20:55:58.016693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132C737510>]}
[0m20:55:58.016693 [error] [Thread-1 (]: 1 of 5 ERROR creating python table model dfb.fct_nfl_teams ..................... [[31mERROR[0m in 2.12s]
[0m20:55:58.016693 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m20:55:58.016693 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m20:55:58.016693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.src_dfb_Nfl_data)
[0m20:55:58.032347 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m20:55:58.035810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m20:55:58.037455 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 20:55:58.033217 => 20:55:58.037455
[0m20:55:58.038542 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m20:55:58.040706 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m20:55:58.042740 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m20:55:58.046220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.dim_dfb_nfl_data)
[0m20:55:58.047262 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m20:55:58.049341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m20:55:58.049341 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 20:55:58.047262 => 20:55:58.049341
[0m20:55:58.049341 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m20:55:58.080938 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m20:55:58.082998 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m20:55:58.082998 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m20:55:58.082998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:58.989552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:55:59.020902 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 20:55:58.049341 => 20:55:59.020902
[0m20:55:59.020902 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m20:55:59.146525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132DD414D0>]}
[0m20:55:59.146525 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.10s]
[0m20:55:59.146525 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m20:55:59.146525 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m20:55:59.146525 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m20:55:59.146525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m20:55:59.146525 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m20:55:59.163223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m20:55:59.166022 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 20:55:59.146525 => 20:55:59.165013
[0m20:55:59.166941 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m20:55:59.169057 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m20:55:59.174161 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m20:55:59.174161 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m20:55:59.176293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:00.133193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:56:00.148700 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 20:55:59.167970 => 20:56:00.148700
[0m20:56:00.148700 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m20:56:00.291242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D8BE1D0>]}
[0m20:56:00.291242 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.14s]
[0m20:56:00.307520 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m20:56:00.307520 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m20:56:00.307520 [info ] [Thread-1 (]: 4 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m20:56:00.312164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m20:56:00.313380 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m20:56:00.317991 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m20:56:00.317991 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 20:56:00.314734 => 20:56:00.317991
[0m20:56:00.317991 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m20:56:00.326575 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m20:56:00.329743 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m20:56:00.329743 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
select * from __dbt__cte__src_dfb_Nfl_data
)select * from source
  );
[0m20:56:00.330722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:01.231827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:56:01.231827 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 20:56:00.317991 => 20:56:01.231827
[0m20:56:01.231827 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m20:56:01.389022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132DDDB750>]}
[0m20:56:01.389022 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.08s]
[0m20:56:01.389022 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m20:56:01.404736 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m20:56:01.404736 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m20:56:01.409228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.py_nfl_data)
[0m20:56:01.410930 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m20:56:01.414502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m20:56:01.414502 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 20:56:01.411228 => 20:56:01.414502
[0m20:56:01.414502 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m20:56:01.414502 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m20:56:01.427584 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m20:56:01.428595 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m20:56:01.429637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:04.052685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:56:04.052685 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 20:56:01.414502 => 20:56:04.052685
[0m20:56:04.052685 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m20:56:04.193919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da652f77-8e50-40e7-8bfa-e7d316403fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132D8F4290>]}
[0m20:56:04.193919 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 2.79s]
[0m20:56:04.193919 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m20:56:04.209558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:04.209558 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m20:56:04.209558 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m20:56:04.209558 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m20:56:04.209558 [info ] [MainThread]: 
[0m20:56:04.209558 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 10.93 seconds (10.93s).
[0m20:56:04.218606 [debug] [MainThread]: Command end result
[0m20:56:04.230860 [info ] [MainThread]: 
[0m20:56:04.230860 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:56:04.230860 [info ] [MainThread]: 
[0m20:56:04.230860 [error] [MainThread]:   Database Error in model fct_nfl_teams (models\fct\fct_nfl_teams.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 98, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 93, in materialize
      df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
      val = self.func(instance)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
      output = analyze_attributes(self.schema_query, self.session)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
      return session._get_result_attributes(sql)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
      return self._conn.get_result_attributes(query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
      self._run_new_describe(self._cursor, query), self.max_string_size
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
      result_metadata = run_new_describe(cursor, query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
      return cursor._describe_internal(query)  # pyright: ignore
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b81757-0102-2a83-0006-b1e6000310f6: 002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
   in function FCT_NFL_TEAMS__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\fct\fct_nfl_teams.py
[0m20:56:04.293024 [info ] [MainThread]: 
[0m20:56:04.295259 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m20:56:04.296236 [debug] [MainThread]: Command `dbt run` failed at 20:56:04.296236 after 14.27 seconds
[0m20:56:04.296236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132BC49890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021324D61FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132BC0E910>]}
[0m20:56:04.296236 [debug] [MainThread]: Flushing usage events
[0m20:58:42.024250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B44EF5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B44EF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B44EFCD0>]}


============================== 20:58:42.024250 | c983f47f-462f-4b7e-8c24-d4aae230745b ==============================
[0m20:58:42.024250 [info ] [MainThread]: Running with dbt=1.7.18
[0m20:58:42.024250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:42.652011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B6104B50>]}
[0m20:58:42.752392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B605FF10>]}
[0m20:58:42.752392 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:58:42.768304 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m20:58:42.873976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:58:42.889647 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\staging\stg_nfl_teams.sql
[0m20:58:43.138132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B64D0910>]}
[0m20:58:43.154161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B630C690>]}
[0m20:58:43.154161 [info ] [MainThread]: Found 6 models, 4 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:58:43.154161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B60862D0>]}
[0m20:58:43.169795 [info ] [MainThread]: 
[0m20:58:43.173885 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:58:43.177086 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m20:58:43.179175 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m20:58:43.179175 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m20:58:43.191195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:44.189429 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m20:58:44.189429 [debug] [ThreadPool]: On list_storage: Close
[0m20:58:44.345894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m20:58:44.361992 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m20:58:44.361992 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m20:58:44.361992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:45.057214 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m20:58:45.066781 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m20:58:45.208171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B45119D0>]}
[0m20:58:45.208171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:58:45.223696 [info ] [MainThread]: 
[0m20:58:45.226705 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m20:58:45.226705 [info ] [Thread-1 (]: 1 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m20:58:45.233584 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.fct_nfl_teams'
[0m20:58:45.235427 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m20:58:45.260657 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m20:58:45.260657 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 20:58:45.236263 => 20:58:45.260657
[0m20:58:45.260657 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m20:58:45.303923 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m20:58:45.306900 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m20:58:45.308044 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"nfl_teams": "storage.dfb.nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m20:58:45.308107 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:58:47.279728 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8175a-0102-2a83-0006-b1e60003110a
[0m20:58:47.296994 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 98, in main
    materialize(session, df, dbt.this)
  File "_udf_code.py", line 93, in materialize
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
    result = func(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
    snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
    result = self.do_resolve(logical_plan)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
    res = self.do_resolve_with_resolved_children(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
    child_attributes=resolved_child.attributes,
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
    val = self.func(instance)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
    output = analyze_attributes(self.schema_query, self.session)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
    return session._get_result_attributes(sql)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
    return self._conn.get_result_attributes(query)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
    raise ne.with_traceback(tb) from None
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
    return func(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
    self._run_new_describe(self._cursor, query), self.max_string_size
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
    result_metadata = run_new_describe(cursor, query)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
    return cursor._describe_internal(query)  # pyright: ignore
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
    self.execute(*args, **kwargs)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b8175a-0102-2a83-0006-b1e600031112: 002003 (42S02): SQL compilation error:
Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
 in function FCT_NFL_TEAMS__DBT_SP with handler main
[0m20:58:47.296994 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 20:58:45.260657 => 20:58:47.296994
[0m20:58:47.296994 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m20:58:47.435030 [debug] [Thread-1 (]: Database Error in model fct_nfl_teams (models\fct\fct_nfl_teams.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 98, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 93, in materialize
      df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
      val = self.func(instance)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
      output = analyze_attributes(self.schema_query, self.session)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
      return session._get_result_attributes(sql)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
      return self._conn.get_result_attributes(query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
      self._run_new_describe(self._cursor, query), self.max_string_size
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
      result_metadata = run_new_describe(cursor, query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
      return cursor._describe_internal(query)  # pyright: ignore
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b8175a-0102-2a83-0006-b1e600031112: 002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
   in function FCT_NFL_TEAMS__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\fct\fct_nfl_teams.py
[0m20:58:47.435030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B67D5C10>]}
[0m20:58:47.435030 [error] [Thread-1 (]: 1 of 5 ERROR creating python table model dfb.fct_nfl_teams ..................... [[31mERROR[0m in 2.21s]
[0m20:58:47.435030 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m20:58:47.435030 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m20:58:47.435030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.src_dfb_Nfl_data)
[0m20:58:47.435030 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m20:58:47.435030 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m20:58:47.450659 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 20:58:47.435030 => 20:58:47.435030
[0m20:58:47.452862 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m20:58:47.453847 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m20:58:47.455943 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m20:58:47.459400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m20:58:47.461216 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m20:58:47.464870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m20:58:47.464870 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 20:58:47.461216 => 20:58:47.464870
[0m20:58:47.464870 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m20:58:47.494063 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m20:58:47.494063 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m20:58:47.494063 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.nfl_teams
)select * from source
  );
[0m20:58:47.494063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:48.218998 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8175a-0102-2a83-0006-b1e600031116
[0m20:58:48.218998 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
[0m20:58:48.218998 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 20:58:47.464870 => 20:58:48.218998
[0m20:58:48.218998 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m20:58:48.361372 [debug] [Thread-1 (]: Database Error in model stg_nfl_teams (models\staging\stg_nfl_teams.sql)
  002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
  compiled Code at target\run\dfb_data\models\staging\stg_nfl_teams.sql
[0m20:58:48.362503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B64D8D10>]}
[0m20:58:48.362503 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model dfb.stg_nfl_teams ......................... [[31mERROR[0m in 0.91s]
[0m20:58:48.365080 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m20:58:48.365080 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m20:58:48.365080 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m20:58:48.371236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m20:58:48.372301 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m20:58:48.376808 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m20:58:48.376808 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 20:58:48.372301 => 20:58:48.376808
[0m20:58:48.376808 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m20:58:48.376808 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m20:58:48.376808 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m20:58:48.376808 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m20:58:48.376808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:49.892991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:58:49.926388 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 20:58:48.376808 => 20:58:49.926388
[0m20:58:49.926388 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m20:58:50.077147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B63F06D0>]}
[0m20:58:50.077147 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.71s]
[0m20:58:50.077147 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m20:58:50.077147 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m20:58:50.077147 [info ] [Thread-1 (]: 4 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m20:58:50.077147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m20:58:50.090898 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m20:58:50.096955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m20:58:50.098061 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 20:58:50.091917 => 20:58:50.098061
[0m20:58:50.098061 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m20:58:50.098061 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m20:58:50.098061 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m20:58:50.098061 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m20:58:50.098061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:51.055448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:58:51.058614 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 20:58:50.098061 => 20:58:51.058614
[0m20:58:51.058614 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m20:58:51.197081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B67BCB10>]}
[0m20:58:51.199082 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.12s]
[0m20:58:51.201095 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m20:58:51.202082 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m20:58:51.203079 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m20:58:51.206330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.py_nfl_data)
[0m20:58:51.207360 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m20:58:51.211064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m20:58:51.211064 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 20:58:51.208329 => 20:58:51.211064
[0m20:58:51.211064 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m20:58:51.211064 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m20:58:51.211064 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m20:58:51.224406 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m20:58:51.225487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:53.927288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m20:58:53.943145 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 20:58:51.211064 => 20:58:53.943145
[0m20:58:53.943145 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m20:58:54.078012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c983f47f-462f-4b7e-8c24-d4aae230745b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2B62D3450>]}
[0m20:58:54.078012 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 2.87s]
[0m20:58:54.085141 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m20:58:54.085141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:54.085141 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m20:58:54.085141 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m20:58:54.085141 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m20:58:54.085141 [info ] [MainThread]: 
[0m20:58:54.085141 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 10.92 seconds (10.92s).
[0m20:58:54.099154 [debug] [MainThread]: Command end result
[0m20:58:54.113864 [info ] [MainThread]: 
[0m20:58:54.114885 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:58:54.115906 [info ] [MainThread]: 
[0m20:58:54.115906 [error] [MainThread]:   Database Error in model fct_nfl_teams (models\fct\fct_nfl_teams.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 98, in main
      materialize(session, df, dbt.this)
    File "_udf_code.py", line 93, in materialize
      df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 216, in wrap
      result = func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe_writer.py", line 289, in save_as_table
      snowflake_plan = session._analyzer.resolve(create_table_logic_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 776, in resolve
      result = self.do_resolve(logical_plan)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 819, in do_resolve
      res = self.do_resolve_with_resolved_children(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/analyzer.py", line 1016, in do_resolve_with_resolved_children
      child_attributes=resolved_child.attributes,
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/functools.py", line 967, in __get__
      val = self.func(instance)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 401, in attributes
      output = analyze_attributes(self.schema_query, self.session)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 93, in analyze_attributes
      return session._get_result_attributes(sql)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/session.py", line 2340, in _get_result_attributes
      return self._conn.get_result_attributes(query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 208, in wrap
      raise ne.with_traceback(tb) from None
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/snowflake_plan.py", line 139, in wrap
      return func(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 248, in get_result_attributes
      self._run_new_describe(self._cursor, query), self.max_string_size
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/server_connection.py", line 254, in _run_new_describe
      result_metadata = run_new_describe(cursor, query)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/analyzer/schema_utils.py", line 147, in run_new_describe
      return cursor._describe_internal(query)  # pyright: ignore
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1063, in _describe_internal
      self.execute(*args, **kwargs)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 1018, in execute
      Error.errorhandler_wrapper(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
      handed_over = Error.hand_to_other_handler(
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
      cursor.errorhandler(connection, cursor, error_class, error_value)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
      raise error_class(
  snowflake.snowpark.exceptions.SnowparkSQLException: (1304): 01b8175a-0102-2a83-0006-b1e600031112: 002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
   in function FCT_NFL_TEAMS__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\fct\fct_nfl_teams.py
[0m20:58:54.132936 [info ] [MainThread]: 
[0m20:58:54.134496 [error] [MainThread]:   Database Error in model stg_nfl_teams (models\staging\stg_nfl_teams.sql)
  002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.NFL_TEAMS' does not exist or not authorized.
  compiled Code at target\run\dfb_data\models\staging\stg_nfl_teams.sql
[0m20:58:54.137503 [info ] [MainThread]: 
[0m20:58:54.138513 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m20:58:54.140873 [debug] [MainThread]: Command `dbt run` failed at 20:58:54.140873 after 12.22 seconds
[0m20:58:54.142880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2AD6C1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2AD707650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2AD706A10>]}
[0m20:58:54.144603 [debug] [MainThread]: Flushing usage events
[0m21:02:36.181132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC3D19890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC3D6B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC3D680D0>]}


============================== 21:02:36.181132 | aac33b80-b04b-4da7-afee-301d309ae071 ==============================
[0m21:02:36.181132 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:02:36.193651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:02:36.980924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aac33b80-b04b-4da7-afee-301d309ae071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC58D2E10>]}
[0m21:02:37.094684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aac33b80-b04b-4da7-afee-301d309ae071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC3D58950>]}
[0m21:02:37.094684 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:02:37.108931 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:02:37.270573 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m21:02:37.270573 [debug] [MainThread]: Partial parsing: added file: dfb_data://seeds\seed_nfl_teams.csv
[0m21:02:37.286207 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://seeds\nfl_teams.csv
[0m21:02:37.286207 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\fct\fct_nfl_teams.py
[0m21:02:37.286207 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\staging\stg_nfl_teams.sql
[0m21:02:37.809233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aac33b80-b04b-4da7-afee-301d309ae071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC5D2CB90>]}
[0m21:02:37.834889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aac33b80-b04b-4da7-afee-301d309ae071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC5B2F450>]}
[0m21:02:37.835668 [info ] [MainThread]: Found 6 models, 4 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:02:37.837531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac33b80-b04b-4da7-afee-301d309ae071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC5927410>]}
[0m21:02:37.839041 [info ] [MainThread]: 
[0m21:02:37.856475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:02:37.859156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:02:37.878760 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:02:37.878760 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:02:37.878760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:39.778885 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m21:02:39.793908 [debug] [ThreadPool]: On list_storage: Close
[0m21:02:39.961232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:02:39.999239 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:02:39.999239 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:02:39.999239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:41.098231 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m21:02:41.100746 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:02:41.287431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac33b80-b04b-4da7-afee-301d309ae071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC5EFDD90>]}
[0m21:02:41.300949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:41.303516 [info ] [MainThread]: 
[0m21:02:41.303516 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:02:41.303516 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:02:41.303516 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:02:41.328014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:02:41.344393 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:02:41.303516 => 21:02:41.341003
[0m21:02:41.345134 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:02:41.345134 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m21:02:41.349237 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m21:02:41.349237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m21:02:41.349237 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m21:02:41.357473 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m21:02:41.360738 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 21:02:41.349237 => 21:02:41.360738
[0m21:02:41.360738 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m21:02:41.393560 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m21:02:41.401077 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m21:02:41.401077 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m21:02:41.401077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:02:43.904373 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8175e-0102-2a83-0006-b1e60003112e
[0m21:02:43.905435 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STORAGE.DFB.SEED_NFL_TEAMS' does not exist or not authorized.
[0m21:02:43.905435 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 21:02:41.360738 => 21:02:43.905435
[0m21:02:43.905435 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m21:02:44.519844 [debug] [Thread-1 (]: Database Error in model stg_nfl_teams (models\staging\stg_nfl_teams.sql)
  002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.SEED_NFL_TEAMS' does not exist or not authorized.
  compiled Code at target\run\dfb_data\models\staging\stg_nfl_teams.sql
[0m21:02:44.519844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac33b80-b04b-4da7-afee-301d309ae071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC5E5FF90>]}
[0m21:02:44.519844 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dfb.stg_nfl_teams ......................... [[31mERROR[0m in 3.17s]
[0m21:02:44.519844 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m21:02:44.519844 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:02:44.534365 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m21:02:44.539229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m21:02:44.542244 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:02:44.550568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:02:44.563682 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:02:44.544661 => 21:02:44.562112
[0m21:02:44.563792 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:02:44.578083 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:02:44.578083 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:02:44.578083 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m21:02:44.578083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:46.597658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:02:46.661029 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:02:44.566445 => 21:02:46.661029
[0m21:02:46.661029 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:02:46.823668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac33b80-b04b-4da7-afee-301d309ae071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC5D2C890>]}
[0m21:02:46.823668 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.29s]
[0m21:02:46.830267 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:02:46.830267 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:02:46.830267 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m21:02:46.837199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:02:46.837199 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:02:46.851909 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:02:46.855398 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:02:46.840440 => 21:02:46.854213
[0m21:02:46.855398 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:02:46.870316 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:02:46.870316 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:02:46.870316 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m21:02:46.870316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:48.461927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:02:48.468463 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:02:46.855398 => 21:02:48.468463
[0m21:02:48.468463 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:02:48.785028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac33b80-b04b-4da7-afee-301d309ae071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC5D17050>]}
[0m21:02:48.802160 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.95s]
[0m21:02:48.802160 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:02:48.802160 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m21:02:48.809149 [info ] [Thread-1 (]: 4 of 5 SKIP relation dfb.fct_nfl_teams ......................................... [[33mSKIP[0m]
[0m21:02:48.811806 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m21:02:48.815571 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:02:48.817924 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m21:02:48.821930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.py_nfl_data)
[0m21:02:48.823266 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:02:48.878239 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:02:48.878239 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:02:48.823266 => 21:02:48.878239
[0m21:02:48.886266 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:02:48.916675 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:02:48.919820 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:02:48.919820 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:02:48.919820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:52.851857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m21:02:52.868744 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:02:48.887569 => 21:02:52.868744
[0m21:02:52.868744 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:02:53.057877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac33b80-b04b-4da7-afee-301d309ae071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC630C690>]}
[0m21:02:53.057877 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 4.24s]
[0m21:02:53.057877 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:02:53.057877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:53.057877 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:02:53.057877 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:02:53.073492 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m21:02:53.073492 [info ] [MainThread]: 
[0m21:02:53.075849 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 15.22 seconds (15.22s).
[0m21:02:53.077984 [debug] [MainThread]: Command end result
[0m21:02:53.090129 [info ] [MainThread]: 
[0m21:02:53.090129 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:02:53.098211 [info ] [MainThread]: 
[0m21:02:53.100541 [error] [MainThread]:   Database Error in model stg_nfl_teams (models\staging\stg_nfl_teams.sql)
  002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.SEED_NFL_TEAMS' does not exist or not authorized.
  compiled Code at target\run\dfb_data\models\staging\stg_nfl_teams.sql
[0m21:02:53.102819 [info ] [MainThread]: 
[0m21:02:53.102819 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m21:02:53.102819 [debug] [MainThread]: Command `dbt run` failed at 21:02:53.102819 after 17.11 seconds
[0m21:02:53.102819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBCE11FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC3D0E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC3D0E2D0>]}
[0m21:02:53.102819 [debug] [MainThread]: Flushing usage events
[0m21:15:10.084537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F80C0DE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F80C0E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F80C0FD10>]}


============================== 21:15:10.084537 | 3aaaca37-592e-483b-9cfa-000c77ad721e ==============================
[0m21:15:10.084537 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:15:10.084537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:15:11.056724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aaaca37-592e-483b-9cfa-000c77ad721e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F82771450>]}
[0m21:15:11.226150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aaaca37-592e-483b-9cfa-000c77ad721e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F827E6CD0>]}
[0m21:15:11.229675 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:15:11.252418 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:15:11.389948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:15:11.389948 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:15:11.398497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aaaca37-592e-483b-9cfa-000c77ad721e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F816F1F90>]}
[0m21:15:11.414099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aaaca37-592e-483b-9cfa-000c77ad721e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F828EF150>]}
[0m21:15:11.426108 [info ] [MainThread]: Found 6 models, 4 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:15:11.429410 [info ] [MainThread]: 
[0m21:15:11.435237 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:15:11.438941 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:15:11.468932 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:15:11.468932 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:15:11.468932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:13.634006 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m21:15:13.634006 [debug] [ThreadPool]: On list_storage: Close
[0m21:15:14.131188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:15:14.146834 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:15:14.146834 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:15:14.146834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:15.271076 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m21:15:15.286781 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:15:15.676992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aaaca37-592e-483b-9cfa-000c77ad721e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F80624CD0>]}
[0m21:15:15.691012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:15:15.691012 [info ] [MainThread]: 
[0m21:15:15.695017 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:15:15.695017 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:15:15.707032 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:15:15.730920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:15:15.738950 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:15:15.710393 => 21:15:15.735934
[0m21:15:15.740681 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:15:15.740681 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m21:15:15.751545 [info ] [Thread-1 (]: 1 of 10 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m21:15:15.755477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m21:15:15.755477 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m21:15:15.755477 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 21:15:15.755477 => 21:15:15.755477
[0m21:15:15.755477 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m21:15:15.855831 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:15:15.865330 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
create table storage.dfb.seed_nfl_teams (ARI text,Arizona Cardinals text)
[0m21:15:15.865330 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:15:17.566470 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8176b-0102-2a7c-0006-b1e60003214e
[0m21:15:17.566470 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 68 unexpected 'text'.
[0m21:15:17.581488 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 21:15:15.755477 => 21:15:17.581488
[0m21:15:17.581488 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m21:15:18.147406 [debug] [Thread-1 (]: Database Error in seed seed_nfl_teams (seeds\seed_nfl_teams.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 68 unexpected 'text'.
[0m21:15:18.147406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aaaca37-592e-483b-9cfa-000c77ad721e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F828EF450>]}
[0m21:15:18.147406 [error] [Thread-1 (]: 1 of 10 ERROR loading seed file dfb.seed_nfl_teams ............................. [[31mERROR[0m in 2.39s]
[0m21:15:18.163055 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m21:15:18.163055 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:15:18.163055 [info ] [Thread-1 (]: 2 of 10 START sql view model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m21:15:18.163055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m21:15:18.163055 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:15:18.178676 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:15:18.178676 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:15:18.163055 => 21:15:18.178676
[0m21:15:18.195246 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:15:18.220302 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:15:18.224638 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:15:18.224638 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m21:15:18.229719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:20.495334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:15:20.544371 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:15:18.195246 => 21:15:20.544371
[0m21:15:20.544371 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:15:20.794218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aaaca37-592e-483b-9cfa-000c77ad721e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F828EED90>]}
[0m21:15:20.794218 [info ] [Thread-1 (]: 2 of 10 OK created sql view model dfb.dim_dfb_nfl_data ......................... [[32mSUCCESS 1[0m in 2.63s]
[0m21:15:20.809950 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:15:20.809950 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:15:20.809950 [info ] [Thread-1 (]: 3 of 10 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m21:15:20.820513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:15:20.822596 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:15:20.835775 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:15:20.840574 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:15:20.822804 => 21:15:20.837453
[0m21:15:20.840574 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:15:20.845573 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:15:20.860908 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:15:20.860908 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m21:15:20.860908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:22.154164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:15:22.166233 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:15:20.844098 => 21:15:22.166233
[0m21:15:22.166233 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:15:22.480894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aaaca37-592e-483b-9cfa-000c77ad721e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F82936B90>]}
[0m21:15:22.480894 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 1.67s]
[0m21:15:22.480894 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:15:22.480894 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m21:15:22.496388 [info ] [Thread-1 (]: 4 of 10 SKIP relation dfb.stg_nfl_teams ........................................ [[33mSKIP[0m]
[0m21:15:22.501883 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m21:15:22.504746 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m21:15:22.504746 [info ] [Thread-1 (]: 5 of 10 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [RUN]
[0m21:15:22.510811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133)
[0m21:15:22.512847 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m21:15:22.552582 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m21:15:22.552582 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (compile): 21:15:22.512847 => 21:15:22.552582
[0m21:15:22.552582 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m21:15:22.597399 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m21:15:22.602979 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m21:15:22.602979 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'
)



      
    ) dbt_internal_test
[0m21:15:22.605612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:24.689188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:15:24.720699 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (execute): 21:15:22.552582 => 21:15:24.720699
[0m21:15:24.720699 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: Close
[0m21:15:25.103480 [error] [Thread-1 (]: 5 of 10 FAIL 4 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[31mFAIL 4[0m in 2.60s]
[0m21:15:25.109791 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m21:15:25.109791 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:15:25.109791 [info ] [Thread-1 (]: 6 of 10 START test not_null_dim_dfb_nfl_data_date .............................. [RUN]
[0m21:15:25.118029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m21:15:25.118029 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:15:25.137315 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:15:25.144819 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 21:15:25.120881 => 21:15:25.144819
[0m21:15:25.144819 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:15:25.154467 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:15:25.156779 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:15:25.156779 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m21:15:25.158265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:27.176978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:15:27.176978 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 21:15:25.144819 => 21:15:27.176978
[0m21:15:27.176978 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m21:15:27.604661 [info ] [Thread-1 (]: 6 of 10 PASS not_null_dim_dfb_nfl_data_date .................................... [[32mPASS[0m in 2.49s]
[0m21:15:27.604661 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:15:27.604661 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:15:27.604661 [info ] [Thread-1 (]: 7 of 10 START test not_null_dim_dfb_nfl_data_name .............................. [RUN]
[0m21:15:27.618011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m21:15:27.618595 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:15:27.627578 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:15:27.643579 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 21:15:27.621678 => 21:15:27.643579
[0m21:15:27.647009 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:15:27.659177 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:15:27.660916 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:15:27.660916 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m21:15:27.660916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:29.439116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:15:29.439116 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 21:15:27.647009 => 21:15:29.439116
[0m21:15:29.439116 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m21:15:29.884442 [info ] [Thread-1 (]: 7 of 10 PASS not_null_dim_dfb_nfl_data_name .................................... [[32mPASS[0m in 2.27s]
[0m21:15:29.899480 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:15:29.899480 [debug] [Thread-1 (]: Began running node test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb
[0m21:15:29.899480 [info ] [Thread-1 (]: 8 of 10 START test unique_dim_dfb_nfl_data_name ................................ [RUN]
[0m21:15:29.907985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb)
[0m21:15:29.910912 [debug] [Thread-1 (]: Began compiling node test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb
[0m21:15:29.932088 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb"
[0m21:15:29.937050 [debug] [Thread-1 (]: Timing info for test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb (compile): 21:15:29.912602 => 21:15:29.937050
[0m21:15:29.937050 [debug] [Thread-1 (]: Began executing node test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb
[0m21:15:29.942298 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb"
[0m21:15:29.952262 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb"
[0m21:15:29.954570 [debug] [Thread-1 (]: On test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    name as unique_field,
    count(*) as n_records

from storage.dfb.dim_dfb_nfl_data
where name is not null
group by name
having count(*) > 1



      
    ) dbt_internal_test
[0m21:15:29.954570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:31.248221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:15:31.248221 [debug] [Thread-1 (]: Timing info for test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb (execute): 21:15:29.937050 => 21:15:31.248221
[0m21:15:31.248221 [debug] [Thread-1 (]: On test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb: Close
[0m21:15:31.453991 [error] [Thread-1 (]: 8 of 10 FAIL 805 unique_dim_dfb_nfl_data_name .................................. [[31mFAIL 805[0m in 1.55s]
[0m21:15:31.453991 [debug] [Thread-1 (]: Finished running node test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb
[0m21:15:31.453991 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:15:31.453991 [info ] [Thread-1 (]: 9 of 10 START python table model dfb.py_nfl_data ............................... [RUN]
[0m21:15:31.466963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb, now model.dfb_data.py_nfl_data)
[0m21:15:31.471070 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:15:31.529576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:15:31.531957 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:15:31.472873 => 21:15:31.531957
[0m21:15:31.531957 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:15:31.586364 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:15:31.602715 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:15:31.602715 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:15:31.602715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:35.340264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m21:15:35.345605 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:15:31.536553 => 21:15:35.345605
[0m21:15:35.345605 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:15:35.641966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aaaca37-592e-483b-9cfa-000c77ad721e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F82C2C350>]}
[0m21:15:35.657473 [info ] [Thread-1 (]: 9 of 10 OK created python table model dfb.py_nfl_data .......................... [[32mSUCCESS 1[0m in 4.18s]
[0m21:15:35.657473 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:15:35.657473 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m21:15:35.657473 [info ] [Thread-1 (]: 10 of 10 SKIP relation dfb.fct_nfl_teams ....................................... [[33mSKIP[0m]
[0m21:15:35.671309 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m21:15:35.676007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:35.676007 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:15:35.676007 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:15:35.676007 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m21:15:35.687028 [info ] [MainThread]: 
[0m21:15:35.689290 [info ] [MainThread]: Finished running 1 seed, 3 view models, 4 tests, 2 table models in 0 hours 0 minutes and 24.26 seconds (24.26s).
[0m21:15:35.695471 [debug] [MainThread]: Command end result
[0m21:15:35.717055 [info ] [MainThread]: 
[0m21:15:35.722956 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m21:15:35.722956 [info ] [MainThread]: 
[0m21:15:35.726847 [error] [MainThread]:   Database Error in seed seed_nfl_teams (seeds\seed_nfl_teams.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 68 unexpected 'text'.
[0m21:15:35.729171 [info ] [MainThread]: 
[0m21:15:35.729171 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX (models\schema.yml)[0m
[0m21:15:35.732018 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m21:15:35.732018 [info ] [MainThread]: 
[0m21:15:35.734469 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_44ee71505c94851bef85367bc43999be.sql
[0m21:15:35.735683 [info ] [MainThread]: 
[0m21:15:35.736888 [error] [MainThread]: [31mFailure in test unique_dim_dfb_nfl_data_name (models\schema.yml)[0m
[0m21:15:35.737863 [error] [MainThread]:   Got 805 results, configured to fail if != 0
[0m21:15:35.739137 [info ] [MainThread]: 
[0m21:15:35.739137 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\unique_dim_dfb_nfl_data_name.sql
[0m21:15:35.739137 [info ] [MainThread]: 
[0m21:15:35.745471 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=2 TOTAL=10
[0m21:15:35.747622 [debug] [MainThread]: Command `dbt build` failed at 21:15:35.747622 after 25.79 seconds
[0m21:15:35.747622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F80BBEF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FF9C91FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FF9CD7710>]}
[0m21:15:35.750581 [debug] [MainThread]: Flushing usage events
[0m21:17:03.231248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC4A96D810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC4A9883D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC4A92EB10>]}


============================== 21:17:03.231248 | 1f889062-a141-479b-b0b6-cce977e6a6be ==============================
[0m21:17:03.231248 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:17:03.231248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:17:04.097985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f889062-a141-479b-b0b6-cce977e6a6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC4C54B450>]}
[0m21:17:04.257505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f889062-a141-479b-b0b6-cce977e6a6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC4A93C8D0>]}
[0m21:17:04.257505 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:17:04.271819 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:17:04.430799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:04.430799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:04.430799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f889062-a141-479b-b0b6-cce977e6a6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC4C4AF2D0>]}
[0m21:17:04.447671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f889062-a141-479b-b0b6-cce977e6a6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC4C67E190>]}
[0m21:17:04.447671 [info ] [MainThread]: Found 6 models, 4 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:17:04.447671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f889062-a141-479b-b0b6-cce977e6a6be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC4A9ACCD0>]}
[0m21:17:04.456080 [info ] [MainThread]: 
[0m21:17:04.457637 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:17:04.529579 [info ] [MainThread]: Done.
[0m21:17:04.534376 [debug] [MainThread]: Command `dbt source freshness` succeeded at 21:17:04.534376 after 1.39 seconds
[0m21:17:04.534376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC43D20150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC43A86A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC4A592050>]}
[0m21:17:04.534376 [debug] [MainThread]: Flushing usage events
[0m21:17:16.491732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC05379DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC05353050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC05382A50>]}


============================== 21:17:16.507435 | 3282aa02-df56-4f51-81d8-1ba08d2477e0 ==============================
[0m21:17:16.507435 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:17:16.507435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:17:17.185705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3282aa02-df56-4f51-81d8-1ba08d2477e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC05F1CE10>]}
[0m21:17:17.386196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3282aa02-df56-4f51-81d8-1ba08d2477e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC05363E10>]}
[0m21:17:17.386196 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:17:17.408458 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:17:17.497077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:17.497077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:17.512759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3282aa02-df56-4f51-81d8-1ba08d2477e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC053CA990>]}
[0m21:17:17.528414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3282aa02-df56-4f51-81d8-1ba08d2477e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0705AC50>]}
[0m21:17:17.528414 [info ] [MainThread]: Found 6 models, 4 tests, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:17:17.528414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3282aa02-df56-4f51-81d8-1ba08d2477e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC03BD9310>]}
[0m21:17:17.528414 [info ] [MainThread]: 
[0m21:17:17.528414 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:17:17.528414 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:17:17.558222 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:17:17.558222 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:17:17.558222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:20.100880 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m21:17:20.116602 [debug] [ThreadPool]: On list_storage: Close
[0m21:17:20.307918 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:17:20.333676 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:17:20.333676 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:17:20.333676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:22.636671 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:17:22.636671 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:17:23.066885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3282aa02-df56-4f51-81d8-1ba08d2477e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC07012FD0>]}
[0m21:17:23.066885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:17:23.066885 [info ] [MainThread]: 
[0m21:17:23.082457 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:17:23.082457 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:17:23.082457 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:17:23.115346 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:17:23.120636 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:17:23.082457 => 21:17:23.120546
[0m21:17:23.122740 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:17:23.122740 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m21:17:23.130947 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m21:17:23.135944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m21:17:23.135944 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m21:17:23.135944 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m21:17:23.146525 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 21:17:23.135944 => 21:17:23.135944
[0m21:17:23.147758 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m21:17:23.189581 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m21:17:23.189581 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m21:17:23.189581 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m21:17:23.189581 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:17:24.705557 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8176d-0102-2a7c-0006-b1e60003216a
[0m21:17:24.705557 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STORAGE.DFB.SEED_NFL_TEAMS' does not exist or not authorized.
[0m21:17:24.721264 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 21:17:23.147758 => 21:17:24.721264
[0m21:17:24.721264 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m21:17:24.911113 [debug] [Thread-1 (]: Database Error in model stg_nfl_teams (models\staging\stg_nfl_teams.sql)
  002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.SEED_NFL_TEAMS' does not exist or not authorized.
  compiled Code at target\run\dfb_data\models\staging\stg_nfl_teams.sql
[0m21:17:24.911113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3282aa02-df56-4f51-81d8-1ba08d2477e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC070A30D0>]}
[0m21:17:24.911113 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model dfb.stg_nfl_teams ......................... [[31mERROR[0m in 1.78s]
[0m21:17:24.926128 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m21:17:24.926128 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:17:24.926128 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m21:17:24.937402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m21:17:24.939368 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:17:24.957439 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:17:24.960916 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:17:24.942046 => 21:17:24.960916
[0m21:17:24.960916 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:17:24.977113 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:17:24.977113 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:17:24.977113 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m21:17:24.985220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:26.346715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:17:26.403987 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:17:24.960916 => 21:17:26.403987
[0m21:17:26.403987 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:17:26.898131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3282aa02-df56-4f51-81d8-1ba08d2477e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC070CCB90>]}
[0m21:17:26.904647 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.97s]
[0m21:17:26.904647 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:17:26.904647 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:17:26.913218 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m21:17:26.919060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:17:26.921560 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:17:26.933771 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:17:26.939316 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:17:26.921560 => 21:17:26.937106
[0m21:17:26.940414 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:17:26.954671 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:17:26.959219 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:17:26.959219 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m21:17:26.959219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:28.901210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:17:28.910314 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:17:26.940414 => 21:17:28.910314
[0m21:17:28.917406 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:17:29.111261 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3282aa02-df56-4f51-81d8-1ba08d2477e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0761FC90>]}
[0m21:17:29.111261 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 2.19s]
[0m21:17:29.120844 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:17:29.120844 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m21:17:29.120844 [info ] [Thread-1 (]: 4 of 5 SKIP relation dfb.fct_nfl_teams ......................................... [[33mSKIP[0m]
[0m21:17:29.129585 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m21:17:29.132088 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:17:29.133921 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m21:17:29.137297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.py_nfl_data)
[0m21:17:29.137297 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:17:29.175617 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:17:29.175617 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:17:29.139940 => 21:17:29.175617
[0m21:17:29.180089 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:17:29.201474 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:17:29.208769 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:17:29.209782 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:17:29.211369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:33.301400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m21:17:33.301400 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:17:29.180089 => 21:17:33.301400
[0m21:17:33.316840 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:17:33.923573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3282aa02-df56-4f51-81d8-1ba08d2477e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC070BB550>]}
[0m21:17:33.923573 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 4.79s]
[0m21:17:33.931590 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:17:33.935504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:33.935504 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:17:33.935504 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:17:33.935504 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m21:17:33.935504 [info ] [MainThread]: 
[0m21:17:33.935504 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 16.41 seconds (16.41s).
[0m21:17:33.947841 [debug] [MainThread]: Command end result
[0m21:17:33.985650 [info ] [MainThread]: 
[0m21:17:33.989778 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:17:33.989778 [info ] [MainThread]: 
[0m21:17:33.995489 [error] [MainThread]:   Database Error in model stg_nfl_teams (models\staging\stg_nfl_teams.sql)
  002003 (42S02): SQL compilation error:
  Object 'STORAGE.DFB.SEED_NFL_TEAMS' does not exist or not authorized.
  compiled Code at target\run\dfb_data\models\staging\stg_nfl_teams.sql
[0m21:17:33.996585 [info ] [MainThread]: 
[0m21:17:33.999633 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m21:17:34.006174 [debug] [MainThread]: Command `dbt run` failed at 21:17:34.006174 after 17.62 seconds
[0m21:17:34.006174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7E421FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0536B090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC7E467650>]}
[0m21:17:34.006174 [debug] [MainThread]: Flushing usage events
[0m21:21:51.680933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774629F210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027746307090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774629F350>]}


============================== 21:21:51.680933 | d3772966-7c7f-4554-b04f-f0994720dfc6 ==============================
[0m21:21:51.680933 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:21:51.689733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:21:52.496961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027747EB5D50>]}
[0m21:21:52.616169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277463219D0>]}
[0m21:21:52.616169 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:21:52.624861 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:21:52.903424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:21:52.903424 [debug] [MainThread]: Partial parsing: updated file: dfb_data://seeds\seed_nfl_teams.csv
[0m21:21:52.903424 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\dim_dfb_nfl_data.sql
[0m21:21:53.889627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027748513C10>]}
[0m21:21:53.898211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027748091750>]}
[0m21:21:53.898211 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:21:53.898211 [info ] [MainThread]: 
[0m21:21:53.898211 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:21:53.898211 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:21:53.921992 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:21:53.921992 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:21:53.921992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:56.375417 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m21:21:56.384947 [debug] [ThreadPool]: On list_storage: Close
[0m21:21:57.099491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:21:57.113981 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:21:57.113981 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:21:57.113981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:58.425688 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m21:21:58.425688 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:21:58.641071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277482ACBD0>]}
[0m21:21:58.649730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:21:58.650207 [info ] [MainThread]: 
[0m21:21:58.663771 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:21:58.666154 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:21:58.666154 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:21:58.688030 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:21:58.690613 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:21:58.672349 => 21:21:58.690613
[0m21:21:58.693490 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:21:58.694607 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m21:21:58.694607 [info ] [Thread-1 (]: 1 of 10 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m21:21:58.694607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m21:21:58.694607 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m21:21:58.694607 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 21:21:58.694607 => 21:21:58.694607
[0m21:21:58.694607 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m21:21:58.742945 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:21:58.742945 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
create table storage.dfb.seed_nfl_teams (Abbrev text,Team_Name text)
[0m21:21:58.742945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:22:00.257035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:22:00.305115 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:22:00.305115 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m21:22:00.508831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:22:00.508831 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:22:00.508831 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m21:22:01.130645 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 1.0 seconds
[0m21:22:01.130645 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:22:01.130645 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m21:22:01.497372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:22:01.513088 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m21:22:01.560107 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 21:21:58.694607 => 21:22:01.560107
[0m21:22:01.560107 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m21:22:01.959807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774888A550>]}
[0m21:22:01.959807 [info ] [Thread-1 (]: 1 of 10 OK loaded seed file dfb.seed_nfl_teams ................................. [[32mINSERT 31[0m in 3.27s]
[0m21:22:01.959807 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m21:22:01.959807 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:22:01.959807 [info ] [Thread-1 (]: 2 of 10 START sql table model dfb.dim_dfb_nfl_data ............................. [RUN]
[0m21:22:01.977744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m21:22:01.978698 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:22:01.991195 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:22:01.997214 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:22:01.981988 => 21:22:01.997214
[0m21:22:01.997214 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:22:02.032824 [debug] [Thread-1 (]: Dropping relation "STORAGE"."DFB"."DIM_DFB_NFL_DATA" because it is of type view
[0m21:22:02.048852 [debug] [Thread-1 (]: Applying DROP to: "STORAGE"."DFB"."DIM_DFB_NFL_DATA"
[0m21:22:02.072617 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:22:02.072617 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
drop view if exists "STORAGE"."DFB"."DIM_DFB_NFL_DATA" cascade
[0m21:22:02.072617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:03.863334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:22:03.909571 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:22:03.914247 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:22:03.914247 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace transient table storage.dfb.dim_dfb_nfl_data
         as
        (
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
        );
[0m21:22:04.564038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:22:04.579903 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:22:01.997214 => 21:22:04.579903
[0m21:22:04.579903 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:22:04.721036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774889F610>]}
[0m21:22:04.721036 [info ] [Thread-1 (]: 2 of 10 OK created sql table model dfb.dim_dfb_nfl_data ........................ [[32mSUCCESS 1[0m in 2.76s]
[0m21:22:04.721036 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:22:04.721036 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:22:04.721036 [info ] [Thread-1 (]: 3 of 10 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m21:22:04.740545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:22:04.742823 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:22:04.753075 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:22:04.753075 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:22:04.746313 => 21:22:04.753075
[0m21:22:04.758634 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:22:04.791621 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:22:04.802154 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:22:04.802154 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m21:22:04.802154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:06.447960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:22:06.464806 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:22:04.758634 => 21:22:06.464806
[0m21:22:06.464806 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:22:07.069717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027748092510>]}
[0m21:22:07.069717 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 2.33s]
[0m21:22:07.069717 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:22:07.069717 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m21:22:07.085344 [info ] [Thread-1 (]: 4 of 10 START sql view model dfb.stg_nfl_teams ................................. [RUN]
[0m21:22:07.090134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m21:22:07.094167 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m21:22:07.096009 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m21:22:07.102031 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 21:22:07.096009 => 21:22:07.102031
[0m21:22:07.103394 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m21:22:07.108784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m21:22:07.110590 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m21:22:07.110590 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m21:22:07.110590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:09.018041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:22:09.018041 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 21:22:07.103394 => 21:22:09.018041
[0m21:22:09.018041 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m21:22:09.634386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277487214D0>]}
[0m21:22:09.639403 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dfb.stg_nfl_teams ............................ [[32mSUCCESS 1[0m in 2.54s]
[0m21:22:09.640666 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m21:22:09.640666 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m21:22:09.640666 [info ] [Thread-1 (]: 5 of 10 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [RUN]
[0m21:22:09.651740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133)
[0m21:22:09.654422 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m21:22:09.662388 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m21:22:09.670209 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (compile): 21:22:09.655122 => 21:22:09.662388
[0m21:22:09.671922 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m21:22:09.691982 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m21:22:09.691982 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m21:22:09.691982 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'
)



      
    ) dbt_internal_test
[0m21:22:09.691982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:12.048488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:22:12.064073 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (execute): 21:22:09.671922 => 21:22:12.064073
[0m21:22:12.064073 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: Close
[0m21:22:12.492155 [error] [Thread-1 (]: 5 of 10 FAIL 4 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[31mFAIL 4[0m in 2.83s]
[0m21:22:12.492155 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m21:22:12.492155 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:22:12.492155 [info ] [Thread-1 (]: 6 of 10 START test not_null_dim_dfb_nfl_data_date .............................. [RUN]
[0m21:22:12.502418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m21:22:12.505350 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:22:12.519490 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:22:12.525725 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 21:22:12.506782 => 21:22:12.525725
[0m21:22:12.525725 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:22:12.535399 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:22:12.539080 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:22:12.539080 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m21:22:12.539080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:14.955143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:22:14.955143 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 21:22:12.525725 => 21:22:14.955143
[0m21:22:14.955143 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m21:22:15.570127 [info ] [Thread-1 (]: 6 of 10 PASS not_null_dim_dfb_nfl_data_date .................................... [[32mPASS[0m in 3.08s]
[0m21:22:15.570127 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:22:15.570127 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:22:15.570127 [info ] [Thread-1 (]: 7 of 10 START test not_null_dim_dfb_nfl_data_name .............................. [RUN]
[0m21:22:15.586780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m21:22:15.588788 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:22:15.602939 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:22:15.611314 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 21:22:15.589573 => 21:22:15.602939
[0m21:22:15.612145 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:22:15.625378 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:22:15.631603 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:22:15.634084 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m21:22:15.635143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:16.849218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:22:16.849218 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 21:22:15.613604 => 21:22:16.849218
[0m21:22:16.866183 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m21:22:17.071725 [info ] [Thread-1 (]: 7 of 10 PASS not_null_dim_dfb_nfl_data_name .................................... [[32mPASS[0m in 1.50s]
[0m21:22:17.071725 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:22:17.071725 [debug] [Thread-1 (]: Began running node test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb
[0m21:22:17.071725 [info ] [Thread-1 (]: 8 of 10 START test unique_dim_dfb_nfl_data_name ................................ [RUN]
[0m21:22:17.086395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb)
[0m21:22:17.088906 [debug] [Thread-1 (]: Began compiling node test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb
[0m21:22:17.111792 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb"
[0m21:22:17.119120 [debug] [Thread-1 (]: Timing info for test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb (compile): 21:22:17.091727 => 21:22:17.111792
[0m21:22:17.119120 [debug] [Thread-1 (]: Began executing node test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb
[0m21:22:17.127373 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb"
[0m21:22:17.127373 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb"
[0m21:22:17.127373 [debug] [Thread-1 (]: On test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    name as unique_field,
    count(*) as n_records

from storage.dfb.dim_dfb_nfl_data
where name is not null
group by name
having count(*) > 1



      
    ) dbt_internal_test
[0m21:22:17.140822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:18.894614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:22:18.910319 [debug] [Thread-1 (]: Timing info for test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb (execute): 21:22:17.119120 => 21:22:18.910319
[0m21:22:18.910319 [debug] [Thread-1 (]: On test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb: Close
[0m21:22:19.521453 [error] [Thread-1 (]: 8 of 10 FAIL 805 unique_dim_dfb_nfl_data_name .................................. [[31mFAIL 805[0m in 2.45s]
[0m21:22:19.521453 [debug] [Thread-1 (]: Finished running node test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb
[0m21:22:19.521453 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:22:19.531973 [info ] [Thread-1 (]: 9 of 10 START python table model dfb.py_nfl_data ............................... [RUN]
[0m21:22:19.538358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb, now model.dfb_data.py_nfl_data)
[0m21:22:19.540690 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:22:19.598768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:22:19.611243 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:22:19.542031 => 21:22:19.607313
[0m21:22:19.611243 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:22:19.624954 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:22:19.628039 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:22:19.632601 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:22:19.632601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:23.208388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m21:22:23.225672 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:22:19.611243 => 21:22:23.225672
[0m21:22:23.225672 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:22:23.414205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027748A033D0>]}
[0m21:22:23.414205 [info ] [Thread-1 (]: 9 of 10 OK created python table model dfb.py_nfl_data .......................... [[32mSUCCESS 1[0m in 3.88s]
[0m21:22:23.422749 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:22:23.422749 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m21:22:23.422749 [info ] [Thread-1 (]: 10 of 10 START python table model dfb.fct_nfl_teams ............................ [RUN]
[0m21:22:23.430108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m21:22:23.433321 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m21:22:23.446879 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m21:22:23.450332 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 21:22:23.433321 => 21:22:23.450332
[0m21:22:23.450332 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m21:22:23.462415 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m21:22:23.468226 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m21:22:23.468226 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m21:22:23.478244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:22:26.797963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:22:26.813008 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 21:22:23.450332 => 21:22:26.813008
[0m21:22:26.813008 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m21:22:26.991036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3772966-7c7f-4554-b04f-f0994720dfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027748A91F90>]}
[0m21:22:26.991036 [info ] [Thread-1 (]: 10 of 10 OK created python table model dfb.fct_nfl_teams ....................... [[32mSUCCESS 1[0m in 3.57s]
[0m21:22:27.003063 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m21:22:27.003063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:27.003063 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:22:27.003063 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:22:27.003063 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m21:22:27.021293 [info ] [MainThread]: 
[0m21:22:27.023920 [info ] [MainThread]: Finished running 1 seed, 3 table models, 2 view models, 4 tests in 0 hours 0 minutes and 33.12 seconds (33.12s).
[0m21:22:27.029494 [debug] [MainThread]: Command end result
[0m21:22:27.062763 [info ] [MainThread]: 
[0m21:22:27.062763 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:22:27.062763 [info ] [MainThread]: 
[0m21:22:27.062763 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX (models\schema.yml)[0m
[0m21:22:27.075030 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m21:22:27.077517 [info ] [MainThread]: 
[0m21:22:27.080297 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_44ee71505c94851bef85367bc43999be.sql
[0m21:22:27.080297 [info ] [MainThread]: 
[0m21:22:27.080297 [error] [MainThread]: [31mFailure in test unique_dim_dfb_nfl_data_name (models\schema.yml)[0m
[0m21:22:27.080297 [error] [MainThread]:   Got 805 results, configured to fail if != 0
[0m21:22:27.080297 [info ] [MainThread]: 
[0m21:22:27.090412 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\unique_dim_dfb_nfl_data_name.sql
[0m21:22:27.092932 [info ] [MainThread]: 
[0m21:22:27.095923 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m21:22:27.096952 [debug] [MainThread]: Command `dbt build` failed at 21:22:27.096952 after 35.53 seconds
[0m21:22:27.096952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002774631BC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277463212D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773F411FD0>]}
[0m21:22:27.096952 [debug] [MainThread]: Flushing usage events
[0m21:26:18.705482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6CB78290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6BF44390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6CB66450>]}


============================== 21:26:18.715989 | 87da9a8c-b075-45c1-8c62-cfe08ecc925a ==============================
[0m21:26:18.715989 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:26:18.715989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:26:19.498297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6CB2CD50>]}
[0m21:26:19.655420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6CB68A50>]}
[0m21:26:19.655420 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:26:19.679595 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:26:19.902460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:26:19.902460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:26:19.906532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6CB1D350>]}
[0m21:26:19.937816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6E8575D0>]}
[0m21:26:19.937816 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:26:19.937816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6E8E9110>]}
[0m21:26:19.957232 [info ] [MainThread]: 
[0m21:26:19.963524 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:26:19.963524 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:26:20.002644 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:26:20.002644 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:26:20.002644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:22.306468 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m21:26:22.318509 [debug] [ThreadPool]: On list_storage: Close
[0m21:26:22.623159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:26:22.652905 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:26:22.652905 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:26:22.652905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:24.675583 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m21:26:24.691581 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:26:24.976443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6E788410>]}
[0m21:26:24.976443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:26:24.976443 [info ] [MainThread]: 
[0m21:26:24.994873 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:26:24.994873 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:26:24.994873 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:26:25.016104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:26:25.016104 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:26:24.994873 => 21:26:25.016104
[0m21:26:25.016104 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:26:25.016104 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m21:26:25.032903 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m21:26:25.034696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m21:26:25.034696 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m21:26:25.040383 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m21:26:25.040383 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 21:26:25.034696 => 21:26:25.040383
[0m21:26:25.045012 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m21:26:25.114733 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m21:26:25.122248 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m21:26:25.122248 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m21:26:25.122248 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:26:27.061330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:26:27.116390 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 21:26:25.047131 => 21:26:27.116390
[0m21:26:27.116390 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m21:26:27.681143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6EC452D0>]}
[0m21:26:27.681143 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 2.65s]
[0m21:26:27.681143 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m21:26:27.681143 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:26:27.695170 [info ] [Thread-1 (]: 2 of 5 START sql table model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m21:26:27.700320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m21:26:27.701766 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:26:27.718042 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:26:27.724653 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:26:27.703655 => 21:26:27.720412
[0m21:26:27.724855 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:26:27.786635 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:26:27.790891 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:26:27.793456 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace transient table storage.dfb.dim_dfb_nfl_data
         as
        (
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
        );
[0m21:26:27.793456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:29.469812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:26:29.483916 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:26:27.728947 => 21:26:29.483916
[0m21:26:29.483916 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:26:29.688424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6EB2AB50>]}
[0m21:26:29.688424 [info ] [Thread-1 (]: 2 of 5 OK created sql table model dfb.dim_dfb_nfl_data ......................... [[32mSUCCESS 1[0m in 1.99s]
[0m21:26:29.688424 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:26:29.688424 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:26:29.688424 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m21:26:29.703653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:26:29.706152 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:26:29.719068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:26:29.722970 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:26:29.707966 => 21:26:29.722970
[0m21:26:29.725947 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:26:29.732352 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:26:29.744879 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:26:29.747826 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m21:26:29.747826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:31.557755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:26:31.573258 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:26:29.727465 => 21:26:31.573258
[0m21:26:31.573258 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:26:32.187520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6CB9EB10>]}
[0m21:26:32.187520 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 2.50s]
[0m21:26:32.200958 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:26:32.203475 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m21:26:32.203475 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m21:26:32.209920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m21:26:32.212436 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m21:26:32.270756 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m21:26:32.286666 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 21:26:32.213747 => 21:26:32.270756
[0m21:26:32.290131 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m21:26:32.301336 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m21:26:32.304310 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m21:26:32.308602 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m21:26:32.309615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:36.156495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m21:26:36.173550 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 21:26:32.290131 => 21:26:36.173550
[0m21:26:36.173550 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m21:26:36.323993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6E9570D0>]}
[0m21:26:36.335507 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 4.12s]
[0m21:26:36.340055 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m21:26:36.340055 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:26:36.340055 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m21:26:36.350718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m21:26:36.352628 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:26:36.362875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:26:36.362875 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:26:36.353784 => 21:26:36.362875
[0m21:26:36.362875 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:26:36.375889 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:26:36.378286 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:26:36.380713 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:26:36.380713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:40.024886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m21:26:40.024886 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:26:36.362875 => 21:26:40.024886
[0m21:26:40.024886 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:26:40.231846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87da9a8c-b075-45c1-8c62-cfe08ecc925a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6E8BA7D0>]}
[0m21:26:40.231846 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 3.89s]
[0m21:26:40.231846 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:26:40.246452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:40.246452 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:26:40.246452 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:26:40.246452 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m21:26:40.246452 [info ] [MainThread]: 
[0m21:26:40.246452 [info ] [MainThread]: Finished running 2 view models, 3 table models in 0 hours 0 minutes and 20.28 seconds (20.28s).
[0m21:26:40.262632 [debug] [MainThread]: Command end result
[0m21:26:40.289132 [info ] [MainThread]: 
[0m21:26:40.293697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:40.293697 [info ] [MainThread]: 
[0m21:26:40.293697 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:26:40.300867 [debug] [MainThread]: Command `dbt run` succeeded at 21:26:40.293697 after 21.69 seconds
[0m21:26:40.301872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD65CC1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD6C60C8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD65F97D90>]}
[0m21:26:40.302956 [debug] [MainThread]: Flushing usage events
[0m12:07:14.369198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876E4F2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876EBABCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876F0CE090>]}


============================== 12:07:14.522144 | 898b44ca-47ca-49a9-b778-344661cdf25a ==============================
[0m12:07:14.522144 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:07:14.524763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m12:07:17.898925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '898b44ca-47ca-49a9-b778-344661cdf25a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876E4F2310>]}
[0m12:07:17.902342 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:07:17.905361 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:07:17.908108 [debug] [MainThread]: Command `dbt deps` succeeded at 12:07:17.908108 after 3.83 seconds
[0m12:07:17.909064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876F147810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018768231FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876ED05CD0>]}
[0m12:07:17.909064 [debug] [MainThread]: Flushing usage events
[0m12:08:05.830651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020027A9EE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002757C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020027AEDAD0>]}


============================== 12:08:05.835735 | 32a55fdc-0cf6-4f38-b1eb-498d953549af ==============================
[0m12:08:05.835735 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:08:05.836737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:08:06.034086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32a55fdc-0cf6-4f38-b1eb-498d953549af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020027B39F90>]}
[0m12:08:06.102679 [debug] [MainThread]: Set downloads directory='C:\Users\harol\AppData\Local\Temp\dbt-downloads-mdr212uv'
[0m12:08:06.104713 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:08:06.437900 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:08:06.439718 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:08:06.539639 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:08:06.549953 [info ] [MainThread]: Updating lock file in file path: C:\Users\harol\PycharmProjects\pythonProject\dbt_course\dfb_data/package-lock.yml
[0m12:08:06.560754 [debug] [MainThread]: Set downloads directory='C:\Users\harol\AppData\Local\Temp\dbt-downloads-etbf5w3t'
[0m12:08:06.564921 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:08:07.879177 [info ] [MainThread]: Installed from version 0.8.0
[0m12:08:07.880179 [info ] [MainThread]: Updated version available: 1.3.0
[0m12:08:07.880179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '32a55fdc-0cf6-4f38-b1eb-498d953549af', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020027B1D510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020027B1E290>]}
[0m12:08:07.881686 [info ] [MainThread]: 
[0m12:08:07.882693 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m12:08:07.886162 [debug] [MainThread]: Command `dbt deps` succeeded at 12:08:07.886162 after 2.18 seconds
[0m12:08:07.888341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020027AB3AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020020BD1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020027B01690>]}
[0m12:08:07.889149 [debug] [MainThread]: Flushing usage events
[0m12:30:50.382178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2F94F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2F94EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2F94F310>]}


============================== 12:30:50.386665 | 37456e3b-480a-40a5-96ec-1458cdbf9065 ==============================
[0m12:30:50.386665 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:30:50.389004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m12:30:54.627627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2F9FC390>]}
[0m12:30:54.755321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD314FCED0>]}
[0m12:30:54.757274 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:30:54.962422 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:30:55.069307 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:30:55.071304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD314CF290>]}
[0m12:31:00.237799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD31BBD290>]}
[0m12:31:00.570923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD31DCB190>]}
[0m12:31:00.571925 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 617 macros, 0 groups, 0 semantic models
[0m12:31:00.575637 [info ] [MainThread]: 
[0m12:31:00.577568 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:00.579567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:31:00.596874 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:31:00.596874 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:31:00.597828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:02.464893 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:31:02.467893 [debug] [ThreadPool]: On list_storage: Close
[0m12:31:02.722743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:31:02.731751 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:31:02.732752 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:31:02.732752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:03.423541 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:31:03.425576 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:31:03.572624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD31CE4750>]}
[0m12:31:03.573672 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:03.574626 [info ] [MainThread]: 
[0m12:31:03.625185 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:31:03.626184 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:31:03.626184 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:31:03.635184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:31:03.653740 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:31:03.627185 => 12:31:03.653740
[0m12:31:03.655740 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:31:03.656740 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m12:31:03.657733 [info ] [Thread-1 (]: 1 of 10 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m12:31:03.660237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m12:31:03.660237 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m12:31:03.661227 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 12:31:03.661227 => 12:31:03.661227
[0m12:31:03.661227 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m12:31:03.704390 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:31:03.706419 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m12:31:03.706419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:31:04.416561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:04.417556 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:31:04.418558 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m12:31:04.804102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:31:04.805147 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:31:04.806168 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m12:31:05.051302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:31:05.069927 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:31:05.070925 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m12:31:05.167930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:31:05.170923 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:31:05.172866 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m12:31:05.975165 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 1.0 seconds
[0m12:31:05.977183 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:31:05.979162 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m12:31:06.189575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:31:06.196534 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m12:31:06.238190 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 12:31:03.662667 => 12:31:06.238190
[0m12:31:06.238190 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m12:31:06.373142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD318D3610>]}
[0m12:31:06.374143 [info ] [Thread-1 (]: 1 of 10 OK loaded seed file dfb.seed_nfl_teams ................................. [[32mINSERT 31[0m in 2.71s]
[0m12:31:06.376145 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m12:31:06.376145 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:31:06.379405 [info ] [Thread-1 (]: 2 of 10 START sql table model dfb.dim_dfb_nfl_data ............................. [RUN]
[0m12:31:06.380913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m12:31:06.381921 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:31:06.426004 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:31:06.382923 => 12:31:06.426004
[0m12:31:06.710085 [debug] [Thread-1 (]: Compilation Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:31:06.710085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD31AF1FD0>]}
[0m12:31:06.711029 [error] [Thread-1 (]: 2 of 10 ERROR creating sql table model dfb.dim_dfb_nfl_data .................... [[31mERROR[0m in 0.33s]
[0m12:31:06.713634 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:31:06.713634 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m12:31:06.716662 [info ] [Thread-1 (]: 3 of 10 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m12:31:06.718091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m12:31:06.719092 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m12:31:06.725384 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m12:31:06.727318 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 12:31:06.720131 => 12:31:06.726380
[0m12:31:06.728318 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m12:31:06.758273 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m12:31:06.760228 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m12:31:06.761230 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m12:31:06.762475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:07.780053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:07.790127 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 12:31:06.728318 => 12:31:07.790127
[0m12:31:07.792136 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m12:31:07.939516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD31709010>]}
[0m12:31:07.939516 [info ] [Thread-1 (]: 3 of 10 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 1.22s]
[0m12:31:07.939516 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m12:31:07.939516 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m12:31:07.939516 [info ] [Thread-1 (]: 4 of 10 START sql view model dfb.stg_nfl_teams ................................. [RUN]
[0m12:31:07.939516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m12:31:07.939516 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m12:31:07.954296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m12:31:07.971948 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 12:31:07.939516 => 12:31:07.971948
[0m12:31:07.972952 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m12:31:07.978945 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m12:31:07.989814 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m12:31:07.990821 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m12:31:07.991810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:08.885604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:08.891970 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 12:31:07.973972 => 12:31:08.891970
[0m12:31:08.892967 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m12:31:09.013054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3207F490>]}
[0m12:31:09.019391 [info ] [Thread-1 (]: 4 of 10 OK created sql view model dfb.stg_nfl_teams ............................ [[32mSUCCESS 1[0m in 1.07s]
[0m12:31:09.020124 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m12:31:09.020124 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:31:09.020124 [info ] [Thread-1 (]: 5 of 10 SKIP test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[33mSKIP[0m]
[0m12:31:09.025929 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:31:09.026948 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:31:09.026948 [info ] [Thread-1 (]: 6 of 10 SKIP test not_null_dim_dfb_nfl_data_date ............................... [[33mSKIP[0m]
[0m12:31:09.028991 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:31:09.029956 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:31:09.030956 [info ] [Thread-1 (]: 7 of 10 SKIP test not_null_dim_dfb_nfl_data_name ............................... [[33mSKIP[0m]
[0m12:31:09.076564 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:31:09.077534 [debug] [Thread-1 (]: Began running node test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb
[0m12:31:09.078531 [info ] [Thread-1 (]: 8 of 10 SKIP test unique_dim_dfb_nfl_data_name ................................. [[33mSKIP[0m]
[0m12:31:09.079562 [debug] [Thread-1 (]: Finished running node test.dfb_data.unique_dim_dfb_nfl_data_name.c7eaf688fb
[0m12:31:09.080533 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m12:31:09.081532 [info ] [Thread-1 (]: 9 of 10 START python table model dfb.py_nfl_data ............................... [RUN]
[0m12:31:09.084039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.py_nfl_data)
[0m12:31:09.084039 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m12:31:09.115119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m12:31:09.117086 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 12:31:09.085048 => 12:31:09.117086
[0m12:31:09.118085 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m12:31:09.138456 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m12:31:09.152182 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m12:31:09.154539 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m12:31:09.155587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:14.838711 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m12:31:14.856583 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 12:31:09.118085 => 12:31:14.856583
[0m12:31:14.857604 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m12:31:15.008403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3049E4D0>]}
[0m12:31:15.011399 [info ] [Thread-1 (]: 9 of 10 OK created python table model dfb.py_nfl_data .......................... [[32mSUCCESS 1[0m in 5.93s]
[0m12:31:15.013758 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m12:31:15.014803 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m12:31:15.015756 [info ] [Thread-1 (]: 10 of 10 START python table model dfb.fct_nfl_teams ............................ [RUN]
[0m12:31:15.016755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m12:31:15.017815 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m12:31:15.023818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m12:31:15.066764 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 12:31:15.018760 => 12:31:15.065785
[0m12:31:15.067834 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m12:31:15.073811 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m12:31:15.075773 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m12:31:15.076824 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m12:31:15.077826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:17.903095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:31:17.907098 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 12:31:15.068788 => 12:31:17.906041
[0m12:31:17.907098 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m12:31:18.072794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37456e3b-480a-40a5-96ec-1458cdbf9065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD3193A710>]}
[0m12:31:18.074803 [info ] [Thread-1 (]: 10 of 10 OK created python table model dfb.fct_nfl_teams ....................... [[32mSUCCESS 1[0m in 3.06s]
[0m12:31:18.076746 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m12:31:18.079483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:18.080522 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:31:18.081522 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:31:18.081522 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m12:31:18.082531 [info ] [MainThread]: 
[0m12:31:18.084559 [info ] [MainThread]: Finished running 1 seed, 3 table models, 2 view models, 4 tests in 0 hours 0 minutes and 17.51 seconds (17.51s).
[0m12:31:18.087574 [debug] [MainThread]: Command end result
[0m12:31:18.119967 [info ] [MainThread]: 
[0m12:31:18.121956 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:31:18.123188 [info ] [MainThread]: 
[0m12:31:18.125201 [error] [MainThread]:   Compilation Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:31:18.127574 [info ] [MainThread]: 
[0m12:31:18.128578 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=4 TOTAL=10
[0m12:31:18.131637 [debug] [MainThread]: Command `dbt build` failed at 12:31:18.130625 after 27.92 seconds
[0m12:31:18.131637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD28AA1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2F9D1A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD2F5B1FD0>]}
[0m12:31:18.132673 [debug] [MainThread]: Flushing usage events
[0m12:39:43.260284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179A6F9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179A6F9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179A6F95D0>]}


============================== 12:39:43.265777 | 9fd84d2a-9188-432e-a7b2-ddc4343dce1f ==============================
[0m12:39:43.265777 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:39:43.267779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --select dim_dfb_nfl_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:43.876441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fd84d2a-9188-432e-a7b2-ddc4343dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179C2D0390>]}
[0m12:39:43.971179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fd84d2a-9188-432e-a7b2-ddc4343dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179C2401D0>]}
[0m12:39:43.973131 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:39:43.987199 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:39:44.220153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:44.221155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:44.227153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fd84d2a-9188-432e-a7b2-ddc4343dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179C3FAED0>]}
[0m12:39:44.288135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fd84d2a-9188-432e-a7b2-ddc4343dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179C484890>]}
[0m12:39:44.289196 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 617 macros, 0 groups, 0 semantic models
[0m12:39:44.290166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd84d2a-9188-432e-a7b2-ddc4343dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217961F7750>]}
[0m12:39:44.292144 [info ] [MainThread]: 
[0m12:39:44.293889 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:44.295961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:39:44.311880 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:39:44.312880 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:39:44.313914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:45.255346 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:39:45.259377 [debug] [ThreadPool]: On list_storage: Close
[0m12:39:45.388908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:39:45.402893 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:39:45.403936 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:39:45.403936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:46.141982 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:39:46.145956 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:39:46.295662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd84d2a-9188-432e-a7b2-ddc4343dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179944A010>]}
[0m12:39:46.296666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:46.298603 [info ] [MainThread]: 
[0m12:39:46.304354 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:39:46.305358 [info ] [Thread-1 (]: 1 of 1 START sql table model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m12:39:46.307357 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.dim_dfb_nfl_data'
[0m12:39:46.308378 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:39:46.319352 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:39:46.309360 => 12:39:46.318340
[0m12:39:46.326347 [debug] [Thread-1 (]: Compilation Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:39:46.327399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd84d2a-9188-432e-a7b2-ddc4343dce1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179C86E4D0>]}
[0m12:39:46.328348 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dfb.dim_dfb_nfl_data ..................... [[31mERROR[0m in 0.02s]
[0m12:39:46.329352 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:39:46.332395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:46.333428 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:39:46.333428 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:39:46.334396 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_data' was properly closed.
[0m12:39:46.334396 [info ] [MainThread]: 
[0m12:39:46.336351 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m12:39:46.338352 [debug] [MainThread]: Command end result
[0m12:39:46.351360 [info ] [MainThread]: 
[0m12:39:46.352359 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:39:46.355418 [info ] [MainThread]: 
[0m12:39:46.356418 [error] [MainThread]:   Compilation Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:39:46.358413 [info ] [MainThread]: 
[0m12:39:46.360414 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:39:46.361991 [debug] [MainThread]: Command `dbt run` failed at 12:39:46.361991 after 3.25 seconds
[0m12:39:46.363018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179A723E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021793811F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179A1CC910>]}
[0m12:39:46.363975 [debug] [MainThread]: Flushing usage events
[0m12:42:13.914291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B60FE8F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B60FE8F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B60FE8DE50>]}


============================== 12:42:13.918310 | ce891867-c447-449d-976b-d8be67f6ddee ==============================
[0m12:42:13.918310 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:42:13.919630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select dim_dfb_nfl_data', 'send_anonymous_usage_stats': 'True'}
[0m12:42:14.477319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce891867-c447-449d-976b-d8be67f6ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B611A0FE90>]}
[0m12:42:14.577928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce891867-c447-449d-976b-d8be67f6ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B611AE9390>]}
[0m12:42:14.579967 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:42:14.594975 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:42:14.724448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:14.725421 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\dim_dfb_nfl_data.sql
[0m12:42:15.205830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce891867-c447-449d-976b-d8be67f6ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6120F6090>]}
[0m12:42:15.223317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce891867-c447-449d-976b-d8be67f6ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B611D1F610>]}
[0m12:42:15.224258 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 617 macros, 0 groups, 0 semantic models
[0m12:42:15.226280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce891867-c447-449d-976b-d8be67f6ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B61206E850>]}
[0m12:42:15.229262 [info ] [MainThread]: 
[0m12:42:15.230993 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:15.233618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:42:15.248665 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:42:15.248665 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:42:15.249674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:16.178479 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:42:16.181474 [debug] [ThreadPool]: On list_storage: Close
[0m12:42:16.361947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:42:16.371941 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:42:16.372942 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:42:16.373942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:17.146145 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:42:17.150150 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:42:17.309921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce891867-c447-449d-976b-d8be67f6ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6120F4D50>]}
[0m12:42:17.311856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:17.313854 [info ] [MainThread]: 
[0m12:42:17.318563 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:42:17.319605 [info ] [Thread-1 (]: 1 of 1 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:42:17.321566 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.dim_dfb_nfl_data'
[0m12:42:17.322565 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:42:17.333562 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:42:17.322565 => 12:42:17.332564
[0m12:42:17.337568 [debug] [Thread-1 (]: Compilation Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:42:17.338569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce891867-c447-449d-976b-d8be67f6ddee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B612383A10>]}
[0m12:42:17.339572 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dfb.dim_dfb_nfl_data ...................... [[31mERROR[0m in 0.02s]
[0m12:42:17.342565 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:42:17.345610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:17.345610 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:42:17.346564 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:42:17.346564 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_data' was properly closed.
[0m12:42:17.347565 [info ] [MainThread]: 
[0m12:42:17.348566 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m12:42:17.350596 [debug] [MainThread]: Command end result
[0m12:42:17.364563 [info ] [MainThread]: 
[0m12:42:17.366572 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:42:17.367568 [info ] [MainThread]: 
[0m12:42:17.368440 [error] [MainThread]:   Compilation Error in model dim_dfb_nfl_data (models\dim\dim_dfb_nfl_data.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:42:17.371468 [info ] [MainThread]: 
[0m12:42:17.372486 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:42:17.375690 [debug] [MainThread]: Command `dbt run` failed at 12:42:17.375690 after 3.55 seconds
[0m12:42:17.376468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B60FF0C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B609051F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6090976D0>]}
[0m12:42:17.377467 [debug] [MainThread]: Flushing usage events
[0m12:50:45.346198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BD6413C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BD63ED6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BD63EC650>]}


============================== 12:50:45.350553 | 93e3652b-33f5-45ac-9b3d-4e704fce4fc4 ==============================
[0m12:50:45.350553 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:50:45.470897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:45.639097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93e3652b-33f5-45ac-9b3d-4e704fce4fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BD649FB10>]}
[0m12:50:45.691132 [debug] [MainThread]: Set downloads directory='C:\Users\harol\AppData\Local\Temp\dbt-downloads-b6f6519o'
[0m12:50:45.691132 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:50:46.059418 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:50:46.061422 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:50:46.182987 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:50:46.189023 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:50:46.858457 [info ] [MainThread]: Installed from version 0.8.0
[0m12:50:46.859482 [info ] [MainThread]: Updated version available: 1.3.0
[0m12:50:46.861463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93e3652b-33f5-45ac-9b3d-4e704fce4fc4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BD642BE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BD642DDD0>]}
[0m12:50:46.862460 [info ] [MainThread]: 
[0m12:50:46.863797 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m12:50:46.867900 [debug] [MainThread]: Command `dbt deps` succeeded at 12:50:46.867900 after 1.60 seconds
[0m12:50:46.868876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BCF4D1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BD4FDA710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BCF7B0110>]}
[0m12:50:46.869819 [debug] [MainThread]: Flushing usage events
[0m12:53:24.382719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002399113AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023991103350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023991101CD0>]}


============================== 12:53:24.386799 | e3ac5a55-e840-4510-8b99-6ac7a4714dd8 ==============================
[0m12:53:24.386799 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:53:24.389746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m12:53:24.565099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3ac5a55-e840-4510-8b99-6ac7a4714dd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239912090D0>]}
[0m12:53:24.569055 [debug] [MainThread]: Set downloads directory='C:\Users\harol\AppData\Local\Temp\dbt-downloads-r_cv4h7s'
[0m12:53:24.570121 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:53:24.807687 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:53:24.809326 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:53:24.911101 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:53:24.916100 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m12:53:25.017118 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m12:53:25.026124 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m12:53:25.128439 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m12:53:25.145400 [info ] [MainThread]: Updating lock file in file path: C:\Users\harol\PycharmProjects\pythonProject\dbt_course\dfb_data/package-lock.yml
[0m12:53:25.213970 [debug] [MainThread]: Set downloads directory='C:\Users\harol\AppData\Local\Temp\dbt-downloads-s8de81hq'
[0m12:53:25.222971 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:53:26.435624 [info ] [MainThread]: Installed from version 1.3.0
[0m12:53:26.437646 [info ] [MainThread]: Up to date!
[0m12:53:26.438623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e3ac5a55-e840-4510-8b99-6ac7a4714dd8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398F98ED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023991198190>]}
[0m12:53:26.438623 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m12:53:27.327567 [info ] [MainThread]: Installed from version 0.10.1
[0m12:53:27.329590 [info ] [MainThread]: Updated version available: 0.10.4
[0m12:53:27.329590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e3ac5a55-e840-4510-8b99-6ac7a4714dd8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023991157250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239910EB9D0>]}
[0m12:53:27.330568 [info ] [MainThread]: Installing calogica/dbt_date
[0m12:53:27.578848 [info ] [MainThread]: Installed from version 0.10.1
[0m12:53:27.579841 [info ] [MainThread]: Up to date!
[0m12:53:27.580842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e3ac5a55-e840-4510-8b99-6ac7a4714dd8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023991252D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023991209750>]}
[0m12:53:27.581843 [info ] [MainThread]: 
[0m12:53:27.582841 [info ] [MainThread]: Updates available for packages: ['calogica/dbt_expectations']                 
Update your versions in packages.yml, then run dbt deps
[0m12:53:27.585855 [debug] [MainThread]: Command `dbt deps` succeeded at 12:53:27.585855 after 3.30 seconds
[0m12:53:27.586854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398A231FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398A510110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398A510BD0>]}
[0m12:53:27.586854 [debug] [MainThread]: Flushing usage events
[0m12:53:53.895072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B3829B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B37CEB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B3828110>]}


============================== 12:53:53.935636 | 90b56819-f206-47c5-8a91-c73656a6198f ==============================
[0m12:53:53.935636 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:53:53.937645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select dim_dfb_nfl_data', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:54.518803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90b56819-f206-47c5-8a91-c73656a6198f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B537FBD0>]}
[0m12:53:54.608439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90b56819-f206-47c5-8a91-c73656a6198f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B538AF10>]}
[0m12:53:54.610670 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:53:54.737549 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:53:54.774898 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:53:54.776850 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:53:54.777852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90b56819-f206-47c5-8a91-c73656a6198f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B5405610>]}
[0m12:53:58.672190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90b56819-f206-47c5-8a91-c73656a6198f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B581C3D0>]}
[0m12:53:58.690189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90b56819-f206-47c5-8a91-c73656a6198f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B5615250>]}
[0m12:53:58.691193 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 807 macros, 0 groups, 0 semantic models
[0m12:53:58.692189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90b56819-f206-47c5-8a91-c73656a6198f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6AF2E7750>]}
[0m12:53:58.694256 [info ] [MainThread]: 
[0m12:53:58.696269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:53:58.699067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:53:58.714065 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:53:58.715067 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:53:58.716067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:59.719980 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:53:59.723973 [debug] [ThreadPool]: On list_storage: Close
[0m12:53:59.883958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:53:59.893949 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:53:59.894950 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:53:59.894950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:00.578067 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:54:00.583031 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:54:00.718192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90b56819-f206-47c5-8a91-c73656a6198f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B5932850>]}
[0m12:54:00.720271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:00.722227 [info ] [MainThread]: 
[0m12:54:00.728155 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:54:00.729195 [info ] [Thread-1 (]: 1 of 1 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:54:00.731154 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.dim_dfb_nfl_data'
[0m12:54:00.732155 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:54:00.746662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:54:00.751660 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:54:00.892330 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:54:00.733155 => 12:54:00.891329
[0m12:54:00.893325 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:54:00.929467 [debug] [Thread-1 (]: Dropping relation "STORAGE"."DFB"."DIM_DFB_NFL_DATA" because it is of type table
[0m12:54:00.938409 [debug] [Thread-1 (]: Applying DROP to: "STORAGE"."DFB"."DIM_DFB_NFL_DATA"
[0m12:54:00.945102 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:54:00.946101 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
drop table if exists "STORAGE"."DFB"."DIM_DFB_NFL_DATA" cascade
[0m12:54:00.947102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:01.785434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:54:01.802423 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:54:01.804424 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:54:01.805425 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m12:54:02.227155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:54:02.247833 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:54:00.895324 => 12:54:02.247833
[0m12:54:02.248835 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:54:02.386449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90b56819-f206-47c5-8a91-c73656a6198f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B5B92D10>]}
[0m12:54:02.388448 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.66s]
[0m12:54:02.390611 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:54:02.392613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:02.393612 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:54:02.393612 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:54:02.394574 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_data' was properly closed.
[0m12:54:02.394574 [info ] [MainThread]: 
[0m12:54:02.396575 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m12:54:02.398579 [debug] [MainThread]: Command end result
[0m12:54:02.421577 [info ] [MainThread]: 
[0m12:54:02.423721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:02.425487 [info ] [MainThread]: 
[0m12:54:02.426392 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:54:02.429473 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:02.428401 after 8.62 seconds
[0m12:54:02.430480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6AC8D1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B264D8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6B583DCD0>]}
[0m12:54:02.430480 [debug] [MainThread]: Flushing usage events
[0m20:43:32.817099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3E43B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3E3DD050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3E442A50>]}


============================== 20:43:32.887458 | 5b0a8a59-ddb5-41cf-8b38-eda222f72101 ==============================
[0m20:43:32.887458 [info ] [MainThread]: Running with dbt=1.7.18
[0m20:43:32.890513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:43:35.294674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b0a8a59-ddb5-41cf-8b38-eda222f72101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3FF51A50>]}
[0m20:43:35.392381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b0a8a59-ddb5-41cf-8b38-eda222f72101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3E3EBAD0>]}
[0m20:43:35.394697 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:43:35.545499 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m20:43:38.496252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:43:38.496252 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m20:43:38.801276 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\schema.yml @ models: {'name': 'dim_dfb_nfl_data', 'description': 'Daily Fantasy Buzz data', 'columns': [{'name': 'record_id'}, {'tests': ['unique', 'not_null']}, {'name': 'date', 'description': 'Date of game', 'tests': ['not_null']}, {'name': 'name', 'description': 'Player name', 'tests': ['not_null']}, {'name': 'position', 'description': 'Type of the apartment / room', 'tests': [{'accepted_values': {'values': ['TE/FLEX', 'QB', 'WR/FLEX', 'RB/FLEX']}}]}], 'original_file_path': 'models\\schema.yml', 'yaml_key': 'models', 'package_name': 'dfb_data'} - at path ['columns'][1]: 'name' is a required property
[0m20:43:38.801276 [debug] [MainThread]: Command `dbt run` failed at 20:43:38.801276 after 6.36 seconds
[0m20:43:38.805826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3E3EAD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F375C1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3E011E90>]}
[0m20:43:38.806055 [debug] [MainThread]: Flushing usage events
[0m22:03:14.777606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6AA7B390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6AA68A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6AA4E490>]}


============================== 22:03:14.779148 | b9243f1b-5993-4748-9c9f-3268b082f6b9 ==============================
[0m22:03:14.779148 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:03:14.779148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:03:15.457837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9243f1b-5993-4748-9c9f-3268b082f6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6AAB6650>]}
[0m22:03:15.572829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9243f1b-5993-4748-9c9f-3268b082f6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6C67A050>]}
[0m22:03:15.577425 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:03:15.607308 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:03:15.877607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:03:15.877607 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m22:03:16.192375 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\schema.yml @ models: {'name': 'dim_dfb_nfl_data', 'description': 'Daily Fantasy Buzz data', 'columns': [{'name': 'record_id'}, {'tests': ['unique', 'not_null']}, {'name': 'date', 'description': 'Date of game', 'tests': ['not_null']}, {'name': 'name', 'description': 'Player name', 'tests': ['not_null']}, {'name': 'position', 'description': 'Type of the apartment / room', 'tests': [{'accepted_values': {'values': ['TE/FLEX', 'QB', 'WR/FLEX', 'RB/FLEX']}}]}], 'original_file_path': 'models\\schema.yml', 'yaml_key': 'models', 'package_name': 'dfb_data'} - at path ['columns'][1]: 'name' is a required property
[0m22:03:16.198748 [debug] [MainThread]: Command `dbt run` failed at 22:03:16.197515 after 1.60 seconds
[0m22:03:16.199160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6AA42590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F63B71FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6CC7C790>]}
[0m22:03:16.199160 [debug] [MainThread]: Flushing usage events
[0m22:15:02.834298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4FFB345D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4FFB37410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4FFB1B450>]}


============================== 22:15:02.834298 | bf1aef85-de16-45c2-ae4c-bfa867dcffe3 ==============================
[0m22:15:02.834298 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:15:02.834298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:03.414497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48061DD10>]}
[0m22:15:03.493174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4FFB5AA50>]}
[0m22:15:03.493174 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:15:03.530523 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:15:03.805548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:15:03.821223 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m22:15:04.276817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B481CC5F10>]}
[0m22:15:04.511812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B481E74790>]}
[0m22:15:04.511812 [info ] [MainThread]: Found 6 models, 1 seed, 3 tests, 0 sources, 0 exposures, 0 metrics, 807 macros, 0 groups, 0 semantic models
[0m22:15:04.511812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4FFB0BE90>]}
[0m22:15:04.511812 [info ] [MainThread]: 
[0m22:15:04.511812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:15:04.511812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m22:15:04.533626 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m22:15:04.533626 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m22:15:04.540349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:07.366000 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m22:15:07.366000 [debug] [ThreadPool]: On list_storage: Close
[0m22:15:07.522689 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:15:07.538818 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:15:07.538818 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:15:07.538818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:08.244249 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:15:08.244249 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:15:08.386271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4818682D0>]}
[0m22:15:08.386271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:15:08.401837 [info ] [MainThread]: 
[0m22:15:08.442666 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m22:15:08.442666 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m22:15:08.442666 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m22:15:08.459232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m22:15:08.505582 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 22:15:08.442666 => 22:15:08.504580
[0m22:15:08.507716 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m22:15:08.507716 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m22:15:08.507716 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m22:15:08.507716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m22:15:08.507716 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m22:15:08.507716 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m22:15:08.529437 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 22:15:08.507716 => 22:15:08.529437
[0m22:15:08.529437 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m22:15:08.558669 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m22:15:08.639689 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m22:15:08.639689 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m22:15:08.639689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:09.702275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:15:09.717732 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 22:15:08.529437 => 22:15:09.717732
[0m22:15:09.717732 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m22:15:09.921732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4821FA8D0>]}
[0m22:15:09.939212 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.41s]
[0m22:15:09.939212 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m22:15:09.939212 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m22:15:09.939212 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m22:15:09.939212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m22:15:09.939212 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m22:15:09.958347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m22:15:10.026077 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 22:15:09.939212 => 22:15:10.025045
[0m22:15:10.028037 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m22:15:10.033025 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m22:15:10.036064 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m22:15:10.037027 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m22:15:10.037027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:11.130277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:15:11.142353 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 22:15:10.029040 => 22:15:11.142353
[0m22:15:11.146438 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m22:15:11.270533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B481BE55D0>]}
[0m22:15:11.270533 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.33s]
[0m22:15:11.286744 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m22:15:11.286744 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m22:15:11.286744 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m22:15:11.286744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m22:15:11.286744 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m22:15:11.286744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m22:15:11.331512 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 22:15:11.286744 => 22:15:11.331512
[0m22:15:11.331512 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m22:15:11.331512 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m22:15:11.362776 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m22:15:11.363771 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m22:15:11.364768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:12.259522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:15:12.263525 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 22:15:11.331512 => 22:15:12.262520
[0m22:15:12.263525 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m22:15:12.398975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B481DA1D10>]}
[0m22:15:12.398975 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.11s]
[0m22:15:12.414405 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m22:15:12.414405 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m22:15:12.414405 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m22:15:12.419143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m22:15:12.420182 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m22:15:12.447017 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m22:15:12.488641 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 22:15:12.420498 => 22:15:12.488641
[0m22:15:12.490838 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m22:15:12.507147 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m22:15:12.507147 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m22:15:12.507147 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m22:15:12.522819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:18.734448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m22:15:18.734448 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 22:15:12.491893 => 22:15:18.734448
[0m22:15:18.734448 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m22:15:18.891997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B48223C7D0>]}
[0m22:15:18.891997 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 6.48s]
[0m22:15:18.891997 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m22:15:18.891997 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m22:15:18.891997 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m22:15:18.891997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m22:15:18.891997 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m22:15:18.907465 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m22:15:18.909974 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 22:15:18.891997 => 22:15:18.909691
[0m22:15:18.911397 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m22:15:18.913630 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m22:15:18.997334 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m22:15:18.998336 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m22:15:18.999330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:21.730946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:15:21.730946 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 22:15:18.911527 => 22:15:21.730946
[0m22:15:21.730946 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m22:15:21.868955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf1aef85-de16-45c2-ae4c-bfa867dcffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B481FE7D10>]}
[0m22:15:21.868955 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 2.98s]
[0m22:15:21.868955 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m22:15:21.884645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:21.884645 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m22:15:21.884645 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:15:21.884645 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m22:15:21.884645 [info ] [MainThread]: 
[0m22:15:21.889400 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 17.37 seconds (17.37s).
[0m22:15:21.891457 [debug] [MainThread]: Command end result
[0m22:15:21.907618 [info ] [MainThread]: 
[0m22:15:21.924810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:21.926818 [info ] [MainThread]: 
[0m22:15:21.927857 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:15:21.929437 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:21.929437 after 19.25 seconds
[0m22:15:21.929437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F8BD1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4FF705E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4F8EA4C10>]}
[0m22:15:21.929437 [debug] [MainThread]: Flushing usage events
[0m12:06:27.479485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017971602AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179716178D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179709C4390>]}


============================== 12:06:27.603059 | 68999049-aa81-403a-9017-0e28c3487e14 ==============================
[0m12:06:27.603059 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:06:27.603059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:06:34.000336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68999049-aa81-403a-9017-0e28c3487e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001797319F550>]}
[0m12:06:34.110815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68999049-aa81-403a-9017-0e28c3487e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017972102190>]}
[0m12:06:34.110815 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:06:34.293409 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:06:41.542692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:06:41.558318 [debug] [MainThread]: Partial parsing: added file: dfb_data://tests\ppg_greater_zero.sql
[0m12:06:41.558318 [debug] [MainThread]: Partial parsing: added file: dfb_data://macros\positive_value.sql
[0m12:06:41.763226 [error] [MainThread]: Encountered an error:
Compilation Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
[0m12:06:41.778841 [debug] [MainThread]: Command `dbt run` failed at 12:06:41.778841 after 14.79 seconds
[0m12:06:41.778841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179715B3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001796A7A1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179709D1F90>]}
[0m12:06:41.778841 [debug] [MainThread]: Flushing usage events
[0m12:07:31.755392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002630666D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002630666F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002630666F050>]}


============================== 12:07:31.755392 | 43ab5714-7997-4a4e-9be4-483158e308f1 ==============================
[0m12:07:31.755392 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:07:31.755392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:07:32.358567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43ab5714-7997-4a4e-9be4-483158e308f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002630821E050>]}
[0m12:07:32.459592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43ab5714-7997-4a4e-9be4-483158e308f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263081DC790>]}
[0m12:07:32.474423 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:07:32.499255 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:07:32.795374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:07:32.795374 [debug] [MainThread]: Partial parsing: added file: dfb_data://tests\ppg_greater_zero.sql
[0m12:07:32.795374 [debug] [MainThread]: Partial parsing: added file: dfb_data://macros\positive_value.sql
[0m12:07:32.952716 [error] [MainThread]: Encountered an error:
Compilation Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
[0m12:07:32.952716 [debug] [MainThread]: Command `dbt build` failed at 12:07:32.952716 after 1.29 seconds
[0m12:07:32.952716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002637F7C1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263066EB810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263066E8F90>]}
[0m12:07:32.952716 [debug] [MainThread]: Flushing usage events
[0m12:09:50.110276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB7F9EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB792E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB7F9C610>]}


============================== 12:09:50.110276 | 92a41778-cd94-4bcf-974e-3a9a18c16c20 ==============================
[0m12:09:50.110276 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:09:50.110276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:50.738402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB9B70090>]}
[0m12:09:50.832706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB9B0A9D0>]}
[0m12:09:50.832706 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:09:50.877035 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:09:51.162344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:09:51.162344 [debug] [MainThread]: Partial parsing: added file: dfb_data://macros\positive_value.sql
[0m12:09:51.162344 [debug] [MainThread]: Partial parsing: added file: dfb_data://tests\ppg_greater_zero.sql
[0m12:09:51.303497 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'ppg' in package 'dim_dfb_Nfl_data' which was not found
[0m12:09:51.327180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBBA037E50>]}
[0m12:09:51.600895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB9E4B4D0>]}
[0m12:09:51.600895 [info ] [MainThread]: Found 6 models, 1 seed, 3 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:09:51.600895 [info ] [MainThread]: 
[0m12:09:51.615039 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:51.619862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:09:51.633177 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:09:51.633177 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:09:51.633177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:54.125227 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:09:54.125227 [debug] [ThreadPool]: On list_storage: Close
[0m12:09:54.298200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:09:54.298200 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:09:54.298200 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:09:54.298200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:55.018747 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:09:55.018747 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:09:55.175002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB9D3A150>]}
[0m12:09:55.175002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:55.175002 [info ] [MainThread]: 
[0m12:09:55.276047 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:09:55.276047 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:09:55.291161 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:09:55.300175 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:09:55.341096 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:09:55.292183 => 12:09:55.341096
[0m12:09:55.356747 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:09:55.356747 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m12:09:55.356747 [info ] [Thread-1 (]: 1 of 9 START seed file dfb.seed_nfl_teams ...................................... [RUN]
[0m12:09:55.356747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m12:09:55.356747 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m12:09:55.356747 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 12:09:55.356747 => 12:09:55.356747
[0m12:09:55.356747 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m12:09:55.408729 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:09:55.408729 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m12:09:55.408729 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:09:56.100902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:09:56.100902 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:09:56.100902 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m12:09:56.492103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:09:56.507664 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:09:56.507664 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m12:09:56.774872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:09:56.790559 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:09:56.790559 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m12:09:56.916327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:09:56.916327 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:09:56.916327 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m12:09:57.621614 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 1.0 seconds
[0m12:09:57.621614 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:09:57.637091 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m12:09:57.889150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:09:57.905806 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m12:09:58.030500 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 12:09:55.356747 => 12:09:58.030500
[0m12:09:58.030500 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m12:09:58.156356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB9CCF4D0>]}
[0m12:09:58.156356 [info ] [Thread-1 (]: 1 of 9 OK loaded seed file dfb.seed_nfl_teams .................................. [[32mINSERT 31[0m in 2.80s]
[0m12:09:58.156356 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m12:09:58.156356 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:09:58.156356 [info ] [Thread-1 (]: 2 of 9 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:09:58.170101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m12:09:58.172124 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:09:58.196378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:09:58.228029 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:09:58.172760 => 12:09:58.227000
[0m12:09:58.229038 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:09:58.252583 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:09:58.260735 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:09:58.261708 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m12:09:58.261708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:59.237028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:09:59.237028 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:09:58.229038 => 12:09:59.237028
[0m12:09:59.237028 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:09:59.379212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBBA036450>]}
[0m12:09:59.379212 [info ] [Thread-1 (]: 2 of 9 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.22s]
[0m12:09:59.379212 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:09:59.379212 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m12:09:59.379212 [info ] [Thread-1 (]: 3 of 9 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m12:09:59.390670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m12:09:59.392478 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m12:09:59.396593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m12:09:59.444790 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 12:09:59.393484 => 12:09:59.444790
[0m12:09:59.444790 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m12:09:59.444790 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m12:09:59.486601 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m12:09:59.487570 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m12:09:59.488570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:00.506072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:00.506072 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 12:09:59.444790 => 12:10:00.506072
[0m12:10:00.506072 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m12:10:00.647696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBBA42B150>]}
[0m12:10:00.647696 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.27s]
[0m12:10:00.663205 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m12:10:00.663205 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m12:10:00.663205 [info ] [Thread-1 (]: 4 of 9 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m12:10:00.668619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m12:10:00.670333 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m12:10:00.675675 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m12:10:00.679191 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 12:10:00.670333 => 12:10:00.679191
[0m12:10:00.680205 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m12:10:00.682209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m12:10:00.746274 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m12:10:00.748811 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m12:10:00.749807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:01.548799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:01.548799 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 12:10:00.680205 => 12:10:01.548799
[0m12:10:01.548799 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m12:10:01.682337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB9CCF4D0>]}
[0m12:10:01.682337 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.02s]
[0m12:10:01.682337 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m12:10:01.682337 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:10:01.682337 [info ] [Thread-1 (]: 5 of 9 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [RUN]
[0m12:10:01.695624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133)
[0m12:10:01.697367 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:10:01.715618 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:10:01.773634 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (compile): 12:10:01.698484 => 12:10:01.772691
[0m12:10:01.775297 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:10:01.791578 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:10:01.791578 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:10:01.791578 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'
)



      
    ) dbt_internal_test
[0m12:10:01.791578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:02.889721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:02.889721 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (execute): 12:10:01.776365 => 12:10:02.889721
[0m12:10:02.889721 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: Close
[0m12:10:03.062272 [error] [Thread-1 (]: 5 of 9 FAIL 4 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[31mFAIL 4[0m in 1.38s]
[0m12:10:03.077950 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:10:03.077950 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:10:03.077950 [info ] [Thread-1 (]: 6 of 9 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:10:03.085217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:10:03.086313 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:10:03.093069 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:10:03.093069 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:10:03.087697 => 12:10:03.093069
[0m12:10:03.093069 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:10:03.093069 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:10:03.093069 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:10:03.093069 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:10:03.093069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:04.144602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:04.144602 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:10:03.093069 => 12:10:04.144602
[0m12:10:04.144602 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:10:04.284955 [info ] [Thread-1 (]: 6 of 9 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.21s]
[0m12:10:04.300477 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:10:04.300477 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:10:04.300477 [info ] [Thread-1 (]: 7 of 9 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:10:04.307326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:10:04.309334 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:10:04.316373 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:10:04.318531 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:10:04.310336 => 12:10:04.317518
[0m12:10:04.319531 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:10:04.322527 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:10:04.324536 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:10:04.325721 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:10:04.325721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:05.038729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:05.038729 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:10:04.319531 => 12:10:05.038729
[0m12:10:05.038729 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:10:05.180513 [info ] [Thread-1 (]: 7 of 9 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.88s]
[0m12:10:05.180513 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:10:05.180513 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m12:10:05.196038 [info ] [Thread-1 (]: 8 of 9 START python table model dfb.py_nfl_data ................................ [RUN]
[0m12:10:05.199193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now model.dfb_data.py_nfl_data)
[0m12:10:05.201046 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m12:10:05.226986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m12:10:05.260933 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 12:10:05.202365 => 12:10:05.259917
[0m12:10:05.261933 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m12:10:05.286892 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m12:10:05.288866 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m12:10:05.289887 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m12:10:05.290865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:11.922895 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 7.0 seconds
[0m12:10:11.922895 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 12:10:05.261933 => 12:10:11.922895
[0m12:10:11.922895 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m12:10:12.079818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBBA030A50>]}
[0m12:10:12.079818 [info ] [Thread-1 (]: 8 of 9 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 6.88s]
[0m12:10:12.079818 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m12:10:12.079818 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m12:10:12.079818 [info ] [Thread-1 (]: 9 of 9 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m12:10:12.094488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m12:10:12.095819 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m12:10:12.099536 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m12:10:12.192451 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 12:10:12.095819 => 12:10:12.192451
[0m12:10:12.192451 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m12:10:12.198915 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m12:10:12.198915 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m12:10:12.198915 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m12:10:12.198915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:15.356413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:10:15.371826 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 12:10:12.192451 => 12:10:15.371826
[0m12:10:15.371826 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m12:10:15.529205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a41778-cd94-4bcf-974e-3a9a18c16c20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBBA38C990>]}
[0m12:10:15.529205 [info ] [Thread-1 (]: 9 of 9 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 3.43s]
[0m12:10:15.529205 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m12:10:15.529205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:15.529205 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:10:15.529205 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:10:15.529205 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m12:10:15.529205 [info ] [MainThread]: 
[0m12:10:15.623656 [info ] [MainThread]: Finished running 1 seed, 3 view models, 3 tests, 2 table models in 0 hours 0 minutes and 23.93 seconds (23.93s).
[0m12:10:15.713904 [debug] [MainThread]: Command end result
[0m12:10:15.731566 [info ] [MainThread]: 
[0m12:10:15.731566 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:10:15.741084 [info ] [MainThread]: 
[0m12:10:15.743092 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX (models\schema.yml)[0m
[0m12:10:15.743481 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m12:10:15.746989 [info ] [MainThread]: 
[0m12:10:15.748346 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_44ee71505c94851bef85367bc43999be.sql
[0m12:10:15.749881 [info ] [MainThread]: 
[0m12:10:15.752026 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m12:10:15.754451 [debug] [MainThread]: Command `dbt build` failed at 12:10:15.754451 after 25.73 seconds
[0m12:10:15.755506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB10D1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB7F91050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBB1117610>]}
[0m12:10:15.756452 [debug] [MainThread]: Flushing usage events
[0m12:11:08.231117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49B689A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49B15C090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49AAA2390>]}


============================== 12:11:08.231117 | f840b920-18f5-482e-884c-7c26d3a076de ==============================
[0m12:11:08.231117 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:11:08.246748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:08.825734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49D29AF10>]}
[0m12:11:08.919992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49B6ABD90>]}
[0m12:11:08.919992 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:11:08.960852 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:11:09.246328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:09.246328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:09.246328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49D5B2050>]}
[0m12:11:09.277642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49D3E55D0>]}
[0m12:11:09.277642 [info ] [MainThread]: Found 6 models, 1 seed, 3 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:11:09.277642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49D35A750>]}
[0m12:11:09.277642 [info ] [MainThread]: 
[0m12:11:09.285972 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:09.290505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:11:09.292989 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:11:09.292989 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:11:09.292989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:10.258259 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:11:10.258259 [debug] [ThreadPool]: On list_storage: Close
[0m12:11:10.425617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:11:10.425617 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:11:10.425617 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:11:10.425617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:11.209219 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:11:11.213240 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:11:11.366298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49D2F7E90>]}
[0m12:11:11.366298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:11.381868 [info ] [MainThread]: 
[0m12:11:11.381868 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:11:11.381868 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:11:11.381868 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:11:11.402152 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:11:11.405405 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:11:11.381868 => 12:11:11.403553
[0m12:11:11.407861 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:11:11.408865 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m12:11:11.410918 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m12:11:11.413966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m12:11:11.413966 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m12:11:11.413966 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m12:11:11.413966 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 12:11:11.413966 => 12:11:11.413966
[0m12:11:11.413966 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m12:11:11.449226 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m12:11:11.457767 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m12:11:11.458787 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m12:11:11.459785 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:11:12.342564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:12.359624 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 12:11:11.413966 => 12:11:12.359624
[0m12:11:12.359624 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m12:11:12.493486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49D30D610>]}
[0m12:11:12.493486 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.08s]
[0m12:11:12.510066 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m12:11:12.510066 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:11:12.510066 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:11:12.515644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m12:11:12.515644 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:11:12.531232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:11:12.544000 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:11:12.516705 => 12:11:12.542986
[0m12:11:12.545359 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:11:12.551637 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:11:12.551637 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:11:12.551637 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m12:11:12.551637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:13.626699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:13.626699 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:11:12.546576 => 12:11:13.626699
[0m12:11:13.626699 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:11:13.776437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49DA82850>]}
[0m12:11:13.776437 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.27s]
[0m12:11:13.791232 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:11:13.792014 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m12:11:13.792014 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m12:11:13.796801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m12:11:13.797816 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m12:11:13.801920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m12:11:13.801920 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 12:11:13.797816 => 12:11:13.801920
[0m12:11:13.801920 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m12:11:13.810777 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m12:11:13.814001 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m12:11:13.816067 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m12:11:13.817059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:14.925193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:14.927207 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 12:11:13.801920 => 12:11:14.927207
[0m12:11:14.927207 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m12:11:15.060133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49D48AD50>]}
[0m12:11:15.060133 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.27s]
[0m12:11:15.075152 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m12:11:15.076735 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m12:11:15.076735 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m12:11:15.081944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m12:11:15.081944 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m12:11:15.108856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m12:11:15.144563 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 12:11:15.082995 => 12:11:15.144563
[0m12:11:15.144563 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m12:11:15.177596 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m12:11:15.179223 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m12:11:15.179223 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m12:11:15.179223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:17.930362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:11:17.936876 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 12:11:15.144563 => 12:11:17.936876
[0m12:11:17.936876 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m12:11:18.062262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49DA55550>]}
[0m12:11:18.062262 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 2.99s]
[0m12:11:18.077792 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m12:11:18.077792 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m12:11:18.077792 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m12:11:18.083268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m12:11:18.084015 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m12:11:18.092398 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m12:11:18.096608 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 12:11:18.085071 => 12:11:18.095526
[0m12:11:18.097532 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m12:11:18.100856 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m12:11:18.100856 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m12:11:18.100856 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m12:11:18.100856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:20.665184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:11:20.665184 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 12:11:18.097532 => 12:11:20.665184
[0m12:11:20.665184 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m12:11:20.823009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f840b920-18f5-482e-884c-7c26d3a076de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49D447690>]}
[0m12:11:20.823009 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 2.75s]
[0m12:11:20.823009 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m12:11:20.838598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:20.838598 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:11:20.838598 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:11:20.838598 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m12:11:20.838598 [info ] [MainThread]: 
[0m12:11:20.838598 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 11.56 seconds (11.56s).
[0m12:11:20.849340 [debug] [MainThread]: Command end result
[0m12:11:20.878186 [info ] [MainThread]: 
[0m12:11:20.894214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:20.894214 [info ] [MainThread]: 
[0m12:11:20.894214 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:11:20.894214 [debug] [MainThread]: Command `dbt run` succeeded at 12:11:20.894214 after 12.75 seconds
[0m12:11:20.894214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4947A1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B49B2D2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B494A77D90>]}
[0m12:11:20.894214 [debug] [MainThread]: Flushing usage events
[0m12:11:54.485358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887C38F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887C38E610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887C38DD50>]}


============================== 12:11:54.485358 | 126a9e7a-b60a-47d0-a2f2-b9676ad11282 ==============================
[0m12:11:54.485358 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:11:54.485358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:11:55.108384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887C3E8510>]}
[0m12:11:55.224899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887C3F03D0>]}
[0m12:11:55.224899 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:11:55.263279 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:11:55.531579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:55.531579 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\positive_value.sql
[0m12:11:55.562842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887E028FD0>]}
[0m12:11:55.578450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887E129450>]}
[0m12:11:55.578450 [info ] [MainThread]: Found 6 models, 1 seed, 3 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:11:55.578450 [info ] [MainThread]: 
[0m12:11:55.578450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:55.578450 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:11:55.612048 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:11:55.612048 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:11:55.613042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:56.559634 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:11:56.575635 [debug] [ThreadPool]: On list_storage: Close
[0m12:11:56.727625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:11:56.741234 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:11:56.742259 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:11:56.743419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:57.528378 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:11:57.528378 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:11:57.669941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887C33D1D0>]}
[0m12:11:57.685456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:57.685456 [info ] [MainThread]: 
[0m12:11:57.685456 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:11:57.685456 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:11:57.685456 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:11:57.710837 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:11:57.713855 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:11:57.685456 => 12:11:57.713855
[0m12:11:57.713855 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:11:57.713855 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m12:11:57.713855 [info ] [Thread-1 (]: 1 of 9 START seed file dfb.seed_nfl_teams ...................................... [RUN]
[0m12:11:57.713855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m12:11:57.713855 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m12:11:57.713855 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 12:11:57.713855 => 12:11:57.713855
[0m12:11:57.713855 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m12:11:57.766730 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:11:57.766730 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m12:11:57.766730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:11:58.509469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:58.509469 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:11:58.516035 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m12:11:58.726141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:11:58.726141 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:11:58.742037 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m12:11:58.992869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:11:59.024530 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:11:59.025070 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m12:11:59.186163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:11:59.186163 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:11:59.186163 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m12:11:59.503854 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.0 seconds
[0m12:11:59.503854 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:11:59.503854 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m12:11:59.864753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:11:59.880252 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m12:11:59.895874 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 12:11:57.713855 => 12:11:59.895874
[0m12:11:59.895874 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m12:12:00.068523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887E012FD0>]}
[0m12:12:00.068523 [info ] [Thread-1 (]: 1 of 9 OK loaded seed file dfb.seed_nfl_teams .................................. [[32mINSERT 31[0m in 2.35s]
[0m12:12:00.068523 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m12:12:00.068523 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:12:00.068523 [info ] [Thread-1 (]: 2 of 9 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:12:00.068523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m12:12:00.068523 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:12:00.099279 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:12:00.099279 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:12:00.068523 => 12:12:00.099279
[0m12:12:00.099279 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:12:00.127603 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:12:00.127603 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:12:00.127603 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m12:12:00.127603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:01.603911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:12:01.622877 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:12:00.099279 => 12:12:01.622877
[0m12:12:01.622877 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:12:01.761226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887C3EA7D0>]}
[0m12:12:01.776620 [info ] [Thread-1 (]: 2 of 9 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.69s]
[0m12:12:01.776620 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:12:01.776620 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m12:12:01.776620 [info ] [Thread-1 (]: 3 of 9 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m12:12:01.785273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m12:12:01.786116 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m12:12:01.793168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m12:12:01.793168 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 12:12:01.787169 => 12:12:01.793168
[0m12:12:01.793168 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m12:12:01.793168 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m12:12:01.793168 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m12:12:01.793168 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m12:12:01.793168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:02.959749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:12:02.959749 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 12:12:01.793168 => 12:12:02.959749
[0m12:12:02.959749 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m12:12:03.125264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887E283850>]}
[0m12:12:03.128095 [info ] [Thread-1 (]: 3 of 9 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.35s]
[0m12:12:03.130041 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m12:12:03.130041 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m12:12:03.132075 [info ] [Thread-1 (]: 4 of 9 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m12:12:03.134038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m12:12:03.135037 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m12:12:03.139035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m12:12:03.141037 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 12:12:03.135037 => 12:12:03.140035
[0m12:12:03.142251 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m12:12:03.150066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m12:12:03.151999 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m12:12:03.153050 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m12:12:03.154108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:03.976543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:12:03.992026 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 12:12:03.143257 => 12:12:03.992026
[0m12:12:03.992026 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m12:12:04.127547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887E0AE8D0>]}
[0m12:12:04.127547 [info ] [Thread-1 (]: 4 of 9 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 0.99s]
[0m12:12:04.127547 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m12:12:04.127547 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:12:04.127547 [info ] [Thread-1 (]: 5 of 9 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [RUN]
[0m12:12:04.141930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133)
[0m12:12:04.142936 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:12:04.158030 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:12:04.160102 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (compile): 12:12:04.143936 => 12:12:04.160102
[0m12:12:04.161082 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:12:04.177355 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:12:04.177355 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:12:04.177355 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'
)



      
    ) dbt_internal_test
[0m12:12:04.177355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:05.029831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:12:05.029831 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (execute): 12:12:04.161082 => 12:12:05.029831
[0m12:12:05.029831 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: Close
[0m12:12:05.194022 [error] [Thread-1 (]: 5 of 9 FAIL 4 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[31mFAIL 4[0m in 1.05s]
[0m12:12:05.194022 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:12:05.194022 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:12:05.205514 [info ] [Thread-1 (]: 6 of 9 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:12:05.207316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:12:05.209798 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:12:05.215948 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:12:05.215948 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:12:05.210822 => 12:12:05.215948
[0m12:12:05.224510 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:12:05.230488 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:12:05.230488 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:12:05.230488 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:12:05.230488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:06.093457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:12:06.093457 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:12:05.225524 => 12:12:06.093457
[0m12:12:06.093457 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:12:06.225015 [info ] [Thread-1 (]: 6 of 9 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.02s]
[0m12:12:06.225015 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:12:06.225015 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:12:06.232031 [info ] [Thread-1 (]: 7 of 9 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:12:06.232031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:12:06.232031 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:12:06.232031 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:12:06.241817 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:12:06.232031 => 12:12:06.240543
[0m12:12:06.242871 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:12:06.246908 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:12:06.246908 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:12:06.246908 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:12:06.246908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:07.042624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:12:07.042624 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:12:06.242871 => 12:12:07.042624
[0m12:12:07.042624 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:12:07.176620 [info ] [Thread-1 (]: 7 of 9 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.94s]
[0m12:12:07.191979 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:12:07.191979 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m12:12:07.195840 [info ] [Thread-1 (]: 8 of 9 START python table model dfb.py_nfl_data ................................ [RUN]
[0m12:12:07.197982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now model.dfb_data.py_nfl_data)
[0m12:12:07.198995 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m12:12:07.234866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m12:12:07.234866 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 12:12:07.200307 => 12:12:07.234866
[0m12:12:07.234866 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m12:12:07.258827 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m12:12:07.258827 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m12:12:07.258827 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m12:12:07.258827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:09.946758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:12:09.946758 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 12:12:07.234866 => 12:12:09.946758
[0m12:12:09.946758 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m12:12:10.089006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887E7D0250>]}
[0m12:12:10.089006 [info ] [Thread-1 (]: 8 of 9 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 2.89s]
[0m12:12:10.089006 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m12:12:10.104468 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m12:12:10.104468 [info ] [Thread-1 (]: 9 of 9 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m12:12:10.104468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m12:12:10.104468 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m12:12:10.104468 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m12:12:10.104468 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 12:12:10.104468 => 12:12:10.104468
[0m12:12:10.104468 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m12:12:10.121698 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m12:12:10.124943 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m12:12:10.124943 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m12:12:10.124943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:13.180394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:12:13.180394 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 12:12:10.104468 => 12:12:13.180394
[0m12:12:13.180394 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m12:12:13.365135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '126a9e7a-b60a-47d0-a2f2-b9676ad11282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887E60D890>]}
[0m12:12:13.380615 [info ] [Thread-1 (]: 9 of 9 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 3.26s]
[0m12:12:13.380615 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m12:12:13.380615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:13.380615 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:12:13.380615 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:12:13.380615 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m12:12:13.380615 [info ] [MainThread]: 
[0m12:12:13.380615 [info ] [MainThread]: Finished running 1 seed, 3 view models, 3 tests, 2 table models in 0 hours 0 minutes and 17.80 seconds (17.80s).
[0m12:12:13.396604 [debug] [MainThread]: Command end result
[0m12:12:13.416215 [info ] [MainThread]: 
[0m12:12:13.417424 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:12:13.417424 [info ] [MainThread]: 
[0m12:12:13.417424 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX (models\schema.yml)[0m
[0m12:12:13.417424 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m12:12:13.417424 [info ] [MainThread]: 
[0m12:12:13.425401 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_44ee71505c94851bef85367bc43999be.sql
[0m12:12:13.427567 [info ] [MainThread]: 
[0m12:12:13.429294 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m12:12:13.431658 [debug] [MainThread]: Command `dbt build` failed at 12:12:13.431658 after 19.03 seconds
[0m12:12:13.432672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887C33E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000188754F1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001887B1BD950>]}
[0m12:12:13.433671 [debug] [MainThread]: Flushing usage events
[0m12:12:30.065494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D75A1A550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D75A1BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D75A1B490>]}


============================== 12:12:30.081188 | 2227634b-031d-4210-979c-4c0023c064d6 ==============================
[0m12:12:30.081188 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:12:30.081188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:12:30.676529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D77613B10>]}
[0m12:12:30.775242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D776293D0>]}
[0m12:12:30.775242 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:12:30.808889 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:12:31.079536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:31.079536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:31.079536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D778E94D0>]}
[0m12:12:31.095095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D77734FD0>]}
[0m12:12:31.095095 [info ] [MainThread]: Found 6 models, 1 seed, 3 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:12:31.110750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D776BE1D0>]}
[0m12:12:31.110750 [info ] [MainThread]: 
[0m12:12:31.110750 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:12:31.110750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:12:31.133207 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:12:31.133207 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:12:31.133207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:32.126694 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:12:32.126694 [debug] [ThreadPool]: On list_storage: Close
[0m12:12:32.275977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:12:32.292089 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:12:32.292089 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:12:32.292089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:33.029098 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:12:33.029098 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:12:33.185695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D75A4E1D0>]}
[0m12:12:33.195071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:12:33.197282 [info ] [MainThread]: 
[0m12:12:33.201459 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:12:33.201459 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:12:33.201459 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:12:33.217091 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:12:33.219681 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:12:33.201459 => 12:12:33.218628
[0m12:12:33.221570 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:12:33.222847 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m12:12:33.225802 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m12:12:33.228053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m12:12:33.228053 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m12:12:33.228053 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m12:12:33.228053 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 12:12:33.228053 => 12:12:33.228053
[0m12:12:33.228053 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m12:12:33.261047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m12:12:33.261047 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m12:12:33.261047 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m12:12:33.261047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:12:34.176135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:12:34.208727 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 12:12:33.228053 => 12:12:34.208727
[0m12:12:34.208727 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m12:12:34.342433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D77D7B290>]}
[0m12:12:34.342433 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.11s]
[0m12:12:34.358057 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m12:12:34.359388 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:12:34.359388 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:12:34.363894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m12:12:34.363894 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:12:34.386591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:12:34.391171 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:12:34.364926 => 12:12:34.391171
[0m12:12:34.392344 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:12:34.394697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:12:34.394697 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:12:34.394697 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select * from A
  );
[0m12:12:34.394697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:35.343493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:12:35.343493 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:12:34.393180 => 12:12:35.343493
[0m12:12:35.343493 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:12:35.492815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D77D83950>]}
[0m12:12:35.492815 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.13s]
[0m12:12:35.492815 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:12:35.492815 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m12:12:35.492815 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m12:12:35.506328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m12:12:35.507843 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m12:12:35.513196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m12:12:35.514304 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 12:12:35.508624 => 12:12:35.514304
[0m12:12:35.514304 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m12:12:35.514304 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m12:12:35.514304 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m12:12:35.514304 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m12:12:35.514304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:36.458749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:12:36.458749 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 12:12:35.514304 => 12:12:36.458749
[0m12:12:36.458749 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m12:12:36.592654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D77635250>]}
[0m12:12:36.592654 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.09s]
[0m12:12:36.592654 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m12:12:36.592654 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m12:12:36.592654 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m12:12:36.608766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m12:12:36.609790 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m12:12:36.632711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m12:12:36.632711 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 12:12:36.610847 => 12:12:36.632711
[0m12:12:36.632711 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m12:12:36.661481 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m12:12:36.661481 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m12:12:36.661481 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m12:12:36.661481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:39.457591 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:12:39.457591 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 12:12:36.632711 => 12:12:39.457591
[0m12:12:39.457591 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m12:12:39.598600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D776EE3D0>]}
[0m12:12:39.598600 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 2.99s]
[0m12:12:39.598600 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m12:12:39.598600 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m12:12:39.598600 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m12:12:39.614746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m12:12:39.614746 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m12:12:39.614746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m12:12:39.614746 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 12:12:39.614746 => 12:12:39.614746
[0m12:12:39.614746 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m12:12:39.614746 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m12:12:39.632075 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m12:12:39.633090 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m12:12:39.633090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:42.297534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:12:42.313039 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 12:12:39.614746 => 12:12:42.313039
[0m12:12:42.313039 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m12:12:42.452871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2227634b-031d-4210-979c-4c0023c064d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D77916950>]}
[0m12:12:42.452871 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 2.84s]
[0m12:12:42.452871 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m12:12:42.468380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:42.468380 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:12:42.468380 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:12:42.468380 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m12:12:42.468380 [info ] [MainThread]: 
[0m12:12:42.468380 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 11.36 seconds (11.36s).
[0m12:12:42.476459 [debug] [MainThread]: Command end result
[0m12:12:42.492957 [info ] [MainThread]: 
[0m12:12:42.494941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:42.496906 [info ] [MainThread]: 
[0m12:12:42.498523 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:12:42.501901 [debug] [MainThread]: Command `dbt run` succeeded at 12:12:42.501901 after 12.51 seconds
[0m12:12:42.503022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6EB81FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7484DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6EE57D90>]}
[0m12:12:42.503022 [debug] [MainThread]: Flushing usage events
[0m12:23:51.388942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAEEE2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAEEE2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAFAB8410>]}


============================== 12:23:51.404554 | 1132470a-7e16-4808-8231-dc62084a9235 ==============================
[0m12:23:51.404554 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:23:51.404554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:23:52.042611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1132470a-7e16-4808-8231-dc62084a9235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FB1617D90>]}
[0m12:23:52.142258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1132470a-7e16-4808-8231-dc62084a9235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FB166BA10>]}
[0m12:23:52.158167 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:23:52.180318 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:23:52.418144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:52.418144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:52.433721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1132470a-7e16-4808-8231-dc62084a9235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FB18D0790>]}
[0m12:23:52.458361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1132470a-7e16-4808-8231-dc62084a9235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FB1815350>]}
[0m12:23:52.458361 [info ] [MainThread]: Found 6 models, 1 seed, 3 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:23:52.458361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1132470a-7e16-4808-8231-dc62084a9235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FB1756610>]}
[0m12:23:52.458361 [info ] [MainThread]: 
[0m12:23:52.465446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:23:52.468967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:23:52.477733 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:23:52.477733 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:23:52.477733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:53.576614 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:23:53.592876 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:23:53.726510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1132470a-7e16-4808-8231-dc62084a9235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FB1876D90>]}
[0m12:23:53.726510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:23:53.726510 [info ] [MainThread]: 
[0m12:23:53.742156 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:23:53.742156 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [RUN]
[0m12:23:53.750159 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133'
[0m12:23:53.751178 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:23:53.777938 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:23:53.778068 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (compile): 12:23:53.752176 => 12:23:53.778068
[0m12:23:53.778068 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:23:53.793799 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:23:53.793799 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:23:53.793799 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'
)



      
    ) dbt_internal_test
[0m12:23:53.793799 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:23:54.962422 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:54.975463 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (execute): 12:23:53.778068 => 12:23:54.974747
[0m12:23:54.975463 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: Close
[0m12:23:55.126857 [error] [Thread-1 (]: 1 of 3 FAIL 4 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[31mFAIL 4[0m in 1.38s]
[0m12:23:55.128870 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:23:55.130863 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:23:55.131852 [info ] [Thread-1 (]: 2 of 3 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:23:55.132851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:23:55.133852 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:23:55.145918 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:23:55.145918 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:23:55.134852 => 12:23:55.145918
[0m12:23:55.145918 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:23:55.145918 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:23:55.145918 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:23:55.145918 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:23:55.145918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:55.926597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:55.926597 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:23:55.145918 => 12:23:55.926597
[0m12:23:55.926597 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:23:56.077585 [info ] [Thread-1 (]: 2 of 3 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.94s]
[0m12:23:56.077585 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:23:56.077585 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:23:56.077585 [info ] [Thread-1 (]: 3 of 3 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:23:56.087147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:23:56.088187 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:23:56.096571 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:23:56.096571 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:23:56.089208 => 12:23:56.096571
[0m12:23:56.096571 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:23:56.096571 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:23:56.096571 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:23:56.096571 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:23:56.096571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:56.860098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:23:56.860098 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:23:56.096571 => 12:23:56.860098
[0m12:23:56.866191 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:23:56.992076 [info ] [Thread-1 (]: 3 of 3 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.91s]
[0m12:23:56.992076 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:23:57.008113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:57.009887 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:23:57.010904 [debug] [MainThread]: Connection 'test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3' was properly closed.
[0m12:23:57.011914 [info ] [MainThread]: 
[0m12:23:57.012709 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m12:23:57.016070 [debug] [MainThread]: Command end result
[0m12:23:57.033456 [info ] [MainThread]: 
[0m12:23:57.033638 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:23:57.036161 [info ] [MainThread]: 
[0m12:23:57.037230 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX (models\schema.yml)[0m
[0m12:23:57.040006 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m12:23:57.041313 [info ] [MainThread]: 
[0m12:23:57.042315 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_44ee71505c94851bef85367bc43999be.sql
[0m12:23:57.044379 [info ] [MainThread]: 
[0m12:23:57.045351 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m12:23:57.048361 [debug] [MainThread]: Command `dbt test` failed at 12:23:57.048361 after 5.81 seconds
[0m12:23:57.050042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FA8BF1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAFAAEF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FA8ED0090>]}
[0m12:23:57.052120 [debug] [MainThread]: Flushing usage events
[0m12:31:14.758642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188FE6C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218902B5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218903F4C90>]}


============================== 12:31:14.773690 | dd639b1b-3d99-4f1e-9c98-7a8c2965a95f ==============================
[0m12:31:14.773690 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:31:14.773690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:15.384512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd639b1b-3d99-4f1e-9c98-7a8c2965a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021890AE7BD0>]}
[0m12:31:15.478842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd639b1b-3d99-4f1e-9c98-7a8c2965a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021891F3B910>]}
[0m12:31:15.478842 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:31:15.513453 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:31:15.753267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:15.753267 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m12:31:16.292091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd639b1b-3d99-4f1e-9c98-7a8c2965a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218924D0AD0>]}
[0m12:31:16.309175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd639b1b-3d99-4f1e-9c98-7a8c2965a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218924A9F50>]}
[0m12:31:16.309175 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:31:16.309175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd639b1b-3d99-4f1e-9c98-7a8c2965a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021891F15610>]}
[0m12:31:16.309175 [info ] [MainThread]: 
[0m12:31:16.309175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:16.325663 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:31:16.344000 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:31:16.345020 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:31:16.347030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:17.343459 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:31:17.343459 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:31:17.511732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd639b1b-3d99-4f1e-9c98-7a8c2965a95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218920C0C50>]}
[0m12:31:17.511732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:17.511732 [info ] [MainThread]: 
[0m12:31:17.511732 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:31:17.511732 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [RUN]
[0m12:31:17.527163 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133'
[0m12:31:17.528146 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:31:17.531203 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:31:17.543582 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (compile): 12:31:17.529218 => 12:31:17.542578
[0m12:31:17.545054 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:31:17.577292 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:31:17.577292 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:31:17.577292 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'
)



      
    ) dbt_internal_test
[0m12:31:17.577292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:31:18.514063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:18.527198 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (execute): 12:31:17.545054 => 12:31:18.527198
[0m12:31:18.527198 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: Close
[0m12:31:18.676496 [error] [Thread-1 (]: 1 of 4 FAIL 4 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[31mFAIL 4[0m in 1.15s]
[0m12:31:18.676496 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:31:18.676496 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:31:18.676496 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:31:18.676496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:31:18.676496 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:31:18.696770 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:31:18.698737 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:31:18.676496 => 12:31:18.697771
[0m12:31:18.698856 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:31:18.698856 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:31:18.698856 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:31:18.698856 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:31:18.698856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:19.393293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:19.393293 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:31:18.698856 => 12:31:19.393293
[0m12:31:19.393293 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:31:19.542733 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.87s]
[0m12:31:19.542733 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:31:19.542733 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:31:19.542733 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:31:19.542733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:31:19.558386 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:31:19.564435 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:31:19.565709 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:31:19.559396 => 12:31:19.565709
[0m12:31:19.565709 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:31:19.565709 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:31:19.565709 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:31:19.565709 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:31:19.574999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:20.276714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:20.276714 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:31:19.565709 => 12:31:20.276714
[0m12:31:20.276714 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:31:20.426405 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.88s]
[0m12:31:20.426405 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:31:20.426405 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:31:20.426405 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_ppg .......................... [RUN]
[0m12:31:20.442232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970)
[0m12:31:20.443688 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:31:20.448809 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"
[0m12:31:20.448809 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970 (compile): 12:31:20.444706 => 12:31:20.448809
[0m12:31:20.448809 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:31:20.448809 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"
[0m12:31:20.458218 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"
[0m12:31:20.459231 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 ppg > 20

      
    ) dbt_internal_test
[0m12:31:20.460232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:21.260233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:31:21.260233 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970 (execute): 12:31:20.448809 => 12:31:21.260233
[0m12:31:21.260233 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970: Close
[0m12:31:21.408835 [error] [Thread-1 (]: 4 of 4 FAIL 66 positive_value_dim_dfb_nfl_data_ppg ............................. [[31mFAIL 66[0m in 0.97s]
[0m12:31:21.411030 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:31:21.411030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:21.411030 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:31:21.411030 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970' was properly closed.
[0m12:31:21.411030 [info ] [MainThread]: 
[0m12:31:21.411030 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m12:31:21.421145 [debug] [MainThread]: Command end result
[0m12:31:21.435818 [info ] [MainThread]: 
[0m12:31:21.442601 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:31:21.445062 [info ] [MainThread]: 
[0m12:31:21.447803 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX (models\schema.yml)[0m
[0m12:31:21.448971 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m12:31:21.448971 [info ] [MainThread]: 
[0m12:31:21.448971 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_44ee71505c94851bef85367bc43999be.sql
[0m12:31:21.448971 [info ] [MainThread]: 
[0m12:31:21.448971 [error] [MainThread]: [31mFailure in test positive_value_dim_dfb_nfl_data_ppg (models\schema.yml)[0m
[0m12:31:21.448971 [error] [MainThread]:   Got 66 results, configured to fail if != 0
[0m12:31:21.457363 [info ] [MainThread]: 
[0m12:31:21.458353 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\positive_value_dim_dfb_nfl_data_ppg.sql
[0m12:31:21.459360 [info ] [MainThread]: 
[0m12:31:21.462252 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m12:31:21.465842 [debug] [MainThread]: Command `dbt test` failed at 12:31:21.465842 after 6.94 seconds
[0m12:31:21.466842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218894A1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188FE6C110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188FE6C810>]}
[0m12:31:21.467918 [debug] [MainThread]: Flushing usage events
[0m12:31:59.507183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E398CD9A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E398D33FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E398D31010>]}


============================== 12:31:59.507183 | af860a7d-aa8e-41b7-a644-624fa31ff85c ==============================
[0m12:31:59.507183 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:31:59.507183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:00.124301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af860a7d-aa8e-41b7-a644-624fa31ff85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39A834E90>]}
[0m12:32:00.226919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af860a7d-aa8e-41b7-a644-624fa31ff85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39A913590>]}
[0m12:32:00.226919 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:32:00.264163 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:32:00.605466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:00.605466 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\positive_value.sql
[0m12:32:01.075803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af860a7d-aa8e-41b7-a644-624fa31ff85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39B014390>]}
[0m12:32:01.109568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af860a7d-aa8e-41b7-a644-624fa31ff85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39ABF3950>]}
[0m12:32:01.109568 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:32:01.109568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af860a7d-aa8e-41b7-a644-624fa31ff85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39A9BE310>]}
[0m12:32:01.109568 [info ] [MainThread]: 
[0m12:32:01.109568 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:01.109568 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:32:01.131320 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:32:01.131320 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:32:01.131320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:02.193356 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:32:02.193356 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:32:02.343529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af860a7d-aa8e-41b7-a644-624fa31ff85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39983B190>]}
[0m12:32:02.343529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:02.343529 [info ] [MainThread]: 
[0m12:32:02.359006 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:32:02.359006 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [RUN]
[0m12:32:02.364605 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133'
[0m12:32:02.365653 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:32:02.376046 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:32:02.377998 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (compile): 12:32:02.365653 => 12:32:02.377998
[0m12:32:02.379015 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:32:02.406231 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:32:02.409298 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:32:02.411121 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'
)



      
    ) dbt_internal_test
[0m12:32:02.411121 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:03.210486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:03.225064 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (execute): 12:32:02.380003 => 12:32:03.210486
[0m12:32:03.225757 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: Close
[0m12:32:03.376897 [error] [Thread-1 (]: 1 of 4 FAIL 4 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[31mFAIL 4[0m in 1.02s]
[0m12:32:03.376897 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:32:03.376897 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:32:03.376897 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:32:03.376897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:32:03.376897 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:32:03.398249 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:32:03.398249 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:32:03.376897 => 12:32:03.398249
[0m12:32:03.398249 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:32:03.398249 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:32:03.398249 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:32:03.409823 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:32:03.411836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:04.193583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:04.193583 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:32:03.398249 => 12:32:04.193583
[0m12:32:04.193583 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:32:04.410523 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.03s]
[0m12:32:04.410523 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:32:04.410523 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:32:04.424911 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:32:04.425511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:32:04.425511 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:32:04.425511 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:32:04.425511 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:32:04.425511 => 12:32:04.425511
[0m12:32:04.425511 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:32:04.440522 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:32:04.442582 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:32:04.443579 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:32:04.445093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:05.229434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:05.245010 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:32:04.425511 => 12:32:05.245010
[0m12:32:05.245010 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:32:05.388258 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.96s]
[0m12:32:05.388258 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:32:05.388258 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:32:05.388258 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_ppg .......................... [RUN]
[0m12:32:05.404183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970)
[0m12:32:05.405188 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:32:05.413111 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"
[0m12:32:05.413111 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970 (compile): 12:32:05.406187 => 12:32:05.413111
[0m12:32:05.413111 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:32:05.413111 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"
[0m12:32:05.413111 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"
[0m12:32:05.413111 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 ppg > 0

      
    ) dbt_internal_test
[0m12:32:05.413111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:06.343633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:06.361228 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970 (execute): 12:32:05.413111 => 12:32:06.361228
[0m12:32:06.361228 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970: Close
[0m12:32:06.492309 [error] [Thread-1 (]: 4 of 4 FAIL 1549 positive_value_dim_dfb_nfl_data_ppg ........................... [[31mFAIL 1549[0m in 1.10s]
[0m12:32:06.492309 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:32:06.492309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:06.492309 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:32:06.492309 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970' was properly closed.
[0m12:32:06.492309 [info ] [MainThread]: 
[0m12:32:06.492309 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m12:32:06.506289 [debug] [MainThread]: Command end result
[0m12:32:06.525943 [info ] [MainThread]: 
[0m12:32:06.529426 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:32:06.530367 [info ] [MainThread]: 
[0m12:32:06.532365 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX (models\schema.yml)[0m
[0m12:32:06.532454 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m12:32:06.535197 [info ] [MainThread]: 
[0m12:32:06.536204 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_44ee71505c94851bef85367bc43999be.sql
[0m12:32:06.538203 [info ] [MainThread]: 
[0m12:32:06.539432 [error] [MainThread]: [31mFailure in test positive_value_dim_dfb_nfl_data_ppg (models\schema.yml)[0m
[0m12:32:06.541501 [error] [MainThread]:   Got 1549 results, configured to fail if != 0
[0m12:32:06.543562 [info ] [MainThread]: 
[0m12:32:06.545674 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\positive_value_dim_dfb_nfl_data_ppg.sql
[0m12:32:06.547402 [info ] [MainThread]: 
[0m12:32:06.548630 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m12:32:06.551302 [debug] [MainThread]: Command `dbt test` failed at 12:32:06.550290 after 7.14 seconds
[0m12:32:06.551302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E391E51F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E398D0E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E391E96950>]}
[0m12:32:06.552302 [debug] [MainThread]: Flushing usage events
[0m12:32:45.632565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179DC9641D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179DD587DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179DD584A90>]}


============================== 12:32:45.648189 | d07eaaac-205b-4756-90cc-4ce34cff660a ==============================
[0m12:32:45.648189 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:32:45.648189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:46.214604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd07eaaac-205b-4756-90cc-4ce34cff660a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179DF0A77D0>]}
[0m12:32:46.305789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd07eaaac-205b-4756-90cc-4ce34cff660a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179DF0FA850>]}
[0m12:32:46.305789 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:32:46.343555 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:32:46.599147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:46.599147 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\positive_value.sql
[0m12:32:47.042205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd07eaaac-205b-4756-90cc-4ce34cff660a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179DF640FD0>]}
[0m12:32:47.057832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd07eaaac-205b-4756-90cc-4ce34cff660a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179DF458710>]}
[0m12:32:47.057832 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:32:47.057832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd07eaaac-205b-4756-90cc-4ce34cff660a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179DF182FD0>]}
[0m12:32:47.057832 [info ] [MainThread]: 
[0m12:32:47.057832 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:47.074582 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:32:47.091614 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:32:47.093760 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:32:47.094612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:48.062783 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:32:48.062783 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:32:48.203115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd07eaaac-205b-4756-90cc-4ce34cff660a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179DF260C50>]}
[0m12:32:48.204683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:48.204683 [info ] [MainThread]: 
[0m12:32:48.204683 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:32:48.204683 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [RUN]
[0m12:32:48.218928 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133'
[0m12:32:48.220780 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:32:48.232852 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:32:48.233972 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (compile): 12:32:48.221533 => 12:32:48.233972
[0m12:32:48.233972 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:32:48.260226 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:32:48.260226 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:32:48.260226 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'
)



      
    ) dbt_internal_test
[0m12:32:48.260226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:48.987478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:48.987478 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (execute): 12:32:48.233972 => 12:32:48.987478
[0m12:32:48.987478 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: Close
[0m12:32:49.129307 [error] [Thread-1 (]: 1 of 4 FAIL 4 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[31mFAIL 4[0m in 0.92s]
[0m12:32:49.144759 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:32:49.144759 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:32:49.144759 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:32:49.144759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:32:49.144759 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:32:49.144759 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:32:49.160395 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:32:49.144759 => 12:32:49.144759
[0m12:32:49.161723 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:32:49.166769 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:32:49.166769 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:32:49.166769 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:32:49.166769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:49.865245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:49.865245 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:32:49.161723 => 12:32:49.865245
[0m12:32:49.865245 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:32:50.022170 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.88s]
[0m12:32:50.022170 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:32:50.022170 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:32:50.022170 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:32:50.035392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:32:50.037158 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:32:50.046627 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:32:50.048631 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:32:50.038206 => 12:32:50.047625
[0m12:32:50.049630 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:32:50.049739 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:32:50.049739 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:32:50.049739 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:32:50.049739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:50.821433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:50.821433 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:32:50.049739 => 12:32:50.821433
[0m12:32:50.821433 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:32:50.947514 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.93s]
[0m12:32:50.947514 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:32:50.947514 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:32:50.947514 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_ppg .......................... [RUN]
[0m12:32:50.962738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970)
[0m12:32:50.964849 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:32:50.967516 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"
[0m12:32:50.967516 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970 (compile): 12:32:50.964849 => 12:32:50.967516
[0m12:32:50.967516 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:32:50.978906 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"
[0m12:32:50.980897 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"
[0m12:32:50.981944 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 ppg < 1

      
    ) dbt_internal_test
[0m12:32:50.981944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:51.762493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:32:51.762493 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970 (execute): 12:32:50.967516 => 12:32:51.762493
[0m12:32:51.762493 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970: Close
[0m12:32:51.982418 [error] [Thread-1 (]: 4 of 4 FAIL 928 positive_value_dim_dfb_nfl_data_ppg ............................ [[31mFAIL 928[0m in 1.03s]
[0m12:32:51.982418 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970
[0m12:32:51.982418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:51.982418 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:32:51.982418 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_ppg.2f70ebd970' was properly closed.
[0m12:32:51.982418 [info ] [MainThread]: 
[0m12:32:51.997987 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m12:32:52.001391 [debug] [MainThread]: Command end result
[0m12:32:52.017419 [info ] [MainThread]: 
[0m12:32:52.022070 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:32:52.023082 [info ] [MainThread]: 
[0m12:32:52.024350 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX (models\schema.yml)[0m
[0m12:32:52.060835 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m12:32:52.062285 [info ] [MainThread]: 
[0m12:32:52.062285 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_44ee71505c94851bef85367bc43999be.sql
[0m12:32:52.066334 [info ] [MainThread]: 
[0m12:32:52.067337 [error] [MainThread]: [31mFailure in test positive_value_dim_dfb_nfl_data_ppg (models\schema.yml)[0m
[0m12:32:52.068369 [error] [MainThread]:   Got 928 results, configured to fail if != 0
[0m12:32:52.070686 [info ] [MainThread]: 
[0m12:32:52.070686 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\positive_value_dim_dfb_nfl_data_ppg.sql
[0m12:32:52.073579 [info ] [MainThread]: 
[0m12:32:52.074510 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m12:32:52.078100 [debug] [MainThread]: Command `dbt test` failed at 12:32:52.078100 after 6.53 seconds
[0m12:32:52.079439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179D6691F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179D6970C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179DCFA4AD0>]}
[0m12:32:52.080538 [debug] [MainThread]: Flushing usage events
[0m12:33:28.583500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EED684710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EEDC1E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EEDC78110>]}


============================== 12:33:28.583500 | 411b0400-7238-4f7f-9f45-f7e4703a71ba ==============================
[0m12:33:28.583500 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:33:28.583500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:33:29.159313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '411b0400-7238-4f7f-9f45-f7e4703a71ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EEF839990>]}
[0m12:33:29.259082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '411b0400-7238-4f7f-9f45-f7e4703a71ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EEF7A39D0>]}
[0m12:33:29.259082 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:33:29.284641 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:33:29.562957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:29.562957 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m12:33:30.042271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '411b0400-7238-4f7f-9f45-f7e4703a71ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EEFD48E50>]}
[0m12:33:30.059222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '411b0400-7238-4f7f-9f45-f7e4703a71ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EEFE36FD0>]}
[0m12:33:30.059222 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:33:30.059222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411b0400-7238-4f7f-9f45-f7e4703a71ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EEE78A590>]}
[0m12:33:30.059222 [info ] [MainThread]: 
[0m12:33:30.059222 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:30.076484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:33:30.093672 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:33:30.095700 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:33:30.096673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:31.060197 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:33:31.060197 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:33:31.210346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411b0400-7238-4f7f-9f45-f7e4703a71ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EEDCBFE50>]}
[0m12:33:31.210346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:31.225890 [info ] [MainThread]: 
[0m12:33:31.225890 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:33:31.225890 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [RUN]
[0m12:33:31.236233 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133'
[0m12:33:31.236233 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:33:31.250208 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:33:31.252208 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (compile): 12:33:31.237247 => 12:33:31.251207
[0m12:33:31.252208 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:33:31.277968 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:33:31.277968 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:33:31.277968 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'
)



      
    ) dbt_internal_test
[0m12:33:31.277968 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:33:31.943503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:33:31.959445 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (execute): 12:33:31.253330 => 12:33:31.959445
[0m12:33:31.959445 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: Close
[0m12:33:32.094081 [error] [Thread-1 (]: 1 of 4 FAIL 4 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[31mFAIL 4[0m in 0.87s]
[0m12:33:32.109709 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:33:32.110606 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:33:32.110606 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:33:32.115013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:33:32.116075 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:33:32.120321 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:33:32.126041 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:33:32.116075 => 12:33:32.126041
[0m12:33:32.127029 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:33:32.131000 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:33:32.131000 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:33:32.131000 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:33:32.131000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:32.910182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:33:32.910182 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:33:32.128037 => 12:33:32.910182
[0m12:33:32.910182 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:33:33.042806 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.93s]
[0m12:33:33.042806 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:33:33.042806 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:33:33.042806 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:33:33.059119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:33:33.059119 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:33:33.059119 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:33:33.059119 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:33:33.059119 => 12:33:33.059119
[0m12:33:33.059119 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:33:33.075910 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:33:33.077876 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:33:33.077876 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:33:33.078949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:33.743881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:33:33.759185 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:33:33.059119 => 12:33:33.759185
[0m12:33:33.759185 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:33:33.876557 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.82s]
[0m12:33:33.891722 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:33:33.893889 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:33:33.893889 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m12:33:33.897667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m12:33:33.899676 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:33:33.902678 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:33:33.909279 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 12:33:33.899676 => 12:33:33.908269
[0m12:33:33.910281 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:33:33.917070 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:33:33.919000 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:33:33.920067 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m12:33:33.920067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:34.675170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:33:34.676198 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 12:33:33.911350 => 12:33:34.676198
[0m12:33:34.676198 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m12:33:34.895827 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.00s]
[0m12:33:34.895827 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:33:34.895827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:34.895827 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:33:34.895827 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m12:33:34.895827 [info ] [MainThread]: 
[0m12:33:34.895827 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m12:33:34.908721 [debug] [MainThread]: Command end result
[0m12:33:34.928072 [info ] [MainThread]: 
[0m12:33:34.928072 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:33:34.928072 [info ] [MainThread]: 
[0m12:33:34.928072 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX (models\schema.yml)[0m
[0m12:33:34.928072 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m12:33:34.938790 [info ] [MainThread]: 
[0m12:33:34.939899 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_44ee71505c94851bef85367bc43999be.sql
[0m12:33:34.941908 [info ] [MainThread]: 
[0m12:33:34.943924 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:33:34.946863 [debug] [MainThread]: Command `dbt test` failed at 12:33:34.946863 after 6.45 seconds
[0m12:33:34.947853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EE6D41F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EEF839210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013EED865ED0>]}
[0m12:33:34.948853 [debug] [MainThread]: Flushing usage events
[0m12:34:41.245879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17FCE9CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17EB4D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17E8F9FD0>]}


============================== 12:34:41.245879 | a66d1217-209e-46d9-a023-09efa864fd11 ==============================
[0m12:34:41.245879 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:34:41.255387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select ppg_greater_zero', 'send_anonymous_usage_stats': 'True'}
[0m12:34:41.860085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a66d1217-209e-46d9-a023-09efa864fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17FD2CB10>]}
[0m12:34:41.958996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a66d1217-209e-46d9-a023-09efa864fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17F7BBD90>]}
[0m12:34:41.958996 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:34:41.998737 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:34:42.279680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:34:42.279680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:34:42.279680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a66d1217-209e-46d9-a023-09efa864fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E101BA01D0>]}
[0m12:34:42.310969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a66d1217-209e-46d9-a023-09efa864fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E101A63510>]}
[0m12:34:42.310969 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:34:42.310969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a66d1217-209e-46d9-a023-09efa864fd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17FE31DD0>]}
[0m12:34:42.310969 [warn ] [MainThread]: The selection criterion 'ppg_greater_zero' does not match any nodes
[0m12:34:42.310969 [info ] [MainThread]: 
[0m12:34:42.310969 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:34:42.310969 [debug] [MainThread]: Command end result
[0m12:34:42.328612 [debug] [MainThread]: Command `dbt test` succeeded at 12:34:42.328612 after 1.19 seconds
[0m12:34:42.328612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E178E11F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17FD54090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17FD57950>]}
[0m12:34:42.328612 [debug] [MainThread]: Flushing usage events
[0m12:35:06.820832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192637A350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219263978D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021926349410>]}


============================== 12:35:06.836522 | ada4b7c8-1de4-4eda-adad-4bd126b89ec7 ==============================
[0m12:35:06.836522 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:35:06.836522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select ppg_greater_zero.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:35:07.459099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ada4b7c8-1de4-4eda-adad-4bd126b89ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021926367BD0>]}
[0m12:35:07.559154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ada4b7c8-1de4-4eda-adad-4bd126b89ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021926E6A2D0>]}
[0m12:35:07.559154 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:35:07.596714 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:35:07.854599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:07.854599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:07.870244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ada4b7c8-1de4-4eda-adad-4bd126b89ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021928253C50>]}
[0m12:35:07.885882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ada4b7c8-1de4-4eda-adad-4bd126b89ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219280A3790>]}
[0m12:35:07.885882 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:35:07.885882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ada4b7c8-1de4-4eda-adad-4bd126b89ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021926E7C290>]}
[0m12:35:07.885882 [warn ] [MainThread]: The selection criterion 'ppg_greater_zero.sql' does not match any nodes
[0m12:35:07.885882 [info ] [MainThread]: 
[0m12:35:07.885882 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:35:07.900592 [debug] [MainThread]: Command end result
[0m12:35:07.919324 [debug] [MainThread]: Command `dbt test` succeeded at 12:35:07.919324 after 1.18 seconds
[0m12:35:07.919324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191F421F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191F6F0C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021925E0BBD0>]}
[0m12:35:07.919324 [debug] [MainThread]: Flushing usage events
[0m12:46:33.819287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD38089650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD380F44D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD380F4C50>]}


============================== 12:46:33.825845 | 83e95004-213e-4ecd-9acb-b8b66dabc457 ==============================
[0m12:46:33.825845 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:46:33.826860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:46:34.430012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83e95004-213e-4ecd-9acb-b8b66dabc457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD39C03950>]}
[0m12:46:34.530046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83e95004-213e-4ecd-9acb-b8b66dabc457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD38BDD910>]}
[0m12:46:34.530046 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:46:34.565700 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:46:34.825796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:34.825796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:34.830365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83e95004-213e-4ecd-9acb-b8b66dabc457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD3812A410>]}
[0m12:46:34.841445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83e95004-213e-4ecd-9acb-b8b66dabc457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD39DE5590>]}
[0m12:46:34.841445 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:46:34.841445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83e95004-213e-4ecd-9acb-b8b66dabc457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD38BEBF10>]}
[0m12:46:34.857148 [info ] [MainThread]: 
[0m12:46:34.860143 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:46:34.863898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:46:34.881808 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:46:34.882805 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:46:34.882805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:36.023226 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:46:36.027626 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:46:36.160563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83e95004-213e-4ecd-9acb-b8b66dabc457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD3A2A9A50>]}
[0m12:46:36.160563 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:36.160563 [info ] [MainThread]: 
[0m12:46:36.160563 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:46:36.160563 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [RUN]
[0m12:46:36.173590 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133'
[0m12:46:36.174650 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:46:36.194864 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:46:36.194864 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (compile): 12:46:36.174650 => 12:46:36.194864
[0m12:46:36.194864 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:46:36.231145 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:46:36.233779 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"
[0m12:46:36.234803 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'
)



      
    ) dbt_internal_test
[0m12:46:36.235736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:37.163865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:37.173911 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133 (execute): 12:46:36.194864 => 12:46:37.172910
[0m12:46:37.173911 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133: Close
[0m12:46:37.359925 [error] [Thread-1 (]: 1 of 4 FAIL 4 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX  [[31mFAIL 4[0m in 1.20s]
[0m12:46:37.375417 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133
[0m12:46:37.377420 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:46:37.378959 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:46:37.381881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX.18cfb62133, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:46:37.381881 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:46:37.389879 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:46:37.391849 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:46:37.382882 => 12:46:37.391849
[0m12:46:37.392844 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:46:37.397841 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:46:37.400844 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:46:37.401885 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:46:37.401885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:38.211164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:38.211164 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:46:37.393846 => 12:46:38.211164
[0m12:46:38.211164 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:46:38.365707 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.98s]
[0m12:46:38.367717 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:46:38.368713 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:46:38.369705 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:46:38.371626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:46:38.373637 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:46:38.382711 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:46:38.382711 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:46:38.374635 => 12:46:38.382711
[0m12:46:38.382711 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:46:38.382711 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:46:38.382711 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:46:38.382711 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:46:38.394849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:39.177446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:39.177446 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:46:38.382711 => 12:46:39.177446
[0m12:46:39.177446 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:46:39.360739 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.99s]
[0m12:46:39.360739 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:46:39.360739 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:46:39.376377 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m12:46:39.379013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m12:46:39.380066 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:46:39.384323 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:46:39.384323 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 12:46:39.380066 => 12:46:39.384323
[0m12:46:39.384323 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:46:39.393292 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:46:39.396302 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:46:39.396302 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m12:46:39.398479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:40.291603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:40.296915 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 12:46:39.384323 => 12:46:40.296915
[0m12:46:40.298852 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m12:46:40.443834 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.07s]
[0m12:46:40.459712 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:46:40.459712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:40.459712 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:46:40.459712 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m12:46:40.459712 [info ] [MainThread]: 
[0m12:46:40.459712 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 5.60 seconds (5.60s).
[0m12:46:40.471371 [debug] [MainThread]: Command end result
[0m12:46:40.487105 [info ] [MainThread]: 
[0m12:46:40.491910 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:46:40.494545 [info ] [MainThread]: 
[0m12:46:40.496948 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX (models\schema.yml)[0m
[0m12:46:40.499964 [error] [MainThread]:   Got 4 results, configured to fail if != 0
[0m12:46:40.501028 [info ] [MainThread]: 
[0m12:46:40.503027 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_44ee71505c94851bef85367bc43999be.sql
[0m12:46:40.504997 [info ] [MainThread]: 
[0m12:46:40.506869 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:46:40.508705 [debug] [MainThread]: Command `dbt test` failed at 12:46:40.508705 after 6.78 seconds
[0m12:46:40.509704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD380DB4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD31221F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD380AFBD0>]}
[0m12:46:40.511704 [debug] [MainThread]: Flushing usage events
[0m12:48:26.625266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC8BCE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC8BCFB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC8BCFE10>]}


============================== 12:48:26.625266 | 240022a4-7401-483b-ad2b-25bf29e7d2e9 ==============================
[0m12:48:26.625266 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:48:26.625266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:27.241956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '240022a4-7401-483b-ad2b-25bf29e7d2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCCA77F390>]}
[0m12:48:27.326016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '240022a4-7401-483b-ad2b-25bf29e7d2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCCA739450>]}
[0m12:48:27.342083 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:48:27.364519 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:48:27.737834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:48:27.753457 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m12:48:27.753457 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m12:48:28.309356 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'ppg' in package 'dim_dfb_nfl_data' which was not found
[0m12:48:28.340996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '240022a4-7401-483b-ad2b-25bf29e7d2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCCB026490>]}
[0m12:48:28.364984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '240022a4-7401-483b-ad2b-25bf29e7d2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCCA81D450>]}
[0m12:48:28.364984 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:48:28.364984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '240022a4-7401-483b-ad2b-25bf29e7d2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCCA703E10>]}
[0m12:48:28.364984 [info ] [MainThread]: 
[0m12:48:28.364984 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:48:28.364984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:48:28.394009 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:48:28.395086 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:48:28.397505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:29.527335 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:48:29.527335 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:48:29.713420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '240022a4-7401-483b-ad2b-25bf29e7d2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCCAFD5450>]}
[0m12:48:29.713420 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:29.713420 [info ] [MainThread]: 
[0m12:48:29.713420 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:48:29.725317 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [RUN]
[0m12:48:29.728337 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746'
[0m12:48:29.729402 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:48:29.740329 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:48:29.743334 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (compile): 12:48:29.729402 => 12:48:29.742328
[0m12:48:29.743334 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:48:29.768226 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:48:29.768226 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:48:29.768226 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DEF'
)



      
    ) dbt_internal_test
[0m12:48:29.776910 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:48:31.107285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:48:31.109407 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (execute): 12:48:29.744329 => 12:48:31.109407
[0m12:48:31.109407 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: Close
[0m12:48:31.272243 [error] [Thread-1 (]: 1 of 4 FAIL 1 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [[31mFAIL 1[0m in 1.55s]
[0m12:48:31.272243 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:48:31.272243 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:48:31.272243 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:48:31.283963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:48:31.284566 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:48:31.299190 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:48:31.301197 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:48:31.285588 => 12:48:31.300234
[0m12:48:31.301197 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:48:31.301197 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:48:31.301197 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:48:31.301197 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:48:31.308666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:32.675322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:48:32.690858 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:48:31.301197 => 12:48:32.675322
[0m12:48:32.690858 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:48:32.848161 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.57s]
[0m12:48:32.848161 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:48:32.848161 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:48:32.848161 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:48:32.860961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:48:32.862123 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:48:32.865621 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:48:32.865621 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:48:32.863066 => 12:48:32.865621
[0m12:48:32.865621 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:48:32.880405 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:48:32.883418 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:48:32.883418 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:48:32.884471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:33.709943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:48:33.725789 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:48:32.865621 => 12:48:33.724512
[0m12:48:33.726423 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:48:33.860794 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.01s]
[0m12:48:33.860794 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:48:33.860794 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:48:33.860794 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m12:48:33.875322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m12:48:33.876945 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:48:33.881786 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:48:33.881786 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 12:48:33.878750 => 12:48:33.881786
[0m12:48:33.881786 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:48:33.881786 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:48:33.893134 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:48:33.894132 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m12:48:33.895124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:34.827815 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:48:34.842975 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 12:48:33.881786 => 12:48:34.842198
[0m12:48:34.842975 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m12:48:34.978788 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.12s]
[0m12:48:34.978788 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:48:34.978788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:34.978788 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:48:34.978788 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m12:48:34.978788 [info ] [MainThread]: 
[0m12:48:34.991908 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m12:48:34.994539 [debug] [MainThread]: Command end result
[0m12:48:35.011064 [info ] [MainThread]: 
[0m12:48:35.013063 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:48:35.015067 [info ] [MainThread]: 
[0m12:48:35.017171 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF (models\schema.yml)[0m
[0m12:48:35.019976 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:48:35.021290 [info ] [MainThread]: 
[0m12:48:35.021290 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_e1cdc06cadf9e6d459c68be41b944c6a.sql
[0m12:48:35.025305 [info ] [MainThread]: 
[0m12:48:35.028326 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:48:35.032177 [debug] [MainThread]: Command `dbt test` failed at 12:48:35.032177 after 8.49 seconds
[0m12:48:35.033189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC1D21F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC8B7E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC8B7EF50>]}
[0m12:48:35.033189 [debug] [MainThread]: Flushing usage events
[0m12:50:00.158385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4EF37390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4EF37C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4EF1B0D0>]}


============================== 12:50:00.191803 | 58e5fa09-dbc3-40f0-af49-c00e8abc7bc3 ==============================
[0m12:50:00.191803 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:50:00.192607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'send_anonymous_usage_stats': 'True'}
[0m12:50:00.788390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58e5fa09-dbc3-40f0-af49-c00e8abc7bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD50B10250>]}
[0m12:50:00.889850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58e5fa09-dbc3-40f0-af49-c00e8abc7bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4FA0DE90>]}
[0m12:50:00.889850 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:50:00.925401 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:50:01.291292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:50:01.291292 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m12:50:01.425168 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'PPG' in package 'dim_dfb_nfl_data' which was not found
[0m12:50:01.447323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58e5fa09-dbc3-40f0-af49-c00e8abc7bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD50C4CF50>]}
[0m12:50:01.462905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58e5fa09-dbc3-40f0-af49-c00e8abc7bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD50DB81D0>]}
[0m12:50:01.462905 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:50:01.476386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e5fa09-dbc3-40f0-af49-c00e8abc7bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD50B9B790>]}
[0m12:50:01.479418 [info ] [MainThread]: 
[0m12:50:01.482402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:01.485518 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:50:01.505513 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:50:01.507515 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:50:01.508518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:02.625198 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:50:02.625198 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:50:02.818409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58e5fa09-dbc3-40f0-af49-c00e8abc7bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD50BEE250>]}
[0m12:50:02.821413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:02.823673 [info ] [MainThread]: 
[0m12:50:02.825627 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:50:02.825627 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [RUN]
[0m12:50:02.834447 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746'
[0m12:50:02.835729 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:50:02.861177 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:50:02.863712 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (compile): 12:50:02.836264 => 12:50:02.863189
[0m12:50:02.863712 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:50:02.877743 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:50:02.877743 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:50:02.877743 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DEF'
)



      
    ) dbt_internal_test
[0m12:50:02.877743 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:50:03.753802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:50:03.764892 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (execute): 12:50:02.863712 => 12:50:03.764892
[0m12:50:03.769965 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: Close
[0m12:50:03.924156 [error] [Thread-1 (]: 1 of 4 FAIL 1 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [[31mFAIL 1[0m in 1.10s]
[0m12:50:03.924156 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:50:03.924156 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:50:03.924156 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:50:03.941158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:50:03.943211 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:50:03.952228 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:50:03.954275 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:50:03.944161 => 12:50:03.954275
[0m12:50:03.955259 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:50:03.959499 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:50:03.959499 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:50:03.959499 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:50:03.959499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:04.742141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:50:04.742141 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:50:03.955259 => 12:50:04.742141
[0m12:50:04.742141 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:50:04.905718 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.97s]
[0m12:50:04.905718 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:50:04.905718 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:50:04.905718 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:50:04.921321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:50:04.922504 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:50:04.930600 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:50:04.932547 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:50:04.923563 => 12:50:04.931592
[0m12:50:04.932547 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:50:04.936597 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:50:04.938547 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:50:04.939567 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:50:04.940574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:05.707675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:50:05.723312 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:50:04.933549 => 12:50:05.723312
[0m12:50:05.723312 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:50:05.888315 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.98s]
[0m12:50:05.892441 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:50:05.894552 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:50:05.895551 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m12:50:05.898547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m12:50:05.899546 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:50:05.906542 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:50:05.908544 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 12:50:05.900544 => 12:50:05.907543
[0m12:50:05.909548 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:50:05.910655 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:50:05.910655 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:50:05.910655 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m12:50:05.910655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:06.706708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:50:06.706708 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 12:50:05.910655 => 12:50:06.706708
[0m12:50:06.706708 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m12:50:06.874265 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 0.98s]
[0m12:50:06.875834 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:50:06.875834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:06.875834 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:50:06.875834 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m12:50:06.875834 [info ] [MainThread]: 
[0m12:50:06.875834 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 5.39 seconds (5.39s).
[0m12:50:06.888765 [debug] [MainThread]: Command end result
[0m12:50:06.901465 [info ] [MainThread]: 
[0m12:50:06.909791 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:50:06.911131 [info ] [MainThread]: 
[0m12:50:06.911131 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF (models\schema.yml)[0m
[0m12:50:06.911131 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:50:06.917192 [info ] [MainThread]: 
[0m12:50:06.918141 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_e1cdc06cadf9e6d459c68be41b944c6a.sql
[0m12:50:06.920158 [info ] [MainThread]: 
[0m12:50:06.921280 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:50:06.923346 [debug] [MainThread]: Command `dbt test` failed at 12:50:06.923346 after 6.85 seconds
[0m12:50:06.924359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD48061F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4EB121D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD48340090>]}
[0m12:50:06.925354 [debug] [MainThread]: Flushing usage events
[0m12:56:58.154252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405FB49D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405F52E310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002405FB3E090>]}


============================== 12:56:58.154252 | c04af383-e46d-4ac8-b211-dcef977c07ce ==============================
[0m12:56:58.154252 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:56:58.154252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'send_anonymous_usage_stats': 'True'}
[0m12:56:58.791321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c04af383-e46d-4ac8-b211-dcef977c07ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002406177FBD0>]}
[0m12:56:58.907721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c04af383-e46d-4ac8-b211-dcef977c07ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240616FABD0>]}
[0m12:56:58.907721 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:56:58.948359 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:56:59.207340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:56:59.207340 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m12:56:59.382361 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'salary' in package 'dim_dfb_nfl_data' which was not found
[0m12:56:59.395533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c04af383-e46d-4ac8-b211-dcef977c07ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024061A71C50>]}
[0m12:56:59.424206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c04af383-e46d-4ac8-b211-dcef977c07ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024061CD5410>]}
[0m12:56:59.426245 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:56:59.426245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c04af383-e46d-4ac8-b211-dcef977c07ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002406175AC50>]}
[0m12:56:59.426245 [info ] [MainThread]: 
[0m12:56:59.434461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:59.437663 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:56:59.456967 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:56:59.458591 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:56:59.459823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:00.589628 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:57:00.593630 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:57:00.762020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c04af383-e46d-4ac8-b211-dcef977c07ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024061863B90>]}
[0m12:57:00.762020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:00.773931 [info ] [MainThread]: 
[0m12:57:00.782468 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:57:00.783433 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [RUN]
[0m12:57:00.786430 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746'
[0m12:57:00.787429 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:57:00.816451 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:57:00.818453 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (compile): 12:57:00.787429 => 12:57:00.818453
[0m12:57:00.819432 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:57:00.842264 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:57:00.842264 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:57:00.842264 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DEF'
)



      
    ) dbt_internal_test
[0m12:57:00.842264 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:01.625399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:01.641462 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (execute): 12:57:00.819432 => 12:57:01.641462
[0m12:57:01.641462 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: Close
[0m12:57:01.792353 [error] [Thread-1 (]: 1 of 4 FAIL 1 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [[31mFAIL 1[0m in 1.01s]
[0m12:57:01.792353 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:57:01.792353 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:57:01.792353 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:57:01.792353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:57:01.792353 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:57:01.813809 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:57:01.813809 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:57:01.792353 => 12:57:01.813809
[0m12:57:01.813809 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:57:01.813809 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:57:01.813809 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:57:01.823966 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:57:01.825996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:02.758329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:02.759161 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:57:01.813809 => 12:57:02.759161
[0m12:57:02.759161 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:57:02.958258 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.17s]
[0m12:57:02.958258 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:57:02.958258 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:57:02.958258 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:57:02.958258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:57:02.958258 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:57:02.978874 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:57:02.979836 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:57:02.958258 => 12:57:02.979836
[0m12:57:02.980831 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:57:02.984885 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:57:02.986829 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:57:02.986829 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:57:02.987860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:03.660003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:03.660003 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:57:02.981909 => 12:57:03.660003
[0m12:57:03.660003 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:57:03.792357 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.83s]
[0m12:57:03.807986 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:57:03.808502 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:57:03.809775 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m12:57:03.812265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m12:57:03.813281 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:57:03.818303 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:57:03.820264 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 12:57:03.813281 => 12:57:03.820264
[0m12:57:03.821264 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:57:03.825342 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:57:03.827268 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:57:03.828295 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m12:57:03.830273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:04.592509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:04.592509 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 12:57:03.821264 => 12:57:04.592509
[0m12:57:04.592509 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m12:57:04.725894 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 0.91s]
[0m12:57:04.741643 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:57:04.741643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:04.741643 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:57:04.741643 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m12:57:04.741643 [info ] [MainThread]: 
[0m12:57:04.741643 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 5.32 seconds (5.32s).
[0m12:57:04.752873 [debug] [MainThread]: Command end result
[0m12:57:04.762696 [info ] [MainThread]: 
[0m12:57:04.773743 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:57:04.775760 [info ] [MainThread]: 
[0m12:57:04.778758 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF (models\schema.yml)[0m
[0m12:57:04.780757 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:57:04.782752 [info ] [MainThread]: 
[0m12:57:04.783203 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_e1cdc06cadf9e6d459c68be41b944c6a.sql
[0m12:57:04.785249 [info ] [MainThread]: 
[0m12:57:04.786223 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:57:04.790297 [debug] [MainThread]: Command `dbt test` failed at 12:57:04.789214 after 6.79 seconds
[0m12:57:04.791212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024058C91F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024058F70C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024058F70090>]}
[0m12:57:04.793213 [debug] [MainThread]: Flushing usage events
[0m12:57:38.532623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1E258C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1DB9A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1E23CBD0>]}


============================== 12:57:38.532623 | 62571174-f26e-44c2-b605-8be2098e68d6 ==============================
[0m12:57:38.532623 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:57:38.539632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:39.174680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62571174-f26e-44c2-b605-8be2098e68d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1E260810>]}
[0m12:57:39.274509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62571174-f26e-44c2-b605-8be2098e68d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1EDEBA90>]}
[0m12:57:39.274509 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:57:39.313818 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:57:39.605399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:39.605399 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m12:57:39.752518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62571174-f26e-44c2-b605-8be2098e68d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1FFE9250>]}
[0m12:57:39.789277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62571174-f26e-44c2-b605-8be2098e68d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF20118A50>]}
[0m12:57:39.790278 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:57:39.790928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62571174-f26e-44c2-b605-8be2098e68d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2029D690>]}
[0m12:57:39.790928 [info ] [MainThread]: 
[0m12:57:39.790928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:57:39.790928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:57:39.813174 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:57:39.813174 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:57:39.813174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:40.863460 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:57:40.866433 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:57:41.024861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62571174-f26e-44c2-b605-8be2098e68d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1EDD0290>]}
[0m12:57:41.024861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:41.024861 [info ] [MainThread]: 
[0m12:57:41.024861 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:57:41.024861 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [RUN]
[0m12:57:41.041196 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746'
[0m12:57:41.042181 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:57:41.060462 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:57:41.060462 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (compile): 12:57:41.043193 => 12:57:41.060462
[0m12:57:41.060462 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:57:41.097455 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:57:41.099434 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:57:41.100442 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DEF'
)



      
    ) dbt_internal_test
[0m12:57:41.100442 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:41.859180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:41.859180 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (execute): 12:57:41.060462 => 12:57:41.859180
[0m12:57:41.859180 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: Close
[0m12:57:42.008212 [error] [Thread-1 (]: 1 of 5 FAIL 1 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [[31mFAIL 1[0m in 0.97s]
[0m12:57:42.008212 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:57:42.023941 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:57:42.024736 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:57:42.028731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:57:42.029739 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:57:42.036736 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:57:42.039465 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:57:42.029739 => 12:57:42.038403
[0m12:57:42.039465 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:57:42.044989 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:57:42.047995 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:57:42.047995 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:57:42.049031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:42.794201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:42.799793 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:57:42.040978 => 12:57:42.798814
[0m12:57:42.800818 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:57:42.958854 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.93s]
[0m12:57:42.958854 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:57:42.958854 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:57:42.958854 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:57:42.958854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:57:42.958854 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:57:42.978863 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:57:42.980013 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:57:42.958854 => 12:57:42.980013
[0m12:57:42.980013 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:57:42.980013 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:57:42.980013 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:57:42.980013 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:57:42.980013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:43.743375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:43.743375 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:57:42.980013 => 12:57:43.743375
[0m12:57:43.743375 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:57:43.898457 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.94s]
[0m12:57:43.900451 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:57:43.901446 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:57:43.903408 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m12:57:43.905422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m12:57:43.906446 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:57:43.907953 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:57:43.907953 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 12:57:43.906446 => 12:57:43.907953
[0m12:57:43.907953 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:57:43.907953 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:57:43.907953 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:57:43.907953 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m12:57:43.907953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:44.692478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:44.692478 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 12:57:43.907953 => 12:57:44.692478
[0m12:57:44.692478 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m12:57:44.845259 [info ] [Thread-1 (]: 4 of 5 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 0.94s]
[0m12:57:44.845259 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:57:44.845259 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero
[0m12:57:44.845259 [info ] [Thread-1 (]: 5 of 5 START test ppg_greater_zero ............................................. [RUN]
[0m12:57:44.856332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.ppg_greater_zero)
[0m12:57:44.857353 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero
[0m12:57:44.862345 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (compile): 12:57:44.858345 => 12:57:44.862345
[0m12:57:45.506273 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  'positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:57:45.508197 [error] [Thread-1 (]: 5 of 5 ERROR ppg_greater_zero .................................................. [[31mERROR[0m in 0.66s]
[0m12:57:45.511199 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero
[0m12:57:45.514225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:45.515242 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:57:45.515242 [debug] [MainThread]: Connection 'test.dfb_data.ppg_greater_zero' was properly closed.
[0m12:57:45.516227 [info ] [MainThread]: 
[0m12:57:45.518194 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m12:57:45.521254 [debug] [MainThread]: Command end result
[0m12:57:45.534283 [info ] [MainThread]: 
[0m12:57:45.540446 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:57:45.541457 [info ] [MainThread]: 
[0m12:57:45.544503 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF (models\schema.yml)[0m
[0m12:57:45.546465 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:57:45.548087 [info ] [MainThread]: 
[0m12:57:45.548087 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_e1cdc06cadf9e6d459c68be41b944c6a.sql
[0m12:57:45.549850 [info ] [MainThread]: 
[0m12:57:45.549850 [error] [MainThread]:   Compilation Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  'positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:57:45.549850 [info ] [MainThread]: 
[0m12:57:45.554691 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m12:57:45.556622 [debug] [MainThread]: Command `dbt test` failed at 12:57:45.556622 after 7.12 seconds
[0m12:57:45.557623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF17331F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1E1FF510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF1FF8E050>]}
[0m12:57:45.558625 [debug] [MainThread]: Flushing usage events
[0m12:58:47.345972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027323672A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732365C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732365C4D0>]}


============================== 12:58:47.350590 | 3e919e2f-2d07-4c35-8f59-5350dc09ba1d ==============================
[0m12:58:47.350590 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:58:47.352615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:58:47.952165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e919e2f-2d07-4c35-8f59-5350dc09ba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732524FCD0>]}
[0m12:58:48.061051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e919e2f-2d07-4c35-8f59-5350dc09ba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273251CA910>]}
[0m12:58:48.061051 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:58:48.093826 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:58:48.407578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:58:48.407578 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m12:58:48.543363 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'dim_dfb_nfl_data.ppg' in package 'dim_dfb_nfl_data' which was not found
[0m12:58:48.562485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e919e2f-2d07-4c35-8f59-5350dc09ba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273253323D0>]}
[0m12:58:48.592113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e919e2f-2d07-4c35-8f59-5350dc09ba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027325532B10>]}
[0m12:58:48.592113 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m12:58:48.592113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e919e2f-2d07-4c35-8f59-5350dc09ba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027325163DD0>]}
[0m12:58:48.592113 [info ] [MainThread]: 
[0m12:58:48.599958 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:48.603035 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:58:48.622213 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:58:48.622213 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:58:48.623165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:49.838812 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:58:49.838812 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:58:50.012408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e919e2f-2d07-4c35-8f59-5350dc09ba1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732533CFD0>]}
[0m12:58:50.013476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:50.015416 [info ] [MainThread]: 
[0m12:58:50.021422 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:58:50.023411 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [RUN]
[0m12:58:50.025413 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746'
[0m12:58:50.026476 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:58:50.046568 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:58:50.046568 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (compile): 12:58:50.027406 => 12:58:50.046568
[0m12:58:50.046568 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:58:50.078601 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:58:50.078601 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m12:58:50.078601 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DEF'
)



      
    ) dbt_internal_test
[0m12:58:50.078601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:51.341168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:51.356253 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (execute): 12:58:50.046568 => 12:58:51.341168
[0m12:58:51.356253 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: Close
[0m12:58:51.504122 [error] [Thread-1 (]: 1 of 4 FAIL 1 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [[31mFAIL 1[0m in 1.48s]
[0m12:58:51.507256 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m12:58:51.508190 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:58:51.509241 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:58:51.511082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:58:51.512038 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:58:51.519086 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:58:51.521072 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:58:51.512038 => 12:58:51.520037
[0m12:58:51.522080 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:58:51.528152 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:58:51.530143 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:58:51.531144 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:58:51.532143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:52.454006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:52.454006 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:58:51.522080 => 12:58:52.454006
[0m12:58:52.454006 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:58:52.607875 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.10s]
[0m12:58:52.607875 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:58:52.607875 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:58:52.623549 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:58:52.626818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:58:52.628429 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:58:52.631992 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:58:52.631992 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:58:52.628429 => 12:58:52.631992
[0m12:58:52.631992 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:58:52.643281 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:58:52.646376 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:58:52.646376 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:58:52.647373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:53.389358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:53.389358 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:58:52.631992 => 12:58:53.389358
[0m12:58:53.389358 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:58:53.561152 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.94s]
[0m12:58:53.564122 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:58:53.565141 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:58:53.566139 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m12:58:53.569290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m12:58:53.570231 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:58:53.576051 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:58:53.576051 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 12:58:53.570231 => 12:58:53.576051
[0m12:58:53.576051 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:58:53.576051 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:58:53.576051 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m12:58:53.576051 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m12:58:53.576051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:54.965274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:54.970123 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 12:58:53.576051 => 12:58:54.970123
[0m12:58:54.970123 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m12:58:55.107436 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.54s]
[0m12:58:55.123033 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m12:58:55.123033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:55.123033 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:58:55.123033 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m12:58:55.123033 [info ] [MainThread]: 
[0m12:58:55.135850 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m12:58:55.139831 [debug] [MainThread]: Command end result
[0m12:58:55.157386 [info ] [MainThread]: 
[0m12:58:55.159406 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:58:55.160100 [info ] [MainThread]: 
[0m12:58:55.160100 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF (models\schema.yml)[0m
[0m12:58:55.164776 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:58:55.165583 [info ] [MainThread]: 
[0m12:58:55.167668 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_e1cdc06cadf9e6d459c68be41b944c6a.sql
[0m12:58:55.169752 [info ] [MainThread]: 
[0m12:58:55.171150 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:58:55.173776 [debug] [MainThread]: Command `dbt test` failed at 12:58:55.173776 after 7.92 seconds
[0m12:58:55.173776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002731C711F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273230FBBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732529F7D0>]}
[0m12:58:55.176590 [debug] [MainThread]: Flushing usage events
[0m13:07:39.340482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703B3DB950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703B37D050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703AE6C3D0>]}


============================== 13:07:39.345961 | b14e9410-1557-419f-ace5-69cdf7e49fdb ==============================
[0m13:07:39.345961 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:07:39.345961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:07:40.111432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b14e9410-1557-419f-ace5-69cdf7e49fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703CFC3D90>]}
[0m13:07:40.278583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b14e9410-1557-419f-ace5-69cdf7e49fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703B38B990>]}
[0m13:07:40.278583 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:07:40.299842 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:07:40.780282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:07:40.780282 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m13:07:41.065361 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named '"ppg"' in package 'dim_dfb_nfl_data' which was not found
[0m13:07:41.098295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b14e9410-1557-419f-ace5-69cdf7e49fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703D0ACF50>]}
[0m13:07:41.129283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b14e9410-1557-419f-ace5-69cdf7e49fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703D2B18D0>]}
[0m13:07:41.129283 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m13:07:41.132114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b14e9410-1557-419f-ace5-69cdf7e49fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703CFD8BD0>]}
[0m13:07:41.132114 [info ] [MainThread]: 
[0m13:07:41.132114 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:07:41.137456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m13:07:41.154427 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m13:07:41.154427 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m13:07:41.157461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:43.249011 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m13:07:43.249011 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m13:07:43.868579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b14e9410-1557-419f-ace5-69cdf7e49fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703D0AD1D0>]}
[0m13:07:43.868579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:43.875902 [info ] [MainThread]: 
[0m13:07:43.884101 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:07:43.885130 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [RUN]
[0m13:07:43.886369 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746'
[0m13:07:43.886369 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:07:43.929180 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:07:43.930723 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (compile): 13:07:43.886369 => 13:07:43.930723
[0m13:07:43.930723 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:07:43.961562 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:07:43.967335 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:07:43.967335 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DEF'
)



      
    ) dbt_internal_test
[0m13:07:43.967335 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:07:45.797757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:07:45.813423 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (execute): 13:07:43.930723 => 13:07:45.813423
[0m13:07:45.829370 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: Close
[0m13:07:46.113122 [error] [Thread-1 (]: 1 of 4 FAIL 1 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [[31mFAIL 1[0m in 2.23s]
[0m13:07:46.113122 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:07:46.113122 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:07:46.113122 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m13:07:46.128059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m13:07:46.129093 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:07:46.158474 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:07:46.164731 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 13:07:46.129093 => 13:07:46.164731
[0m13:07:46.164731 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:07:46.179834 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:07:46.179834 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:07:46.179834 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m13:07:46.187978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:48.660015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:07:48.680316 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 13:07:46.171721 => 13:07:48.680316
[0m13:07:48.680316 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m13:07:49.279856 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 3.17s]
[0m13:07:49.294372 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:07:49.294372 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:07:49.297438 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m13:07:49.297438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m13:07:49.297438 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:07:49.311336 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:07:49.311336 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 13:07:49.297438 => 13:07:49.311336
[0m13:07:49.311336 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:07:49.326428 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:07:49.326428 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:07:49.326428 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m13:07:49.326428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:50.748439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:07:50.751496 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 13:07:49.311336 => 13:07:50.751496
[0m13:07:50.751496 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m13:07:51.032943 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.73s]
[0m13:07:51.035974 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:07:51.035974 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:07:51.035974 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m13:07:51.045676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m13:07:51.047964 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:07:51.071546 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:07:51.076996 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 13:07:51.047964 => 13:07:51.071546
[0m13:07:51.076996 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:07:51.084100 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:07:51.084100 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:07:51.084100 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m13:07:51.084100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:53.486118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:07:53.495670 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 13:07:51.076996 => 13:07:53.495670
[0m13:07:53.495670 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m13:07:53.691879 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 2.66s]
[0m13:07:53.699986 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:07:53.699986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:53.706496 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m13:07:53.706496 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m13:07:53.706496 [info ] [MainThread]: 
[0m13:07:53.706496 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 12.57 seconds (12.57s).
[0m13:07:53.711039 [debug] [MainThread]: Command end result
[0m13:07:53.736441 [info ] [MainThread]: 
[0m13:07:53.738756 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:07:53.739930 [info ] [MainThread]: 
[0m13:07:53.739930 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF (models\schema.yml)[0m
[0m13:07:53.743041 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:07:53.744645 [info ] [MainThread]: 
[0m13:07:53.744645 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_e1cdc06cadf9e6d459c68be41b944c6a.sql
[0m13:07:53.747816 [info ] [MainThread]: 
[0m13:07:53.751887 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:07:53.751887 [debug] [MainThread]: Command `dbt test` failed at 13:07:53.751887 after 14.51 seconds
[0m13:07:53.751887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002703B3DB750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027034531F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027034810C10>]}
[0m13:07:53.751887 [debug] [MainThread]: Flushing usage events
[0m13:08:19.557417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82FD9BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8303278D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C830327B10>]}


============================== 13:08:19.557417 | 01031ec2-a37c-469e-a58b-6beb7acf56d2 ==============================
[0m13:08:19.557417 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:08:19.557417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:08:20.301591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01031ec2-a37c-469e-a58b-6beb7acf56d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8303595D0>]}
[0m13:08:20.438263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01031ec2-a37c-469e-a58b-6beb7acf56d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8302F7E90>]}
[0m13:08:20.453995 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:08:20.491161 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:08:20.855516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:08:20.855516 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m13:08:21.046190 [error] [MainThread]: Encountered an error:
Compilation Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
[0m13:08:21.046190 [debug] [MainThread]: Command `dbt test` failed at 13:08:21.046190 after 1.67 seconds
[0m13:08:21.046190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C82F6E1C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C829451F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C83032CBD0>]}
[0m13:08:21.046190 [debug] [MainThread]: Flushing usage events
[0m13:09:19.218960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FF688A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FF62E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FF68BCD0>]}


============================== 13:09:19.218960 | 1a817970-b856-47f5-8c43-f40c526e5972 ==============================
[0m13:09:19.218960 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:09:19.218960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:09:19.914993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a817970-b856-47f5-8c43-f40c526e5972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1802AED90>]}
[0m13:09:20.072517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a817970-b856-47f5-8c43-f40c526e5972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D180209AD0>]}
[0m13:09:20.072517 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:09:20.111420 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:09:20.437097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:09:20.437097 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m13:09:20.654659 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named '"PPG"' in package 'dim_dfb_nfl_data' which was not found
[0m13:09:20.670894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a817970-b856-47f5-8c43-f40c526e5972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1813ACF50>]}
[0m13:09:20.703680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a817970-b856-47f5-8c43-f40c526e5972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1815A34D0>]}
[0m13:09:20.703680 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m13:09:20.703680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a817970-b856-47f5-8c43-f40c526e5972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1816E0E10>]}
[0m13:09:20.703680 [info ] [MainThread]: 
[0m13:09:20.712529 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:09:20.712529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m13:09:20.736504 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m13:09:20.736504 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m13:09:20.736504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:22.469851 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m13:09:22.469851 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m13:09:23.193302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a817970-b856-47f5-8c43-f40c526e5972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D180250210>]}
[0m13:09:23.193302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:09:23.193302 [info ] [MainThread]: 
[0m13:09:23.217205 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:09:23.217205 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [RUN]
[0m13:09:23.225296 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746'
[0m13:09:23.225296 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:09:23.279792 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:09:23.279792 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (compile): 13:09:23.225296 => 13:09:23.279792
[0m13:09:23.279792 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:09:23.314083 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:09:23.314083 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:09:23.314083 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DEF'
)



      
    ) dbt_internal_test
[0m13:09:23.314083 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:09:25.133467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:09:25.149012 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (execute): 13:09:23.279792 => 13:09:25.149012
[0m13:09:25.149012 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: Close
[0m13:09:25.855180 [error] [Thread-1 (]: 1 of 4 FAIL 1 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [[31mFAIL 1[0m in 2.64s]
[0m13:09:25.855180 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:09:25.855180 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:09:25.855180 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m13:09:25.867741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m13:09:25.870519 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:09:25.891826 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:09:25.902382 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 13:09:25.870519 => 13:09:25.891826
[0m13:09:25.903911 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:09:25.911623 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:09:25.914560 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:09:25.914560 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m13:09:25.914560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:27.080232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:09:27.089760 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 13:09:25.906203 => 13:09:27.080232
[0m13:09:27.090976 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m13:09:27.287248 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.42s]
[0m13:09:27.287248 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:09:27.287248 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:09:27.287248 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m13:09:27.305969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m13:09:27.308328 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:09:27.327433 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:09:27.329397 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 13:09:27.312334 => 13:09:27.329397
[0m13:09:27.334427 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:09:27.350673 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:09:27.350673 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:09:27.350673 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m13:09:27.350673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:29.412436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:09:29.426476 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 13:09:27.334427 => 13:09:29.426476
[0m13:09:29.426476 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m13:09:29.817316 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.51s]
[0m13:09:29.817316 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:09:29.817316 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:09:29.817316 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m13:09:29.833854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m13:09:29.834517 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:09:29.851791 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:09:29.856959 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 13:09:29.834517 => 13:09:29.856959
[0m13:09:29.856959 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:09:29.865807 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:09:29.865807 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:09:29.865807 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m13:09:29.865807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:31.537637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:09:31.537637 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 13:09:29.856959 => 13:09:31.537637
[0m13:09:31.537637 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m13:09:31.847236 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 2.03s]
[0m13:09:31.853797 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:09:31.853797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:31.863528 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m13:09:31.863528 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m13:09:31.863528 [info ] [MainThread]: 
[0m13:09:31.873400 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 11.16 seconds (11.16s).
[0m13:09:31.878613 [debug] [MainThread]: Command end result
[0m13:09:31.918649 [info ] [MainThread]: 
[0m13:09:31.918649 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:09:31.926678 [info ] [MainThread]: 
[0m13:09:31.929716 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF (models\schema.yml)[0m
[0m13:09:31.932558 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:09:31.934077 [info ] [MainThread]: 
[0m13:09:31.934077 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_e1cdc06cadf9e6d459c68be41b944c6a.sql
[0m13:09:31.934077 [info ] [MainThread]: 
[0m13:09:31.934077 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:09:31.941200 [debug] [MainThread]: Command `dbt test` failed at 13:09:31.941200 after 12.84 seconds
[0m13:09:31.942214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FF671150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F8721F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1F8A00050>]}
[0m13:09:31.942214 [debug] [MainThread]: Flushing usage events
[0m13:10:29.576095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D301320E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3000CF210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3012BD050>]}


============================== 13:10:29.576095 | b1f1ea41-0dbb-49b8-b0e4-73c9853f8ee7 ==============================
[0m13:10:29.576095 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:10:29.576095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:10:30.320445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1f1ea41-0dbb-49b8-b0e4-73c9853f8ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D302EAD090>]}
[0m13:10:30.538271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1f1ea41-0dbb-49b8-b0e4-73c9853f8ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3012E4250>]}
[0m13:10:30.545333 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:10:30.590706 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:10:31.008049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:10:31.008049 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m13:10:31.306924 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named '"Salary"' in package 'dim_dfb_nfl_data' which was not found
[0m13:10:31.363369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1f1ea41-0dbb-49b8-b0e4-73c9853f8ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D302FE2190>]}
[0m13:10:31.380890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1f1ea41-0dbb-49b8-b0e4-73c9853f8ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3034357D0>]}
[0m13:10:31.380890 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m13:10:31.395632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1f1ea41-0dbb-49b8-b0e4-73c9853f8ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D302E43DD0>]}
[0m13:10:31.397324 [info ] [MainThread]: 
[0m13:10:31.397324 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:10:31.405834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m13:10:31.422635 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m13:10:31.422635 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m13:10:31.422635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:33.339089 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m13:10:33.339089 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m13:10:33.954244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1f1ea41-0dbb-49b8-b0e4-73c9853f8ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D302E43DD0>]}
[0m13:10:33.959192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:10:33.962721 [info ] [MainThread]: 
[0m13:10:33.972938 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:10:33.977915 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [RUN]
[0m13:10:33.982963 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746'
[0m13:10:33.982963 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:10:34.016220 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:10:34.016220 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (compile): 13:10:33.982963 => 13:10:34.016220
[0m13:10:34.016220 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:10:34.052261 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:10:34.052261 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:10:34.052261 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DEF'
)



      
    ) dbt_internal_test
[0m13:10:34.052261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:10:35.989322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:10:36.005160 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (execute): 13:10:34.016220 => 13:10:36.005160
[0m13:10:36.005160 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: Close
[0m13:10:36.409709 [error] [Thread-1 (]: 1 of 4 FAIL 1 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [[31mFAIL 1[0m in 2.43s]
[0m13:10:36.409709 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:10:36.421405 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:10:36.424042 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m13:10:36.428980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m13:10:36.428980 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:10:36.441349 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:10:36.450003 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 13:10:36.431996 => 13:10:36.441349
[0m13:10:36.451367 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:10:36.458380 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:10:36.458380 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:10:36.458380 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m13:10:36.458380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:38.063197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:10:38.080941 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 13:10:36.451367 => 13:10:38.078218
[0m13:10:38.080941 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m13:10:38.654668 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 2.23s]
[0m13:10:38.654668 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:10:38.654668 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:10:38.654668 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m13:10:38.671780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m13:10:38.673909 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:10:38.685862 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:10:38.694249 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 13:10:38.675246 => 13:10:38.694249
[0m13:10:38.697924 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:10:38.710174 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:10:38.714764 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:10:38.714764 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m13:10:38.714764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:40.862196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:10:40.877219 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 13:10:38.700579 => 13:10:40.877219
[0m13:10:40.877219 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m13:10:41.532799 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.86s]
[0m13:10:41.532799 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:10:41.540323 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:10:41.540323 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m13:10:41.544859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m13:10:41.548388 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:10:41.564491 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:10:41.570681 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 13:10:41.550501 => 13:10:41.569070
[0m13:10:41.572523 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:10:41.574912 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:10:41.583921 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:10:41.584837 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m13:10:41.584837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:43.260331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:10:43.274858 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 13:10:41.572523 => 13:10:43.274858
[0m13:10:43.279501 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m13:10:43.680696 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 2.14s]
[0m13:10:43.680696 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:10:43.689264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:43.693348 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m13:10:43.696013 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m13:10:43.698589 [info ] [MainThread]: 
[0m13:10:43.701460 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 12.30 seconds (12.30s).
[0m13:10:43.704127 [debug] [MainThread]: Command end result
[0m13:10:43.759339 [info ] [MainThread]: 
[0m13:10:43.762332 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:10:43.763449 [info ] [MainThread]: 
[0m13:10:43.763449 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF (models\schema.yml)[0m
[0m13:10:43.767636 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:10:43.767636 [info ] [MainThread]: 
[0m13:10:43.767636 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_e1cdc06cadf9e6d459c68be41b944c6a.sql
[0m13:10:43.767636 [info ] [MainThread]: 
[0m13:10:43.775667 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:10:43.776662 [debug] [MainThread]: Command `dbt test` failed at 13:10:43.776662 after 14.30 seconds
[0m13:10:43.779707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D30130F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D37A361F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D37A630C50>]}
[0m13:10:43.779707 [debug] [MainThread]: Flushing usage events
[0m13:10:56.384631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AB029850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AB029650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AB029710>]}


============================== 13:10:56.400275 | ea21b0b6-2543-45f6-a31f-f3f23e8778a4 ==============================
[0m13:10:56.400275 [info ] [MainThread]: Running with dbt=1.7.18
[0m13:10:56.400275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:10:57.104202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea21b0b6-2543-45f6-a31f-f3f23e8778a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221A9D8F890>]}
[0m13:10:57.259804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea21b0b6-2543-45f6-a31f-f3f23e8778a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AB13F950>]}
[0m13:10:57.259804 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:10:57.315356 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m13:10:57.822095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:10:57.822095 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m13:10:58.090526 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'Salary' in package 'dim_dfb_nfl_data' which was not found
[0m13:10:58.114570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea21b0b6-2543-45f6-a31f-f3f23e8778a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221ACDCB110>]}
[0m13:10:58.137761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea21b0b6-2543-45f6-a31f-f3f23e8778a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221ACF42810>]}
[0m13:10:58.146148 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m13:10:58.147353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea21b0b6-2543-45f6-a31f-f3f23e8778a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221ACD1FF90>]}
[0m13:10:58.149357 [info ] [MainThread]: 
[0m13:10:58.153259 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:10:58.153259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m13:10:58.174014 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m13:10:58.177022 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m13:10:58.178041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:59.778803 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m13:10:59.780452 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m13:11:00.049747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea21b0b6-2543-45f6-a31f-f3f23e8778a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221ACB90790>]}
[0m13:11:00.064256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:11:00.065341 [info ] [MainThread]: 
[0m13:11:00.074110 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:11:00.074110 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [RUN]
[0m13:11:00.074110 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746'
[0m13:11:00.077427 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:11:00.103415 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:11:00.106376 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (compile): 13:11:00.078652 => 13:11:00.106376
[0m13:11:00.106376 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:11:00.137932 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:11:00.137932 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"
[0m13:11:00.137932 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DEF'
)



      
    ) dbt_internal_test
[0m13:11:00.145018 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:02.113728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:11:02.124788 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746 (execute): 13:11:00.106376 => 13:11:02.124788
[0m13:11:02.124788 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746: Close
[0m13:11:02.729475 [error] [Thread-1 (]: 1 of 4 FAIL 1 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF  [[31mFAIL 1[0m in 2.66s]
[0m13:11:02.729475 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746
[0m13:11:02.729475 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:11:02.739496 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m13:11:02.746113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF.1b15fbf746, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m13:11:02.749444 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:11:02.772664 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:11:02.772664 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 13:11:02.750963 => 13:11:02.772664
[0m13:11:02.777642 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:11:02.782876 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:11:02.782876 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m13:11:02.782876 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m13:11:02.782876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:04.453796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:11:04.469210 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 13:11:02.777642 => 13:11:04.469210
[0m13:11:04.469210 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m13:11:04.672369 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.91s]
[0m13:11:04.672369 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m13:11:04.672369 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:11:04.672369 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m13:11:04.685406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m13:11:04.688055 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:11:04.702632 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:11:04.707282 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 13:11:04.688813 => 13:11:04.707282
[0m13:11:04.709529 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:11:04.717254 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:11:04.717254 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m13:11:04.717254 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m13:11:04.729200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:06.216840 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:11:06.232332 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 13:11:04.712538 => 13:11:06.232332
[0m13:11:06.232332 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m13:11:06.726731 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.05s]
[0m13:11:06.738000 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m13:11:06.744934 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:11:06.747672 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m13:11:06.749744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m13:11:06.754748 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:11:06.771336 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:11:06.777159 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 13:11:06.757696 => 13:11:06.777159
[0m13:11:06.777159 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:11:06.790744 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:11:06.822749 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m13:11:06.822749 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m13:11:06.827993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:08.721887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:11:08.721887 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 13:11:06.777159 => 13:11:08.721887
[0m13:11:08.721887 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m13:11:09.195076 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 2.45s]
[0m13:11:09.195076 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m13:11:09.195076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:09.195076 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m13:11:09.195076 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m13:11:09.195076 [info ] [MainThread]: 
[0m13:11:09.213145 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 11.05 seconds (11.05s).
[0m13:11:09.214556 [debug] [MainThread]: Command end result
[0m13:11:09.253518 [info ] [MainThread]: 
[0m13:11:09.253518 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:11:09.258753 [info ] [MainThread]: 
[0m13:11:09.258753 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DEF (models\schema.yml)[0m
[0m13:11:09.261760 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:11:09.263988 [info ] [MainThread]: 
[0m13:11:09.263988 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_e1cdc06cadf9e6d459c68be41b944c6a.sql
[0m13:11:09.267445 [info ] [MainThread]: 
[0m13:11:09.267445 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:11:09.272177 [debug] [MainThread]: Command `dbt test` failed at 13:11:09.272177 after 12.98 seconds
[0m13:11:09.272177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221A4171F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221A41B6A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221A41B6A10>]}
[0m13:11:09.274176 [debug] [MainThread]: Flushing usage events
[0m19:25:06.814606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC6B0C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC6C826D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC701D310>]}


============================== 19:25:06.883025 | d92726df-de4c-4e3f-8cce-8acf82f9f94b ==============================
[0m19:25:06.883025 [info ] [MainThread]: Running with dbt=1.7.18
[0m19:25:06.883025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:25:12.216835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd92726df-de4c-4e3f-8cce-8acf82f9f94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC709BA90>]}
[0m19:25:12.416962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd92726df-de4c-4e3f-8cce-8acf82f9f94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC7B7ED90>]}
[0m19:25:12.416962 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:25:12.539034 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m19:25:17.061562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:25:17.061562 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m19:25:17.744684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd92726df-de4c-4e3f-8cce-8acf82f9f94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC9171010>]}
[0m19:25:17.807694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd92726df-de4c-4e3f-8cce-8acf82f9f94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC92032D0>]}
[0m19:25:17.807694 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m19:25:17.825087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd92726df-de4c-4e3f-8cce-8acf82f9f94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC9389090>]}
[0m19:25:17.825781 [info ] [MainThread]: 
[0m19:25:17.834635 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:25:17.844904 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m19:25:17.888765 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m19:25:17.888765 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m19:25:17.888765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:20.937912 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.0 seconds
[0m19:25:20.937912 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m19:25:21.573767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd92726df-de4c-4e3f-8cce-8acf82f9f94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC9264290>]}
[0m19:25:21.573767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:25:21.578010 [info ] [MainThread]: 
[0m19:25:21.758050 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:25:21.758050 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m19:25:21.772562 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m19:25:21.772562 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:25:21.804635 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:25:21.832587 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 19:25:21.772562 => 19:25:21.828319
[0m19:25:21.834476 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:25:21.885841 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:25:21.885841 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:25:21.885841 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m19:25:21.901468 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:25:23.825585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:25:23.841623 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 19:25:21.834476 => 19:25:23.841623
[0m19:25:23.841623 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m19:25:24.293065 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 2.52s]
[0m19:25:24.293065 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:25:24.293065 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:25:24.301316 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m19:25:24.307852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m19:25:24.308558 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:25:24.335341 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:25:24.339462 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 19:25:24.311380 => 19:25:24.339462
[0m19:25:24.341679 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:25:24.349743 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:25:24.349743 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:25:24.349743 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m19:25:24.349743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:25:26.046634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:25:26.053504 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 19:25:24.341679 => 19:25:26.053504
[0m19:25:26.061524 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m19:25:26.307749 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 2.00s]
[0m19:25:26.307749 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:25:26.307749 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:25:26.307749 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m19:25:26.321019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m19:25:26.321019 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:25:26.329037 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:25:26.436372 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 19:25:26.321019 => 19:25:26.436372
[0m19:25:26.436372 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:25:26.452713 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:25:26.452713 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:25:26.452713 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m19:25:26.452713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:25:27.834075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:25:27.834075 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 19:25:26.436372 => 19:25:27.834075
[0m19:25:27.834075 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m19:25:28.036514 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.73s]
[0m19:25:28.045491 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:25:28.046523 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:25:28.048449 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m19:25:28.052814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m19:25:28.055219 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:25:28.069653 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:25:28.069653 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 19:25:28.055966 => 19:25:28.069653
[0m19:25:28.069653 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:25:28.083652 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:25:28.097755 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:25:28.097755 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m19:25:28.097755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:25:29.494974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:25:29.500386 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 19:25:28.080841 => 19:25:29.499221
[0m19:25:29.500386 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m19:25:29.739841 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.69s]
[0m19:25:29.739841 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:25:29.749569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:29.749569 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m19:25:29.749569 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m19:25:29.754585 [info ] [MainThread]: 
[0m19:25:29.757511 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 11.92 seconds (11.92s).
[0m19:25:29.766523 [debug] [MainThread]: Command end result
[0m19:25:29.801730 [info ] [MainThread]: 
[0m19:25:29.812765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:25:29.813193 [info ] [MainThread]: 
[0m19:25:29.817051 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:25:29.819915 [debug] [MainThread]: Command `dbt test` succeeded at 19:25:29.819915 after 23.32 seconds
[0m19:25:29.820921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC0181F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC0460C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC0450C50>]}
[0m19:25:29.820921 [debug] [MainThread]: Flushing usage events
[0m19:28:16.635751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C10497BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1048F4A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C104EEB510>]}


============================== 19:28:16.638308 | 5f987721-0c39-4d7a-b782-4a7b7604efcd ==============================
[0m19:28:16.638308 [info ] [MainThread]: Running with dbt=1.7.18
[0m19:28:16.638308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:28:17.408787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f987721-0c39-4d7a-b782-4a7b7604efcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C104EB2AD0>]}
[0m19:28:17.512486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f987721-0c39-4d7a-b782-4a7b7604efcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C106A8F2D0>]}
[0m19:28:17.512486 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:28:17.546473 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m19:28:17.868348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:17.868348 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m19:28:18.105327 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'PPG' in package 'dim_dfb_nfl_data' which was not found
[0m19:28:18.130323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f987721-0c39-4d7a-b782-4a7b7604efcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C106BBCF50>]}
[0m19:28:18.155199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f987721-0c39-4d7a-b782-4a7b7604efcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C106DA9B90>]}
[0m19:28:18.160710 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m19:28:18.160710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f987721-0c39-4d7a-b782-4a7b7604efcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C106ACA9D0>]}
[0m19:28:18.160710 [info ] [MainThread]: 
[0m19:28:18.160710 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:28:18.172778 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m19:28:18.184402 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m19:28:18.184402 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m19:28:18.194703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:20.364152 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:28:20.364152 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m19:28:21.001508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f987721-0c39-4d7a-b782-4a7b7604efcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C106D9A850>]}
[0m19:28:21.020690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:21.023050 [info ] [MainThread]: 
[0m19:28:21.023050 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:28:21.033083 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m19:28:21.039971 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m19:28:21.041671 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:28:21.082354 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:28:21.082354 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 19:28:21.041671 => 19:28:21.082354
[0m19:28:21.082354 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:28:21.113777 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:28:21.121795 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:28:21.121795 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m19:28:21.121795 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:22.903712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:28:22.935272 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 19:28:21.082354 => 19:28:22.935272
[0m19:28:22.935272 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m19:28:23.141190 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 2.10s]
[0m19:28:23.141190 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:28:23.141190 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:28:23.156854 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m19:28:23.162279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m19:28:23.168700 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:28:23.195998 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:28:23.200313 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 19:28:23.169997 => 19:28:23.200313
[0m19:28:23.200313 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:28:23.214990 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:28:23.214990 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:28:23.225512 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m19:28:23.225512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:24.574199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:28:24.583152 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 19:28:23.200313 => 19:28:24.583152
[0m19:28:24.583152 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m19:28:24.779037 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.62s]
[0m19:28:24.791036 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:28:24.791036 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:28:24.791036 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m19:28:24.798765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m19:28:24.802121 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:28:24.820688 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:28:24.826483 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 19:28:24.802518 => 19:28:24.826258
[0m19:28:24.829001 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:28:24.837060 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:28:24.840183 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:28:24.840183 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m19:28:24.840183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:26.405276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:28:26.405276 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 19:28:24.829782 => 19:28:26.405276
[0m19:28:26.418792 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m19:28:26.699446 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.91s]
[0m19:28:26.699446 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:28:26.714453 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:28:26.714453 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m19:28:26.714453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m19:28:26.714453 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:28:26.714453 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:28:26.714453 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 19:28:26.714453 => 19:28:26.714453
[0m19:28:26.714453 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:28:26.732814 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:28:26.734144 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:28:26.736589 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m19:28:26.738145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:27.962759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:28:27.962759 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 19:28:26.714453 => 19:28:27.962759
[0m19:28:27.962759 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m19:28:28.154179 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.44s]
[0m19:28:28.154179 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:28:28.172210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:28.172210 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m19:28:28.178370 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m19:28:28.180832 [info ] [MainThread]: 
[0m19:28:28.182938 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 10.02 seconds (10.02s).
[0m19:28:28.188556 [debug] [MainThread]: Command end result
[0m19:28:28.232026 [info ] [MainThread]: 
[0m19:28:28.236429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:28.236429 [info ] [MainThread]: 
[0m19:28:28.236429 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:28:28.236429 [debug] [MainThread]: Command `dbt test` succeeded at 19:28:28.236429 after 11.77 seconds
[0m19:28:28.244018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C17E011F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C17E2F0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C17E2E0C50>]}
[0m19:28:28.245061 [debug] [MainThread]: Flushing usage events
[0m19:39:48.103620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002313B0AAC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023139E4F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002313AB2C3D0>]}


============================== 19:39:48.480758 | 269efe25-690b-4246-952d-ace9d95c9272 ==============================
[0m19:39:48.480758 [info ] [MainThread]: Running with dbt=1.7.18
[0m19:39:48.480758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:40:25.781442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '269efe25-690b-4246-952d-ace9d95c9272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002313BAC2890>]}
[0m19:40:26.123786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '269efe25-690b-4246-952d-ace9d95c9272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002313CC0AAD0>]}
[0m19:40:26.130876 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:40:26.454794 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m19:40:40.761993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:40:40.762992 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m19:40:40.964152 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'ppg' in package 'dim_dfb_nfl_data' which was not found
[0m19:40:40.983145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '269efe25-690b-4246-952d-ace9d95c9272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002313CE77610>]}
[0m19:40:41.598553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '269efe25-690b-4246-952d-ace9d95c9272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002313CF77490>]}
[0m19:40:41.600569 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m19:40:41.604560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '269efe25-690b-4246-952d-ace9d95c9272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002313CD82BD0>]}
[0m19:40:41.611870 [info ] [MainThread]: 
[0m19:40:41.618372 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:40:41.627394 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m19:40:41.700071 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m19:40:41.702071 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m19:40:41.704983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:58.395409 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 17.0 seconds
[0m19:40:58.402413 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m19:40:58.792971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '269efe25-690b-4246-952d-ace9d95c9272', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002313D29FBD0>]}
[0m19:40:58.797037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:58.800974 [info ] [MainThread]: 
[0m19:40:59.083903 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:40:59.086903 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m19:40:59.091921 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m19:40:59.093920 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:40:59.181474 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:40:59.186471 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 19:40:59.097185 => 19:40:59.185472
[0m19:40:59.187484 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:40:59.276541 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:40:59.443547 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:40:59.445528 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m19:40:59.447540 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:00.722634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:41:00.805180 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 19:40:59.190023 => 19:41:00.803177
[0m19:41:00.809174 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m19:41:01.020710 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.93s]
[0m19:41:01.026273 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:41:01.030272 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:41:01.033294 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m19:41:01.039451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m19:41:01.042275 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:41:01.076130 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:41:01.101269 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 19:41:01.044260 => 19:41:01.100278
[0m19:41:01.105270 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:41:01.120337 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:41:01.127595 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:41:01.129636 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m19:41:01.132623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:03.779632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m19:41:03.787632 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 19:41:01.107319 => 19:41:03.786632
[0m19:41:03.790638 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m19:41:03.991884 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 2.95s]
[0m19:41:03.996907 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:41:03.998844 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:41:04.001845 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m19:41:04.418357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m19:41:04.421345 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:41:04.439882 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:41:04.589684 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 19:41:04.422358 => 19:41:04.588685
[0m19:41:04.593747 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:41:04.607749 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:41:04.702976 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:41:04.705980 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m19:41:04.708533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:07.041451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:41:07.044703 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 19:41:04.595680 => 19:41:07.044703
[0m19:41:07.044703 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m19:41:07.342480 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.93s]
[0m19:41:07.420690 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:41:07.424519 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:41:07.425542 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m19:41:07.428295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m19:41:07.429949 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:41:07.436551 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:41:07.445037 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 19:41:07.429949 => 19:41:07.436551
[0m19:41:07.446437 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:41:07.452984 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:41:07.452984 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:41:07.452984 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m19:41:07.461674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:08.986858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:41:08.986858 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 19:41:07.446437 => 19:41:08.986858
[0m19:41:08.986858 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m19:41:09.384971 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.96s]
[0m19:41:09.430600 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:41:09.430600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:09.430600 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m19:41:09.437618 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m19:41:09.437618 [info ] [MainThread]: 
[0m19:41:09.440732 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 27.82 seconds (27.82s).
[0m19:41:09.440732 [debug] [MainThread]: Command end result
[0m19:41:09.565151 [info ] [MainThread]: 
[0m19:41:09.565151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:09.565151 [info ] [MainThread]: 
[0m19:41:09.565151 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:41:09.573714 [debug] [MainThread]: Command `dbt test` succeeded at 19:41:09.572622 after 83.45 seconds
[0m19:41:09.574800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002313AC1DFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231341C1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023134490C50>]}
[0m19:41:09.575404 [debug] [MainThread]: Flushing usage events
[0m19:51:10.392008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B386E79A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B386E6D250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B386E6D110>]}


============================== 19:51:10.422502 | 8efd2e02-c8a3-443e-ae96-c8314e46ec03 ==============================
[0m19:51:10.422502 [info ] [MainThread]: Running with dbt=1.7.18
[0m19:51:10.438183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'send_anonymous_usage_stats': 'True'}
[0m19:51:12.865138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8efd2e02-c8a3-443e-ae96-c8314e46ec03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B388A87290>]}
[0m19:51:13.064637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8efd2e02-c8a3-443e-ae96-c8314e46ec03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3862EFA10>]}
[0m19:51:13.064637 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:51:13.130414 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m19:51:14.686089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:51:14.686089 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\dim_dfb_nfl_data.sql
[0m19:51:14.701108 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m19:51:15.819136 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'PPG' in package 'dim_dfb_nfl_data' which was not found
[0m19:51:15.865695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8efd2e02-c8a3-443e-ae96-c8314e46ec03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B389106F50>]}
[0m19:51:15.902306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8efd2e02-c8a3-443e-ae96-c8314e46ec03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3892767D0>]}
[0m19:51:15.902306 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m19:51:15.902306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8efd2e02-c8a3-443e-ae96-c8314e46ec03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B388A86D50>]}
[0m19:51:15.902306 [info ] [MainThread]: 
[0m19:51:15.902306 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:51:15.912800 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m19:51:15.933947 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m19:51:15.933947 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m19:51:15.933947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:17.714923 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:51:17.727938 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m19:51:17.982353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8efd2e02-c8a3-443e-ae96-c8314e46ec03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B38911AA10>]}
[0m19:51:17.982353 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:17.999402 [info ] [MainThread]: 
[0m19:51:18.007155 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:51:18.013675 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m19:51:18.015182 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m19:51:18.015182 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:51:18.039319 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:51:18.039319 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 19:51:18.015182 => 19:51:18.039319
[0m19:51:18.044553 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:51:18.090607 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:51:18.104044 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:51:18.104044 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m19:51:18.104044 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:51:19.940726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:51:19.956289 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 19:51:18.044553 => 19:51:19.956289
[0m19:51:19.956289 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m19:51:20.420471 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 2.41s]
[0m19:51:20.420471 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:51:20.431991 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:51:20.433654 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m19:51:20.435670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m19:51:20.435670 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:51:20.449225 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:51:20.465611 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 19:51:20.435670 => 19:51:20.463765
[0m19:51:20.467747 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:51:20.473864 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:51:20.473864 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:51:20.486273 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m19:51:20.487446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:22.072450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:51:22.089695 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 19:51:20.469692 => 19:51:22.089695
[0m19:51:22.089695 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m19:51:22.281368 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.85s]
[0m19:51:22.281368 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:51:22.296789 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:51:22.296789 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m19:51:22.296789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m19:51:22.303524 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:51:22.324338 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:51:22.328011 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 19:51:22.306463 => 19:51:22.328011
[0m19:51:22.328011 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:51:22.340763 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:51:22.340763 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:51:22.340763 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m19:51:22.340763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:23.440637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:51:23.440637 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 19:51:22.328011 => 19:51:23.440637
[0m19:51:23.440637 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m19:51:23.717501 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.42s]
[0m19:51:23.725529 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:51:23.725529 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:51:23.725529 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m19:51:23.734704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m19:51:23.736444 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:51:23.758231 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:51:23.761007 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 19:51:23.740423 => 19:51:23.761007
[0m19:51:23.761007 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:51:23.773445 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:51:23.773445 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:51:23.773445 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m19:51:23.773445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:25.648653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:51:25.658211 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 19:51:23.761007 => 19:51:25.656702
[0m19:51:25.658211 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m19:51:26.568816 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 2.84s]
[0m19:51:26.576789 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:51:26.576789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:26.584809 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m19:51:26.587062 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m19:51:26.587062 [info ] [MainThread]: 
[0m19:51:26.593207 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 10.68 seconds (10.68s).
[0m19:51:26.599567 [debug] [MainThread]: Command end result
[0m19:51:26.632787 [info ] [MainThread]: 
[0m19:51:26.640802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:26.641580 [info ] [MainThread]: 
[0m19:51:26.642754 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:51:26.647436 [debug] [MainThread]: Command `dbt test` succeeded at 19:51:26.647436 after 16.44 seconds
[0m19:51:26.648946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3800B1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B386EEC090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B380380C50>]}
[0m19:51:26.648946 [debug] [MainThread]: Flushing usage events
[0m19:52:20.198328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828C74BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828CCD5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828CCD44D0>]}


============================== 19:52:20.200743 | 129912ea-547d-4ec0-a306-893644f072f5 ==============================
[0m19:52:20.200743 [info ] [MainThread]: Running with dbt=1.7.18
[0m19:52:20.200743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:52:21.039392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '129912ea-547d-4ec0-a306-893644f072f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828D8CA990>]}
[0m19:52:21.220261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '129912ea-547d-4ec0-a306-893644f072f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828CD103D0>]}
[0m19:52:21.231771 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:52:21.273215 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m19:52:21.604231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:52:21.604231 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m19:52:21.820440 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'Salary' in package 'dim_dfb_nfl_data' which was not found
[0m19:52:21.855378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '129912ea-547d-4ec0-a306-893644f072f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828E954F50>]}
[0m19:52:21.886174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '129912ea-547d-4ec0-a306-893644f072f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828EB67F10>]}
[0m19:52:21.886174 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m19:52:21.886174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129912ea-547d-4ec0-a306-893644f072f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828D885250>]}
[0m19:52:21.892308 [info ] [MainThread]: 
[0m19:52:21.897123 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:52:21.897123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m19:52:21.919570 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m19:52:21.922534 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m19:52:21.922534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:23.916481 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:52:23.916481 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m19:52:24.246956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '129912ea-547d-4ec0-a306-893644f072f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828ECFA150>]}
[0m19:52:24.252474 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:52:24.252474 [info ] [MainThread]: 
[0m19:52:24.252474 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:52:24.252474 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m19:52:24.264645 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m19:52:24.264645 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:52:24.303970 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:52:24.303970 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 19:52:24.264645 => 19:52:24.303970
[0m19:52:24.303970 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:52:24.354248 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:52:24.359671 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:52:24.359671 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m19:52:24.359671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:52:25.571922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:52:25.592601 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 19:52:24.303970 => 19:52:25.590938
[0m19:52:25.592601 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m19:52:25.771741 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.51s]
[0m19:52:25.771741 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:52:25.771741 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:52:25.771741 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m19:52:25.791097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m19:52:25.793211 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:52:25.813099 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:52:25.820469 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 19:52:25.796559 => 19:52:25.819561
[0m19:52:25.820469 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:52:25.822961 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:52:25.830745 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:52:25.830745 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m19:52:25.833666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:27.596659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:52:27.596659 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 19:52:25.822961 => 19:52:27.596659
[0m19:52:27.596659 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m19:52:28.172925 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 2.38s]
[0m19:52:28.172925 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:52:28.172925 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:52:28.172925 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m19:52:28.187665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m19:52:28.191031 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:52:28.214976 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:52:28.214976 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 19:52:28.191031 => 19:52:28.214976
[0m19:52:28.214976 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:52:28.228559 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:52:28.228559 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:52:28.228559 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m19:52:28.228559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:30.183240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:52:30.183240 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 19:52:28.214976 => 19:52:30.183240
[0m19:52:30.183240 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m19:52:30.604028 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.43s]
[0m19:52:30.608133 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:52:30.608133 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:52:30.608133 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m19:52:30.618256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m19:52:30.619933 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:52:30.639898 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:52:30.639898 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 19:52:30.620733 => 19:52:30.639898
[0m19:52:30.649914 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:52:30.654180 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:52:30.665110 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:52:30.665670 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m19:52:30.665670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:32.509421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:52:32.509421 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 19:52:30.649914 => 19:52:32.509421
[0m19:52:32.524832 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m19:52:33.000168 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 2.39s]
[0m19:52:33.000168 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:52:33.000168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:33.000168 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m19:52:33.015468 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m19:52:33.018671 [info ] [MainThread]: 
[0m19:52:33.021102 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 11.12 seconds (11.12s).
[0m19:52:33.022272 [debug] [MainThread]: Command end result
[0m19:52:33.053586 [info ] [MainThread]: 
[0m19:52:33.055160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:52:33.055160 [info ] [MainThread]: 
[0m19:52:33.055160 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:52:33.060065 [debug] [MainThread]: Command `dbt test` succeeded at 19:52:33.060065 after 12.98 seconds
[0m19:52:33.060065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828C74C5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828C6522D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018285DC1F50>]}
[0m19:52:33.062596 [debug] [MainThread]: Flushing usage events
[0m19:54:39.061200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DB330E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DB31DB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DB30E8D0>]}


============================== 19:54:39.064499 | 5c64b3f6-b0cd-46a6-b550-cd74da4f9c9a ==============================
[0m19:54:39.064499 [info ] [MainThread]: Running with dbt=1.7.18
[0m19:54:39.064499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:54:39.817931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c64b3f6-b0cd-46a6-b550-cd74da4f9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DB31C510>]}
[0m19:54:39.977344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c64b3f6-b0cd-46a6-b550-cd74da4f9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DCE7E0D0>]}
[0m19:54:39.978702 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:54:40.017564 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m19:54:40.504497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:54:40.504497 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m19:54:40.504497 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m19:54:41.622286 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'PPG' in package 'dim_dfb_nfl_data' which was not found
[0m19:54:41.664469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c64b3f6-b0cd-46a6-b550-cd74da4f9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DD4160D0>]}
[0m19:54:41.680243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c64b3f6-b0cd-46a6-b550-cd74da4f9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DD78CF10>]}
[0m19:54:41.680243 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m19:54:41.680243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c64b3f6-b0cd-46a6-b550-cd74da4f9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DCE53050>]}
[0m19:54:41.694461 [info ] [MainThread]: 
[0m19:54:41.694461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:54:41.700073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m19:54:41.713349 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m19:54:41.713349 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m19:54:41.713349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:44.060582 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:54:44.060582 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m19:54:44.624275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c64b3f6-b0cd-46a6-b550-cd74da4f9c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DD053990>]}
[0m19:54:44.624275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:54:44.624275 [info ] [MainThread]: 
[0m19:54:44.645458 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:54:44.645458 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m19:54:44.645458 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m19:54:44.655976 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:54:44.689004 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:54:44.695429 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 19:54:44.659306 => 19:54:44.689004
[0m19:54:44.695429 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:54:44.763219 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:54:44.763219 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:54:44.769735 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m19:54:44.769842 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:54:46.860982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:54:46.875955 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 19:54:44.695429 => 19:54:46.875955
[0m19:54:46.875955 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m19:54:47.480027 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 2.83s]
[0m19:54:47.480027 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:54:47.480027 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:54:47.480027 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m19:54:47.497514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m19:54:47.501184 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:54:47.524649 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:54:47.536117 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 19:54:47.502178 => 19:54:47.536117
[0m19:54:47.536117 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:54:47.543146 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:54:47.543146 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:54:47.543146 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m19:54:47.550663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:49.135117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:54:49.135117 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 19:54:47.540440 => 19:54:49.135117
[0m19:54:49.150597 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m19:54:49.572680 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 2.08s]
[0m19:54:49.579699 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:54:49.579699 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:54:49.579699 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m19:54:49.584764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m19:54:49.586249 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:54:49.596281 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:54:49.596281 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 19:54:49.587163 => 19:54:49.596281
[0m19:54:49.600819 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:54:49.609215 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:54:49.610886 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:54:49.610886 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m19:54:49.615395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:50.989246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:54:50.998263 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 19:54:49.600819 => 19:54:50.989246
[0m19:54:50.998263 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m19:54:51.283252 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.70s]
[0m19:54:51.298717 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:54:51.298717 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:54:51.306981 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m19:54:51.309027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m19:54:51.309027 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:54:51.331783 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:54:51.334951 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 19:54:51.315240 => 19:54:51.334951
[0m19:54:51.339659 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:54:51.348006 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:54:51.358300 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:54:51.358300 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m19:54:51.358300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:52.542786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:54:52.553848 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 19:54:51.339659 => 19:54:52.542786
[0m19:54:52.558482 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m19:54:52.754617 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.45s]
[0m19:54:52.756618 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:54:52.760672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:52.760672 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m19:54:52.760672 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m19:54:52.765984 [info ] [MainThread]: 
[0m19:54:52.765984 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 11.07 seconds (11.07s).
[0m19:54:52.770585 [debug] [MainThread]: Command end result
[0m19:54:52.790769 [info ] [MainThread]: 
[0m19:54:52.790769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:54:52.802155 [info ] [MainThread]: 
[0m19:54:52.802155 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:54:52.806568 [debug] [MainThread]: Command `dbt test` succeeded at 19:54:52.806568 after 13.86 seconds
[0m19:54:52.806568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DAF32090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238D44D1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DB2DFA90>]}
[0m19:54:52.806568 [debug] [MainThread]: Flushing usage events
[0m19:55:38.526325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C5CCDB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C5CCFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C5CCCE90>]}


============================== 19:55:38.529428 | 1c19a7a4-97d7-4def-927c-93a03d74b9b0 ==============================
[0m19:55:38.529428 [info ] [MainThread]: Running with dbt=1.7.18
[0m19:55:38.529428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'send_anonymous_usage_stats': 'True'}
[0m19:55:39.223467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c19a7a4-97d7-4def-927c-93a03d74b9b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C681E110>]}
[0m19:55:39.452608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c19a7a4-97d7-4def-927c-93a03d74b9b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C78813D0>]}
[0m19:55:39.452608 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:55:39.531993 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m19:55:40.012498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:55:40.013504 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m19:55:40.830310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c19a7a4-97d7-4def-927c-93a03d74b9b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C8094390>]}
[0m19:55:40.940787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c19a7a4-97d7-4def-927c-93a03d74b9b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C7FC8E90>]}
[0m19:55:40.940787 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m19:55:40.940787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c19a7a4-97d7-4def-927c-93a03d74b9b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C79A3850>]}
[0m19:55:40.947085 [info ] [MainThread]: 
[0m19:55:40.956982 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:55:40.963918 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m19:55:40.997044 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m19:55:40.997044 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m19:55:40.997044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:42.776939 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:55:42.781390 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m19:55:43.077606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c19a7a4-97d7-4def-927c-93a03d74b9b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C79F0C50>]}
[0m19:55:43.089957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:43.091056 [info ] [MainThread]: 
[0m19:55:43.092562 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:55:43.096249 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m19:55:43.098182 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m19:55:43.099750 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:55:43.117979 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:55:43.122872 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 19:55:43.100758 => 19:55:43.122872
[0m19:55:43.124948 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:55:43.157778 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:55:43.160786 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:55:43.160786 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m19:55:43.160786 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:55:45.050566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:55:45.068028 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 19:55:43.125711 => 19:55:45.068028
[0m19:55:45.068028 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m19:55:45.255212 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 2.16s]
[0m19:55:45.261227 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:55:45.261227 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:55:45.264242 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m19:55:45.270064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m19:55:45.273139 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:55:45.274912 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:55:45.289387 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 19:55:45.274912 => 19:55:45.289387
[0m19:55:45.292315 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:55:45.297630 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:55:45.297630 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:55:45.297630 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m19:55:45.297630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:46.480945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:55:46.480945 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 19:55:45.292315 => 19:55:46.480945
[0m19:55:46.480945 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m19:55:46.689666 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.43s]
[0m19:55:46.689666 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:55:46.689666 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:55:46.689666 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m19:55:46.701153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m19:55:46.702081 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:55:46.711259 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:55:46.711259 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 19:55:46.703635 => 19:55:46.711259
[0m19:55:46.718486 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:55:46.718486 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:55:46.718486 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:55:46.736144 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m19:55:46.738448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:48.602179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:55:48.616714 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 19:55:46.718486 => 19:55:48.616714
[0m19:55:48.616714 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m19:55:48.881812 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.19s]
[0m19:55:48.881812 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:55:48.881812 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf
[0m19:55:48.881812 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_PPG .......................... [RUN]
[0m19:55:48.894531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf)
[0m19:55:48.894531 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf
[0m19:55:48.902235 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf"
[0m19:55:48.902235 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf (compile): 19:55:48.898071 => 19:55:48.902235
[0m19:55:48.919491 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf
[0m19:55:48.926477 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf"
[0m19:55:48.926477 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf"
[0m19:55:48.926477 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 1

      
    ) dbt_internal_test
[0m19:55:48.939089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:51.291154 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:55:51.291154 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf (execute): 19:55:48.921803 => 19:55:51.291154
[0m19:55:51.291154 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf: Close
[0m19:55:51.504122 [error] [Thread-1 (]: 4 of 5 FAIL 928 positive_value_dim_dfb_nfl_data_PPG ............................ [[31mFAIL 928[0m in 2.62s]
[0m19:55:51.504122 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf
[0m19:55:51.504122 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:55:51.504122 [info ] [Thread-1 (]: 5 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m19:55:51.518148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m19:55:51.520705 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:55:51.536306 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:55:51.536306 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 19:55:51.521974 => 19:55:51.536306
[0m19:55:51.536306 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:55:51.554042 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:55:51.560012 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:55:51.560012 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m19:55:51.564525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:52.834505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:55:52.838683 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 19:55:51.536306 => 19:55:52.838683
[0m19:55:52.838683 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m19:55:53.221361 [info ] [Thread-1 (]: 5 of 5 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.72s]
[0m19:55:53.221361 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:55:53.232137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:53.232137 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m19:55:53.238374 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m19:55:53.241254 [info ] [MainThread]: 
[0m19:55:53.248693 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 12.29 seconds (12.29s).
[0m19:55:53.254477 [debug] [MainThread]: Command end result
[0m19:55:53.298763 [info ] [MainThread]: 
[0m19:55:53.309947 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:55:53.312202 [info ] [MainThread]: 
[0m19:55:53.317143 [error] [MainThread]: [31mFailure in test positive_value_dim_dfb_nfl_data_PPG (models\schema.yml)[0m
[0m19:55:53.319359 [error] [MainThread]:   Got 928 results, configured to fail if != 0
[0m19:55:53.321036 [info ] [MainThread]: 
[0m19:55:53.321036 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\positive_value_dim_dfb_nfl_data_PPG.sql
[0m19:55:53.324653 [info ] [MainThread]: 
[0m19:55:53.325991 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m19:55:53.332376 [debug] [MainThread]: Command `dbt test` failed at 19:55:53.331966 after 14.95 seconds
[0m19:55:53.332376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173BEDD1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173BEE16950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C7A40690>]}
[0m19:55:53.332376 [debug] [MainThread]: Flushing usage events
[0m19:57:44.783839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1802CD890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C180332A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1802CEB10>]}


============================== 19:57:44.783839 | bee4c4b6-8f57-40cb-b3da-7d0691f74b04 ==============================
[0m19:57:44.783839 [info ] [MainThread]: Running with dbt=1.7.18
[0m19:57:44.791608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:45.745611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bee4c4b6-8f57-40cb-b3da-7d0691f74b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C180330410>]}
[0m19:57:45.938643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bee4c4b6-8f57-40cb-b3da-7d0691f74b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C181E14DD0>]}
[0m19:57:45.953522 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:57:46.011939 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m19:57:46.326548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:57:46.326548 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m19:57:46.637156 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'storage.dfb.dim_dfb_nfl_data.PPG' in package 'dim_dfb_nfl_data' which was not found
[0m19:57:46.685986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bee4c4b6-8f57-40cb-b3da-7d0691f74b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C18203CF50>]}
[0m19:57:46.721856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bee4c4b6-8f57-40cb-b3da-7d0691f74b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1821BADD0>]}
[0m19:57:46.721856 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m19:57:46.725870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee4c4b6-8f57-40cb-b3da-7d0691f74b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C181EF3350>]}
[0m19:57:46.727380 [info ] [MainThread]: 
[0m19:57:46.727380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:57:46.736953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m19:57:46.754406 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m19:57:46.754406 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m19:57:46.754406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:48.536568 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m19:57:48.551090 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m19:57:48.743898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee4c4b6-8f57-40cb-b3da-7d0691f74b04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C181EF3350>]}
[0m19:57:48.759559 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:48.759559 [info ] [MainThread]: 
[0m19:57:48.766642 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:57:48.775661 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m19:57:48.779795 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m19:57:48.783822 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:57:48.816937 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:57:48.828766 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 19:57:48.788158 => 19:57:48.828766
[0m19:57:48.831190 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:57:48.862298 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:57:48.862298 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m19:57:48.862298 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m19:57:48.862298 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:57:50.461251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:57:50.492396 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 19:57:48.831190 => 19:57:50.492396
[0m19:57:50.492396 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m19:57:51.090372 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 2.30s]
[0m19:57:51.094144 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m19:57:51.094144 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:57:51.094144 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m19:57:51.094144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m19:57:51.094144 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:57:51.129800 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:57:51.136228 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 19:57:51.094144 => 19:57:51.133209
[0m19:57:51.137747 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:57:51.137747 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:57:51.152393 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m19:57:51.152393 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m19:57:51.152393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:52.918483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:57:52.934042 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 19:57:51.137747 => 19:57:52.934042
[0m19:57:52.936730 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m19:57:53.345489 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 2.25s]
[0m19:57:53.345489 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m19:57:53.345489 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:57:53.361137 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m19:57:53.367471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m19:57:53.369557 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:57:53.372393 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:57:53.387823 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 19:57:53.372393 => 19:57:53.387823
[0m19:57:53.391446 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:57:53.393715 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:57:53.393715 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m19:57:53.399984 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m19:57:53.399984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:55.173457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:57:55.189089 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 19:57:53.391528 => 19:57:55.189089
[0m19:57:55.189089 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m19:57:55.408945 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.04s]
[0m19:57:55.408945 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m19:57:55.408945 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf
[0m19:57:55.424451 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_PPG .......................... [RUN]
[0m19:57:55.429164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf)
[0m19:57:55.429164 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf
[0m19:57:55.448494 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf"
[0m19:57:55.449910 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf (compile): 19:57:55.429164 => 19:57:55.449910
[0m19:57:55.449910 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf
[0m19:57:55.462219 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf"
[0m19:57:55.462219 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf"
[0m19:57:55.462219 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 1

      
    ) dbt_internal_test
[0m19:57:55.462219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:56.651023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:57:56.663138 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf (execute): 19:57:55.449910 => 19:57:56.661346
[0m19:57:56.663138 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf: Close
[0m19:57:56.921393 [error] [Thread-1 (]: 4 of 5 FAIL 928 positive_value_dim_dfb_nfl_data_PPG ............................ [[31mFAIL 928[0m in 1.49s]
[0m19:57:56.925951 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf
[0m19:57:56.925951 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:57:56.925951 [info ] [Thread-1 (]: 5 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m19:57:56.935435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_PPG.ab68774abf, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m19:57:56.936220 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:57:56.953708 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:57:56.958080 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 19:57:56.936220 => 19:57:56.958080
[0m19:57:56.958080 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:57:56.961172 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:57:56.965186 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m19:57:56.965186 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m19:57:56.967830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:58.249960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:57:58.261372 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 19:57:56.958080 => 19:57:58.261372
[0m19:57:58.261372 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m19:57:58.635431 [info ] [Thread-1 (]: 5 of 5 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.71s]
[0m19:57:58.651008 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m19:57:58.651008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:58.651008 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m19:57:58.651008 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m19:57:58.651008 [info ] [MainThread]: 
[0m19:57:58.662371 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 11.92 seconds (11.92s).
[0m19:57:58.663967 [debug] [MainThread]: Command end result
[0m19:57:58.687763 [info ] [MainThread]: 
[0m19:57:58.698163 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:57:58.699082 [info ] [MainThread]: 
[0m19:57:58.699082 [error] [MainThread]: [31mFailure in test positive_value_dim_dfb_nfl_data_PPG (models\schema.yml)[0m
[0m19:57:58.704284 [error] [MainThread]:   Got 928 results, configured to fail if != 0
[0m19:57:58.705737 [info ] [MainThread]: 
[0m19:57:58.705737 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\positive_value_dim_dfb_nfl_data_PPG.sql
[0m19:57:58.705737 [info ] [MainThread]: 
[0m19:57:58.708911 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m19:57:58.712401 [debug] [MainThread]: Command `dbt test` failed at 19:57:58.712401 after 14.04 seconds
[0m19:57:58.714954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F9361F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C180331910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F9640C10>]}
[0m19:57:58.716845 [debug] [MainThread]: Flushing usage events
[0m20:00:11.873076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544CA19C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544CA19B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544CA19650>]}


============================== 20:00:11.873076 | bc85f1c0-8389-454d-b738-b108f7955294 ==============================
[0m20:00:11.873076 [info ] [MainThread]: Running with dbt=1.7.18
[0m20:00:11.879123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:00:12.510433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc85f1c0-8389-454d-b738-b108f7955294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544E652E50>]}
[0m20:00:12.680423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc85f1c0-8389-454d-b738-b108f7955294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544CA87E10>]}
[0m20:00:12.680423 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:00:12.724818 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m20:00:13.180852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:00:13.180852 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m20:00:13.180852 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m20:00:14.160913 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'PPG' in package 'storage.dfb.dim_dfb_nfl_data' which was not found
[0m20:00:14.231725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc85f1c0-8389-454d-b738-b108f7955294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544EE5D610>]}
[0m20:00:14.270565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc85f1c0-8389-454d-b738-b108f7955294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544E8C00D0>]}
[0m20:00:14.270565 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m20:00:14.279628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc85f1c0-8389-454d-b738-b108f7955294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544E687E10>]}
[0m20:00:14.283141 [info ] [MainThread]: 
[0m20:00:14.288099 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:00:14.292797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m20:00:14.339701 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m20:00:14.339701 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m20:00:14.339701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:16.790126 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m20:00:16.804148 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m20:00:17.160959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc85f1c0-8389-454d-b738-b108f7955294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544E687E10>]}
[0m20:00:17.160959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:00:17.160959 [info ] [MainThread]: 
[0m20:00:17.181764 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m20:00:17.183716 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m20:00:17.189303 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m20:00:17.189303 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m20:00:17.221096 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m20:00:17.233845 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 20:00:17.192397 => 20:00:17.231656
[0m20:00:17.233845 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m20:00:17.261418 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m20:00:17.268995 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m20:00:17.268995 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m20:00:17.268995 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:18.793536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:00:18.822344 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 20:00:17.233845 => 20:00:18.822344
[0m20:00:18.822344 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m20:00:18.995267 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.81s]
[0m20:00:18.995267 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m20:00:18.995267 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m20:00:18.995267 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m20:00:18.995267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m20:00:19.009052 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m20:00:19.036120 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m20:00:19.041963 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 20:00:19.012205 => 20:00:19.036275
[0m20:00:19.041963 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m20:00:19.056231 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m20:00:19.056231 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m20:00:19.056231 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m20:00:19.056231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:20.945783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:00:20.961431 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 20:00:19.041963 => 20:00:20.961431
[0m20:00:20.961431 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m20:00:21.605033 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 2.61s]
[0m20:00:21.622453 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m20:00:21.622453 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m20:00:21.622453 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m20:00:21.630206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m20:00:21.633522 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m20:00:21.651038 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m20:00:21.656770 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 20:00:21.634064 => 20:00:21.654579
[0m20:00:21.657610 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m20:00:21.666831 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m20:00:21.679503 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m20:00:21.681251 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m20:00:21.681251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:23.249469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:00:23.265112 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 20:00:21.657610 => 20:00:23.265112
[0m20:00:23.265112 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m20:00:23.575151 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.95s]
[0m20:00:23.589669 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m20:00:23.589669 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m20:00:23.589669 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m20:00:23.600942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m20:00:23.603517 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m20:00:23.609257 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m20:00:23.609257 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 20:00:23.605119 => 20:00:23.609257
[0m20:00:23.609257 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m20:00:23.631059 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m20:00:23.631059 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m20:00:23.631059 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m20:00:23.640571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:00:25.058272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:00:25.075097 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 20:00:23.626989 => 20:00:25.075097
[0m20:00:25.075097 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m20:00:25.716510 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 2.12s]
[0m20:00:25.719009 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m20:00:25.723737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:25.723737 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m20:00:25.723737 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m20:00:25.723737 [info ] [MainThread]: 
[0m20:00:25.733793 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 11.44 seconds (11.44s).
[0m20:00:25.740561 [debug] [MainThread]: Command end result
[0m20:00:25.788519 [info ] [MainThread]: 
[0m20:00:25.788519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:25.788519 [info ] [MainThread]: 
[0m20:00:25.788519 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:00:25.797644 [debug] [MainThread]: Command `dbt test` succeeded at 20:00:25.797644 after 14.05 seconds
[0m20:00:25.797644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025445B21F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025445E00C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025445E00090>]}
[0m20:00:25.797644 [debug] [MainThread]: Flushing usage events
[0m20:03:33.640052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C51A84AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C51A6B010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C51A68A90>]}


============================== 20:03:33.644560 | 79fbf946-3a25-43b5-890e-812fc2de1b41 ==============================
[0m20:03:33.644560 [info ] [MainThread]: Running with dbt=1.7.18
[0m20:03:33.644560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:03:34.387507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79fbf946-3a25-43b5-890e-812fc2de1b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C5360F050>]}
[0m20:03:34.524300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79fbf946-3a25-43b5-890e-812fc2de1b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C524ECB90>]}
[0m20:03:34.524300 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:03:34.563835 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m20:03:34.978529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:03:34.991599 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m20:03:35.259723 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'PPG' in package 'dim_dfb_nfl_data' which was not found
[0m20:03:35.283652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79fbf946-3a25-43b5-890e-812fc2de1b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C537BB990>]}
[0m20:03:35.299329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79fbf946-3a25-43b5-890e-812fc2de1b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C539321D0>]}
[0m20:03:35.299329 [info ] [MainThread]: Found 6 models, 1 seed, 4 tests, 0 sources, 0 exposures, 0 metrics, 808 macros, 0 groups, 0 semantic models
[0m20:03:35.311304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79fbf946-3a25-43b5-890e-812fc2de1b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C53753ED0>]}
[0m20:03:35.311304 [info ] [MainThread]: 
[0m20:03:35.317913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:03:35.318988 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m20:03:35.330058 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m20:03:35.330058 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m20:03:35.330058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:03:37.699599 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m20:03:37.715265 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m20:03:38.058360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79fbf946-3a25-43b5-890e-812fc2de1b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C536696D0>]}
[0m20:03:38.058360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:03:38.065393 [info ] [MainThread]: 
[0m20:03:38.066752 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m20:03:38.066752 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m20:03:38.082222 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m20:03:38.083668 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m20:03:38.146423 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m20:03:38.146423 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 20:03:38.086186 => 20:03:38.146423
[0m20:03:38.151074 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m20:03:38.177804 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m20:03:38.177804 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m20:03:38.177804 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m20:03:38.192854 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:03:39.482373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:03:39.497381 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 20:03:38.151074 => 20:03:39.497381
[0m20:03:39.497381 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m20:03:39.678314 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.60s]
[0m20:03:39.687834 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m20:03:39.687834 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m20:03:39.687834 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m20:03:39.696911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m20:03:39.700227 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m20:03:39.719118 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m20:03:39.719118 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 20:03:39.700704 => 20:03:39.719118
[0m20:03:39.731113 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m20:03:39.733993 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m20:03:39.733993 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m20:03:39.749729 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m20:03:39.751697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:41.102290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:03:41.117858 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 20:03:39.733993 => 20:03:41.117858
[0m20:03:41.117858 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m20:03:41.511919 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.82s]
[0m20:03:41.511919 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m20:03:41.527544 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m20:03:41.527544 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m20:03:41.531308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m20:03:41.532220 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m20:03:41.535064 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m20:03:41.544158 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 20:03:41.533720 => 20:03:41.544158
[0m20:03:41.546588 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m20:03:41.546588 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m20:03:41.546588 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m20:03:41.546588 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m20:03:41.546588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:43.448816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:43.455413 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 20:03:41.546588 => 20:03:43.448816
[0m20:03:43.456928 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m20:03:44.053483 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.53s]
[0m20:03:44.070404 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m20:03:44.070404 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m20:03:44.070404 [info ] [Thread-1 (]: 4 of 4 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m20:03:44.079167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m20:03:44.081661 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m20:03:44.096690 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m20:03:44.096690 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 20:03:44.082524 => 20:03:44.096690
[0m20:03:44.096690 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m20:03:44.106275 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m20:03:44.106275 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m20:03:44.106275 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m20:03:44.106275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:03:46.111740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m20:03:46.119763 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 20:03:44.096690 => 20:03:46.111740
[0m20:03:46.119763 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m20:03:46.716033 [info ] [Thread-1 (]: 4 of 4 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 2.65s]
[0m20:03:46.716033 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m20:03:46.731612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:03:46.731612 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m20:03:46.731612 [debug] [MainThread]: Connection 'test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1' was properly closed.
[0m20:03:46.731612 [info ] [MainThread]: 
[0m20:03:46.745930 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 11.42 seconds (11.42s).
[0m20:03:46.754184 [debug] [MainThread]: Command end result
[0m20:03:46.804383 [info ] [MainThread]: 
[0m20:03:46.806749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:03:46.806749 [info ] [MainThread]: 
[0m20:03:46.806749 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:03:46.815477 [debug] [MainThread]: Command `dbt test` succeeded at 20:03:46.815477 after 13.29 seconds
[0m20:03:46.815477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C4ABF1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C51A8CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C51A8CD10>]}
[0m20:03:46.815477 [debug] [MainThread]: Flushing usage events
[0m21:48:44.667443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B7E39750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B7E899D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B7E88050>]}


============================== 21:48:44.683120 | f2da1b67-3ad0-4709-bd8d-c2d3f931c151 ==============================
[0m21:48:44.683120 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:48:44.683120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:48:45.365282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2da1b67-3ad0-4709-bd8d-c2d3f931c151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B9A2FA50>]}
[0m21:48:45.462706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2da1b67-3ad0-4709-bd8d-c2d3f931c151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B99EACD0>]}
[0m21:48:45.478635 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:48:45.501346 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:48:45.797587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m21:48:45.797587 [debug] [MainThread]: Partial parsing: added file: dfb_data://tests\value_test.sql
[0m21:48:45.797587 [debug] [MainThread]: Partial parsing: added file: dfb_data://macros\ppg.sql
[0m21:48:45.956147 [error] [MainThread]: Encountered an error:
Compilation Error in test value_test (tests\value_test.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
[0m21:48:45.956147 [debug] [MainThread]: Command `dbt test` failed at 21:48:45.956147 after 1.38 seconds
[0m21:48:45.956147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B7EADC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B0F51F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1B9EFFD90>]}
[0m21:48:45.956147 [debug] [MainThread]: Flushing usage events
[0m21:49:07.397814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022760ADFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022760AB0F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022760AB2850>]}


============================== 21:49:07.405818 | da5b1d50-e4e0-4ddd-81f5-52a2526c4fff ==============================
[0m21:49:07.405818 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:49:07.405818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:49:07.992131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da5b1d50-e4e0-4ddd-81f5-52a2526c4fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227611B1650>]}
[0m21:49:08.092140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da5b1d50-e4e0-4ddd-81f5-52a2526c4fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022760AF06D0>]}
[0m21:49:08.098691 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:49:08.129498 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:49:08.406829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m21:49:08.406829 [debug] [MainThread]: Partial parsing: added file: dfb_data://macros\ppg.sql
[0m21:49:08.406829 [debug] [MainThread]: Partial parsing: added file: dfb_data://tests\value_test.sql
[0m21:49:08.571132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da5b1d50-e4e0-4ddd-81f5-52a2526c4fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276277F490>]}
[0m21:49:08.590779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da5b1d50-e4e0-4ddd-81f5-52a2526c4fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227629A9890>]}
[0m21:49:08.590779 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m21:49:08.590779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da5b1d50-e4e0-4ddd-81f5-52a2526c4fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022762748450>]}
[0m21:49:08.590779 [info ] [MainThread]: 
[0m21:49:08.590779 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:49:08.599290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:49:08.620402 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:49:08.620688 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:49:08.620688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:09.688405 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:49:09.701492 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:49:09.879671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da5b1d50-e4e0-4ddd-81f5-52a2526c4fff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227626FCA50>]}
[0m21:49:09.895293 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:49:09.895891 [info ] [MainThread]: 
[0m21:49:09.901942 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:49:09.901942 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m21:49:09.907911 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m21:49:09.907911 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:49:09.935269 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:49:09.981766 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 21:49:09.908930 => 21:49:09.981766
[0m21:49:09.981766 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:49:10.016755 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:49:10.031224 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:49:10.032252 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m21:49:10.033270 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:49:10.881799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:49:10.896782 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 21:49:09.981766 => 21:49:10.896782
[0m21:49:10.896782 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m21:49:11.053010 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.15s]
[0m21:49:11.054866 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:49:11.056908 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:49:11.057914 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m21:49:11.059866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m21:49:11.060933 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:49:11.073425 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:49:11.074612 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 21:49:11.061866 => 21:49:11.074612
[0m21:49:11.074612 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:49:11.081307 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:49:11.081307 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:49:11.081307 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m21:49:11.081307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:11.894792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:49:11.895598 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 21:49:11.074612 => 21:49:11.895598
[0m21:49:11.895598 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m21:49:12.030274 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.97s]
[0m21:49:12.030274 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:49:12.030274 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:49:12.030274 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m21:49:12.030274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m21:49:12.030274 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:49:12.050357 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:49:12.051586 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 21:49:12.044902 => 21:49:12.051586
[0m21:49:12.051586 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:49:12.051586 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:49:12.051586 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:49:12.051586 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m21:49:12.051586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:12.929381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:49:12.945861 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 21:49:12.051586 => 21:49:12.945861
[0m21:49:12.945861 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m21:49:13.074271 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.04s]
[0m21:49:13.077379 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:49:13.079362 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:49:13.081376 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m21:49:13.083232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m21:49:13.084284 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:49:13.091237 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:49:13.093236 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 21:49:13.085233 => 21:49:13.092228
[0m21:49:13.093236 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:49:13.099687 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:49:13.102334 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:49:13.103356 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m21:49:13.103356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:13.846183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:49:13.846183 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 21:49:13.094685 => 21:49:13.846183
[0m21:49:13.846183 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m21:49:14.017103 [info ] [Thread-1 (]: 4 of 5 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 0.93s]
[0m21:49:14.021130 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:49:14.022155 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m21:49:14.024128 [info ] [Thread-1 (]: 5 of 5 START test value_test ................................................... [RUN]
[0m21:49:14.026313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m21:49:14.027981 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m21:49:14.035050 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 21:49:14.029005 => 21:49:14.035050
[0m21:49:14.274184 [debug] [Thread-1 (]: Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:49:14.274184 [error] [Thread-1 (]: 5 of 5 ERROR value_test ........................................................ [[31mERROR[0m in 0.25s]
[0m21:49:14.274184 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m21:49:14.274184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:14.274184 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:49:14.289793 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m21:49:14.290790 [info ] [MainThread]: 
[0m21:49:14.291798 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m21:49:14.294077 [debug] [MainThread]: Command end result
[0m21:49:14.296615 [info ] [MainThread]: 
[0m21:49:14.312444 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:49:14.314433 [info ] [MainThread]: 
[0m21:49:14.315913 [error] [MainThread]:   Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:49:14.317907 [info ] [MainThread]: 
[0m21:49:14.318886 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:49:14.321898 [debug] [MainThread]: Command `dbt test` failed at 21:49:14.321898 after 7.01 seconds
[0m21:49:14.322906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022759C41F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227606F2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227626AFA10>]}
[0m21:49:14.324039 [debug] [MainThread]: Flushing usage events
[0m21:49:52.506438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287A15B9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287A15B9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287A15B9C10>]}


============================== 21:49:52.506438 | 1199c439-0b32-422a-bc48-649d01592fe2 ==============================
[0m21:49:52.506438 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:49:52.506438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:49:53.133321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1199c439-0b32-422a-bc48-649d01592fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287A318EA50>]}
[0m21:49:53.245754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1199c439-0b32-422a-bc48-649d01592fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287A15F7F10>]}
[0m21:49:53.245754 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:49:53.267606 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:49:53.539890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:49:53.539890 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:49:53.539890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1199c439-0b32-422a-bc48-649d01592fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287A165A550>]}
[0m21:49:53.567441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1199c439-0b32-422a-bc48-649d01592fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287A332FED0>]}
[0m21:49:53.568397 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m21:49:53.569424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1199c439-0b32-422a-bc48-649d01592fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287A32AC150>]}
[0m21:49:53.571397 [info ] [MainThread]: 
[0m21:49:53.573516 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:49:53.577861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:49:53.580381 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:49:53.595518 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:49:53.597682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:54.645135 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:49:54.646192 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:49:54.779152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1199c439-0b32-422a-bc48-649d01592fe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287A3109ED0>]}
[0m21:49:54.779152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:49:54.795417 [info ] [MainThread]: 
[0m21:49:54.801429 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:49:54.801429 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m21:49:54.806045 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m21:49:54.806045 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:49:54.835230 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:49:54.837199 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 21:49:54.807094 => 21:49:54.836243
[0m21:49:54.837199 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:49:54.862210 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:49:54.862210 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:49:54.862210 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m21:49:54.862210 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:49:55.596179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:49:55.604463 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 21:49:54.838201 => 21:49:55.604463
[0m21:49:55.605463 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m21:49:55.762977 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.96s]
[0m21:49:55.762977 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:49:55.762977 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:49:55.762977 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m21:49:55.775077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m21:49:55.776140 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:49:55.787670 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:49:55.788760 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 21:49:55.776140 => 21:49:55.788760
[0m21:49:55.789754 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:49:55.790989 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:49:55.796488 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:49:55.798507 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m21:49:55.800177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:56.575355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:49:56.579588 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 21:49:55.790989 => 21:49:56.579588
[0m21:49:56.579588 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m21:49:56.713371 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.95s]
[0m21:49:56.713371 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:49:56.713371 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:49:56.729060 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m21:49:56.732023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m21:49:56.732023 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:49:56.737353 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:49:56.737353 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 21:49:56.733074 => 21:49:56.737353
[0m21:49:56.737353 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:49:56.737353 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:49:56.745805 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:49:56.746860 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m21:49:56.747871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:57.539592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:49:57.545785 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 21:49:56.737353 => 21:49:57.544780
[0m21:49:57.546829 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m21:49:57.699354 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.97s]
[0m21:49:57.701353 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:49:57.703314 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:49:57.704313 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m21:49:57.706313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m21:49:57.708847 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:49:57.715624 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:49:57.716221 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 21:49:57.708847 => 21:49:57.716221
[0m21:49:57.716221 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:49:57.716221 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:49:57.716221 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:49:57.716221 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m21:49:57.716221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:58.473921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:49:58.480462 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 21:49:57.716221 => 21:49:58.480462
[0m21:49:58.480462 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m21:49:58.644276 [info ] [Thread-1 (]: 4 of 5 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 0.94s]
[0m21:49:58.647345 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:49:58.648229 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m21:49:58.649054 [info ] [Thread-1 (]: 5 of 5 START test value_test ................................................... [RUN]
[0m21:49:58.651144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m21:49:58.652189 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m21:49:58.659186 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 21:49:58.653183 => 21:49:58.658139
[0m21:49:58.665182 [debug] [Thread-1 (]: Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:49:58.666591 [error] [Thread-1 (]: 5 of 5 ERROR value_test ........................................................ [[31mERROR[0m in 0.02s]
[0m21:49:58.669516 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m21:49:58.672550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:58.673526 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:49:58.674534 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m21:49:58.674665 [info ] [MainThread]: 
[0m21:49:58.674665 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m21:49:58.682099 [debug] [MainThread]: Command end result
[0m21:49:58.699459 [info ] [MainThread]: 
[0m21:49:58.699459 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:49:58.699459 [info ] [MainThread]: 
[0m21:49:58.699459 [error] [MainThread]:   Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:49:58.708995 [info ] [MainThread]: 
[0m21:49:58.711891 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:49:58.714921 [debug] [MainThread]: Command `dbt test` failed at 21:49:58.714921 after 6.30 seconds
[0m21:49:58.716829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879A751F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002879AA30C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287A32DFB10>]}
[0m21:49:58.717679 [debug] [MainThread]: Flushing usage events
[0m21:50:32.156943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013931E0DDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013931E0F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013931E0D310>]}


============================== 21:50:32.176797 | 9923d374-cfd5-4977-8e22-8edb9d3c8bf9 ==============================
[0m21:50:32.176797 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:50:32.179147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:50:32.835371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013933A537D0>]}
[0m21:50:32.935752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139339613D0>]}
[0m21:50:32.935752 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:50:32.964637 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:50:33.235571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:50:33.236658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:50:33.242641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013933AFBE90>]}
[0m21:50:33.252764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013933B94ED0>]}
[0m21:50:33.268360 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m21:50:33.268360 [info ] [MainThread]: 
[0m21:50:33.268360 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:50:33.268360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:50:33.290122 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:50:33.294874 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:50:33.296821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:34.378351 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:50:34.379621 [debug] [ThreadPool]: On list_storage: Close
[0m21:50:34.547042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:50:34.562379 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:50:34.562379 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:50:34.562379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:35.303865 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:50:35.303865 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:50:35.451282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013933B50150>]}
[0m21:50:35.451282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:35.451282 [info ] [MainThread]: 
[0m21:50:35.466807 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:50:35.468758 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:50:35.469839 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:50:35.479089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:50:35.481079 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:50:35.469839 => 21:50:35.481079
[0m21:50:35.481828 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:50:35.481828 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m21:50:35.481828 [info ] [Thread-1 (]: 1 of 11 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m21:50:35.481828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m21:50:35.481828 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m21:50:35.481828 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 21:50:35.481828 => 21:50:35.481828
[0m21:50:35.481828 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m21:50:35.599647 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:50:35.600660 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m21:50:35.601686 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:50:36.363310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:50:36.363310 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:50:36.363310 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m21:50:36.628435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:50:36.629821 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:50:36.629821 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m21:50:36.861648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:50:36.877338 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:50:36.877338 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m21:50:36.982885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:50:36.982885 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:50:36.982885 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m21:50:37.669914 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 1.0 seconds
[0m21:50:37.670914 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:50:37.670914 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m21:50:38.008518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:50:38.016517 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m21:50:38.036418 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 21:50:35.481828 => 21:50:38.036418
[0m21:50:38.036418 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m21:50:38.253732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013933BF81D0>]}
[0m21:50:38.253732 [info ] [Thread-1 (]: 1 of 11 OK loaded seed file dfb.seed_nfl_teams ................................. [[32mINSERT 31[0m in 2.77s]
[0m21:50:38.253732 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m21:50:38.253732 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:50:38.253732 [info ] [Thread-1 (]: 2 of 11 START sql view model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m21:50:38.270706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m21:50:38.271222 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:50:38.298488 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:50:38.300059 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:50:38.272274 => 21:50:38.300059
[0m21:50:38.301126 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:50:38.320612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:50:38.330114 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:50:38.332171 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Player_ID
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from A
  );
[0m21:50:38.333109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:39.304783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:50:39.304783 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:50:38.302126 => 21:50:39.304783
[0m21:50:39.304783 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:50:39.446423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139342108D0>]}
[0m21:50:39.446423 [info ] [Thread-1 (]: 2 of 11 OK created sql view model dfb.dim_dfb_nfl_data ......................... [[32mSUCCESS 1[0m in 1.18s]
[0m21:50:39.446423 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:50:39.446423 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:50:39.446423 [info ] [Thread-1 (]: 3 of 11 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m21:50:39.457525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:50:39.458610 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:50:39.464537 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:50:39.466534 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:50:39.458610 => 21:50:39.465607
[0m21:50:39.467537 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:50:39.473842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:50:39.473842 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:50:39.473842 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m21:50:39.473842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:40.530031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:50:40.530031 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:50:39.469788 => 21:50:40.530031
[0m21:50:40.530031 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:50:40.681750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139342128D0>]}
[0m21:50:40.682747 [info ] [Thread-1 (]: 3 of 11 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 1.24s]
[0m21:50:40.684749 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:50:40.685809 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m21:50:40.686760 [info ] [Thread-1 (]: 4 of 11 START sql view model dfb.stg_nfl_teams ................................. [RUN]
[0m21:50:40.690208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m21:50:40.691273 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m21:50:40.696217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m21:50:40.697219 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 21:50:40.691273 => 21:50:40.697219
[0m21:50:40.698217 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m21:50:40.703624 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m21:50:40.748330 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m21:50:40.748330 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m21:50:40.748330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:41.597495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:50:41.604569 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 21:50:40.699570 => 21:50:41.604569
[0m21:50:41.604569 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m21:50:41.763249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013934139510>]}
[0m21:50:41.763249 [info ] [Thread-1 (]: 4 of 11 OK created sql view model dfb.stg_nfl_teams ............................ [[32mSUCCESS 1[0m in 1.07s]
[0m21:50:41.763249 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m21:50:41.763249 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:50:41.763249 [info ] [Thread-1 (]: 5 of 11 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m21:50:41.777968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b)
[0m21:50:41.778986 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:50:41.800037 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:50:41.800037 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 21:50:41.779984 => 21:50:41.800037
[0m21:50:41.800037 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:50:41.819042 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:50:41.819042 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:50:41.828155 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m21:50:41.829166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:42.878976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:50:42.878976 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 21:50:41.800037 => 21:50:42.878976
[0m21:50:42.878976 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m21:50:43.073522 [info ] [Thread-1 (]: 5 of 11 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.31s]
[0m21:50:43.079272 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:50:43.079272 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:50:43.079272 [info ] [Thread-1 (]: 6 of 11 START test not_null_dim_dfb_nfl_data_date .............................. [RUN]
[0m21:50:43.085979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m21:50:43.087038 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:50:43.094767 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:50:43.096774 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 21:50:43.087038 => 21:50:43.096774
[0m21:50:43.097837 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:50:43.104398 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:50:43.105397 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:50:43.106402 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m21:50:43.107533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.894373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:50:43.897432 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 21:50:43.098780 => 21:50:43.897432
[0m21:50:43.899431 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m21:50:44.040064 [info ] [Thread-1 (]: 6 of 11 PASS not_null_dim_dfb_nfl_data_date .................................... [[32mPASS[0m in 0.96s]
[0m21:50:44.040064 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:50:44.040064 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:50:44.055689 [info ] [Thread-1 (]: 7 of 11 START test not_null_dim_dfb_nfl_data_name .............................. [RUN]
[0m21:50:44.058608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m21:50:44.059751 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:50:44.066274 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:50:44.066274 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 21:50:44.060686 => 21:50:44.066274
[0m21:50:44.066274 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:50:44.072306 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:50:44.074312 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:50:44.074312 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m21:50:44.075305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:44.879347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:50:44.898565 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 21:50:44.066274 => 21:50:44.898565
[0m21:50:44.899555 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m21:50:45.044935 [info ] [Thread-1 (]: 7 of 11 PASS not_null_dim_dfb_nfl_data_name .................................... [[32mPASS[0m in 0.98s]
[0m21:50:45.046023 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:50:45.046023 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:50:45.046023 [info ] [Thread-1 (]: 8 of 11 START test positive_value_dim_dfb_nfl_data_salary ...................... [RUN]
[0m21:50:45.046023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m21:50:45.046023 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:50:45.046023 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:50:45.046023 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 21:50:45.046023 => 21:50:45.046023
[0m21:50:45.046023 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:50:45.066155 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:50:45.068231 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:50:45.068231 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m21:50:45.068231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:45.813373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:50:45.813373 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 21:50:45.062049 => 21:50:45.813373
[0m21:50:45.813373 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m21:50:45.963010 [info ] [Thread-1 (]: 8 of 11 PASS positive_value_dim_dfb_nfl_data_salary ............................ [[32mPASS[0m in 0.92s]
[0m21:50:45.963010 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:50:45.963010 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m21:50:45.963010 [info ] [Thread-1 (]: 9 of 11 START test value_test .................................................. [RUN]
[0m21:50:45.963010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m21:50:45.963010 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m21:50:45.979358 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 21:50:45.963010 => 21:50:45.978181
[0m21:50:45.984555 [debug] [Thread-1 (]: Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:50:45.984555 [error] [Thread-1 (]: 9 of 11 ERROR value_test ....................................................... [[31mERROR[0m in 0.02s]
[0m21:50:45.984555 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m21:50:45.989260 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:50:45.990351 [info ] [Thread-1 (]: 10 of 11 START python table model dfb.py_nfl_data .............................. [RUN]
[0m21:50:45.992658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.value_test, now model.dfb_data.py_nfl_data)
[0m21:50:45.993703 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:50:46.023060 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:50:46.032593 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:50:45.994662 => 21:50:46.032593
[0m21:50:46.032593 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:50:46.065973 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:50:46.065973 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:50:46.065973 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:50:46.065973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:53.759452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 8.0 seconds
[0m21:50:53.759452 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:50:46.032593 => 21:50:53.759452
[0m21:50:53.759452 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:50:53.908489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013933B56C90>]}
[0m21:50:53.908489 [info ] [Thread-1 (]: 10 of 11 OK created python table model dfb.py_nfl_data ......................... [[32mSUCCESS 1[0m in 7.90s]
[0m21:50:53.908489 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:50:53.908489 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m21:50:53.908489 [info ] [Thread-1 (]: 11 of 11 START python table model dfb.fct_nfl_teams ............................ [RUN]
[0m21:50:53.919481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m21:50:53.920210 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m21:50:53.928100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m21:50:53.958830 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 21:50:53.921221 => 21:50:53.957743
[0m21:50:53.958830 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m21:50:53.967946 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m21:50:53.969923 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m21:50:53.970986 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m21:50:53.971956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:56.780594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:50:56.785585 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 21:50:53.958830 => 21:50:56.785585
[0m21:50:56.786585 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m21:50:56.910020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9923d374-cfd5-4977-8e22-8edb9d3c8bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139341C1390>]}
[0m21:50:56.910020 [info ] [Thread-1 (]: 11 of 11 OK created python table model dfb.fct_nfl_teams ....................... [[32mSUCCESS 1[0m in 3.00s]
[0m21:50:56.910020 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m21:50:56.910020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:56.910020 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:50:56.910020 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:50:56.910020 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m21:50:56.910020 [info ] [MainThread]: 
[0m21:50:56.926837 [info ] [MainThread]: Finished running 1 seed, 3 view models, 5 tests, 2 table models in 0 hours 0 minutes and 23.64 seconds (23.64s).
[0m21:50:56.929821 [debug] [MainThread]: Command end result
[0m21:50:56.968872 [info ] [MainThread]: 
[0m21:50:56.968872 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:50:56.968872 [info ] [MainThread]: 
[0m21:50:56.968872 [error] [MainThread]:   Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:50:56.968872 [info ] [MainThread]: 
[0m21:50:56.977477 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m21:50:56.982995 [debug] [MainThread]: Command `dbt build` failed at 21:50:56.981925 after 24.90 seconds
[0m21:50:56.983945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001392AFE1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013931E23DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001392B026A10>]}
[0m21:50:56.983945 [debug] [MainThread]: Flushing usage events
[0m21:51:50.716414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183502247D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001834FC9C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001835020AB50>]}


============================== 21:51:50.722410 | d8031e68-09af-49a2-9a17-e4ebc5d48242 ==============================
[0m21:51:50.722410 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:51:50.724455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:51:51.373530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8031e68-09af-49a2-9a17-e4ebc5d48242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018351D08A10>]}
[0m21:51:51.477717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8031e68-09af-49a2-9a17-e4ebc5d48242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018351D5E650>]}
[0m21:51:51.479028 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:51:51.501861 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:51:51.776851 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m21:51:51.778426 [debug] [MainThread]: Partial parsing: added file: dfb_data://macros\ppg_value.sql
[0m21:51:51.779492 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://macros\ppg.sql
[0m21:51:51.795094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8031e68-09af-49a2-9a17-e4ebc5d48242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018351ED11D0>]}
[0m21:51:51.810761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8031e68-09af-49a2-9a17-e4ebc5d48242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183520E0C90>]}
[0m21:51:51.810761 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m21:51:51.810761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8031e68-09af-49a2-9a17-e4ebc5d48242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018351D21550>]}
[0m21:51:51.810761 [info ] [MainThread]: 
[0m21:51:51.810761 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:51:51.810761 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:51:51.832894 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:51:51.832894 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:51:51.832894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:52.833022 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:51:52.837088 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:51:52.979337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8031e68-09af-49a2-9a17-e4ebc5d48242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018351EDC250>]}
[0m21:51:52.979337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:52.979337 [info ] [MainThread]: 
[0m21:51:52.979337 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:51:52.979337 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m21:51:52.994416 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m21:51:52.995564 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:51:53.015464 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:51:53.015464 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 21:51:52.996506 => 21:51:53.015464
[0m21:51:53.015464 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:51:53.053480 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:51:53.055401 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:51:53.055401 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m21:51:53.056921 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:51:53.930333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:51:53.942968 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 21:51:53.015464 => 21:51:53.941966
[0m21:51:53.943917 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m21:51:54.097693 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.12s]
[0m21:51:54.097693 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:51:54.097693 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:51:54.097693 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m21:51:54.108564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m21:51:54.109645 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:51:54.116523 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:51:54.116523 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 21:51:54.110676 => 21:51:54.116523
[0m21:51:54.116523 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:51:54.116523 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:51:54.129190 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:51:54.130633 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m21:51:54.133797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:54.863144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:51:54.863144 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 21:51:54.116523 => 21:51:54.863144
[0m21:51:54.863144 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m21:51:55.019121 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.92s]
[0m21:51:55.021710 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:51:55.022747 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:51:55.024725 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m21:51:55.026707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m21:51:55.027718 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:51:55.036706 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:51:55.038708 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 21:51:55.028653 => 21:51:55.037703
[0m21:51:55.039653 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:51:55.042699 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:51:55.044660 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:51:55.045657 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m21:51:55.047257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:55.763416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:51:55.763416 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 21:51:55.039653 => 21:51:55.763416
[0m21:51:55.763416 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m21:51:55.896719 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.87s]
[0m21:51:55.896719 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:51:55.896719 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:51:55.896719 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m21:51:55.896719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m21:51:55.896719 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:51:55.914579 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:51:55.916565 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 21:51:55.896719 => 21:51:55.916565
[0m21:51:55.917602 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:51:55.921582 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:51:55.923547 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:51:55.923547 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m21:51:55.924543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:56.659131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:51:56.664946 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 21:51:55.918623 => 21:51:56.664946
[0m21:51:56.664946 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m21:51:56.796042 [info ] [Thread-1 (]: 4 of 5 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 0.90s]
[0m21:51:56.812582 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:51:56.812582 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m21:51:56.812582 [info ] [Thread-1 (]: 5 of 5 START test value_test ................................................... [RUN]
[0m21:51:56.817769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m21:51:56.818854 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m21:51:56.823007 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 21:51:56.819822 => 21:51:56.823007
[0m21:51:56.833226 [debug] [Thread-1 (]: Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:51:56.834230 [error] [Thread-1 (]: 5 of 5 ERROR value_test ........................................................ [[31mERROR[0m in 0.02s]
[0m21:51:56.836172 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m21:51:56.840233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:56.841231 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:51:56.842172 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m21:51:56.843236 [info ] [MainThread]: 
[0m21:51:56.845172 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m21:51:56.849306 [debug] [MainThread]: Command end result
[0m21:51:56.867525 [info ] [MainThread]: 
[0m21:51:56.869452 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:51:56.871482 [info ] [MainThread]: 
[0m21:51:56.872498 [error] [MainThread]:   Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:51:56.874590 [info ] [MainThread]: 
[0m21:51:56.876103 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:51:56.878153 [debug] [MainThread]: Command `dbt test` failed at 21:51:56.878153 after 6.25 seconds
[0m21:51:56.881200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018349311F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001834FD8DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001834FC9BBD0>]}
[0m21:51:56.883183 [debug] [MainThread]: Flushing usage events
[0m21:52:37.867261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC47FDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC479EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC47C5490>]}


============================== 21:52:37.869270 | 71959622-9142-4111-98f8-8c081e7df150 ==============================
[0m21:52:37.869270 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:52:37.869270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m21:52:38.495486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC483A110>]}
[0m21:52:38.595521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC52FF310>]}
[0m21:52:38.595521 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:52:38.631010 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:52:38.905186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:52:38.905186 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:52:38.905186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC6634D10>]}
[0m21:52:38.920831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC6524E50>]}
[0m21:52:38.936455 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m21:52:38.936455 [info ] [MainThread]: 
[0m21:52:38.936455 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:52:38.936455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:52:38.963352 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:52:38.964396 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:52:38.965423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:40.029926 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:52:40.029926 [debug] [ThreadPool]: On list_storage: Close
[0m21:52:40.222928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:52:40.229192 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:52:40.229192 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:52:40.229192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:41.035480 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:52:41.035480 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:52:41.200422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC6454910>]}
[0m21:52:41.202386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:52:41.203338 [info ] [MainThread]: 
[0m21:52:41.209443 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:52:41.211777 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:52:41.213005 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:52:41.218125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:52:41.218125 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:52:41.214057 => 21:52:41.218125
[0m21:52:41.218125 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:52:41.218125 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m21:52:41.218125 [info ] [Thread-1 (]: 1 of 11 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m21:52:41.228751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m21:52:41.229801 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m21:52:41.230811 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 21:52:41.230811 => 21:52:41.230811
[0m21:52:41.231806 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m21:52:41.272942 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:52:41.272942 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m21:52:41.272942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:52:41.996852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:52:41.996852 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:52:41.996852 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m21:52:42.230554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:52:42.246445 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:52:42.246445 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m21:52:42.548217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:52:42.566576 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:52:42.567563 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m21:52:42.660499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:52:42.676081 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:52:42.676081 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m21:52:42.960308 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.0 seconds
[0m21:52:42.976844 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:52:42.976844 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m21:52:43.177507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:52:43.178719 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m21:52:43.194387 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 21:52:41.232797 => 21:52:43.194387
[0m21:52:43.194387 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m21:52:43.328530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC658A090>]}
[0m21:52:43.345048 [info ] [Thread-1 (]: 1 of 11 OK loaded seed file dfb.seed_nfl_teams ................................. [[32mINSERT 31[0m in 2.11s]
[0m21:52:43.346906 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m21:52:43.347964 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:52:43.349958 [info ] [Thread-1 (]: 2 of 11 START sql view model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m21:52:43.351720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m21:52:43.352730 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:52:43.378994 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:52:43.381967 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:52:43.352730 => 21:52:43.380911
[0m21:52:43.384924 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:52:43.397528 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:52:43.412628 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:52:43.413749 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Player_ID
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from A
  );
[0m21:52:43.413749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:44.330065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:52:44.345540 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:52:43.384924 => 21:52:44.345540
[0m21:52:44.345540 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:52:44.479288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC6BA1F50>]}
[0m21:52:44.479288 [info ] [Thread-1 (]: 2 of 11 OK created sql view model dfb.dim_dfb_nfl_data ......................... [[32mSUCCESS 1[0m in 1.13s]
[0m21:52:44.479288 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:52:44.479288 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:52:44.479288 [info ] [Thread-1 (]: 3 of 11 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m21:52:44.495620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:52:44.496643 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:52:44.500925 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:52:44.500925 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:52:44.497683 => 21:52:44.500925
[0m21:52:44.500925 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:52:44.500925 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:52:44.500925 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:52:44.511482 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m21:52:44.512494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:45.580229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:52:45.580229 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:52:44.500925 => 21:52:45.580229
[0m21:52:45.580229 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:52:45.745094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC6ABD950>]}
[0m21:52:45.746191 [info ] [Thread-1 (]: 3 of 11 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 1.25s]
[0m21:52:45.746191 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:52:45.746191 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m21:52:45.746191 [info ] [Thread-1 (]: 4 of 11 START sql view model dfb.stg_nfl_teams ................................. [RUN]
[0m21:52:45.754665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m21:52:45.755683 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m21:52:45.759798 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m21:52:45.759798 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 21:52:45.755683 => 21:52:45.759798
[0m21:52:45.764374 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m21:52:45.768772 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m21:52:45.772253 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m21:52:45.773243 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m21:52:45.774244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:46.663825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:52:46.669971 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 21:52:45.764374 => 21:52:46.669971
[0m21:52:46.670924 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m21:52:46.813431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC6ABD950>]}
[0m21:52:46.813431 [info ] [Thread-1 (]: 4 of 11 OK created sql view model dfb.stg_nfl_teams ............................ [[32mSUCCESS 1[0m in 1.07s]
[0m21:52:46.813431 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m21:52:46.813431 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:52:46.813431 [info ] [Thread-1 (]: 5 of 11 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m21:52:46.813431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b)
[0m21:52:46.813431 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:52:46.835458 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:52:46.846956 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 21:52:46.813431 => 21:52:46.845950
[0m21:52:46.848011 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:52:46.872902 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:52:46.874858 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:52:46.875903 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m21:52:46.875903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:47.639689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:52:47.645533 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 21:52:46.849026 => 21:52:47.645054
[0m21:52:47.645533 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m21:52:47.796879 [info ] [Thread-1 (]: 5 of 11 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.98s]
[0m21:52:47.884322 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:52:47.884322 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:52:47.884322 [info ] [Thread-1 (]: 6 of 11 START test not_null_dim_dfb_nfl_data_date .............................. [RUN]
[0m21:52:47.896885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m21:52:47.897877 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:52:47.899515 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:52:47.899515 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 21:52:47.899515 => 21:52:47.899515
[0m21:52:47.899515 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:52:47.914577 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:52:47.916550 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:52:47.916550 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m21:52:47.917555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:48.691954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:52:48.698824 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 21:52:47.899515 => 21:52:48.697840
[0m21:52:48.698824 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m21:52:48.829871 [info ] [Thread-1 (]: 6 of 11 PASS not_null_dim_dfb_nfl_data_date .................................... [[32mPASS[0m in 0.93s]
[0m21:52:48.829871 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:52:48.829871 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:52:48.845502 [info ] [Thread-1 (]: 7 of 11 START test not_null_dim_dfb_nfl_data_name .............................. [RUN]
[0m21:52:48.847862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m21:52:48.848926 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:52:48.853196 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:52:48.853196 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 21:52:48.849868 => 21:52:48.853196
[0m21:52:48.853196 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:52:48.853196 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:52:48.862924 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:52:48.863942 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m21:52:48.864941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:49.596964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:52:49.613179 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 21:52:48.853196 => 21:52:49.613179
[0m21:52:49.613179 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m21:52:49.768163 [info ] [Thread-1 (]: 7 of 11 PASS not_null_dim_dfb_nfl_data_name .................................... [[32mPASS[0m in 0.92s]
[0m21:52:49.771185 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:52:49.772206 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:52:49.773282 [info ] [Thread-1 (]: 8 of 11 START test positive_value_dim_dfb_nfl_data_salary ...................... [RUN]
[0m21:52:49.776019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m21:52:49.777059 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:52:49.789636 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:52:49.791637 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 21:52:49.778014 => 21:52:49.790635
[0m21:52:49.791637 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:52:49.797519 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:52:49.800496 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:52:49.801486 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m21:52:49.801486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:50.613069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:52:50.613069 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 21:52:49.792712 => 21:52:50.613069
[0m21:52:50.613069 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m21:52:50.763727 [info ] [Thread-1 (]: 8 of 11 PASS positive_value_dim_dfb_nfl_data_salary ............................ [[32mPASS[0m in 0.99s]
[0m21:52:50.763727 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:52:50.763727 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m21:52:50.763727 [info ] [Thread-1 (]: 9 of 11 START test value_test .................................................. [RUN]
[0m21:52:50.763727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m21:52:50.778164 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m21:52:50.784023 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 21:52:50.778842 => 21:52:50.784023
[0m21:52:50.789762 [debug] [Thread-1 (]: Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:52:50.789762 [error] [Thread-1 (]: 9 of 11 ERROR value_test ....................................................... [[31mERROR[0m in 0.03s]
[0m21:52:50.789762 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m21:52:50.789762 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:52:50.795829 [info ] [Thread-1 (]: 10 of 11 START python table model dfb.py_nfl_data .............................. [RUN]
[0m21:52:50.797846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.value_test, now model.dfb_data.py_nfl_data)
[0m21:52:50.797846 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:52:50.815340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:52:50.815340 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:52:50.798807 => 21:52:50.815340
[0m21:52:50.828166 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:52:50.858185 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:52:50.861479 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:52:50.862488 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:52:50.863477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:53.520249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:52:53.539111 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:52:50.829181 => 21:52:53.538030
[0m21:52:53.540002 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:52:53.697208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC658A110>]}
[0m21:52:53.697208 [info ] [Thread-1 (]: 10 of 11 OK created python table model dfb.py_nfl_data ......................... [[32mSUCCESS 1[0m in 2.90s]
[0m21:52:53.697208 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:52:53.697208 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m21:52:53.697208 [info ] [Thread-1 (]: 11 of 11 START python table model dfb.fct_nfl_teams ............................ [RUN]
[0m21:52:53.707420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m21:52:53.708136 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m21:52:53.712275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m21:52:53.712275 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 21:52:53.709213 => 21:52:53.712275
[0m21:52:53.712275 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m21:52:53.712275 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m21:52:53.712275 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m21:52:53.712275 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m21:52:53.727789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:52:56.335723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:52:56.335723 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 21:52:53.712275 => 21:52:56.335723
[0m21:52:56.335723 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m21:52:56.479524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71959622-9142-4111-98f8-8c081e7df150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC6C07C50>]}
[0m21:52:56.480524 [info ] [Thread-1 (]: 11 of 11 OK created python table model dfb.fct_nfl_teams ....................... [[32mSUCCESS 1[0m in 2.77s]
[0m21:52:56.482542 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m21:52:56.485165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:56.486169 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:52:56.487145 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:52:56.488107 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m21:52:56.489107 [info ] [MainThread]: 
[0m21:52:56.490937 [info ] [MainThread]: Finished running 1 seed, 3 view models, 5 tests, 2 table models in 0 hours 0 minutes and 17.55 seconds (17.55s).
[0m21:52:56.494759 [debug] [MainThread]: Command end result
[0m21:52:56.512492 [info ] [MainThread]: 
[0m21:52:56.514488 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:52:56.515485 [info ] [MainThread]: 
[0m21:52:56.517987 [error] [MainThread]:   Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:52:56.520017 [info ] [MainThread]: 
[0m21:52:56.522995 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m21:52:56.525066 [debug] [MainThread]: Command `dbt build` failed at 21:52:56.525066 after 18.74 seconds
[0m21:52:56.526132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FBD8A1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FC47EDD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FBD8E7AD0>]}
[0m21:52:56.526132 [debug] [MainThread]: Flushing usage events
[0m21:54:08.729687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002400E505ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002400E8FB390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002400E8FA4D0>]}


============================== 21:54:08.729687 | 62186433-ff07-4a94-bca2-007ba2224630 ==============================
[0m21:54:08.729687 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:54:08.729687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m21:54:09.366720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240104E1910>]}
[0m21:54:09.469066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002400F42F310>]}
[0m21:54:09.470722 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:54:09.496913 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:54:09.744777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:09.744777 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\value_test.sql
[0m21:54:09.911454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024010553A50>]}
[0m21:54:09.927651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240107DE350>]}
[0m21:54:09.927651 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m21:54:09.927651 [info ] [MainThread]: 
[0m21:54:09.927651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:54:09.927651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:54:09.949768 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:54:09.949768 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:54:09.956277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:10.934875 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:54:10.937951 [debug] [ThreadPool]: On list_storage: Close
[0m21:54:11.079786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:54:11.079786 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:54:11.079786 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:54:11.079786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:11.862565 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:54:11.879042 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:54:12.010751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024010A53A50>]}
[0m21:54:12.027508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:54:12.029410 [info ] [MainThread]: 
[0m21:54:12.036268 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m21:54:12.038242 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m21:54:12.038242 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m21:54:12.048655 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m21:54:12.050902 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 21:54:12.039247 => 21:54:12.050264
[0m21:54:12.052139 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m21:54:12.052139 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m21:54:12.052139 [info ] [Thread-1 (]: 1 of 11 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m21:54:12.052139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m21:54:12.060157 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m21:54:12.060157 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 21:54:12.060157 => 21:54:12.060157
[0m21:54:12.061527 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m21:54:12.098051 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:54:12.098051 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m21:54:12.098051 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:54:12.813742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:54:12.813742 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:54:12.813742 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m21:54:13.029342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:54:13.029342 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:54:13.044834 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m21:54:13.247792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:54:13.262451 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:54:13.262451 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m21:54:13.381384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:54:13.381384 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:54:13.381384 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m21:54:13.645737 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.0 seconds
[0m21:54:13.661405 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:54:13.662877 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m21:54:13.879995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:54:13.879995 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m21:54:13.911293 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 21:54:12.062540 => 21:54:13.911293
[0m21:54:13.911293 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m21:54:14.041750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024010B32310>]}
[0m21:54:14.041750 [info ] [Thread-1 (]: 1 of 11 OK loaded seed file dfb.seed_nfl_teams ................................. [[32mINSERT 31[0m in 1.99s]
[0m21:54:14.041750 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m21:54:14.041750 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:54:14.041750 [info ] [Thread-1 (]: 2 of 11 START sql view model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m21:54:14.055569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m21:54:14.057418 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:54:14.082076 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:54:14.082076 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:54:14.057418 => 21:54:14.082076
[0m21:54:14.082076 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:54:14.112389 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:54:14.112389 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:54:14.112389 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Player_ID
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from A
  );
[0m21:54:14.112389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:15.095660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:54:15.112825 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:54:14.082076 => 21:54:15.112825
[0m21:54:15.112825 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:54:15.267421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002401074B090>]}
[0m21:54:15.279129 [info ] [Thread-1 (]: 2 of 11 OK created sql view model dfb.dim_dfb_nfl_data ......................... [[32mSUCCESS 1[0m in 1.23s]
[0m21:54:15.279129 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:54:15.279129 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:54:15.279129 [info ] [Thread-1 (]: 3 of 11 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m21:54:15.286892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:54:15.287962 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:54:15.292216 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:54:15.295869 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:54:15.287962 => 21:54:15.295869
[0m21:54:15.296870 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:54:15.303489 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:54:15.305447 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:54:15.306496 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m21:54:15.306770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:16.380483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:54:16.380483 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:54:15.297882 => 21:54:16.380483
[0m21:54:16.380483 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:54:16.527972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024010B22E50>]}
[0m21:54:16.529799 [info ] [Thread-1 (]: 3 of 11 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 1.25s]
[0m21:54:16.532431 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:54:16.533488 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m21:54:16.535433 [info ] [Thread-1 (]: 4 of 11 START sql view model dfb.stg_nfl_teams ................................. [RUN]
[0m21:54:16.537423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m21:54:16.538476 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m21:54:16.543470 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m21:54:16.544491 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 21:54:16.539462 => 21:54:16.543470
[0m21:54:16.546444 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m21:54:16.551437 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m21:54:16.554448 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m21:54:16.555461 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m21:54:16.555461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:17.492118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:54:17.496016 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 21:54:16.546444 => 21:54:17.496016
[0m21:54:17.496016 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m21:54:17.629107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240109AAB50>]}
[0m21:54:17.629107 [info ] [Thread-1 (]: 4 of 11 OK created sql view model dfb.stg_nfl_teams ............................ [[32mSUCCESS 1[0m in 1.09s]
[0m21:54:17.644854 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m21:54:17.645448 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:54:17.645448 [info ] [Thread-1 (]: 5 of 11 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m21:54:17.650290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b)
[0m21:54:17.650290 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:54:17.670915 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:54:17.687131 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 21:54:17.651352 => 21:54:17.685108
[0m21:54:17.713261 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:54:17.729473 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:54:17.729473 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:54:17.729473 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m21:54:17.729473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:18.513040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:54:18.529280 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 21:54:17.713261 => 21:54:18.529280
[0m21:54:18.529280 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m21:54:18.679691 [info ] [Thread-1 (]: 5 of 11 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.03s]
[0m21:54:18.679691 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:54:18.679691 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:54:18.679691 [info ] [Thread-1 (]: 6 of 11 START test not_null_dim_dfb_nfl_data_date .............................. [RUN]
[0m21:54:18.690097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m21:54:18.691113 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:54:18.700958 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:54:18.704141 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 21:54:18.691113 => 21:54:18.704141
[0m21:54:18.705154 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:54:18.707400 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:54:18.711521 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:54:18.712564 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m21:54:18.715464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:19.540888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:54:19.542874 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 21:54:18.706156 => 21:54:19.542874
[0m21:54:19.543938 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m21:54:19.696435 [info ] [Thread-1 (]: 6 of 11 PASS not_null_dim_dfb_nfl_data_date .................................... [[32mPASS[0m in 1.02s]
[0m21:54:19.696435 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:54:19.696435 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:54:19.696435 [info ] [Thread-1 (]: 7 of 11 START test not_null_dim_dfb_nfl_data_name .............................. [RUN]
[0m21:54:19.706997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m21:54:19.707894 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:54:19.713905 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:54:19.716314 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 21:54:19.708959 => 21:54:19.715905
[0m21:54:19.716314 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:54:19.716314 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:54:19.716314 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:54:19.716314 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m21:54:19.716314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:20.513528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:54:20.513528 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 21:54:19.716314 => 21:54:20.513528
[0m21:54:20.513528 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m21:54:20.663301 [info ] [Thread-1 (]: 7 of 11 PASS not_null_dim_dfb_nfl_data_name .................................... [[32mPASS[0m in 0.97s]
[0m21:54:20.663301 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:54:20.679079 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:54:20.679079 [info ] [Thread-1 (]: 8 of 11 START test positive_value_dim_dfb_nfl_data_salary ...................... [RUN]
[0m21:54:20.683560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m21:54:20.684572 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:54:20.688889 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:54:20.688889 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 21:54:20.684572 => 21:54:20.688889
[0m21:54:20.688889 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:54:20.699132 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:54:20.702095 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:54:20.703095 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m21:54:20.704138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:21.547258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:54:21.551054 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 21:54:20.688889 => 21:54:21.551054
[0m21:54:21.552050 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m21:54:21.729559 [info ] [Thread-1 (]: 8 of 11 PASS positive_value_dim_dfb_nfl_data_salary ............................ [[32mPASS[0m in 1.05s]
[0m21:54:21.730178 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:54:21.730178 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m21:54:21.730178 [info ] [Thread-1 (]: 9 of 11 START test value_test .................................................. [RUN]
[0m21:54:21.730178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m21:54:21.730178 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m21:54:21.744909 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 21:54:21.730178 => 21:54:21.730178
[0m21:54:21.751260 [debug] [Thread-1 (]: Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:54:21.752260 [error] [Thread-1 (]: 9 of 11 ERROR value_test ....................................................... [[31mERROR[0m in 0.02s]
[0m21:54:21.754278 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m21:54:21.755318 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:54:21.757255 [info ] [Thread-1 (]: 10 of 11 START python table model dfb.py_nfl_data .............................. [RUN]
[0m21:54:21.758867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.value_test, now model.dfb_data.py_nfl_data)
[0m21:54:21.760022 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:54:21.785889 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:54:21.785889 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:54:21.760022 => 21:54:21.785889
[0m21:54:21.785889 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:54:21.816528 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:54:21.816528 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:54:21.816528 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:54:21.816528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:24.575352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:54:24.585362 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:54:21.785889 => 21:54:24.585362
[0m21:54:24.585362 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:54:24.735078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024010E2A1D0>]}
[0m21:54:24.737097 [info ] [Thread-1 (]: 10 of 11 OK created python table model dfb.py_nfl_data ......................... [[32mSUCCESS 1[0m in 2.98s]
[0m21:54:24.739050 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:54:24.740106 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m21:54:24.741045 [info ] [Thread-1 (]: 11 of 11 START python table model dfb.fct_nfl_teams ............................ [RUN]
[0m21:54:24.743206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m21:54:24.743206 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m21:54:24.743206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m21:54:24.743206 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 21:54:24.743206 => 21:54:24.743206
[0m21:54:24.743206 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m21:54:24.743206 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m21:54:24.743206 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m21:54:24.759938 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m21:54:24.761030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:27.624584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:54:27.624584 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 21:54:24.743206 => 21:54:27.624584
[0m21:54:27.640290 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m21:54:27.817712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62186433-ff07-4a94-bca2-007ba2224630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024010D26A50>]}
[0m21:54:27.820728 [info ] [Thread-1 (]: 11 of 11 OK created python table model dfb.fct_nfl_teams ....................... [[32mSUCCESS 1[0m in 3.07s]
[0m21:54:27.823711 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m21:54:27.827164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:27.828173 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:54:27.829189 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:54:27.829189 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m21:54:27.830124 [info ] [MainThread]: 
[0m21:54:27.832454 [info ] [MainThread]: Finished running 1 seed, 3 view models, 5 tests, 2 table models in 0 hours 0 minutes and 17.90 seconds (17.90s).
[0m21:54:27.837403 [debug] [MainThread]: Command end result
[0m21:54:27.854763 [info ] [MainThread]: 
[0m21:54:27.854763 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:54:27.861535 [info ] [MainThread]: 
[0m21:54:27.863546 [error] [MainThread]:   Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:54:27.865471 [info ] [MainThread]: 
[0m21:54:27.865471 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m21:54:27.911463 [debug] [MainThread]: Command `dbt build` failed at 21:54:27.911463 after 19.27 seconds
[0m21:54:27.913476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002400E8FA650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024007A31FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002400E8DB450>]}
[0m21:54:27.914490 [debug] [MainThread]: Flushing usage events
[0m21:55:18.343201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F1545FDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F1545FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F1545ED10>]}


============================== 21:55:18.358822 | fdfd712f-2198-438e-828c-cc14071e97fc ==============================
[0m21:55:18.358822 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:55:18.358822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:55:18.541708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdfd712f-2198-438e-828c-cc14071e97fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F154C0E50>]}
[0m21:55:18.839731 [debug] [MainThread]: Set downloads directory='C:\Users\harol\AppData\Local\Temp\dbt-downloads-inrrbovg'
[0m21:55:18.839731 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:55:19.113452 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:55:19.113452 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:55:19.229337 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:55:19.229337 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m21:55:19.380368 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m21:55:19.380368 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:55:19.483942 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:55:19.488484 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:55:20.178684 [info ] [MainThread]: Installed from version 1.3.0
[0m21:55:20.178684 [info ] [MainThread]: Up to date!
[0m21:55:20.178684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fdfd712f-2198-438e-828c-cc14071e97fc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F155D3690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F1558D750>]}
[0m21:55:20.178684 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m21:55:21.551124 [info ] [MainThread]: Installed from version 0.10.1
[0m21:55:21.552127 [info ] [MainThread]: Updated version available: 0.10.4
[0m21:55:21.553126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fdfd712f-2198-438e-828c-cc14071e97fc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F1564F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F1564D550>]}
[0m21:55:21.554128 [info ] [MainThread]: Installing calogica/dbt_date
[0m21:55:21.809242 [info ] [MainThread]: Installed from version 0.10.1
[0m21:55:21.809242 [info ] [MainThread]: Up to date!
[0m21:55:21.809242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fdfd712f-2198-438e-828c-cc14071e97fc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F154DC790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F155E2D50>]}
[0m21:55:21.809242 [info ] [MainThread]: 
[0m21:55:21.818746 [info ] [MainThread]: Updates available for packages: ['calogica/dbt_expectations']                 
Update your versions in packages.yml, then run dbt deps
[0m21:55:21.830428 [debug] [MainThread]: Command `dbt deps` succeeded at 21:55:21.830428 after 3.57 seconds
[0m21:55:21.830428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E581FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F0E854C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F14F3C590>]}
[0m21:55:21.830428 [debug] [MainThread]: Flushing usage events
[0m21:56:02.420302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C7300B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C729E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C72F3950>]}


============================== 21:56:02.435939 | f7c7d8f1-3096-4d8e-b9dd-051e22d868d3 ==============================
[0m21:56:02.435939 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:56:02.435939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:56:03.069318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7c7d8f1-3096-4d8e-b9dd-051e22d868d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C72D28D0>]}
[0m21:56:03.187262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7c7d8f1-3096-4d8e-b9dd-051e22d868d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C731DA50>]}
[0m21:56:03.187262 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:56:03.275709 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:56:04.340494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:56:04.340494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:56:04.344981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7c7d8f1-3096-4d8e-b9dd-051e22d868d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C91D2150>]}
[0m21:56:04.367629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7c7d8f1-3096-4d8e-b9dd-051e22d868d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C9023A90>]}
[0m21:56:04.368630 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m21:56:04.369550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7c7d8f1-3096-4d8e-b9dd-051e22d868d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C8EE2310>]}
[0m21:56:04.370725 [info ] [MainThread]: 
[0m21:56:04.370725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:56:04.370725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:56:04.393407 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:56:04.394819 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:56:04.396369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:05.471633 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:56:05.471633 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:56:05.635723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7c7d8f1-3096-4d8e-b9dd-051e22d868d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C8FC2610>]}
[0m21:56:05.652259 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:56:05.654240 [info ] [MainThread]: 
[0m21:56:05.660843 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:56:05.661905 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m21:56:05.664914 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m21:56:05.665925 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:56:05.686800 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:56:05.686800 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 21:56:05.666903 => 21:56:05.686800
[0m21:56:05.694846 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:56:05.714855 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:56:05.714855 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m21:56:05.714855 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m21:56:05.714855 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:56:06.453853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:56:06.461942 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 21:56:05.694846 => 21:56:06.461942
[0m21:56:06.461942 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m21:56:06.600610 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.94s]
[0m21:56:06.615127 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m21:56:06.616703 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:56:06.619925 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m21:56:06.623444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m21:56:06.624446 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:56:06.635487 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:56:06.637500 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 21:56:06.625444 => 21:56:06.636836
[0m21:56:06.638515 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:56:06.641511 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:56:06.642617 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:56:06.644951 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m21:56:06.646987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:56:07.370499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:56:07.388002 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 21:56:06.638515 => 21:56:07.386939
[0m21:56:07.388998 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m21:56:07.544717 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.92s]
[0m21:56:07.544717 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:56:07.544717 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:56:07.544717 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m21:56:07.555997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m21:56:07.557669 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:56:07.567042 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:56:07.568040 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 21:56:07.558359 => 21:56:07.568040
[0m21:56:07.569001 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:56:07.570125 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:56:07.570125 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:56:07.570125 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m21:56:07.570125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:56:08.300623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:56:08.319633 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 21:56:07.570125 => 21:56:08.319633
[0m21:56:08.319633 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m21:56:08.470112 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.93s]
[0m21:56:08.470112 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:56:08.470112 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:56:08.470112 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m21:56:08.478189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m21:56:08.480311 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:56:08.486619 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:56:08.486619 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 21:56:08.481313 => 21:56:08.486619
[0m21:56:08.486619 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:56:08.486619 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:56:08.494902 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"
[0m21:56:08.497081 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 salary < 1

      
    ) dbt_internal_test
[0m21:56:08.498881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:56:09.335630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:56:09.336825 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (execute): 21:56:08.486619 => 21:56:09.336825
[0m21:56:09.336825 [debug] [Thread-1 (]: On test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1: Close
[0m21:56:09.485147 [info ] [Thread-1 (]: 4 of 5 PASS positive_value_dim_dfb_nfl_data_salary ............................. [[32mPASS[0m in 1.02s]
[0m21:56:09.500621 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m21:56:09.500621 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m21:56:09.500621 [info ] [Thread-1 (]: 5 of 5 START test value_test ................................................... [RUN]
[0m21:56:09.507529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m21:56:09.508541 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m21:56:09.514293 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 21:56:09.509828 => 21:56:09.514293
[0m21:56:09.523218 [debug] [Thread-1 (]: Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:56:09.524255 [error] [Thread-1 (]: 5 of 5 ERROR value_test ........................................................ [[31mERROR[0m in 0.02s]
[0m21:56:09.526135 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m21:56:09.530281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:09.531627 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:56:09.533612 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m21:56:09.534587 [info ] [MainThread]: 
[0m21:56:09.535625 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m21:56:09.537821 [debug] [MainThread]: Command end result
[0m21:56:09.554171 [info ] [MainThread]: 
[0m21:56:09.559337 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:56:09.561351 [info ] [MainThread]: 
[0m21:56:09.562352 [error] [MainThread]:   Compilation Error in test value_test (tests\value_test.sql)
  'ppg_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:56:09.565726 [info ] [MainThread]: 
[0m21:56:09.567743 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m21:56:09.569777 [debug] [MainThread]: Command `dbt test` failed at 21:56:09.569777 after 7.23 seconds
[0m21:56:09.570906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C0391F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C03D75D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184C72A8750>]}
[0m21:56:09.570906 [debug] [MainThread]: Flushing usage events
[0m22:01:57.444636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AC51D9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AC51CD490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AC51CD1D0>]}


============================== 22:01:57.459165 | 9f4f1879-41eb-48a9-8dba-c7259f03dc4b ==============================
[0m22:01:57.459165 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:01:57.459165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_dat', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:01:58.041978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f4f1879-41eb-48a9-8dba-c7259f03dc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AC6D53CD0>]}
[0m22:01:58.141289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f4f1879-41eb-48a9-8dba-c7259f03dc4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AC5D39950>]}
[0m22:01:58.141289 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:01:58.195187 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:01:58.480336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:01:58.482376 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m22:01:58.482376 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\positive_value.sql
[0m22:01:58.483403 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\ppg_value.sql
[0m22:01:58.484441 [error] [MainThread]: Encountered an error:
Compilation Error
  Reached EOF without finding a close tag for macro (searched from line 1)
[0m22:01:58.488336 [debug] [MainThread]: Command `dbt test` failed at 22:01:58.487359 after 1.12 seconds
[0m22:01:58.488336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABE351F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010ABE3968D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010AC51DFF10>]}
[0m22:01:58.489336 [debug] [MainThread]: Flushing usage events
[0m22:02:07.445804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206791A9E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067919EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067919D350>]}


============================== 22:02:07.461750 | 73929a46-5b6e-4a87-b09d-9b9d4d9cb8d7 ==============================
[0m22:02:07.461750 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:02:07.463749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:02:08.060077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73929a46-5b6e-4a87-b09d-9b9d4d9cb8d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002067923BCD0>]}
[0m22:02:08.142577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73929a46-5b6e-4a87-b09d-9b9d4d9cb8d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206791ACC50>]}
[0m22:02:08.142577 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:02:08.186495 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:02:08.411978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:02:08.411978 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\positive_value.sql
[0m22:02:08.411978 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m22:02:08.427926 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\ppg_value.sql
[0m22:02:08.429017 [error] [MainThread]: Encountered an error:
Compilation Error
  Reached EOF without finding a close tag for macro (searched from line 1)
[0m22:02:08.429017 [debug] [MainThread]: Command `dbt test` failed at 22:02:08.429017 after 1.08 seconds
[0m22:02:08.429017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206785D1C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020672301F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020678E02790>]}
[0m22:02:08.429017 [debug] [MainThread]: Flushing usage events
[0m22:03:22.578366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CBA7EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CBAA1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CB4E4AD0>]}


============================== 22:03:22.578366 | f9d176fb-2566-43bd-bcb8-a495441d0339 ==============================
[0m22:03:22.578366 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:03:22.578366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:03:23.191947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9d176fb-2566-43bd-bcb8-a495441d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CD5D8210>]}
[0m22:03:23.294017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9d176fb-2566-43bd-bcb8-a495441d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CD62FF10>]}
[0m22:03:23.294017 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:03:23.322648 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:03:23.579941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:03:23.579941 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\positive_value.sql
[0m22:03:23.579941 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\ppg_value.sql
[0m22:03:23.579941 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m22:03:24.110114 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'PPG' in package 'dim_dfb_nfl_data' which was not found
[0m22:03:24.141848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9d176fb-2566-43bd-bcb8-a495441d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CDEB0AD0>]}
[0m22:03:24.165716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9d176fb-2566-43bd-bcb8-a495441d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CD9B0590>]}
[0m22:03:24.165716 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m22:03:24.165716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9d176fb-2566-43bd-bcb8-a495441d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CDC32E50>]}
[0m22:03:24.165716 [info ] [MainThread]: 
[0m22:03:24.165716 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:03:24.175784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:03:24.194155 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:03:24.195108 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:03:24.196109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:25.256935 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:03:25.256935 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:03:25.422806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9d176fb-2566-43bd-bcb8-a495441d0339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CDF29850>]}
[0m22:03:25.423804 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:03:25.424828 [info ] [MainThread]: 
[0m22:03:25.429418 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:03:25.429418 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:03:25.433894 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:03:25.435533 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:03:25.449079 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:03:25.451021 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:03:25.436904 => 22:03:25.450067
[0m22:03:25.451021 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:03:25.465080 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:03:25.465080 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:03:25.478397 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:03:25.480168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:03:26.265729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:03:26.274699 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:03:25.452080 => 22:03:26.274699
[0m22:03:26.275706 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:03:26.410694 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.98s]
[0m22:03:26.410694 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:03:26.410694 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:03:26.410694 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:03:26.410694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:03:26.410694 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:03:26.428504 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:03:26.431441 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:03:26.410694 => 22:03:26.430448
[0m22:03:26.431441 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:03:26.437514 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:03:26.438463 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:03:26.439498 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:03:26.440495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:27.134859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:03:27.151210 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:03:26.432545 => 22:03:27.151210
[0m22:03:27.152225 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:03:27.299721 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.89s]
[0m22:03:27.299721 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:03:27.299721 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:03:27.299721 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:03:27.309630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:03:27.311668 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:03:27.315819 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:03:27.315819 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:03:27.312932 => 22:03:27.315819
[0m22:03:27.315819 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:03:27.315819 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:03:27.315819 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:03:27.315819 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:03:27.315819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:28.092891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:03:28.092891 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:03:27.315819 => 22:03:28.092891
[0m22:03:28.092891 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:03:28.262121 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.96s]
[0m22:03:28.262121 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:03:28.262121 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:03:28.262121 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m22:03:28.272274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:03:28.273735 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:03:28.284918 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:03:28.274385 => 22:03:28.284918
[0m22:03:28.288057 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:03:28.288057 [error] [Thread-1 (]: 4 of 5 ERROR positive_value_dim_dfb_nfl_data_salary ............................ [[31mERROR[0m in 0.03s]
[0m22:03:28.288057 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:03:28.288057 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:03:28.297046 [info ] [Thread-1 (]: 5 of 5 START test value_test ................................................... [RUN]
[0m22:03:28.300430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m22:03:28.301355 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:03:28.304671 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:03:28.304671 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:03:28.301355 => 22:03:28.304671
[0m22:03:28.304671 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:03:28.317644 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:03:28.319541 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:03:28.320542 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 1

      
    ) dbt_internal_test
[0m22:03:28.320542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:29.107779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:03:29.112080 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:03:28.311721 => 22:03:29.112080
[0m22:03:29.112080 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:03:29.243588 [error] [Thread-1 (]: 5 of 5 FAIL 928 value_test ..................................................... [[31mFAIL 928[0m in 0.94s]
[0m22:03:29.243588 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:03:29.243588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:29.243588 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:03:29.243588 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m22:03:29.243588 [info ] [MainThread]: 
[0m22:03:29.258906 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.08 seconds (5.08s).
[0m22:03:29.261720 [debug] [MainThread]: Command end result
[0m22:03:29.281330 [info ] [MainThread]: 
[0m22:03:29.283323 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:03:29.284319 [info ] [MainThread]: 
[0m22:03:29.285405 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:03:29.288540 [info ] [MainThread]: 
[0m22:03:29.290033 [error] [MainThread]: [31mFailure in test value_test (tests\value_test.sql)[0m
[0m22:03:29.291105 [error] [MainThread]:   Got 928 results, configured to fail if != 0
[0m22:03:29.293080 [info ] [MainThread]: 
[0m22:03:29.294030 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\value_test.sql
[0m22:03:29.296031 [info ] [MainThread]: 
[0m22:03:29.298030 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m22:03:29.302208 [debug] [MainThread]: Command `dbt test` failed at 22:03:29.301211 after 6.80 seconds
[0m22:03:29.302208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256C4BD1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CBA8DB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256CBA8D9D0>]}
[0m22:03:29.303276 [debug] [MainThread]: Flushing usage events
[0m22:06:05.992439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9B35D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9B35D210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9B35D350>]}


============================== 22:06:05.992439 | 834c58dd-9f64-4cfe-948c-6c9ce7898617 ==============================
[0m22:06:05.992439 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:06:05.992439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:06.579368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '834c58dd-9f64-4cfe-948c-6c9ce7898617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9CFA3F90>]}
[0m22:06:06.675803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '834c58dd-9f64-4cfe-948c-6c9ce7898617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9B374A10>]}
[0m22:06:06.675803 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:06:06.713537 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:06:06.993449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:06:06.993449 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\ppg_value.sql
[0m22:06:07.009145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '834c58dd-9f64-4cfe-948c-6c9ce7898617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9D03AED0>]}
[0m22:06:07.024764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '834c58dd-9f64-4cfe-948c-6c9ce7898617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9D27BE90>]}
[0m22:06:07.024764 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m22:06:07.024764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '834c58dd-9f64-4cfe-948c-6c9ce7898617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9D04DE10>]}
[0m22:06:07.040365 [info ] [MainThread]: 
[0m22:06:07.044372 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:06:07.047410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:06:07.062305 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:06:07.062305 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:06:07.062305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:08.162547 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:06:08.162547 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:06:08.312295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '834c58dd-9f64-4cfe-948c-6c9ce7898617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9D269850>]}
[0m22:06:08.312295 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:06:08.312295 [info ] [MainThread]: 
[0m22:06:08.327975 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:06:08.327975 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:06:08.335136 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:06:08.337471 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:06:08.352042 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:06:08.363933 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:06:08.337547 => 22:06:08.362918
[0m22:06:08.365036 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:06:08.381157 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:06:08.381157 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:06:08.381157 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:06:08.381157 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:09.194885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:06:09.210354 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:06:08.365036 => 22:06:09.210354
[0m22:06:09.210354 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:06:09.362067 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.03s]
[0m22:06:09.365645 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:06:09.367674 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:06:09.369731 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:06:09.372706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:06:09.374668 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:06:09.380383 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:06:09.380383 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:06:09.375662 => 22:06:09.380383
[0m22:06:09.380383 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:06:09.380383 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:06:09.380383 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:06:09.380383 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:06:09.380383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:10.066924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:06:10.066924 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:06:09.380383 => 22:06:10.066924
[0m22:06:10.066924 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:06:10.229461 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.86s]
[0m22:06:10.229461 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:06:10.229461 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:06:10.229461 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:06:10.229461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:06:10.229461 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:06:10.247188 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:06:10.249123 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:06:10.229461 => 22:06:10.248154
[0m22:06:10.250124 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:06:10.254225 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:06:10.256190 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:06:10.257224 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:06:10.258202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:11.031718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:06:11.036967 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:06:10.251162 => 22:06:11.036967
[0m22:06:11.036967 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:06:11.169815 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.94s]
[0m22:06:11.169815 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:06:11.169815 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:06:11.169815 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m22:06:11.181614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:06:11.183480 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:06:11.187145 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:06:11.183936 => 22:06:11.187145
[0m22:06:11.199361 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:06:11.200343 [error] [Thread-1 (]: 4 of 5 ERROR positive_value_dim_dfb_nfl_data_salary ............................ [[31mERROR[0m in 0.03s]
[0m22:06:11.202830 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:06:11.203777 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:06:11.203963 [info ] [Thread-1 (]: 5 of 5 START test value_test ................................................... [RUN]
[0m22:06:11.207661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m22:06:11.207661 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:06:11.214734 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:06:11.217673 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:06:11.208723 => 22:06:11.216779
[0m22:06:11.218693 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:06:11.220997 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:06:11.220997 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:06:11.220997 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:06:11.220997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:11.960818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:06:11.965017 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:06:11.218693 => 22:06:11.965017
[0m22:06:11.966031 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:06:12.129806 [info ] [Thread-1 (]: 5 of 5 PASS value_test ......................................................... [[32mPASS[0m in 0.93s]
[0m22:06:12.129806 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:06:12.129806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:12.129806 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:06:12.129806 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m22:06:12.129806 [info ] [MainThread]: 
[0m22:06:12.129806 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m22:06:12.145909 [debug] [MainThread]: Command end result
[0m22:06:12.163170 [info ] [MainThread]: 
[0m22:06:12.165050 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:06:12.165050 [info ] [MainThread]: 
[0m22:06:12.168273 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:06:12.170946 [info ] [MainThread]: 
[0m22:06:12.172298 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:06:12.175195 [debug] [MainThread]: Command `dbt test` failed at 22:06:12.175195 after 6.27 seconds
[0m22:06:12.176264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC94471F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC94750C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC94750090>]}
[0m22:06:12.177219 [debug] [MainThread]: Flushing usage events
[0m22:07:34.559737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B144EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B14708D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B1471050>]}


============================== 22:07:34.565801 | c2a6e8f3-3ab4-4fe7-95ba-b082da798d63 ==============================
[0m22:07:34.565801 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:07:34.567625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:35.169350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2a6e8f3-3ab4-4fe7-95ba-b082da798d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B1473AD0>]}
[0m22:07:35.253694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2a6e8f3-3ab4-4fe7-95ba-b082da798d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B300A150>]}
[0m22:07:35.269274 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:07:35.299969 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:07:35.578001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:07:35.578001 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\dim_dfb_nfl_data.sql
[0m22:07:36.045080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2a6e8f3-3ab4-4fe7-95ba-b082da798d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B359BD50>]}
[0m22:07:36.060781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2a6e8f3-3ab4-4fe7-95ba-b082da798d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B377F890>]}
[0m22:07:36.060781 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m22:07:36.060781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2a6e8f3-3ab4-4fe7-95ba-b082da798d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B3172D10>]}
[0m22:07:36.076332 [info ] [MainThread]: 
[0m22:07:36.080331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:07:36.083966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:07:36.103589 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:07:36.105106 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:07:36.106151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:37.207493 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:07:37.212885 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:07:37.378566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2a6e8f3-3ab4-4fe7-95ba-b082da798d63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210B3598050>]}
[0m22:07:37.378566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:07:37.394061 [info ] [MainThread]: 
[0m22:07:37.394061 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:07:37.394061 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:07:37.407067 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:07:37.408404 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:07:37.413344 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:07:37.413344 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:07:37.408404 => 22:07:37.413344
[0m22:07:37.413344 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:07:37.450793 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:07:37.453810 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:07:37.453810 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:07:37.454801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:07:38.243447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:07:38.243447 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:07:37.413344 => 22:07:38.243447
[0m22:07:38.243447 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:07:38.397419 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.00s]
[0m22:07:38.397419 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:07:38.397419 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:07:38.397419 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:07:38.410975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:07:38.412979 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:07:38.422042 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:07:38.423043 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:07:38.413977 => 22:07:38.423043
[0m22:07:38.423975 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:07:38.429656 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:07:38.429656 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:07:38.429656 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:07:38.429656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:39.127659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:07:39.127659 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:07:38.424975 => 22:07:39.127659
[0m22:07:39.127659 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:07:39.278807 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.88s]
[0m22:07:39.281314 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:07:39.282372 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:07:39.284261 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:07:39.287097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:07:39.288132 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:07:39.296085 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:07:39.299111 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:07:39.289090 => 22:07:39.298104
[0m22:07:39.300181 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:07:39.306093 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:07:39.308142 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:07:39.308142 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:07:39.309092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:40.056587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:07:40.062527 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:07:39.301098 => 22:07:40.062527
[0m22:07:40.063755 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:07:40.194439 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.91s]
[0m22:07:40.194439 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:07:40.194439 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:07:40.194439 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m22:07:40.207919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:07:40.209853 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:07:40.220656 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:07:40.210500 => 22:07:40.220656
[0m22:07:40.222825 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:07:40.222825 [error] [Thread-1 (]: 4 of 5 ERROR positive_value_dim_dfb_nfl_data_salary ............................ [[31mERROR[0m in 0.03s]
[0m22:07:40.229624 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:07:40.231237 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:07:40.231237 [info ] [Thread-1 (]: 5 of 5 START test value_test ................................................... [RUN]
[0m22:07:40.236088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m22:07:40.236088 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:07:40.241146 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:07:40.241146 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:07:40.237147 => 22:07:40.241146
[0m22:07:40.245194 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:07:40.251010 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:07:40.252936 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:07:40.252936 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:07:40.253981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:41.014514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:07:41.029332 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:07:40.245194 => 22:07:41.029221
[0m22:07:41.030422 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:07:41.184956 [info ] [Thread-1 (]: 5 of 5 PASS value_test ......................................................... [[32mPASS[0m in 0.94s]
[0m22:07:41.184956 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:07:41.184956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:41.184956 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:07:41.184956 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m22:07:41.184956 [info ] [MainThread]: 
[0m22:07:41.184956 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m22:07:41.200385 [debug] [MainThread]: Command end result
[0m22:07:41.214839 [info ] [MainThread]: 
[0m22:07:41.214839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:07:41.223871 [info ] [MainThread]: 
[0m22:07:41.225779 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:07:41.227868 [info ] [MainThread]: 
[0m22:07:41.229528 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:07:41.232772 [debug] [MainThread]: Command `dbt test` failed at 22:07:41.232772 after 6.77 seconds
[0m22:07:41.233754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AA551F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AA830050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210AA830C10>]}
[0m22:07:41.233754 [debug] [MainThread]: Flushing usage events
[0m22:08:26.098709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F1D9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F17E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F1CFB10>]}


============================== 22:08:26.098709 | 195db103-3b57-4407-84d8-14be160d8402 ==============================
[0m22:08:26.098709 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:08:26.098709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'send_anonymous_usage_stats': 'True'}
[0m22:08:26.697421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '195db103-3b57-4407-84d8-14be160d8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5F1F7B10>]}
[0m22:08:26.795887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '195db103-3b57-4407-84d8-14be160d8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD60CD9D10>]}
[0m22:08:26.795887 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:08:26.833313 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:08:27.103039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:27.104037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:27.111039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '195db103-3b57-4407-84d8-14be160d8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD610378D0>]}
[0m22:08:27.132856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '195db103-3b57-4407-84d8-14be160d8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD60EE5690>]}
[0m22:08:27.133816 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m22:08:27.136397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '195db103-3b57-4407-84d8-14be160d8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5FCD2010>]}
[0m22:08:27.138412 [info ] [MainThread]: 
[0m22:08:27.141373 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:08:27.143346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:08:27.159951 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:08:27.160900 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:08:27.161967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:28.195905 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:08:28.195905 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:08:28.346347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '195db103-3b57-4407-84d8-14be160d8402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD60F02E50>]}
[0m22:08:28.346347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:08:28.362763 [info ] [MainThread]: 
[0m22:08:28.362763 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:08:28.362763 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:08:28.374191 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:08:28.376600 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:08:28.402365 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:08:28.402365 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:08:28.376600 => 22:08:28.402365
[0m22:08:28.402365 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:08:28.431612 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:08:28.433609 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:08:28.434679 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:08:28.435653 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:08:29.217779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:29.236089 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:08:28.402365 => 22:08:29.236089
[0m22:08:29.237053 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:08:29.364875 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.00s]
[0m22:08:29.380396 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:08:29.380396 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:08:29.380396 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:08:29.385386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:08:29.386945 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:08:29.397881 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:08:29.400889 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:08:29.388024 => 22:08:29.399893
[0m22:08:29.400889 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:08:29.401993 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:08:29.401993 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:08:29.401993 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:08:29.401993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:30.143848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:30.163443 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:08:29.401993 => 22:08:30.163266
[0m22:08:30.164506 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:08:30.329807 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.95s]
[0m22:08:30.329807 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:08:30.329807 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:08:30.329807 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:08:30.346137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:08:30.347206 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:08:30.352059 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:08:30.352059 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:08:30.348534 => 22:08:30.352059
[0m22:08:30.352059 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:08:30.352059 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:08:30.361910 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:08:30.363751 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:08:30.364808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:31.225312 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:31.225312 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:08:30.352059 => 22:08:31.225312
[0m22:08:31.225312 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:08:31.394618 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.06s]
[0m22:08:31.396866 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:08:31.396866 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:08:31.396866 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m22:08:31.402897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:08:31.405068 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:08:31.417299 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:08:31.405554 => 22:08:31.417299
[0m22:08:31.423096 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:08:31.423096 [error] [Thread-1 (]: 4 of 5 ERROR positive_value_dim_dfb_nfl_data_salary ............................ [[31mERROR[0m in 0.03s]
[0m22:08:31.423096 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:08:31.423096 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:08:31.430112 [info ] [Thread-1 (]: 5 of 5 START test value_test ................................................... [RUN]
[0m22:08:31.433579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m22:08:31.434610 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:08:31.437886 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:08:31.437886 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:08:31.434610 => 22:08:31.437886
[0m22:08:31.437886 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:08:31.445196 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:08:31.448375 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:08:31.449424 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:08:31.450429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:32.161408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:32.161408 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:08:31.437886 => 22:08:32.161408
[0m22:08:32.161408 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:08:32.332465 [info ] [Thread-1 (]: 5 of 5 PASS value_test ......................................................... [[32mPASS[0m in 0.90s]
[0m22:08:32.336139 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:08:32.340144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:32.341137 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:08:32.342080 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m22:08:32.342080 [info ] [MainThread]: 
[0m22:08:32.344072 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m22:08:32.348941 [debug] [MainThread]: Command end result
[0m22:08:32.368504 [info ] [MainThread]: 
[0m22:08:32.369503 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:08:32.370101 [info ] [MainThread]: 
[0m22:08:32.370101 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:08:32.370101 [info ] [MainThread]: 
[0m22:08:32.370101 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:08:32.378714 [debug] [MainThread]: Command `dbt test` failed at 22:08:32.378714 after 6.37 seconds
[0m22:08:32.379736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD582C1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD5E5A1C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD585A0C10>]}
[0m22:08:32.381906 [debug] [MainThread]: Flushing usage events
[0m22:08:42.411799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C5A1F950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C5A45FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C5A47D10>]}


============================== 22:08:42.411799 | 77266320-2588-4fcc-ad83-5a9cef128852 ==============================
[0m22:08:42.411799 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:08:42.411799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:43.030732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C64DB890>]}
[0m22:08:43.109454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C75DB590>]}
[0m22:08:43.125026 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:08:43.147103 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:08:43.394035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:43.394035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:43.409723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C7947D10>]}
[0m22:08:43.425390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C779FFD0>]}
[0m22:08:43.425390 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m22:08:43.425390 [info ] [MainThread]: 
[0m22:08:43.440963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:08:43.440963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m22:08:43.446532 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m22:08:43.458201 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m22:08:43.458201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:44.448700 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:08:44.448700 [debug] [ThreadPool]: On list_storage: Close
[0m22:08:44.613966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:08:44.632840 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:08:44.632840 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:08:44.633840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:45.328704 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:08:45.328704 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:08:45.509210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C5B7D610>]}
[0m22:08:45.509210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:08:45.509210 [info ] [MainThread]: 
[0m22:08:45.509210 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m22:08:45.509210 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m22:08:45.509210 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m22:08:45.534592 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m22:08:45.536593 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 22:08:45.524819 => 22:08:45.535591
[0m22:08:45.537603 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m22:08:45.538611 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m22:08:45.539605 [info ] [Thread-1 (]: 1 of 11 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m22:08:45.541605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m22:08:45.542604 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m22:08:45.542604 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 22:08:45.542604 => 22:08:45.542604
[0m22:08:45.543604 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m22:08:45.581437 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:08:45.581437 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m22:08:45.581437 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:08:46.459613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:46.459613 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:08:46.475279 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m22:08:46.761115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:08:46.761115 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:08:46.761115 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m22:08:47.057381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:08:47.062569 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:08:47.062569 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m22:08:47.162913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:08:47.162913 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:08:47.162913 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m22:08:47.480107 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.0 seconds
[0m22:08:47.480107 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:08:47.480107 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m22:08:47.913509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:08:47.913509 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m22:08:47.929179 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 22:08:45.543604 => 22:08:47.929179
[0m22:08:47.929179 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m22:08:48.075893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C7766910>]}
[0m22:08:48.075893 [info ] [Thread-1 (]: 1 of 11 OK loaded seed file dfb.seed_nfl_teams ................................. [[32mINSERT 31[0m in 2.54s]
[0m22:08:48.075893 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m22:08:48.075893 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m22:08:48.075893 [info ] [Thread-1 (]: 2 of 11 START sql view model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m22:08:48.075893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m22:08:48.075893 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m22:08:48.114789 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m22:08:48.114883 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 22:08:48.075893 => 22:08:48.114883
[0m22:08:48.114883 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m22:08:48.130417 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m22:08:48.130417 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m22:08:48.130417 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Player_ID
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
  );
[0m22:08:48.130417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:49.228070 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:49.228070 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 22:08:48.114883 => 22:08:49.228070
[0m22:08:49.228070 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m22:08:49.364396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C7DFE190>]}
[0m22:08:49.364396 [info ] [Thread-1 (]: 2 of 11 OK created sql view model dfb.dim_dfb_nfl_data ......................... [[32mSUCCESS 1[0m in 1.29s]
[0m22:08:49.364396 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m22:08:49.364396 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m22:08:49.364396 [info ] [Thread-1 (]: 3 of 11 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m22:08:49.378564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m22:08:49.378564 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m22:08:49.384232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m22:08:49.384232 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 22:08:49.379930 => 22:08:49.384232
[0m22:08:49.384232 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m22:08:49.384232 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m22:08:49.384232 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m22:08:49.384232 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m22:08:49.395136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:50.529859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:50.545496 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 22:08:49.384232 => 22:08:50.545496
[0m22:08:50.545496 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m22:08:50.693111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C7D17690>]}
[0m22:08:50.693111 [info ] [Thread-1 (]: 3 of 11 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 1.33s]
[0m22:08:50.693111 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m22:08:50.708561 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m22:08:50.708561 [info ] [Thread-1 (]: 4 of 11 START sql view model dfb.stg_nfl_teams ................................. [RUN]
[0m22:08:50.713125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m22:08:50.714838 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m22:08:50.718077 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m22:08:50.718077 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 22:08:50.715278 => 22:08:50.718077
[0m22:08:50.718077 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m22:08:50.718077 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m22:08:50.718077 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m22:08:50.718077 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m22:08:50.718077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:51.566212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:51.566212 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 22:08:50.718077 => 22:08:51.566212
[0m22:08:51.566212 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m22:08:51.692814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C7D17690>]}
[0m22:08:51.692814 [info ] [Thread-1 (]: 4 of 11 OK created sql view model dfb.stg_nfl_teams ............................ [[32mSUCCESS 1[0m in 0.98s]
[0m22:08:51.692814 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m22:08:51.692814 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:08:51.692814 [info ] [Thread-1 (]: 5 of 11 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:08:51.709194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b)
[0m22:08:51.710270 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:08:51.731894 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:08:51.733901 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:08:51.710886 => 22:08:51.732943
[0m22:08:51.733901 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:08:51.748618 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:08:51.748618 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:08:51.748618 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:08:51.748618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:52.580256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:52.580256 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:08:51.734902 => 22:08:52.580256
[0m22:08:52.580256 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:08:52.714944 [info ] [Thread-1 (]: 5 of 11 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.99s]
[0m22:08:52.714944 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:08:52.714944 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:08:52.714944 [info ] [Thread-1 (]: 6 of 11 START test not_null_dim_dfb_nfl_data_date .............................. [RUN]
[0m22:08:52.723554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:08:52.725111 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:08:52.735789 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:08:52.736935 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:08:52.725550 => 22:08:52.736935
[0m22:08:52.736935 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:08:52.736935 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:08:52.736935 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:08:52.736935 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:08:52.736935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:53.572625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:53.576571 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:08:52.736935 => 22:08:53.575583
[0m22:08:53.577530 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:08:53.726018 [info ] [Thread-1 (]: 6 of 11 PASS not_null_dim_dfb_nfl_data_date .................................... [[32mPASS[0m in 1.01s]
[0m22:08:53.726018 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:08:53.726018 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:08:53.726018 [info ] [Thread-1 (]: 7 of 11 START test not_null_dim_dfb_nfl_data_name .............................. [RUN]
[0m22:08:53.739261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:08:53.740980 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:08:53.750548 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:08:53.752481 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:08:53.741405 => 22:08:53.751520
[0m22:08:53.752481 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:08:53.756507 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:08:53.758511 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:08:53.759548 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:08:53.759548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:54.593413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:54.593413 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:08:53.753505 => 22:08:54.593413
[0m22:08:54.593413 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:08:54.749695 [info ] [Thread-1 (]: 7 of 11 PASS not_null_dim_dfb_nfl_data_name .................................... [[32mPASS[0m in 1.02s]
[0m22:08:54.752833 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:08:54.754749 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:08:54.755897 [info ] [Thread-1 (]: 8 of 11 START test positive_value_dim_dfb_nfl_data_salary ...................... [RUN]
[0m22:08:54.759206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:08:54.760144 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:08:54.764338 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:08:54.761147 => 22:08:54.764338
[0m22:08:54.772950 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:08:54.772950 [error] [Thread-1 (]: 8 of 11 ERROR positive_value_dim_dfb_nfl_data_salary ........................... [[31mERROR[0m in 0.02s]
[0m22:08:54.780183 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:08:54.781933 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:08:54.783987 [info ] [Thread-1 (]: 9 of 11 START test value_test .................................................. [RUN]
[0m22:08:54.818499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m22:08:54.819519 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:08:54.829782 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:08:54.829782 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:08:54.819519 => 22:08:54.829782
[0m22:08:54.829782 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:08:54.829782 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:08:54.829782 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:08:54.829782 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:08:54.829782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:55.612508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:08:55.628143 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:08:54.829782 => 22:08:55.628143
[0m22:08:55.628143 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:08:55.762210 [info ] [Thread-1 (]: 9 of 11 PASS value_test ........................................................ [[32mPASS[0m in 0.94s]
[0m22:08:55.762210 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:08:55.762210 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m22:08:55.762210 [info ] [Thread-1 (]: 10 of 11 START python table model dfb.py_nfl_data .............................. [RUN]
[0m22:08:55.775475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.value_test, now model.dfb_data.py_nfl_data)
[0m22:08:55.776530 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m22:08:55.802170 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m22:08:55.802170 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 22:08:55.777542 => 22:08:55.802170
[0m22:08:55.802170 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m22:08:55.834848 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m22:08:55.837826 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m22:08:55.838834 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m22:08:55.838834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:08:58.557007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:08:58.563148 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 22:08:55.802170 => 22:08:58.561986
[0m22:08:58.563148 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m22:08:58.695315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C7E7B910>]}
[0m22:08:58.711028 [info ] [Thread-1 (]: 10 of 11 OK created python table model dfb.py_nfl_data ......................... [[32mSUCCESS 1[0m in 2.93s]
[0m22:08:58.711028 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m22:08:58.711028 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m22:08:58.711028 [info ] [Thread-1 (]: 11 of 11 START python table model dfb.fct_nfl_teams ............................ [RUN]
[0m22:08:58.719055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m22:08:58.720565 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m22:08:58.724781 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m22:08:58.731470 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 22:08:58.722021 => 22:08:58.730324
[0m22:08:58.733491 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m22:08:58.739530 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m22:08:58.742523 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m22:08:58.743481 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m22:08:58.743481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:01.476234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:09:01.476234 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 22:08:58.733491 => 22:09:01.476234
[0m22:09:01.476234 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m22:09:01.613340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77266320-2588-4fcc-ad83-5a9cef128852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C4ED4210>]}
[0m22:09:01.613340 [info ] [Thread-1 (]: 11 of 11 OK created python table model dfb.fct_nfl_teams ....................... [[32mSUCCESS 1[0m in 2.90s]
[0m22:09:01.613340 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m22:09:01.613340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:01.613340 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m22:09:01.630092 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:09:01.630092 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m22:09:01.631536 [info ] [MainThread]: 
[0m22:09:01.634548 [info ] [MainThread]: Finished running 1 seed, 3 view models, 5 tests, 2 table models in 0 hours 0 minutes and 18.21 seconds (18.21s).
[0m22:09:01.639633 [debug] [MainThread]: Command end result
[0m22:09:01.652553 [info ] [MainThread]: 
[0m22:09:01.662885 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:09:01.665788 [info ] [MainThread]: 
[0m22:09:01.666775 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:09:01.668653 [info ] [MainThread]: 
[0m22:09:01.668653 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m22:09:01.668653 [debug] [MainThread]: Command `dbt build` failed at 22:09:01.668653 after 19.34 seconds
[0m22:09:01.668653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152BEB31FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C5A1F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152C5A1F750>]}
[0m22:09:01.668653 [debug] [MainThread]: Flushing usage events
[0m22:10:31.991408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F4F399D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F4F90950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F4F92110>]}


============================== 22:10:31.991408 | 8c814f21-2f94-4203-91bd-119e95e15620 ==============================
[0m22:10:31.991408 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:10:31.991408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:10:32.601379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c814f21-2f94-4203-91bd-119e95e15620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F6B73C90>]}
[0m22:10:32.692470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c814f21-2f94-4203-91bd-119e95e15620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F5A82290>]}
[0m22:10:32.695610 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:10:32.717627 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:10:32.991364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:10:32.991364 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m22:10:33.276899 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\schema.yml @ models: {'name': 'dim_dfb_nfl_data', 'description': 'Daily Fantasy Buzz data', 'columns': [{'name': 'date', 'description': 'Date of game', 'tests': ['not_null']}, {'name': 'name', 'description': 'Player name', 'tests': ['not_null']}, {'name': 'position', 'description': 'Type of the apartment / room', 'tests': [{'accepted_values': {'values': ['TE/FLEX', 'QB', 'WR/FLEX', 'RB/FLEX', 'WR', 'TE', 'RB', 'DST']}}]}, {'name': 'salary', 'tests': ['positive_value']}, {'name': 'PPG'}, {'tests': ['ppg_greater_zero']}], 'original_file_path': 'models\\schema.yml', 'yaml_key': 'models', 'package_name': 'dfb_data'} - at path ['columns'][5]: 'name' is a required property
[0m22:10:33.292505 [debug] [MainThread]: Command `dbt test` failed at 22:10:33.292505 after 1.39 seconds
[0m22:10:33.292505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9EE041F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F4F70E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F4F73250>]}
[0m22:10:33.292505 [debug] [MainThread]: Flushing usage events
[0m22:11:21.476049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54BFC4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C5A4A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C5D78D0>]}


============================== 22:11:21.479014 | 5611819e-31ee-42ee-802b-4fc018c6c011 ==============================
[0m22:11:21.479014 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:11:21.479014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:11:22.077272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5611819e-31ee-42ee-802b-4fc018c6c011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54E12CA90>]}
[0m22:11:22.161184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5611819e-31ee-42ee-802b-4fc018c6c011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54E0B0C90>]}
[0m22:11:22.161184 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:11:22.199246 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:11:22.460198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:22.460198 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m22:11:22.740108 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\schema.yml @ models: {'name': 'dim_dfb_nfl_data', 'description': 'Daily Fantasy Buzz data', 'columns': [{'name': 'date', 'description': 'Date of game', 'tests': ['not_null']}, {'name': 'name', 'description': 'Player name', 'tests': ['not_null']}, {'name': 'position', 'description': 'Type of the apartment / room', 'tests': [{'accepted_values': {'values': ['TE/FLEX', 'QB', 'WR/FLEX', 'RB/FLEX', 'WR', 'TE', 'RB', 'DST']}}]}, {'name': 'salary', 'tests': ['positive_value']}, {'name': 'PPG'}, {'tests': ['ppg_greater_zero']}], 'original_file_path': 'models\\schema.yml', 'yaml_key': 'models', 'package_name': 'dfb_data'} - at path ['columns'][5]: 'name' is a required property
[0m22:11:22.756841 [debug] [MainThread]: Command `dbt test` failed at 22:11:22.756841 after 1.38 seconds
[0m22:11:22.758551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C545691F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C545970050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C545970C10>]}
[0m22:11:22.759620 [debug] [MainThread]: Flushing usage events
[0m22:11:58.232591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3760F610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3760FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3760F990>]}


============================== 22:11:58.238582 | a150e31e-efd1-4d19-a1a0-54a0f0733008 ==============================
[0m22:11:58.238582 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:11:58.240072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:58.860281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a150e31e-efd1-4d19-a1a0-54a0f0733008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A38283610>]}
[0m22:11:58.942835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a150e31e-efd1-4d19-a1a0-54a0f0733008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A381FA8D0>]}
[0m22:11:58.942835 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:11:58.984454 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:11:59.226753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:59.226753 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m22:11:59.273724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a150e31e-efd1-4d19-a1a0-54a0f0733008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A39305E50>]}
[0m22:11:59.291774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a150e31e-efd1-4d19-a1a0-54a0f0733008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A39527550>]}
[0m22:11:59.292830 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m22:11:59.295017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a150e31e-efd1-4d19-a1a0-54a0f0733008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A392DA790>]}
[0m22:11:59.296252 [info ] [MainThread]: 
[0m22:11:59.299406 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:11:59.303230 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:11:59.313979 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:11:59.313979 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:11:59.313979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:00.345901 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:12:00.345901 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:12:00.513814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a150e31e-efd1-4d19-a1a0-54a0f0733008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3954EDD0>]}
[0m22:12:00.513814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:12:00.513814 [info ] [MainThread]: 
[0m22:12:00.529498 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:12:00.531611 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:12:00.534075 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:12:00.534810 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:12:00.553828 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:12:00.561995 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:12:00.536055 => 22:12:00.553828
[0m22:12:00.564005 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:12:00.581183 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:12:00.581183 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:12:00.581183 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:12:00.581183 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:12:01.380037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:12:01.380037 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:12:00.565009 => 22:12:01.380037
[0m22:12:01.380037 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:12:01.527974 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.00s]
[0m22:12:01.543679 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:12:01.543679 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:12:01.543679 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:12:01.549695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:12:01.551756 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:12:01.561965 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:12:01.565672 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:12:01.552914 => 22:12:01.564661
[0m22:12:01.566684 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:12:01.570715 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:12:01.572677 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:12:01.573711 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:12:01.573711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:02.279771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:12:02.279771 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:12:01.567717 => 22:12:02.279771
[0m22:12:02.279771 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:12:02.433620 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.89s]
[0m22:12:02.435577 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:12:02.437568 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:12:02.437698 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:12:02.439731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:12:02.440744 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:12:02.450405 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:12:02.453404 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:12:02.440744 => 22:12:02.452428
[0m22:12:02.454402 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:12:02.460406 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:12:02.463402 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:12:02.464404 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:12:02.466401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:03.264089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:12:03.279755 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:12:02.454402 => 22:12:03.279755
[0m22:12:03.279755 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:12:03.478835 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.03s]
[0m22:12:03.481859 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:12:03.482853 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:12:03.483877 [info ] [Thread-1 (]: 4 of 5 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m22:12:03.487138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:12:03.487138 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:12:03.492445 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:12:03.488193 => 22:12:03.492445
[0m22:12:03.498277 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:12:03.498277 [error] [Thread-1 (]: 4 of 5 ERROR positive_value_dim_dfb_nfl_data_salary ............................ [[31mERROR[0m in 0.01s]
[0m22:12:03.503865 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:12:03.504951 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:12:03.505915 [info ] [Thread-1 (]: 5 of 5 START test value_test ................................................... [RUN]
[0m22:12:03.507965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.value_test)
[0m22:12:03.507965 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:12:03.515740 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:12:03.517754 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:12:03.509004 => 22:12:03.516860
[0m22:12:03.517754 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:12:03.521618 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:12:03.521618 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:12:03.521618 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:12:03.521618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:04.242827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:12:04.258333 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:12:03.519303 => 22:12:04.258333
[0m22:12:04.258333 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:12:04.426529 [info ] [Thread-1 (]: 5 of 5 PASS value_test ......................................................... [[32mPASS[0m in 0.92s]
[0m22:12:04.429667 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:12:04.429667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:12:04.429667 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:12:04.429667 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m22:12:04.429667 [info ] [MainThread]: 
[0m22:12:04.429667 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.13 seconds (5.13s).
[0m22:12:04.443416 [debug] [MainThread]: Command end result
[0m22:12:04.465121 [info ] [MainThread]: 
[0m22:12:04.465121 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:12:04.465121 [info ] [MainThread]: 
[0m22:12:04.465121 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:12:04.465121 [info ] [MainThread]: 
[0m22:12:04.473173 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:12:04.475828 [debug] [MainThread]: Command `dbt test` failed at 22:12:04.475828 after 6.35 seconds
[0m22:12:04.476827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A307A1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A30A80050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A30A80090>]}
[0m22:12:04.477906 [debug] [MainThread]: Flushing usage events
[0m22:12:37.207626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A891A4F2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A891A4F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A891A4FBD0>]}


============================== 22:12:37.211994 | e636a3e0-06df-43b8-a981-4364d81a311f ==============================
[0m22:12:37.211994 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:12:37.211994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:12:37.842011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e636a3e0-06df-43b8-a981-4364d81a311f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8925B3D90>]}
[0m22:12:37.957698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e636a3e0-06df-43b8-a981-4364d81a311f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89368F850>]}
[0m22:12:37.957698 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:12:37.994162 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:12:38.260588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:12:38.260588 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m22:12:38.729338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e636a3e0-06df-43b8-a981-4364d81a311f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A893D44350>]}
[0m22:12:38.752802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e636a3e0-06df-43b8-a981-4364d81a311f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A893D6C810>]}
[0m22:12:38.753791 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m22:12:38.755743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e636a3e0-06df-43b8-a981-4364d81a311f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A89372ADD0>]}
[0m22:12:38.757803 [info ] [MainThread]: 
[0m22:12:38.759753 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:12:38.763786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:12:38.782920 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:12:38.783916 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:12:38.784913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:39.828086 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:12:39.828086 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:12:40.016732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e636a3e0-06df-43b8-a981-4364d81a311f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A893DB0DD0>]}
[0m22:12:40.018688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:12:40.020732 [info ] [MainThread]: 
[0m22:12:40.027716 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:12:40.029268 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:12:40.031803 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:12:40.033172 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:12:40.034272 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:12:40.034272 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:12:40.033172 => 22:12:40.034272
[0m22:12:40.045284 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:12:40.064954 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:12:40.064954 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:12:40.064954 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:12:40.064954 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:12:40.828976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:12:40.844519 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:12:40.046809 => 22:12:40.844519
[0m22:12:40.844519 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:12:40.995789 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.96s]
[0m22:12:40.997813 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:12:40.998853 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:12:40.999819 [info ] [Thread-1 (]: 2 of 6 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:12:41.001994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:12:41.003032 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:12:41.012397 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:12:41.014204 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:12:41.004031 => 22:12:41.013727
[0m22:12:41.015246 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:12:41.017527 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:12:41.017527 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:12:41.017527 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:12:41.017527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:41.725842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:12:41.725842 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:12:41.016376 => 22:12:41.725842
[0m22:12:41.741243 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:12:41.879357 [info ] [Thread-1 (]: 2 of 6 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.88s]
[0m22:12:41.879357 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:12:41.879357 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:12:41.879357 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:12:41.879357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:12:41.879357 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:12:41.901906 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:12:41.901906 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:12:41.894976 => 22:12:41.901906
[0m22:12:41.901906 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:12:41.901906 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:12:41.901906 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:12:41.901906 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:12:41.914394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:42.594765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:12:42.601963 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:12:41.901906 => 22:12:42.600937
[0m22:12:42.602976 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:12:42.777231 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.90s]
[0m22:12:42.792849 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:12:42.792849 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:12:42.792849 [info ] [Thread-1 (]: 4 of 6 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m22:12:42.792849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:12:42.792849 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:12:42.803374 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:12:42.792849 => 22:12:42.803374
[0m22:12:42.811230 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:12:42.812389 [error] [Thread-1 (]: 4 of 6 ERROR positive_value_dim_dfb_nfl_data_salary ............................ [[31mERROR[0m in 0.02s]
[0m22:12:42.815761 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:12:42.815761 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:12:42.815761 [info ] [Thread-1 (]: 5 of 6 START test ppg_greater_zero_dim_dfb_nfl_data_PPG ........................ [RUN]
[0m22:12:42.820222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00)
[0m22:12:42.820222 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:12:42.825230 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00 (compile): 22:12:42.821296 => 22:12:42.825230
[0m22:12:42.829447 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:12:42.829447 [error] [Thread-1 (]: 5 of 6 ERROR ppg_greater_zero_dim_dfb_nfl_data_PPG ............................. [[31mERROR[0m in 0.01s]
[0m22:12:42.834672 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:12:42.835688 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:12:42.835688 [info ] [Thread-1 (]: 6 of 6 START test value_test ................................................... [RUN]
[0m22:12:42.838685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00, now test.dfb_data.value_test)
[0m22:12:42.838685 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:12:42.839791 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:12:42.845983 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:12:42.838685 => 22:12:42.845193
[0m22:12:42.848417 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:12:42.853492 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:12:42.853492 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:12:42.853492 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:12:42.853492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:43.550786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:12:43.550786 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:12:42.849447 => 22:12:43.550786
[0m22:12:43.550786 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:12:43.738108 [info ] [Thread-1 (]: 6 of 6 PASS value_test ......................................................... [[32mPASS[0m in 0.90s]
[0m22:12:43.738108 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:12:43.738108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:12:43.738108 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:12:43.738108 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m22:12:43.738108 [info ] [MainThread]: 
[0m22:12:43.738108 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m22:12:43.755983 [debug] [MainThread]: Command end result
[0m22:12:43.770112 [info ] [MainThread]: 
[0m22:12:43.770112 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:12:43.778608 [info ] [MainThread]: 
[0m22:12:43.780619 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:12:43.782534 [info ] [MainThread]: 
[0m22:12:43.784543 [error] [MainThread]:   Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:12:43.786435 [info ] [MainThread]: 
[0m22:12:43.787527 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m22:12:43.789981 [debug] [MainThread]: Command `dbt test` failed at 22:12:43.789981 after 6.67 seconds
[0m22:12:43.791040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A88ABA1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A891ACCD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8916B21D0>]}
[0m22:12:43.792031 [debug] [MainThread]: Flushing usage events
[0m22:13:38.229834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9577C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9577D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9577DE10>]}


============================== 22:13:38.234009 | 9230d327-a1c9-4fb3-be81-a9b49878dd5d ==============================
[0m22:13:38.234009 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:13:38.236123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:13:38.812904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F957BF5D0>]}
[0m22:13:38.911830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F972DAD50>]}
[0m22:13:38.911830 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:13:38.945353 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:13:39.231289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:13:39.232291 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:13:39.239347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F975D7890>]}
[0m22:13:39.247965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F974A53D0>]}
[0m22:13:39.247965 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m22:13:39.264247 [info ] [MainThread]: 
[0m22:13:39.267209 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:13:39.270062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m22:13:39.283593 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m22:13:39.283593 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m22:13:39.283593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:40.245659 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:13:40.249277 [debug] [ThreadPool]: On list_storage: Close
[0m22:13:40.393792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:13:40.421455 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:13:40.422402 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:13:40.423398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:41.142322 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:13:41.142322 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:13:41.295402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F97673250>]}
[0m22:13:41.297026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:13:41.299042 [info ] [MainThread]: 
[0m22:13:41.304864 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m22:13:41.306929 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m22:13:41.306929 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m22:13:41.317732 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m22:13:41.319004 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 22:13:41.307920 => 22:13:41.319004
[0m22:13:41.319004 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m22:13:41.319004 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m22:13:41.319004 [info ] [Thread-1 (]: 1 of 12 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m22:13:41.326118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m22:13:41.326118 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m22:13:41.327182 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 22:13:41.327182 => 22:13:41.327182
[0m22:13:41.328188 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m22:13:41.365348 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:13:41.365348 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m22:13:41.365348 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:13:42.162572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:13:42.162572 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:13:42.162572 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m22:13:42.684198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:13:42.686268 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:13:42.687266 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m22:13:42.962436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:13:42.978137 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:13:42.978137 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m22:13:43.076137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:13:43.076137 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:13:43.091614 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m22:13:43.393036 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.0 seconds
[0m22:13:43.393036 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:13:43.393036 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m22:13:43.694343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:13:43.709868 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m22:13:43.725489 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 22:13:41.329149 => 22:13:43.725489
[0m22:13:43.725489 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m22:13:43.881538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F97412510>]}
[0m22:13:43.882463 [info ] [Thread-1 (]: 1 of 12 OK loaded seed file dfb.seed_nfl_teams ................................. [[32mINSERT 31[0m in 2.56s]
[0m22:13:43.884464 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m22:13:43.884464 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m22:13:43.885472 [info ] [Thread-1 (]: 2 of 12 START sql view model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m22:13:43.888469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m22:13:43.888469 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m22:13:43.917377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m22:13:43.919312 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 22:13:43.889531 => 22:13:43.918383
[0m22:13:43.919312 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m22:13:43.945353 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m22:13:43.947148 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m22:13:43.947148 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Player_ID
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
  );
[0m22:13:43.947148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:44.875242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:13:44.879451 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 22:13:43.920313 => 22:13:44.879451
[0m22:13:44.879451 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m22:13:45.026558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F974A5750>]}
[0m22:13:45.026558 [info ] [Thread-1 (]: 2 of 12 OK created sql view model dfb.dim_dfb_nfl_data ......................... [[32mSUCCESS 1[0m in 1.14s]
[0m22:13:45.042112 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m22:13:45.042112 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m22:13:45.042112 [info ] [Thread-1 (]: 3 of 12 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m22:13:45.047533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m22:13:45.048805 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m22:13:45.053276 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m22:13:45.053276 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 22:13:45.049268 => 22:13:45.053276
[0m22:13:45.053276 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m22:13:45.061976 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m22:13:45.065112 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m22:13:45.066182 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m22:13:45.067185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:46.171868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:13:46.178984 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 22:13:45.053276 => 22:13:46.177851
[0m22:13:46.179625 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m22:13:46.341652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F97A4A110>]}
[0m22:13:46.341652 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 1.30s]
[0m22:13:46.341652 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m22:13:46.341652 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m22:13:46.341652 [info ] [Thread-1 (]: 4 of 12 START sql view model dfb.stg_nfl_teams ................................. [RUN]
[0m22:13:46.358150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m22:13:46.360236 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m22:13:46.367195 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m22:13:46.368199 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 22:13:46.361141 => 22:13:46.368199
[0m22:13:46.369187 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m22:13:46.373198 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m22:13:46.375151 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m22:13:46.375151 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m22:13:46.376226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:47.203381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:13:47.208360 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 22:13:46.370150 => 22:13:47.208360
[0m22:13:47.209366 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m22:13:47.342509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9744F1D0>]}
[0m22:13:47.342509 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dfb.stg_nfl_teams ............................ [[32mSUCCESS 1[0m in 0.99s]
[0m22:13:47.342509 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m22:13:47.342509 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:13:47.342509 [info ] [Thread-1 (]: 5 of 12 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:13:47.355091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b)
[0m22:13:47.356850 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:13:47.380049 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:13:47.382991 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:13:47.357327 => 22:13:47.382100
[0m22:13:47.383985 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:13:47.397379 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:13:47.397379 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:13:47.397379 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:13:47.397379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:48.177888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:13:48.177888 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:13:47.385031 => 22:13:48.177888
[0m22:13:48.177888 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:13:48.309899 [info ] [Thread-1 (]: 5 of 12 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.97s]
[0m22:13:48.325433 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:13:48.325433 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:13:48.325433 [info ] [Thread-1 (]: 6 of 12 START test not_null_dim_dfb_nfl_data_date .............................. [RUN]
[0m22:13:48.331666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:13:48.332721 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:13:48.336799 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:13:48.336799 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:13:48.333372 => 22:13:48.336799
[0m22:13:48.336799 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:13:48.350426 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:13:48.353438 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:13:48.353438 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:13:48.354478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:49.094168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:13:49.094168 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:13:48.336799 => 22:13:49.094168
[0m22:13:49.094168 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:13:49.229380 [info ] [Thread-1 (]: 6 of 12 PASS not_null_dim_dfb_nfl_data_date .................................... [[32mPASS[0m in 0.90s]
[0m22:13:49.231915 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:13:49.232873 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:13:49.233940 [info ] [Thread-1 (]: 7 of 12 START test not_null_dim_dfb_nfl_data_name .............................. [RUN]
[0m22:13:49.236336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:13:49.237380 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:13:49.245335 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:13:49.247818 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:13:49.238396 => 22:13:49.247391
[0m22:13:49.249344 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:13:49.252446 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:13:49.254481 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:13:49.255422 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:13:49.255422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:49.976049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:13:49.997937 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:13:49.249344 => 22:13:49.996941
[0m22:13:49.998936 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:13:50.130833 [info ] [Thread-1 (]: 7 of 12 PASS not_null_dim_dfb_nfl_data_name .................................... [[32mPASS[0m in 0.89s]
[0m22:13:50.130833 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:13:50.130833 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:13:50.130833 [info ] [Thread-1 (]: 8 of 12 START test positive_value_dim_dfb_nfl_data_salary ...................... [RUN]
[0m22:13:50.138691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:13:50.140311 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:13:50.150179 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:13:50.140832 => 22:13:50.150179
[0m22:13:50.154404 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:13:50.154404 [error] [Thread-1 (]: 8 of 12 ERROR positive_value_dim_dfb_nfl_data_salary ........................... [[31mERROR[0m in 0.02s]
[0m22:13:50.154404 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:13:50.154404 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:13:50.154404 [info ] [Thread-1 (]: 9 of 12 START test ppg_greater_zero_dim_dfb_nfl_data_PPG ....................... [RUN]
[0m22:13:50.162995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00)
[0m22:13:50.163996 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:13:50.171064 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00 (compile): 22:13:50.164997 => 22:13:50.170015
[0m22:13:50.171064 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:13:50.171064 [error] [Thread-1 (]: 9 of 12 ERROR ppg_greater_zero_dim_dfb_nfl_data_PPG ............................ [[31mERROR[0m in 0.01s]
[0m22:13:50.171064 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:13:50.171064 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:13:50.171064 [info ] [Thread-1 (]: 10 of 12 START test value_test ................................................. [RUN]
[0m22:13:50.182518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00, now test.dfb_data.value_test)
[0m22:13:50.182518 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:13:50.200345 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:13:50.202306 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:13:50.182518 => 22:13:50.201348
[0m22:13:50.203317 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:13:50.203511 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:13:50.203511 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:13:50.203511 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:13:50.203511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:51.094207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:13:51.095644 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:13:50.203511 => 22:13:51.095644
[0m22:13:51.095644 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:13:51.229703 [info ] [Thread-1 (]: 10 of 12 PASS value_test ....................................................... [[32mPASS[0m in 1.05s]
[0m22:13:51.245327 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:13:51.245327 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m22:13:51.245327 [info ] [Thread-1 (]: 11 of 12 START python table model dfb.py_nfl_data .............................. [RUN]
[0m22:13:51.252045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.value_test, now model.dfb_data.py_nfl_data)
[0m22:13:51.253778 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m22:13:51.281865 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m22:13:51.281865 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 22:13:51.254390 => 22:13:51.281865
[0m22:13:51.281865 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m22:13:51.319172 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m22:13:51.323134 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m22:13:51.324132 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m22:13:51.325135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:54.062548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:13:54.062548 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 22:13:51.281865 => 22:13:54.062548
[0m22:13:54.062548 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m22:13:54.210621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9219DA10>]}
[0m22:13:54.210621 [info ] [Thread-1 (]: 11 of 12 OK created python table model dfb.py_nfl_data ......................... [[32mSUCCESS 1[0m in 2.97s]
[0m22:13:54.210621 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m22:13:54.210621 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m22:13:54.210621 [info ] [Thread-1 (]: 12 of 12 START python table model dfb.fct_nfl_teams ............................ [RUN]
[0m22:13:54.224090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m22:13:54.225930 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m22:13:54.233445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m22:13:54.235399 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 22:13:54.226397 => 22:13:54.234459
[0m22:13:54.236443 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m22:13:54.240406 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m22:13:54.242403 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m22:13:54.243463 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m22:13:54.244442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:56.946631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:13:56.946631 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 22:13:54.236443 => 22:13:56.946631
[0m22:13:56.946631 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m22:13:57.094882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9230d327-a1c9-4fb3-be81-a9b49878dd5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F979F4410>]}
[0m22:13:57.094882 [info ] [Thread-1 (]: 12 of 12 OK created python table model dfb.fct_nfl_teams ....................... [[32mSUCCESS 1[0m in 2.87s]
[0m22:13:57.094882 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m22:13:57.094882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:57.094882 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m22:13:57.094882 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:13:57.094882 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m22:13:57.094882 [info ] [MainThread]: 
[0m22:13:57.094882 [info ] [MainThread]: Finished running 1 seed, 3 view models, 6 tests, 2 table models in 0 hours 0 minutes and 17.83 seconds (17.83s).
[0m22:13:57.115150 [debug] [MainThread]: Command end result
[0m22:13:57.133132 [info ] [MainThread]: 
[0m22:13:57.135355 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:13:57.135355 [info ] [MainThread]: 
[0m22:13:57.135355 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:13:57.135355 [info ] [MainThread]: 
[0m22:13:57.135355 [error] [MainThread]:   Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:13:57.142634 [info ] [MainThread]: 
[0m22:13:57.144165 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m22:13:57.148172 [debug] [MainThread]: Command `dbt build` failed at 22:13:57.147186 after 19.01 seconds
[0m22:13:57.149179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F8E821FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9572BC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F95728650>]}
[0m22:13:57.150227 [debug] [MainThread]: Flushing usage events
[0m22:20:39.809447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E685DD310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E685DFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E685DD1D0>]}


============================== 22:20:39.825017 | db90177e-c24a-4b39-b70f-752f7f618815 ==============================
[0m22:20:39.825017 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:20:39.825017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:20:40.429335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6A1F0C90>]}
[0m22:20:40.529963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E69131C90>]}
[0m22:20:40.529963 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:20:40.564088 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:20:40.846615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:20:40.846615 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\positive_value.sql
[0m22:20:40.879880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6A2FB190>]}
[0m22:20:40.963442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6A3E15D0>]}
[0m22:20:40.963442 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 809 macros, 0 groups, 0 semantic models
[0m22:20:40.963442 [info ] [MainThread]: 
[0m22:20:40.974512 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:20:40.978688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m22:20:40.997749 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m22:20:40.999143 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m22:20:40.999143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:42.088596 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:20:42.094181 [debug] [ThreadPool]: On list_storage: Close
[0m22:20:42.268462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:20:42.279596 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:20:42.279596 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:20:42.279596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:43.029232 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:20:43.046993 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:20:43.194360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6A49B550>]}
[0m22:20:43.194360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:20:43.194360 [info ] [MainThread]: 
[0m22:20:43.213341 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m22:20:43.215331 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m22:20:43.215331 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m22:20:43.223325 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m22:20:43.225336 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 22:20:43.216330 => 22:20:43.224325
[0m22:20:43.226328 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m22:20:43.227327 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m22:20:43.229381 [info ] [Thread-1 (]: 1 of 12 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m22:20:43.229381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m22:20:43.229381 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m22:20:43.229381 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 22:20:43.229381 => 22:20:43.229381
[0m22:20:43.229381 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m22:20:43.278849 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:20:43.279862 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m22:20:43.281279 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:20:44.161118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:44.161118 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:20:44.161118 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m22:20:44.377992 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:20:44.377992 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:20:44.394056 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m22:20:44.780026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:20:44.795705 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:20:44.796975 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m22:20:44.920318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:20:44.923318 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:20:44.924317 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m22:20:45.314693 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 0.0 seconds
[0m22:20:45.315692 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m22:20:45.316688 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m22:20:45.573777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:20:45.580021 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m22:20:45.595586 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 22:20:43.229381 => 22:20:45.595586
[0m22:20:45.595586 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m22:20:45.757694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6A2F9050>]}
[0m22:20:45.759690 [info ] [Thread-1 (]: 1 of 12 OK loaded seed file dfb.seed_nfl_teams ................................. [[32mINSERT 31[0m in 2.53s]
[0m22:20:45.761689 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m22:20:45.763545 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m22:20:45.765556 [info ] [Thread-1 (]: 2 of 12 START sql view model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m22:20:45.768434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m22:20:45.769432 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m22:20:45.780809 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m22:20:45.780809 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 22:20:45.769432 => 22:20:45.780809
[0m22:20:45.795974 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m22:20:45.814661 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m22:20:45.814661 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m22:20:45.814661 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Player_ID
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
  );
[0m22:20:45.814661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:46.929202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:46.934064 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 22:20:45.796992 => 22:20:46.934064
[0m22:20:46.935077 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m22:20:47.097502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6A1C12D0>]}
[0m22:20:47.097502 [info ] [Thread-1 (]: 2 of 12 OK created sql view model dfb.dim_dfb_nfl_data ......................... [[32mSUCCESS 1[0m in 1.33s]
[0m22:20:47.097502 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m22:20:47.103900 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m22:20:47.103900 [info ] [Thread-1 (]: 3 of 12 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m22:20:47.107283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m22:20:47.107283 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m22:20:47.117498 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m22:20:47.118637 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 22:20:47.107283 => 22:20:47.118637
[0m22:20:47.118637 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m22:20:47.118637 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m22:20:47.118637 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m22:20:47.118637 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m22:20:47.118637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:48.130423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:48.134441 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 22:20:47.118637 => 22:20:48.134441
[0m22:20:48.135432 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m22:20:48.279066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6A2B3750>]}
[0m22:20:48.280827 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 1.17s]
[0m22:20:48.280827 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m22:20:48.280827 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m22:20:48.280827 [info ] [Thread-1 (]: 4 of 12 START sql view model dfb.stg_nfl_teams ................................. [RUN]
[0m22:20:48.289714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m22:20:48.290785 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m22:20:48.299878 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m22:20:48.299878 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 22:20:48.292451 => 22:20:48.299878
[0m22:20:48.299878 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m22:20:48.299878 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m22:20:48.299878 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m22:20:48.299878 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m22:20:48.299878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:49.163939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:49.163939 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 22:20:48.299878 => 22:20:49.163939
[0m22:20:49.163939 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m22:20:49.312081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6A993DD0>]}
[0m22:20:49.312081 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dfb.stg_nfl_teams ............................ [[32mSUCCESS 1[0m in 1.03s]
[0m22:20:49.312081 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m22:20:49.312081 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:20:49.312081 [info ] [Thread-1 (]: 5 of 12 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:20:49.324484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b)
[0m22:20:49.325496 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:20:49.347171 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:20:49.348446 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:20:49.326672 => 22:20:49.348446
[0m22:20:49.348446 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:20:49.364579 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:20:49.364579 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:20:49.364579 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:20:49.364579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:50.145393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:50.145393 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:20:49.348446 => 22:20:50.145393
[0m22:20:50.145393 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:20:50.279518 [info ] [Thread-1 (]: 5 of 12 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.97s]
[0m22:20:50.279518 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:20:50.294531 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:20:50.294531 [info ] [Thread-1 (]: 6 of 12 START test not_null_dim_dfb_nfl_data_date .............................. [RUN]
[0m22:20:50.298790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:20:50.299806 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:20:50.304404 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:20:50.304404 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:20:50.301349 => 22:20:50.304404
[0m22:20:50.313168 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:20:50.318452 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:20:50.319453 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:20:50.320604 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:20:50.320604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:51.077677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:51.093119 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:20:50.314222 => 22:20:51.077677
[0m22:20:51.093119 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:20:51.245916 [info ] [Thread-1 (]: 6 of 12 PASS not_null_dim_dfb_nfl_data_date .................................... [[32mPASS[0m in 0.95s]
[0m22:20:51.245916 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:20:51.245916 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:20:51.245916 [info ] [Thread-1 (]: 7 of 12 START test not_null_dim_dfb_nfl_data_name .............................. [RUN]
[0m22:20:51.256148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:20:51.257496 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:20:51.266386 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:20:51.268336 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:20:51.257994 => 22:20:51.268336
[0m22:20:51.269446 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:20:51.270390 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:20:51.270390 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:20:51.270390 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:20:51.270390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:52.013747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:52.013747 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:20:51.269446 => 22:20:52.013747
[0m22:20:52.029390 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:20:52.160291 [info ] [Thread-1 (]: 7 of 12 PASS not_null_dim_dfb_nfl_data_name .................................... [[32mPASS[0m in 0.91s]
[0m22:20:52.160291 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:20:52.160291 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:20:52.160291 [info ] [Thread-1 (]: 8 of 12 START test positive_value_dim_dfb_nfl_data_salary ...................... [RUN]
[0m22:20:52.175573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:20:52.177588 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:20:52.181200 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:20:52.178587 => 22:20:52.181200
[0m22:20:52.181200 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:20:52.181200 [error] [Thread-1 (]: 8 of 12 ERROR positive_value_dim_dfb_nfl_data_salary ........................... [[31mERROR[0m in 0.02s]
[0m22:20:52.181200 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:20:52.181200 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:20:52.181200 [info ] [Thread-1 (]: 9 of 12 START test ppg_greater_zero_dim_dfb_nfl_data_PPG ....................... [RUN]
[0m22:20:52.198019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00)
[0m22:20:52.199100 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:20:52.204065 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00 (compile): 22:20:52.199100 => 22:20:52.204065
[0m22:20:52.206054 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:20:52.207607 [error] [Thread-1 (]: 9 of 12 ERROR ppg_greater_zero_dim_dfb_nfl_data_PPG ............................ [[31mERROR[0m in 0.01s]
[0m22:20:52.209625 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:20:52.210678 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:20:52.210678 [info ] [Thread-1 (]: 10 of 12 START test value_test ................................................. [RUN]
[0m22:20:52.214455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00, now test.dfb_data.value_test)
[0m22:20:52.214455 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:20:52.214455 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:20:52.214455 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:20:52.214455 => 22:20:52.214455
[0m22:20:52.214455 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:20:52.214455 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:20:52.230245 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:20:52.232608 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:20:52.233721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:53.111503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:53.111503 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:20:52.214455 => 22:20:53.111503
[0m22:20:53.111503 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:20:53.254148 [info ] [Thread-1 (]: 10 of 12 PASS value_test ....................................................... [[32mPASS[0m in 1.04s]
[0m22:20:53.257078 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:20:53.258133 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m22:20:53.260121 [info ] [Thread-1 (]: 11 of 12 START python table model dfb.py_nfl_data .............................. [RUN]
[0m22:20:53.262732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.value_test, now model.dfb_data.py_nfl_data)
[0m22:20:53.263766 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m22:20:53.287565 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m22:20:53.287565 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 22:20:53.264799 => 22:20:53.287565
[0m22:20:53.287565 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m22:20:53.314732 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m22:20:53.314732 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m22:20:53.314732 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m22:20:53.314732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:56.016171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:20:56.016171 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 22:20:53.287565 => 22:20:56.016171
[0m22:20:56.016171 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m22:20:56.162844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6A5F7AD0>]}
[0m22:20:56.162844 [info ] [Thread-1 (]: 11 of 12 OK created python table model dfb.py_nfl_data ......................... [[32mSUCCESS 1[0m in 2.90s]
[0m22:20:56.178472 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m22:20:56.179055 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m22:20:56.180069 [info ] [Thread-1 (]: 12 of 12 START python table model dfb.fct_nfl_teams ............................ [RUN]
[0m22:20:56.182671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m22:20:56.183670 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m22:20:56.188667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m22:20:56.190668 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 22:20:56.183670 => 22:20:56.190668
[0m22:20:56.191667 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m22:20:56.196668 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m22:20:56.198695 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m22:20:56.199667 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m22:20:56.200668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:58.766208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:20:58.771215 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 22:20:56.191667 => 22:20:58.771215
[0m22:20:58.772200 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m22:20:58.896624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db90177e-c24a-4b39-b70f-752f7f618815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E6AA7A610>]}
[0m22:20:58.896624 [info ] [Thread-1 (]: 12 of 12 OK created python table model dfb.fct_nfl_teams ....................... [[32mSUCCESS 1[0m in 2.71s]
[0m22:20:58.896624 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m22:20:58.915371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:58.916384 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m22:20:58.916384 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:20:58.917385 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m22:20:58.918396 [info ] [MainThread]: 
[0m22:20:58.919344 [info ] [MainThread]: Finished running 1 seed, 3 view models, 6 tests, 2 table models in 0 hours 0 minutes and 17.95 seconds (17.95s).
[0m22:20:58.924851 [debug] [MainThread]: Command end result
[0m22:20:58.945532 [info ] [MainThread]: 
[0m22:20:58.947541 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:20:58.948635 [info ] [MainThread]: 
[0m22:20:58.948635 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:20:58.948635 [info ] [MainThread]: 
[0m22:20:58.955695 [error] [MainThread]:   Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:20:58.957648 [info ] [MainThread]: 
[0m22:20:58.959574 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m22:20:58.962853 [debug] [MainThread]: Command `dbt build` failed at 22:20:58.961766 after 19.23 seconds
[0m22:20:58.963840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E616F1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E685DFAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E685DD310>]}
[0m22:20:58.965776 [debug] [MainThread]: Flushing usage events
[0m22:24:07.809422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6145DB150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6145A0990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6145CBFD0>]}


============================== 22:24:07.825071 | adebd4d8-a393-4c1f-818c-8cf842710235 ==============================
[0m22:24:07.825071 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:24:07.825071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:24:08.429644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61511D810>]}
[0m22:24:08.534830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6150CA250>]}
[0m22:24:08.536893 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:24:08.567637 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:24:08.876001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m22:24:08.876971 [debug] [MainThread]: Partial parsing: added file: dfb_data://macros\no_null_in_columns.sql
[0m22:24:08.876971 [debug] [MainThread]: Partial parsing: added file: dfb_data://tests\no_nulls_in_dim_dfb.sql
[0m22:24:09.047616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61661FB50>]}
[0m22:24:09.079282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B616412650>]}
[0m22:24:09.079282 [info ] [MainThread]: Found 6 models, 1 seed, 7 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m22:24:09.081289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61626E010>]}
[0m22:24:09.083348 [info ] [MainThread]: 
[0m22:24:09.085292 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:09.088201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m22:24:09.104845 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m22:24:09.105800 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m22:24:09.105800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:10.125702 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:24:10.125702 [debug] [ThreadPool]: On list_storage: Close
[0m22:24:10.280200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:24:10.302660 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:24:10.303660 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:24:10.304616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:11.030264 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:24:11.030264 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:24:11.163464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6162C4A50>]}
[0m22:24:11.163464 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:11.163464 [info ] [MainThread]: 
[0m22:24:11.178477 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m22:24:11.178477 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m22:24:11.178477 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m22:24:11.194180 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m22:24:11.195823 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 22:24:11.178477 => 22:24:11.195823
[0m22:24:11.198425 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m22:24:11.198425 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m22:24:11.200626 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m22:24:11.201992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m22:24:11.203032 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m22:24:11.207099 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m22:24:11.207099 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 22:24:11.203032 => 22:24:11.207099
[0m22:24:11.207099 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m22:24:11.243188 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m22:24:11.245128 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m22:24:11.246343 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m22:24:11.246343 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:24:12.030022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:24:12.055230 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 22:24:11.207099 => 22:24:12.055230
[0m22:24:12.055230 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m22:24:12.238506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6167F8110>]}
[0m22:24:12.240503 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.04s]
[0m22:24:12.242501 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m22:24:12.243524 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m22:24:12.245499 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m22:24:12.262664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m22:24:12.262664 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m22:24:12.298071 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m22:24:12.298071 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 22:24:12.262664 => 22:24:12.298071
[0m22:24:12.298071 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m22:24:12.298071 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m22:24:12.298071 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m22:24:12.298071 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Player_ID
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
  );
[0m22:24:12.298071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:13.278804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:24:13.278804 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 22:24:12.298071 => 22:24:13.278804
[0m22:24:13.278804 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m22:24:13.441227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B616430B10>]}
[0m22:24:13.443239 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.18s]
[0m22:24:13.446236 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m22:24:13.447236 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m22:24:13.448344 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m22:24:13.451370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m22:24:13.452383 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m22:24:13.458151 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m22:24:13.458151 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 22:24:13.453164 => 22:24:13.458151
[0m22:24:13.462275 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m22:24:13.467614 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m22:24:13.470615 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m22:24:13.470730 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m22:24:13.470730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:14.474337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:24:14.474337 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 22:24:13.462275 => 22:24:14.474337
[0m22:24:14.474337 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m22:24:14.612940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B616486CD0>]}
[0m22:24:14.612940 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.16s]
[0m22:24:14.612940 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m22:24:14.612940 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m22:24:14.612940 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m22:24:14.628858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m22:24:14.629913 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m22:24:14.648196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m22:24:14.648196 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 22:24:14.630907 => 22:24:14.648196
[0m22:24:14.648196 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m22:24:14.681053 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m22:24:14.681053 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m22:24:14.681053 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m22:24:14.681053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:17.596122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:24:17.596122 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 22:24:14.648196 => 22:24:17.596122
[0m22:24:17.596122 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m22:24:17.744553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61686A150>]}
[0m22:24:17.744553 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 3.12s]
[0m22:24:17.744553 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m22:24:17.744553 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m22:24:17.744553 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m22:24:17.756647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m22:24:17.757664 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m22:24:17.766958 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m22:24:17.768431 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 22:24:17.759042 => 22:24:17.768431
[0m22:24:17.769485 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m22:24:17.773481 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m22:24:17.776485 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m22:24:17.777457 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m22:24:17.777457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:20.446158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:24:20.446158 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 22:24:17.769485 => 22:24:20.446158
[0m22:24:20.446158 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m22:24:20.590616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adebd4d8-a393-4c1f-818c-8cf842710235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B616A97D10>]}
[0m22:24:20.592617 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 2.85s]
[0m22:24:20.595892 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m22:24:20.595892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:20.595892 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m22:24:20.595892 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:24:20.595892 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m22:24:20.595892 [info ] [MainThread]: 
[0m22:24:20.595892 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 11.51 seconds (11.51s).
[0m22:24:20.608595 [debug] [MainThread]: Command end result
[0m22:24:20.621192 [info ] [MainThread]: 
[0m22:24:20.628956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:24:20.631931 [info ] [MainThread]: 
[0m22:24:20.631931 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:24:20.636549 [debug] [MainThread]: Command `dbt run` succeeded at 22:24:20.636549 after 12.90 seconds
[0m22:24:20.636549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60D761FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61406BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B61406BBD0>]}
[0m22:24:20.637554 [debug] [MainThread]: Flushing usage events
[0m22:24:32.910379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6D1798D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6D1D3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6D1D08D0>]}


============================== 22:24:32.910379 | 89a5386c-a058-43d9-b15c-b46e61478260 ==============================
[0m22:24:32.910379 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:24:32.910379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:24:33.540584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89a5386c-a058-43d9-b15c-b46e61478260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6DCD1450>]}
[0m22:24:33.645384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89a5386c-a058-43d9-b15c-b46e61478260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6D2C96D0>]}
[0m22:24:33.645384 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:24:33.674585 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:24:33.946605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:24:33.946605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:24:33.946605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89a5386c-a058-43d9-b15c-b46e61478260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6EFF1C50>]}
[0m22:24:33.979888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89a5386c-a058-43d9-b15c-b46e61478260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6EEEB750>]}
[0m22:24:33.979888 [info ] [MainThread]: Found 6 models, 1 seed, 7 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m22:24:33.979888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89a5386c-a058-43d9-b15c-b46e61478260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6ED8A750>]}
[0m22:24:33.979888 [info ] [MainThread]: 
[0m22:24:33.979888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:33.979888 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:24:34.003823 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:24:34.003823 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:24:34.003823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:35.016369 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:24:35.021359 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:24:35.163485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89a5386c-a058-43d9-b15c-b46e61478260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6EE5E110>]}
[0m22:24:35.163485 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:24:35.163485 [info ] [MainThread]: 
[0m22:24:35.179134 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:24:35.179134 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:24:35.184429 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:24:35.186336 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:24:35.213435 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:24:35.215624 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:24:35.186917 => 22:24:35.215624
[0m22:24:35.215624 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:24:35.241897 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:24:35.243904 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:24:35.244899 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:24:35.245900 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:24:36.061561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:24:36.077051 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:24:35.215624 => 22:24:36.077051
[0m22:24:36.077051 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:24:36.232274 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.05s]
[0m22:24:36.234415 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:24:36.236370 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:24:36.237366 [info ] [Thread-1 (]: 2 of 7 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m22:24:36.240423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.no_nulls_in_dim_dfb)
[0m22:24:36.240423 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m22:24:36.248303 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:24:36.248303 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m22:24:36.248303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:36.971853 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.0 seconds
[0m22:24:36.975826 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:24:36.977784 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 22:24:36.241427 => 22:24:36.977784
[0m22:24:36.978786 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m22:24:36.979163 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:24:36.979163 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:24:36.979163 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m22:24:37.128688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:24:37.128688 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 22:24:36.979163 => 22:24:37.128688
[0m22:24:37.128688 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m22:24:37.259122 [error] [Thread-1 (]: 2 of 7 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 1.02s]
[0m22:24:37.259122 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:24:37.259122 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:24:37.259122 [info ] [Thread-1 (]: 3 of 7 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:24:37.272540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:24:37.273603 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:24:37.286694 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:24:37.288644 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:24:37.274664 => 22:24:37.287708
[0m22:24:37.288644 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:24:37.293644 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:24:37.295713 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:24:37.297714 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:24:37.298966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:38.055799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:24:38.058794 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:24:37.289687 => 22:24:38.058794
[0m22:24:38.059782 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:24:38.193664 [info ] [Thread-1 (]: 3 of 7 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.93s]
[0m22:24:38.193664 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:24:38.193664 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:24:38.193664 [info ] [Thread-1 (]: 4 of 7 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:24:38.206481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:24:38.208307 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:24:38.213962 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:24:38.213962 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:24:38.209005 => 22:24:38.213962
[0m22:24:38.213962 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:24:38.213962 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:24:38.213962 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:24:38.213962 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:24:38.213962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:38.964645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:24:38.979317 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:24:38.213962 => 22:24:38.964645
[0m22:24:39.013310 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:24:39.146049 [info ] [Thread-1 (]: 4 of 7 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.95s]
[0m22:24:39.161541 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:24:39.161541 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:24:39.161541 [info ] [Thread-1 (]: 5 of 7 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m22:24:39.169156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:24:39.171187 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:24:39.179924 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:24:39.171375 => 22:24:39.178915
[0m22:24:39.186112 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:24:39.187331 [error] [Thread-1 (]: 5 of 7 ERROR positive_value_dim_dfb_nfl_data_salary ............................ [[31mERROR[0m in 0.03s]
[0m22:24:39.187331 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:24:39.187331 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:24:39.187331 [info ] [Thread-1 (]: 6 of 7 START test ppg_greater_zero_dim_dfb_nfl_data_PPG ........................ [RUN]
[0m22:24:39.187331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00)
[0m22:24:39.187331 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:24:39.202375 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00 (compile): 22:24:39.195555 => 22:24:39.202375
[0m22:24:39.203651 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:24:39.203651 [error] [Thread-1 (]: 6 of 7 ERROR ppg_greater_zero_dim_dfb_nfl_data_PPG ............................. [[31mERROR[0m in 0.02s]
[0m22:24:39.203651 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:24:39.209121 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:24:39.210172 [info ] [Thread-1 (]: 7 of 7 START test value_test ................................................... [RUN]
[0m22:24:39.212132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00, now test.dfb_data.value_test)
[0m22:24:39.213637 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:24:39.219982 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:24:39.221940 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:24:39.213637 => 22:24:39.220983
[0m22:24:39.222970 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:24:39.226984 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:24:39.228936 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:24:39.231362 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:24:39.232371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:24:40.032914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:24:40.032914 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:24:39.222970 => 22:24:40.032914
[0m22:24:40.045978 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:24:40.192923 [info ] [Thread-1 (]: 7 of 7 PASS value_test ......................................................... [[32mPASS[0m in 0.97s]
[0m22:24:40.192923 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:24:40.192923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:40.192923 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:24:40.192923 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m22:24:40.192923 [info ] [MainThread]: 
[0m22:24:40.192923 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m22:24:40.208137 [debug] [MainThread]: Command end result
[0m22:24:40.227864 [info ] [MainThread]: 
[0m22:24:40.229870 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m22:24:40.232045 [info ] [MainThread]: 
[0m22:24:40.232045 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m22:24:40.236150 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m22:24:40.237139 [info ] [MainThread]: 
[0m22:24:40.238923 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m22:24:40.240001 [info ] [MainThread]: 
[0m22:24:40.243115 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:24:40.244110 [info ] [MainThread]: 
[0m22:24:40.246118 [error] [MainThread]:   Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:24:40.248123 [info ] [MainThread]: 
[0m22:24:40.249978 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
[0m22:24:40.253030 [debug] [MainThread]: Command `dbt test` failed at 22:24:40.253030 after 7.42 seconds
[0m22:24:40.254156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B66271F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6D1951D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B6D1957D0>]}
[0m22:24:40.254156 [debug] [MainThread]: Flushing usage events
[0m22:35:28.012506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131CF80B490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131CF28C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131CF28BDD0>]}


============================== 22:35:28.028171 | e5cc4ebd-a5f0-453c-a4f0-8aa13d6aeb28 ==============================
[0m22:35:28.028171 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:35:28.028171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:35:28.643421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5cc4ebd-a5f0-453c-a4f0-8aa13d6aeb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131CF7B93D0>]}
[0m22:35:28.740909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5cc4ebd-a5f0-453c-a4f0-8aa13d6aeb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131D0350A50>]}
[0m22:35:28.743101 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:35:28.773569 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:35:29.025957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:35:29.025957 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m22:35:29.191918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5cc4ebd-a5f0-453c-a4f0-8aa13d6aeb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131D149C690>]}
[0m22:35:29.212823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5cc4ebd-a5f0-453c-a4f0-8aa13d6aeb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131D16A8190>]}
[0m22:35:29.212823 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m22:35:29.212823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5cc4ebd-a5f0-453c-a4f0-8aa13d6aeb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131D148A790>]}
[0m22:35:29.212823 [info ] [MainThread]: 
[0m22:35:29.212823 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:35:29.212823 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:35:29.235863 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:35:29.235863 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:35:29.235863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:30.194981 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:35:30.210458 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:35:30.360970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5cc4ebd-a5f0-453c-a4f0-8aa13d6aeb28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131D14D3A90>]}
[0m22:35:30.361969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:30.363096 [info ] [MainThread]: 
[0m22:35:30.363096 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:35:30.363096 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:35:30.371793 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:35:30.373046 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:35:30.397867 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:35:30.398960 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:35:30.374101 => 22:35:30.398960
[0m22:35:30.398960 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:35:30.413955 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:35:30.413955 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:35:30.413955 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:35:30.413955 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:35:31.210894 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:35:31.219895 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:35:30.398960 => 22:35:31.219895
[0m22:35:31.220893 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:35:31.362366 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.00s]
[0m22:35:31.363503 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:35:31.363503 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:35:31.363503 [info ] [Thread-1 (]: 2 of 8 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m22:35:31.369398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.no_nulls_in_dim_dfb)
[0m22:35:31.371012 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m22:35:31.387354 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:35:31.387354 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m22:35:31.387354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:32.129189 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.0 seconds
[0m22:35:32.129189 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:35:32.129189 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 22:35:31.371012 => 22:35:32.129189
[0m22:35:32.129189 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m22:35:32.129189 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:35:32.129189 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:35:32.144807 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m22:35:32.243875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:35:32.259401 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 22:35:32.129189 => 22:35:32.259401
[0m22:35:32.259401 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m22:35:32.381301 [error] [Thread-1 (]: 2 of 8 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 1.02s]
[0m22:35:32.397148 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:35:32.399122 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:35:32.400124 [info ] [Thread-1 (]: 3 of 8 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:35:32.402115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:35:32.403158 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:35:32.412491 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:35:32.414503 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:35:32.403158 => 22:35:32.414503
[0m22:35:32.416498 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:35:32.420546 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:35:32.421547 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:35:32.422501 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:35:32.423501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:33.163084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:35:33.163084 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:35:32.417590 => 22:35:33.163084
[0m22:35:33.179884 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:35:33.327149 [info ] [Thread-1 (]: 3 of 8 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.91s]
[0m22:35:33.327149 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:35:33.327149 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:35:33.327149 [info ] [Thread-1 (]: 4 of 8 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:35:33.335581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:35:33.336598 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:35:33.341184 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:35:33.346962 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:35:33.338059 => 22:35:33.345954
[0m22:35:33.349085 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:35:33.354424 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:35:33.354424 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:35:33.354424 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:35:33.354424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:34.045482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:35:34.045482 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:35:33.350161 => 22:35:34.045482
[0m22:35:34.045482 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:35:34.183914 [info ] [Thread-1 (]: 4 of 8 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.86s]
[0m22:35:34.183914 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:35:34.183914 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:35:34.195469 [info ] [Thread-1 (]: 5 of 8 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m22:35:34.195469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:35:34.195469 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:35:34.195469 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:35:34.195469 => 22:35:34.195469
[0m22:35:34.195469 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:35:34.195469 [error] [Thread-1 (]: 5 of 8 ERROR positive_value_dim_dfb_nfl_data_salary ............................ [[31mERROR[0m in 0.00s]
[0m22:35:34.217352 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:35:34.217352 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero
[0m22:35:34.217352 [info ] [Thread-1 (]: 6 of 8 START test ppg_greater_zero ............................................. [RUN]
[0m22:35:34.217352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.ppg_greater_zero)
[0m22:35:34.217352 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero
[0m22:35:34.217352 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.ppg_greater_zero"
[0m22:35:34.232178 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (compile): 22:35:34.217352 => 22:35:34.232178
[0m22:35:34.233178 [debug] [Thread-1 (]: Began executing node test.dfb_data.ppg_greater_zero
[0m22:35:34.237194 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.ppg_greater_zero"
[0m22:35:34.282664 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.ppg_greater_zero"
[0m22:35:34.282664 [debug] [Thread-1 (]: On test.dfb_data.ppg_greater_zero: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.ppg_greater_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
  < 1

      
    ) dbt_internal_test
[0m22:35:34.284222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:35.508997 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b828d7-0102-2a7c-0006-b1e6000326c6
[0m22:35:35.508997 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 2 unexpected '<'.
[0m22:35:35.508997 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (execute): 22:35:34.234177 => 22:35:35.508997
[0m22:35:35.508997 [debug] [Thread-1 (]: On test.dfb_data.ppg_greater_zero: Close
[0m22:35:35.662331 [debug] [Thread-1 (]: Database Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '<'.
  compiled Code at target\run\dfb_data\tests\ppg_greater_zero.sql
[0m22:35:35.662331 [error] [Thread-1 (]: 6 of 8 ERROR ppg_greater_zero .................................................. [[31mERROR[0m in 1.44s]
[0m22:35:35.662331 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero
[0m22:35:35.662331 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:35:35.662331 [info ] [Thread-1 (]: 7 of 8 START test ppg_greater_zero_dim_dfb_nfl_data_PPG ........................ [RUN]
[0m22:35:35.676374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero, now test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00)
[0m22:35:35.677430 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:35:35.682283 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00 (compile): 22:35:35.678637 => 22:35:35.682283
[0m22:35:35.688143 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:35:35.689153 [error] [Thread-1 (]: 7 of 8 ERROR ppg_greater_zero_dim_dfb_nfl_data_PPG ............................. [[31mERROR[0m in 0.03s]
[0m22:35:35.691042 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:35:35.691042 [debug] [Thread-1 (]: Began running node test.dfb_data.value_test
[0m22:35:35.692007 [info ] [Thread-1 (]: 8 of 8 START test value_test ................................................... [RUN]
[0m22:35:35.694155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00, now test.dfb_data.value_test)
[0m22:35:35.696128 [debug] [Thread-1 (]: Began compiling node test.dfb_data.value_test
[0m22:35:35.702566 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.value_test"
[0m22:35:35.704670 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (compile): 22:35:35.698094 => 22:35:35.703569
[0m22:35:35.704670 [debug] [Thread-1 (]: Began executing node test.dfb_data.value_test
[0m22:35:35.704670 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.value_test"
[0m22:35:35.704670 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.value_test"
[0m22:35:35.704670 [debug] [Thread-1 (]: On test.dfb_data.value_test: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.value_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:35:35.704670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:36.462471 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:35:36.477921 [debug] [Thread-1 (]: Timing info for test.dfb_data.value_test (execute): 22:35:35.704670 => 22:35:36.477921
[0m22:35:36.477921 [debug] [Thread-1 (]: On test.dfb_data.value_test: Close
[0m22:35:36.613093 [info ] [Thread-1 (]: 8 of 8 PASS value_test ......................................................... [[32mPASS[0m in 0.92s]
[0m22:35:36.613093 [debug] [Thread-1 (]: Finished running node test.dfb_data.value_test
[0m22:35:36.613093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:36.613093 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:35:36.613093 [debug] [MainThread]: Connection 'test.dfb_data.value_test' was properly closed.
[0m22:35:36.613093 [info ] [MainThread]: 
[0m22:35:36.613093 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m22:35:36.629452 [debug] [MainThread]: Command end result
[0m22:35:36.646593 [info ] [MainThread]: 
[0m22:35:36.648593 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:35:36.650420 [info ] [MainThread]: 
[0m22:35:36.652808 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m22:35:36.654215 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m22:35:36.655815 [info ] [MainThread]: 
[0m22:35:36.656871 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m22:35:36.659842 [info ] [MainThread]: 
[0m22:35:36.660874 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:35:36.662844 [info ] [MainThread]: 
[0m22:35:36.663844 [error] [MainThread]:   Database Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '<'.
  compiled Code at target\run\dfb_data\tests\ppg_greater_zero.sql
[0m22:35:36.666530 [info ] [MainThread]: 
[0m22:35:36.668546 [error] [MainThread]:   Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:35:36.670660 [info ] [MainThread]: 
[0m22:35:36.670660 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
[0m22:35:36.674921 [debug] [MainThread]: Command `dbt test` failed at 22:35:36.674921 after 8.75 seconds
[0m22:35:36.675922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131C88B1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131CF7BEB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131CF7BD7D0>]}
[0m22:35:36.676881 [debug] [MainThread]: Flushing usage events
[0m22:38:40.344030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E1D0C8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E1D22A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E1CE2C90>]}


============================== 22:38:40.360416 | aed9d1df-e225-4e1c-bfdd-93e5fd8809cf ==============================
[0m22:38:40.360416 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:38:40.362427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'send_anonymous_usage_stats': 'True'}
[0m22:38:40.977618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aed9d1df-e225-4e1c-bfdd-93e5fd8809cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E388B150>]}
[0m22:38:41.062956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aed9d1df-e225-4e1c-bfdd-93e5fd8809cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E387F350>]}
[0m22:38:41.062956 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:38:41.104044 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:38:41.363098 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m22:38:41.363098 [debug] [MainThread]: Partial parsing: added file: dfb_data://macros\m_ppg_value.sql
[0m22:38:41.363098 [debug] [MainThread]: Partial parsing: added file: dfb_data://tests\t_ppg_value.sql
[0m22:38:41.363098 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://tests\value_test.sql
[0m22:38:41.363098 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://macros\ppg_value.sql
[0m22:38:41.524631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aed9d1df-e225-4e1c-bfdd-93e5fd8809cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E3DBFCD0>]}
[0m22:38:41.559460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aed9d1df-e225-4e1c-bfdd-93e5fd8809cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E3BC02D0>]}
[0m22:38:41.559460 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m22:38:41.561083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed9d1df-e225-4e1c-bfdd-93e5fd8809cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E38CE6D0>]}
[0m22:38:41.563208 [info ] [MainThread]: 
[0m22:38:41.563208 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:38:41.563208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:38:41.585019 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:38:41.586048 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:38:41.587030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:42.674826 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:38:42.676809 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:38:42.827135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed9d1df-e225-4e1c-bfdd-93e5fd8809cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E39BC110>]}
[0m22:38:42.842707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:38:42.842707 [info ] [MainThread]: 
[0m22:38:42.842707 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:38:42.842707 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:38:42.855762 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:38:42.856783 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:38:42.884284 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:38:42.884284 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:38:42.858282 => 22:38:42.884284
[0m22:38:42.884284 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:38:42.921866 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:38:42.923820 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:38:42.924822 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:38:42.925823 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:43.646049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:38:43.661701 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:38:42.884284 => 22:38:43.661701
[0m22:38:43.661701 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:38:43.792892 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.95s]
[0m22:38:43.808375 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:38:43.808375 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:38:43.808375 [info ] [Thread-1 (]: 2 of 8 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m22:38:43.884917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.no_nulls_in_dim_dfb)
[0m22:38:43.885980 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m22:38:43.901261 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:38:43.901261 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m22:38:43.901261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:44.563145 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.0 seconds
[0m22:38:44.563145 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:38:44.563145 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 22:38:43.886917 => 22:38:44.563145
[0m22:38:44.563145 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m22:38:44.563145 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:38:44.578761 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:38:44.578761 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m22:38:44.678529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:38:44.678529 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 22:38:44.563145 => 22:38:44.678529
[0m22:38:44.678529 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m22:38:44.811508 [error] [Thread-1 (]: 2 of 8 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 0.93s]
[0m22:38:44.811508 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:38:44.811508 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:38:44.811508 [info ] [Thread-1 (]: 3 of 8 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:38:44.823221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:38:44.824278 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:38:44.836477 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:38:44.837507 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:38:44.825612 => 22:38:44.837507
[0m22:38:44.837507 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:38:44.837507 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:38:44.837507 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:38:44.837507 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:38:44.837507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:45.538914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:38:45.543915 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:38:44.837507 => 22:38:45.543915
[0m22:38:45.545887 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:38:45.662737 [info ] [Thread-1 (]: 3 of 8 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.85s]
[0m22:38:45.662737 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:38:45.662737 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:38:45.662737 [info ] [Thread-1 (]: 4 of 8 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:38:45.662737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:38:45.678371 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:38:45.687772 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:38:45.691149 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:38:45.678371 => 22:38:45.690026
[0m22:38:45.691149 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:38:45.696971 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:38:45.699643 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:38:45.699643 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:38:45.699643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:46.403919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:38:46.408897 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:38:45.691149 => 22:38:46.407896
[0m22:38:46.409892 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:38:46.551116 [info ] [Thread-1 (]: 4 of 8 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.89s]
[0m22:38:46.551116 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:38:46.551116 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:38:46.562130 [info ] [Thread-1 (]: 5 of 8 START test positive_value_dim_dfb_nfl_data_salary ....................... [RUN]
[0m22:38:46.564278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1)
[0m22:38:46.565795 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:38:46.570103 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1 (compile): 22:38:46.566872 => 22:38:46.570103
[0m22:38:46.580212 [debug] [Thread-1 (]: Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:38:46.582195 [error] [Thread-1 (]: 5 of 8 ERROR positive_value_dim_dfb_nfl_data_salary ............................ [[31mERROR[0m in 0.02s]
[0m22:38:46.584245 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1
[0m22:38:46.585258 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero
[0m22:38:46.587296 [info ] [Thread-1 (]: 6 of 8 START test ppg_greater_zero ............................................. [RUN]
[0m22:38:46.589626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_dim_dfb_nfl_data_salary.9337154dc1, now test.dfb_data.ppg_greater_zero)
[0m22:38:46.590641 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero
[0m22:38:46.595946 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.ppg_greater_zero"
[0m22:38:46.599457 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (compile): 22:38:46.590641 => 22:38:46.598447
[0m22:38:46.602467 [debug] [Thread-1 (]: Began executing node test.dfb_data.ppg_greater_zero
[0m22:38:46.605465 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.ppg_greater_zero"
[0m22:38:46.607469 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.ppg_greater_zero"
[0m22:38:46.608466 [debug] [Thread-1 (]: On test.dfb_data.ppg_greater_zero: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.ppg_greater_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
  < 1

      
    ) dbt_internal_test
[0m22:38:46.608466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:47.396013 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b828da-0102-2a83-0006-b1e6000316a2
[0m22:38:47.396013 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 2 unexpected '<'.
[0m22:38:47.411440 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (execute): 22:38:46.602467 => 22:38:47.411440
[0m22:38:47.411440 [debug] [Thread-1 (]: On test.dfb_data.ppg_greater_zero: Close
[0m22:38:47.560493 [debug] [Thread-1 (]: Database Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '<'.
  compiled Code at target\run\dfb_data\tests\ppg_greater_zero.sql
[0m22:38:47.560493 [error] [Thread-1 (]: 6 of 8 ERROR ppg_greater_zero .................................................. [[31mERROR[0m in 0.97s]
[0m22:38:47.560493 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero
[0m22:38:47.560493 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:38:47.560493 [info ] [Thread-1 (]: 7 of 8 START test ppg_greater_zero_dim_dfb_nfl_data_PPG ........................ [RUN]
[0m22:38:47.560493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero, now test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00)
[0m22:38:47.560493 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:38:47.579196 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00 (compile): 22:38:47.560493 => 22:38:47.578267
[0m22:38:47.583431 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:38:47.584516 [error] [Thread-1 (]: 7 of 8 ERROR ppg_greater_zero_dim_dfb_nfl_data_PPG ............................. [[31mERROR[0m in 0.02s]
[0m22:38:47.586667 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:38:47.587624 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m22:38:47.588330 [info ] [Thread-1 (]: 8 of 8 START test t_ppg_value .................................................. [RUN]
[0m22:38:47.590008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00, now test.dfb_data.t_ppg_value)
[0m22:38:47.591058 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m22:38:47.596721 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m22:38:47.600637 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 22:38:47.591058 => 22:38:47.600637
[0m22:38:47.601701 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m22:38:47.604764 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m22:38:47.604764 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m22:38:47.604764 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:38:47.604764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:48.308857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:38:48.308857 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 22:38:47.602657 => 22:38:48.308857
[0m22:38:48.308857 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m22:38:48.478404 [info ] [Thread-1 (]: 8 of 8 PASS t_ppg_value ........................................................ [[32mPASS[0m in 0.87s]
[0m22:38:48.478404 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m22:38:48.478404 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:48.478404 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:38:48.478404 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m22:38:48.478404 [info ] [MainThread]: 
[0m22:38:48.478404 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m22:38:48.496867 [debug] [MainThread]: Command end result
[0m22:38:48.556338 [info ] [MainThread]: 
[0m22:38:48.556855 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:38:48.558865 [info ] [MainThread]: 
[0m22:38:48.560887 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m22:38:48.562876 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m22:38:48.563936 [info ] [MainThread]: 
[0m22:38:48.566359 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m22:38:48.567390 [info ] [MainThread]: 
[0m22:38:48.568572 [error] [MainThread]:   Compilation Error in test positive_value_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_positive_value' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:38:48.571915 [info ] [MainThread]: 
[0m22:38:48.572840 [error] [MainThread]:   Database Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '<'.
  compiled Code at target\run\dfb_data\tests\ppg_greater_zero.sql
[0m22:38:48.575205 [info ] [MainThread]: 
[0m22:38:48.577464 [error] [MainThread]:   Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:38:48.580315 [info ] [MainThread]: 
[0m22:38:48.581422 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
[0m22:38:48.583563 [debug] [MainThread]: Command `dbt test` failed at 22:38:48.583563 after 8.32 seconds
[0m22:38:48.583563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DAE11F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5DAE57650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5E38FEC50>]}
[0m22:38:48.583563 [debug] [MainThread]: Flushing usage events
[0m22:44:27.711405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC0F9E850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC0F9D290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC0F9D950>]}


============================== 22:44:27.727036 | 75a084f9-0eb1-4838-bbba-9c914fc68ec5 ==============================
[0m22:44:27.727036 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:44:27.727036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:44:28.286536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75a084f9-0eb1-4838-bbba-9c914fc68ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC2B6A6D0>]}
[0m22:44:28.382813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75a084f9-0eb1-4838-bbba-9c914fc68ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC0FC2950>]}
[0m22:44:28.382813 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:44:28.426862 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:44:28.671988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:44:28.672994 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m22:44:29.118478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a084f9-0eb1-4838-bbba-9c914fc68ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC30CAC90>]}
[0m22:44:29.123742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a084f9-0eb1-4838-bbba-9c914fc68ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC32DFE50>]}
[0m22:44:29.123742 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m22:44:29.139369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a084f9-0eb1-4838-bbba-9c914fc68ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC2D50450>]}
[0m22:44:29.141771 [info ] [MainThread]: 
[0m22:44:29.142951 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:44:29.142951 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:44:29.161487 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:44:29.162530 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:44:29.163095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:30.153799 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:44:30.153799 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:44:30.334171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a084f9-0eb1-4838-bbba-9c914fc68ec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC3090D90>]}
[0m22:44:30.336165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:44:30.337162 [info ] [MainThread]: 
[0m22:44:30.339334 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:44:30.339334 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:44:30.346025 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:44:30.347082 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:44:30.362049 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:44:30.362049 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:44:30.347692 => 22:44:30.362049
[0m22:44:30.362049 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:44:30.389607 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:44:30.389607 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:44:30.389607 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:44:30.389607 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:44:31.109843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:44:31.109843 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:44:30.362049 => 22:44:31.109843
[0m22:44:31.109843 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:44:31.253597 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.91s]
[0m22:44:31.269045 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:44:31.269045 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:44:31.269045 [info ] [Thread-1 (]: 2 of 8 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m22:44:31.269045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.no_nulls_in_dim_dfb)
[0m22:44:31.276909 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m22:44:31.292354 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:44:31.293354 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m22:44:31.294357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:32.007293 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.0 seconds
[0m22:44:32.007293 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:44:32.007293 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 22:44:31.277656 => 22:44:32.007293
[0m22:44:32.007293 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m22:44:32.022785 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:44:32.022785 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:44:32.022785 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m22:44:32.122974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:44:32.138544 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 22:44:32.007293 => 22:44:32.122974
[0m22:44:32.138544 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m22:44:32.287709 [error] [Thread-1 (]: 2 of 8 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 1.02s]
[0m22:44:32.287709 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:44:32.287709 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:44:32.287709 [info ] [Thread-1 (]: 3 of 8 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:44:32.299177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:44:32.300205 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:44:32.311093 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:44:32.313142 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:44:32.301218 => 22:44:32.313142
[0m22:44:32.313142 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:44:32.313142 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:44:32.313142 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:44:32.313142 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:44:32.313142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:33.039532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:44:33.039532 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:44:32.313142 => 22:44:33.039532
[0m22:44:33.055962 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:44:33.251872 [info ] [Thread-1 (]: 3 of 8 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.96s]
[0m22:44:33.251872 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:44:33.251872 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:44:33.251872 [info ] [Thread-1 (]: 4 of 8 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:44:33.266045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:44:33.267058 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:44:33.272937 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:44:33.272937 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:44:33.268048 => 22:44:33.272937
[0m22:44:33.272937 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:44:33.272937 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:44:33.272937 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:44:33.272937 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:44:33.272937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:34.043799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:44:34.043799 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:44:33.272937 => 22:44:34.043799
[0m22:44:34.043799 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:44:34.202633 [info ] [Thread-1 (]: 4 of 8 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.95s]
[0m22:44:34.202633 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:44:34.202633 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero
[0m22:44:34.202633 [info ] [Thread-1 (]: 5 of 8 START test ppg_greater_zero ............................................. [RUN]
[0m22:44:34.220316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.ppg_greater_zero)
[0m22:44:34.221376 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero
[0m22:44:34.227383 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.ppg_greater_zero"
[0m22:44:34.229383 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (compile): 22:44:34.222392 => 22:44:34.229383
[0m22:44:34.230384 [debug] [Thread-1 (]: Began executing node test.dfb_data.ppg_greater_zero
[0m22:44:34.234382 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.ppg_greater_zero"
[0m22:44:34.235552 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.ppg_greater_zero"
[0m22:44:34.237718 [debug] [Thread-1 (]: On test.dfb_data.ppg_greater_zero: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.ppg_greater_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
  < 1

      
    ) dbt_internal_test
[0m22:44:34.243347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:35.073661 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b828e0-0102-2a83-0006-b1e6000316b6
[0m22:44:35.073661 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 2 unexpected '<'.
[0m22:44:35.073661 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (execute): 22:44:34.230384 => 22:44:35.073661
[0m22:44:35.073661 [debug] [Thread-1 (]: On test.dfb_data.ppg_greater_zero: Close
[0m22:44:35.239564 [debug] [Thread-1 (]: Database Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '<'.
  compiled Code at target\run\dfb_data\tests\ppg_greater_zero.sql
[0m22:44:35.239564 [error] [Thread-1 (]: 5 of 8 ERROR ppg_greater_zero .................................................. [[31mERROR[0m in 1.02s]
[0m22:44:35.239564 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero
[0m22:44:35.239564 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:44:35.239564 [info ] [Thread-1 (]: 6 of 8 START test ppg_greater_zero_dim_dfb_nfl_data_PPG ........................ [RUN]
[0m22:44:35.239564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero, now test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00)
[0m22:44:35.239564 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:44:35.261694 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00 (compile): 22:44:35.239564 => 22:44:35.260380
[0m22:44:35.261694 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:44:35.261694 [error] [Thread-1 (]: 6 of 8 ERROR ppg_greater_zero_dim_dfb_nfl_data_PPG ............................. [[31mERROR[0m in 0.02s]
[0m22:44:35.261694 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:44:35.267708 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186
[0m22:44:35.268755 [info ] [Thread-1 (]: 7 of 8 START test ppg_greater_zero_dim_dfb_nfl_data_salary ..................... [RUN]
[0m22:44:35.270743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00, now test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186)
[0m22:44:35.271712 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186
[0m22:44:35.273680 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186 (compile): 22:44:35.272711 => 22:44:35.273680
[0m22:44:35.273680 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:44:35.273680 [error] [Thread-1 (]: 7 of 8 ERROR ppg_greater_zero_dim_dfb_nfl_data_salary .......................... [[31mERROR[0m in 0.00s]
[0m22:44:35.273680 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186
[0m22:44:35.283406 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m22:44:35.284598 [info ] [Thread-1 (]: 8 of 8 START test t_ppg_value .................................................. [RUN]
[0m22:44:35.286182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186, now test.dfb_data.t_ppg_value)
[0m22:44:35.286182 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m22:44:35.291006 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m22:44:35.291006 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 22:44:35.287208 => 22:44:35.291006
[0m22:44:35.291006 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m22:44:35.291006 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m22:44:35.291006 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m22:44:35.291006 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:44:35.291006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:36.007763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:44:36.023452 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 22:44:35.291006 => 22:44:36.023452
[0m22:44:36.023452 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m22:44:36.154199 [info ] [Thread-1 (]: 8 of 8 PASS t_ppg_value ........................................................ [[32mPASS[0m in 0.87s]
[0m22:44:36.154199 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m22:44:36.154199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:44:36.169613 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:44:36.169613 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m22:44:36.169613 [info ] [MainThread]: 
[0m22:44:36.169613 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m22:44:36.175924 [debug] [MainThread]: Command end result
[0m22:44:36.193491 [info ] [MainThread]: 
[0m22:44:36.195506 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:44:36.196571 [info ] [MainThread]: 
[0m22:44:36.197814 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m22:44:36.199910 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m22:44:36.200839 [info ] [MainThread]: 
[0m22:44:36.202824 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m22:44:36.203830 [info ] [MainThread]: 
[0m22:44:36.205314 [error] [MainThread]:   Database Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '<'.
  compiled Code at target\run\dfb_data\tests\ppg_greater_zero.sql
[0m22:44:36.208323 [info ] [MainThread]: 
[0m22:44:36.209319 [error] [MainThread]:   Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:44:36.210319 [info ] [MainThread]: 
[0m22:44:36.211340 [error] [MainThread]:   Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:44:36.212392 [info ] [MainThread]: 
[0m22:44:36.213406 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
[0m22:44:36.214992 [debug] [MainThread]: Command `dbt test` failed at 22:44:36.214992 after 8.57 seconds
[0m22:44:36.215978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBA0E1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBA3C0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBA126A10>]}
[0m22:44:36.215978 [debug] [MainThread]: Flushing usage events
[0m22:45:17.273071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252FFBC9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252FFBB08D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252FFBB30D0>]}


============================== 22:45:17.278149 | ee6b5f51-29a2-4416-8fd0-ed12ffbf88c0 ==============================
[0m22:45:17.278149 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:45:17.279134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:45:17.836666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee6b5f51-29a2-4416-8fd0-ed12ffbf88c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252FFBED350>]}
[0m22:45:17.930721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee6b5f51-29a2-4416-8fd0-ed12ffbf88c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025281818290>]}
[0m22:45:17.946306 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:45:17.973724 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:45:18.227322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:45:18.227322 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:45:18.233341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee6b5f51-29a2-4416-8fd0-ed12ffbf88c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025281A42150>]}
[0m22:45:18.243596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee6b5f51-29a2-4416-8fd0-ed12ffbf88c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002528193B850>]}
[0m22:45:18.243596 [info ] [MainThread]: Found 6 models, 1 seed, 8 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m22:45:18.243596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee6b5f51-29a2-4416-8fd0-ed12ffbf88c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025280828B10>]}
[0m22:45:18.243596 [info ] [MainThread]: 
[0m22:45:18.259220 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:45:18.259220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:45:18.278808 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:45:18.280330 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:45:18.281290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:19.339361 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:45:19.339361 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:45:19.488344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee6b5f51-29a2-4416-8fd0-ed12ffbf88c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252819867D0>]}
[0m22:45:19.488344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:45:19.488344 [info ] [MainThread]: 
[0m22:45:19.503798 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:45:19.505806 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:45:19.507867 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:45:19.507867 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:45:19.531859 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:45:19.533806 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:45:19.508850 => 22:45:19.532852
[0m22:45:19.535113 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:45:19.555318 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:45:19.555318 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:45:19.555318 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:45:19.555318 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:45:20.258003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:45:20.273450 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:45:19.536122 => 22:45:20.273450
[0m22:45:20.273450 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:45:20.404523 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.90s]
[0m22:45:20.404523 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:45:20.404523 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:45:20.404523 [info ] [Thread-1 (]: 2 of 8 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m22:45:20.418550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.no_nulls_in_dim_dfb)
[0m22:45:20.419572 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m22:45:20.423794 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:45:20.423794 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m22:45:20.423794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:21.176148 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.0 seconds
[0m22:45:21.176148 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:45:21.191666 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 22:45:20.420568 => 22:45:21.176148
[0m22:45:21.192275 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m22:45:21.195391 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:45:21.195391 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:45:21.195391 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m22:45:21.310402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:45:21.310402 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 22:45:21.192275 => 22:45:21.310402
[0m22:45:21.310402 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m22:45:21.470285 [error] [Thread-1 (]: 2 of 8 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 1.07s]
[0m22:45:21.470285 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:45:21.473793 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:45:21.473793 [info ] [Thread-1 (]: 3 of 8 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:45:21.477334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:45:21.478344 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:45:21.491051 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:45:21.492615 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:45:21.479540 => 22:45:21.492615
[0m22:45:21.493622 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:45:21.495694 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:45:21.495694 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:45:21.495694 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:45:21.495694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:22.259604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:45:22.265009 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:45:21.493622 => 22:45:22.265009
[0m22:45:22.267051 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:45:22.394034 [info ] [Thread-1 (]: 3 of 8 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.92s]
[0m22:45:22.394034 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:45:22.394034 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:45:22.394034 [info ] [Thread-1 (]: 4 of 8 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:45:22.407932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:45:22.408942 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:45:22.413991 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:45:22.413991 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:45:22.410361 => 22:45:22.413991
[0m22:45:22.413991 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:45:22.423518 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:45:22.426364 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:45:22.427363 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:45:22.428382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:23.194408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:45:23.195928 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:45:22.413991 => 22:45:23.195928
[0m22:45:23.195928 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:45:23.354802 [info ] [Thread-1 (]: 4 of 8 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.95s]
[0m22:45:23.355991 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:45:23.355991 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero
[0m22:45:23.355991 [info ] [Thread-1 (]: 5 of 8 START test ppg_greater_zero ............................................. [RUN]
[0m22:45:23.355991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.ppg_greater_zero)
[0m22:45:23.355991 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero
[0m22:45:23.355991 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.ppg_greater_zero"
[0m22:45:23.355991 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (compile): 22:45:23.355991 => 22:45:23.355991
[0m22:45:23.355991 [debug] [Thread-1 (]: Began executing node test.dfb_data.ppg_greater_zero
[0m22:45:23.373245 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.ppg_greater_zero"
[0m22:45:23.375883 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.ppg_greater_zero"
[0m22:45:23.376947 [debug] [Thread-1 (]: On test.dfb_data.ppg_greater_zero: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.ppg_greater_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
  < 1

      
    ) dbt_internal_test
[0m22:45:23.378131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:24.127713 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b828e1-0102-2a7c-0006-b1e6000326e6
[0m22:45:24.127713 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 2 unexpected '<'.
[0m22:45:24.127713 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (execute): 22:45:23.355991 => 22:45:24.127713
[0m22:45:24.127713 [debug] [Thread-1 (]: On test.dfb_data.ppg_greater_zero: Close
[0m22:45:24.275064 [debug] [Thread-1 (]: Database Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '<'.
  compiled Code at target\run\dfb_data\tests\ppg_greater_zero.sql
[0m22:45:24.275064 [error] [Thread-1 (]: 5 of 8 ERROR ppg_greater_zero .................................................. [[31mERROR[0m in 0.92s]
[0m22:45:24.275064 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero
[0m22:45:24.275064 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:45:24.290508 [info ] [Thread-1 (]: 6 of 8 START test ppg_greater_zero_dim_dfb_nfl_data_PPG ........................ [RUN]
[0m22:45:24.290508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero, now test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00)
[0m22:45:24.290508 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:45:24.297514 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00 (compile): 22:45:24.290508 => 22:45:24.297514
[0m22:45:24.309943 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:45:24.312016 [error] [Thread-1 (]: 6 of 8 ERROR ppg_greater_zero_dim_dfb_nfl_data_PPG ............................. [[31mERROR[0m in 0.02s]
[0m22:45:24.314014 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00
[0m22:45:24.315011 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186
[0m22:45:24.315486 [info ] [Thread-1 (]: 7 of 8 START test ppg_greater_zero_dim_dfb_nfl_data_salary ..................... [RUN]
[0m22:45:24.317161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_PPG.c1d90f7d00, now test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186)
[0m22:45:24.317161 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186
[0m22:45:24.327357 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186 (compile): 22:45:24.318206 => 22:45:24.327357
[0m22:45:24.329356 [debug] [Thread-1 (]: Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:45:24.330317 [error] [Thread-1 (]: 7 of 8 ERROR ppg_greater_zero_dim_dfb_nfl_data_salary .......................... [[31mERROR[0m in 0.01s]
[0m22:45:24.331310 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186
[0m22:45:24.332331 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m22:45:24.333743 [info ] [Thread-1 (]: 8 of 8 START test t_ppg_value .................................................. [RUN]
[0m22:45:24.336439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero_dim_dfb_nfl_data_salary.d1d1558186, now test.dfb_data.t_ppg_value)
[0m22:45:24.336439 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m22:45:24.343438 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m22:45:24.344440 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 22:45:24.337406 => 22:45:24.344440
[0m22:45:24.345391 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m22:45:24.346673 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m22:45:24.346673 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m22:45:24.346673 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:45:24.346673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:25.086968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:45:25.092198 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 22:45:24.346673 => 22:45:25.092198
[0m22:45:25.092198 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m22:45:25.227830 [info ] [Thread-1 (]: 8 of 8 PASS t_ppg_value ........................................................ [[32mPASS[0m in 0.89s]
[0m22:45:25.239301 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m22:45:25.242243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:45:25.242243 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:45:25.243242 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m22:45:25.243242 [info ] [MainThread]: 
[0m22:45:25.244714 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m22:45:25.248483 [debug] [MainThread]: Command end result
[0m22:45:25.261912 [info ] [MainThread]: 
[0m22:45:25.261912 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m22:45:25.261912 [info ] [MainThread]: 
[0m22:45:25.261912 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m22:45:25.271012 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m22:45:25.273032 [info ] [MainThread]: 
[0m22:45:25.274731 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m22:45:25.276136 [info ] [MainThread]: 
[0m22:45:25.278053 [error] [MainThread]:   Database Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '<'.
  compiled Code at target\run\dfb_data\tests\ppg_greater_zero.sql
[0m22:45:25.279710 [info ] [MainThread]: 
[0m22:45:25.279710 [error] [MainThread]:   Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_PPG (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:45:25.279710 [info ] [MainThread]: 
[0m22:45:25.283667 [error] [MainThread]:   Compilation Error in test ppg_greater_zero_dim_dfb_nfl_data_salary (models\schema.yml)
  'test_ppg_greater_zero' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:45:25.284681 [info ] [MainThread]: 
[0m22:45:25.285750 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
[0m22:45:25.287680 [debug] [MainThread]: Command `dbt test` failed at 22:45:25.287680 after 8.10 seconds
[0m22:45:25.288678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252FFB97250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F8CE1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252F8FB0C50>]}
[0m22:45:25.290312 [debug] [MainThread]: Flushing usage events
[0m22:46:03.774805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A789D1FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A789D1FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A789D1E090>]}


============================== 22:46:03.774805 | b348f471-7eab-481d-8aa5-dc1b61f169e0 ==============================
[0m22:46:03.774805 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:46:03.774805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:46:04.333964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b348f471-7eab-481d-8aa5-dc1b61f169e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78A873F10>]}
[0m22:46:04.443220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b348f471-7eab-481d-8aa5-dc1b61f169e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78A87F310>]}
[0m22:46:04.445174 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:46:04.469842 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:46:04.710050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:46:04.710050 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m22:46:05.134163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b348f471-7eab-481d-8aa5-dc1b61f169e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78BE80DD0>]}
[0m22:46:05.149786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b348f471-7eab-481d-8aa5-dc1b61f169e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78BC6CF50>]}
[0m22:46:05.149786 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m22:46:05.149786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b348f471-7eab-481d-8aa5-dc1b61f169e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78BAD0D90>]}
[0m22:46:05.166606 [info ] [MainThread]: 
[0m22:46:05.168490 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:46:05.172502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:46:05.189283 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:46:05.190342 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:46:05.191274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:06.147772 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:46:06.163986 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:46:06.315226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b348f471-7eab-481d-8aa5-dc1b61f169e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78B9EBED0>]}
[0m22:46:06.315226 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:46:06.315226 [info ] [MainThread]: 
[0m22:46:06.330790 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:46:06.330790 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:46:06.336511 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:46:06.337525 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:46:06.348562 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:46:06.349570 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:46:06.338541 => 22:46:06.349570
[0m22:46:06.350520 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:46:06.375087 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:46:06.377088 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:46:06.378089 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:46:06.379207 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:46:07.204776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:46:07.204776 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:46:06.350520 => 22:46:07.204776
[0m22:46:07.204776 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:46:07.362808 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.03s]
[0m22:46:07.362808 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:46:07.362808 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:46:07.362808 [info ] [Thread-1 (]: 2 of 6 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m22:46:07.372626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.no_nulls_in_dim_dfb)
[0m22:46:07.373641 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m22:46:07.387782 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:46:07.388789 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m22:46:07.390098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:08.116253 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.0 seconds
[0m22:46:08.116253 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:46:08.131875 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 22:46:07.374716 => 22:46:08.116253
[0m22:46:08.132310 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m22:46:08.134421 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:46:08.134421 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:46:08.134421 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m22:46:08.244470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:46:08.247413 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 22:46:08.133380 => 22:46:08.247413
[0m22:46:08.248457 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m22:46:08.394265 [error] [Thread-1 (]: 2 of 6 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 1.03s]
[0m22:46:08.394265 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:46:08.394265 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:46:08.394265 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:46:08.407113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:46:08.408136 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:46:08.413100 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:46:08.413100 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:46:08.409268 => 22:46:08.413100
[0m22:46:08.421028 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:46:08.427072 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:46:08.429029 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:46:08.429029 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:46:08.430073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:09.118491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:46:09.118491 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:46:08.422048 => 22:46:09.118491
[0m22:46:09.118491 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:46:09.250975 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.86s]
[0m22:46:09.250975 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:46:09.250975 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:46:09.250975 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:46:09.266478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:46:09.266478 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:46:09.266478 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:46:09.266478 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:46:09.266478 => 22:46:09.266478
[0m22:46:09.266478 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:46:09.266478 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:46:09.266478 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:46:09.266478 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:46:09.266478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:10.053704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:46:10.053704 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:46:09.266478 => 22:46:10.053704
[0m22:46:10.053704 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:46:10.199300 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.93s]
[0m22:46:10.199300 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:46:10.199300 [debug] [Thread-1 (]: Began running node test.dfb_data.ppg_greater_zero
[0m22:46:10.199300 [info ] [Thread-1 (]: 5 of 6 START test ppg_greater_zero ............................................. [RUN]
[0m22:46:10.216744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.ppg_greater_zero)
[0m22:46:10.217800 [debug] [Thread-1 (]: Began compiling node test.dfb_data.ppg_greater_zero
[0m22:46:10.222883 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.ppg_greater_zero"
[0m22:46:10.222883 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (compile): 22:46:10.218768 => 22:46:10.222883
[0m22:46:10.222883 [debug] [Thread-1 (]: Began executing node test.dfb_data.ppg_greater_zero
[0m22:46:10.222883 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.ppg_greater_zero"
[0m22:46:10.222883 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.ppg_greater_zero"
[0m22:46:10.222883 [debug] [Thread-1 (]: On test.dfb_data.ppg_greater_zero: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.ppg_greater_zero"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
  < 1

      
    ) dbt_internal_test
[0m22:46:10.222883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:11.183352 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b828e2-0102-2a83-0006-b1e6000316de
[0m22:46:11.183352 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 2 unexpected '<'.
[0m22:46:11.183352 [debug] [Thread-1 (]: Timing info for test.dfb_data.ppg_greater_zero (execute): 22:46:10.222883 => 22:46:11.183352
[0m22:46:11.183352 [debug] [Thread-1 (]: On test.dfb_data.ppg_greater_zero: Close
[0m22:46:11.334134 [debug] [Thread-1 (]: Database Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '<'.
  compiled Code at target\run\dfb_data\tests\ppg_greater_zero.sql
[0m22:46:11.334134 [error] [Thread-1 (]: 5 of 6 ERROR ppg_greater_zero .................................................. [[31mERROR[0m in 1.12s]
[0m22:46:11.334134 [debug] [Thread-1 (]: Finished running node test.dfb_data.ppg_greater_zero
[0m22:46:11.334134 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m22:46:11.334134 [info ] [Thread-1 (]: 6 of 6 START test t_ppg_value .................................................. [RUN]
[0m22:46:11.334134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.ppg_greater_zero, now test.dfb_data.t_ppg_value)
[0m22:46:11.334134 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m22:46:11.334134 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m22:46:11.334134 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 22:46:11.334134 => 22:46:11.334134
[0m22:46:11.349755 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m22:46:11.356622 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m22:46:11.356622 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m22:46:11.356622 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:46:11.356622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:12.086936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:46:12.086936 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 22:46:11.351080 => 22:46:12.086936
[0m22:46:12.086936 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m22:46:12.233846 [info ] [Thread-1 (]: 6 of 6 PASS t_ppg_value ........................................................ [[32mPASS[0m in 0.90s]
[0m22:46:12.233846 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m22:46:12.233846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:12.233846 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:46:12.250662 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m22:46:12.252266 [info ] [MainThread]: 
[0m22:46:12.254283 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 7.08 seconds (7.08s).
[0m22:46:12.259273 [debug] [MainThread]: Command end result
[0m22:46:12.277602 [info ] [MainThread]: 
[0m22:46:12.279658 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:46:12.280187 [info ] [MainThread]: 
[0m22:46:12.282299 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m22:46:12.283277 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m22:46:12.284198 [info ] [MainThread]: 
[0m22:46:12.285240 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m22:46:12.287792 [info ] [MainThread]: 
[0m22:46:12.289799 [error] [MainThread]:   Database Error in test ppg_greater_zero (tests\ppg_greater_zero.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 2 unexpected '<'.
  compiled Code at target\run\dfb_data\tests\ppg_greater_zero.sql
[0m22:46:12.292015 [info ] [MainThread]: 
[0m22:46:12.293882 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m22:46:12.295955 [debug] [MainThread]: Command `dbt test` failed at 22:46:12.295955 after 8.61 seconds
[0m22:46:12.296909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A782E61F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A782EA7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A78C1B6810>]}
[0m22:46:12.296909 [debug] [MainThread]: Flushing usage events
[0m22:48:28.391201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337E9B9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337E9B9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337E9B9910>]}


============================== 22:48:28.391201 | 18e4cd12-08c4-4464-a313-2f644150c09f ==============================
[0m22:48:28.391201 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:48:28.391201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:48:28.998901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e4cd12-08c4-4464-a313-2f644150c09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337EA27650>]}
[0m22:48:29.078953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18e4cd12-08c4-4464-a313-2f644150c09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337F512F50>]}
[0m22:48:29.078953 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:48:29.108847 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:48:29.355915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:48:29.355915 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\ppg_greater_zero.sql
[0m22:48:29.486927 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.ppg_greater_zero' (tests\ppg_greater_zero.sql) depends on a node named 'PPG' in package 'dim_dfb_nfl_data' which was not found
[0m22:48:29.514167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18e4cd12-08c4-4464-a313-2f644150c09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337FA77690>]}
[0m22:48:29.533797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18e4cd12-08c4-4464-a313-2f644150c09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337F8569D0>]}
[0m22:48:29.533797 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m22:48:29.533797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e4cd12-08c4-4464-a313-2f644150c09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337F6BB350>]}
[0m22:48:29.539433 [info ] [MainThread]: 
[0m22:48:29.541328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:48:29.544812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:48:29.559423 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:48:29.559423 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:48:29.559423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:30.580793 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:48:30.598761 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:48:30.745322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e4cd12-08c4-4464-a313-2f644150c09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337F5ECD10>]}
[0m22:48:30.745322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:48:30.745322 [info ] [MainThread]: 
[0m22:48:30.745322 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:48:30.745322 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:48:30.761542 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:48:30.762293 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:48:30.779753 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:48:30.787805 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:48:30.762854 => 22:48:30.779753
[0m22:48:30.789825 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:48:30.825274 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:48:30.828286 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:48:30.829258 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:48:30.830229 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:48:31.598148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:48:31.598148 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:48:30.790953 => 22:48:31.598148
[0m22:48:31.598148 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:48:31.757021 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 1.01s]
[0m22:48:31.758903 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:48:31.759865 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:48:31.761874 [info ] [Thread-1 (]: 2 of 5 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m22:48:31.765330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.no_nulls_in_dim_dfb)
[0m22:48:31.766751 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m22:48:31.779463 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:48:31.779463 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m22:48:31.779463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:32.513291 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.0 seconds
[0m22:48:32.528789 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:48:32.528789 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 22:48:31.766935 => 22:48:32.528789
[0m22:48:32.528789 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m22:48:32.536392 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:48:32.536392 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:48:32.536392 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m22:48:32.653756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:48:32.658994 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 22:48:32.528789 => 22:48:32.658994
[0m22:48:32.658994 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m22:48:32.811261 [error] [Thread-1 (]: 2 of 5 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 1.05s]
[0m22:48:32.811261 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:48:32.811261 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:48:32.811261 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:48:32.811261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:48:32.811261 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:48:32.828987 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:48:32.830742 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:48:32.811261 => 22:48:32.830742
[0m22:48:32.831727 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:48:32.832793 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:48:32.836832 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:48:32.837806 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:48:32.839505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:33.581734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:48:33.584813 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:48:32.832793 => 22:48:33.584813
[0m22:48:33.584813 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:48:33.716097 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.90s]
[0m22:48:33.716097 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:48:33.716097 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:48:33.716097 [info ] [Thread-1 (]: 4 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:48:33.716097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:48:33.716097 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:48:33.734578 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:48:33.737177 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:48:33.716097 => 22:48:33.736124
[0m22:48:33.738179 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:48:33.739665 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:48:33.739665 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:48:33.739665 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:48:33.739665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:34.453193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:48:34.470406 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:48:33.739665 => 22:48:34.469391
[0m22:48:34.470406 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:48:34.619900 [info ] [Thread-1 (]: 4 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.89s]
[0m22:48:34.619900 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:48:34.619900 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m22:48:34.619900 [info ] [Thread-1 (]: 5 of 5 START test t_ppg_value .................................................. [RUN]
[0m22:48:34.629888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.t_ppg_value)
[0m22:48:34.631755 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m22:48:34.637829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m22:48:34.639913 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 22:48:34.632154 => 22:48:34.639913
[0m22:48:34.641847 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m22:48:34.644882 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m22:48:34.645837 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m22:48:34.645837 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:48:34.645837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:48:35.443090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:48:35.454150 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 22:48:34.641847 => 22:48:35.454150
[0m22:48:35.454150 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m22:48:35.584399 [info ] [Thread-1 (]: 5 of 5 PASS t_ppg_value ........................................................ [[32mPASS[0m in 0.96s]
[0m22:48:35.584399 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m22:48:35.584399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:35.584399 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:48:35.599895 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m22:48:35.601320 [info ] [MainThread]: 
[0m22:48:35.602875 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 6.06 seconds (6.06s).
[0m22:48:35.606231 [debug] [MainThread]: Command end result
[0m22:48:35.622067 [info ] [MainThread]: 
[0m22:48:35.623091 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:48:35.625070 [info ] [MainThread]: 
[0m22:48:35.627066 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m22:48:35.629232 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m22:48:35.629232 [info ] [MainThread]: 
[0m22:48:35.629232 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m22:48:35.629232 [info ] [MainThread]: 
[0m22:48:35.629232 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:48:35.637536 [debug] [MainThread]: Command `dbt test` failed at 22:48:35.636463 after 7.34 seconds
[0m22:48:35.638510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337E9AD310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013377AD1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001337EA2C090>]}
[0m22:48:35.640458 [debug] [MainThread]: Flushing usage events
[0m22:49:54.461132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD5134C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD51378D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD5137F10>]}


============================== 22:49:54.476818 | 5ade5091-bcde-4f55-9980-35f0efdd1616 ==============================
[0m22:49:54.476818 [info ] [MainThread]: Running with dbt=1.7.18
[0m22:49:54.476818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:49:55.078906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ade5091-bcde-4f55-9980-35f0efdd1616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD6D038D0>]}
[0m22:49:55.183491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ade5091-bcde-4f55-9980-35f0efdd1616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD3E3E9D0>]}
[0m22:49:55.185875 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:49:55.213232 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m22:49:55.456578 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m22:49:55.456578 [debug] [MainThread]: Partial parsing: added file: dfb_data://tests\positive_value_in dfb.sql
[0m22:49:55.456578 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://tests\ppg_greater_zero.sql
[0m22:49:55.616818 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dfb_data.positive_value_in dfb' (tests\positive_value_in dfb.sql) depends on a node named 'PPG' in package 'dim_dfb_nfl_data' which was not found
[0m22:49:55.618866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ade5091-bcde-4f55-9980-35f0efdd1616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD6E02F10>]}
[0m22:49:55.657450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ade5091-bcde-4f55-9980-35f0efdd1616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD6FEFE10>]}
[0m22:49:55.657450 [info ] [MainThread]: Found 6 models, 1 seed, 5 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m22:49:55.657450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ade5091-bcde-4f55-9980-35f0efdd1616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD6C43050>]}
[0m22:49:55.657450 [info ] [MainThread]: 
[0m22:49:55.657450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:49:55.657450 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m22:49:55.679017 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m22:49:55.679017 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m22:49:55.679017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:56.698949 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:49:56.698949 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m22:49:56.846733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ade5091-bcde-4f55-9980-35f0efdd1616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD6FFFCD0>]}
[0m22:49:56.846733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:49:56.846733 [info ] [MainThread]: 
[0m22:49:56.846733 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:49:56.846733 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m22:49:56.861806 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m22:49:56.863609 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:49:56.887821 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:49:56.891447 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 22:49:56.864367 => 22:49:56.890700
[0m22:49:56.893434 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:49:56.911589 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:49:56.911589 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m22:49:56.911589 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m22:49:56.911589 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:49:57.639423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:49:57.653879 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 22:49:56.893434 => 22:49:57.653879
[0m22:49:57.654884 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m22:49:57.795602 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 0.95s]
[0m22:49:57.795602 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m22:49:57.795602 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:49:57.795602 [info ] [Thread-1 (]: 2 of 5 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m22:49:57.809953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.no_nulls_in_dim_dfb)
[0m22:49:57.811890 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m22:49:57.827581 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:49:57.827581 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m22:49:57.828584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:58.598816 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.0 seconds
[0m22:49:58.598816 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:49:58.614288 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 22:49:57.812334 => 22:49:58.598816
[0m22:49:58.615104 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m22:49:58.619567 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:49:58.621571 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m22:49:58.622558 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m22:49:58.731022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:49:58.734994 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 22:49:58.616123 => 22:49:58.734018
[0m22:49:58.734994 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m22:49:58.876651 [error] [Thread-1 (]: 2 of 5 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 1.08s]
[0m22:49:58.876651 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m22:49:58.876651 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:49:58.876651 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m22:49:58.876651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m22:49:58.876651 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:49:58.899036 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:49:58.899036 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 22:49:58.876651 => 22:49:58.899036
[0m22:49:58.899036 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:49:58.905581 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:49:58.908294 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m22:49:58.909324 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m22:49:58.910325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:59.598026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:49:59.598026 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 22:49:58.899036 => 22:49:59.598026
[0m22:49:59.598026 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m22:49:59.745486 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 0.87s]
[0m22:49:59.747613 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m22:49:59.747613 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:49:59.747613 [info ] [Thread-1 (]: 4 of 5 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m22:49:59.747613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m22:49:59.747613 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:49:59.747613 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:49:59.747613 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 22:49:59.747613 => 22:49:59.747613
[0m22:49:59.747613 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:49:59.764868 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:49:59.767314 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m22:49:59.767856 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m22:49:59.768911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:00.453884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:50:00.453884 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 22:49:59.747613 => 22:50:00.453884
[0m22:50:00.469523 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m22:50:00.586006 [info ] [Thread-1 (]: 4 of 5 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 0.84s]
[0m22:50:00.586006 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m22:50:00.586006 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m22:50:00.586006 [info ] [Thread-1 (]: 5 of 5 START test t_ppg_value .................................................. [RUN]
[0m22:50:00.602235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.t_ppg_value)
[0m22:50:00.603537 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m22:50:00.610739 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m22:50:00.612701 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 22:50:00.603700 => 22:50:00.611700
[0m22:50:00.612701 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m22:50:00.615746 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m22:50:00.615746 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m22:50:00.615746 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m22:50:00.615746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:50:01.408869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:50:01.413865 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 22:50:00.613782 => 22:50:01.413865
[0m22:50:01.414890 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m22:50:01.580565 [info ] [Thread-1 (]: 5 of 5 PASS t_ppg_value ........................................................ [[32mPASS[0m in 0.98s]
[0m22:50:01.580565 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m22:50:01.596251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:01.597620 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m22:50:01.598765 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m22:50:01.599798 [info ] [MainThread]: 
[0m22:50:01.601338 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 5.94 seconds (5.94s).
[0m22:50:01.603258 [debug] [MainThread]: Command end result
[0m22:50:01.612516 [info ] [MainThread]: 
[0m22:50:01.622122 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:50:01.624115 [info ] [MainThread]: 
[0m22:50:01.624115 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m22:50:01.624115 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m22:50:01.629030 [info ] [MainThread]: 
[0m22:50:01.629648 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m22:50:01.631088 [info ] [MainThread]: 
[0m22:50:01.633091 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:50:01.635199 [debug] [MainThread]: Command `dbt test` failed at 22:50:01.635199 after 7.29 seconds
[0m22:50:01.635199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD51378D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BCE231F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020BD513D310>]}
[0m22:50:01.636267 [debug] [MainThread]: Flushing usage events
[0m11:31:19.355229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029223E506D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029223E4AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029223E33590>]}


============================== 11:31:19.418512 | 5578ae61-3115-4fe5-8131-416896208027 ==============================
[0m11:31:19.418512 [info ] [MainThread]: Running with dbt=1.7.18
[0m11:31:19.418512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'send_anonymous_usage_stats': 'True'}
[0m11:31:22.444534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5578ae61-3115-4fe5-8131-416896208027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029224952ED0>]}
[0m11:31:22.586074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5578ae61-3115-4fe5-8131-416896208027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029223E8FDD0>]}
[0m11:31:22.586074 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:31:22.904993 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m11:31:29.131926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:31:29.131926 [debug] [MainThread]: Partial parsing: updated file: dfb_data://tests\positive_value_in dfb.sql
[0m11:31:29.336808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5578ae61-3115-4fe5-8131-416896208027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029225B12390>]}
[0m11:31:29.447790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5578ae61-3115-4fe5-8131-416896208027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029225CE40D0>]}
[0m11:31:29.447790 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m11:31:29.462326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5578ae61-3115-4fe5-8131-416896208027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029225A5C950>]}
[0m11:31:29.462326 [info ] [MainThread]: 
[0m11:31:29.473229 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:31:29.482670 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m11:31:29.502736 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m11:31:29.502736 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m11:31:29.514748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:31.878276 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m11:31:31.878276 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m11:31:32.497897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5578ae61-3115-4fe5-8131-416896208027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029225AE4150>]}
[0m11:31:32.497897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:32.497897 [info ] [MainThread]: 
[0m11:31:32.518228 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m11:31:32.520865 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [RUN]
[0m11:31:32.520865 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b'
[0m11:31:32.520865 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m11:31:32.561059 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m11:31:32.561059 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (compile): 11:31:32.520865 => 11:31:32.561059
[0m11:31:32.564640 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m11:31:32.601274 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m11:31:32.601274 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"
[0m11:31:32.601274 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','WR','TE','RB','DST'
)



      
    ) dbt_internal_test
[0m11:31:32.601274 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:31:34.763142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:31:34.778835 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b (execute): 11:31:32.565269 => 11:31:34.778835
[0m11:31:34.778835 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b: Close
[0m11:31:34.957402 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST  [[32mPASS[0m in 2.44s]
[0m11:31:34.973029 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b
[0m11:31:34.973029 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m11:31:34.973029 [info ] [Thread-1 (]: 2 of 6 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m11:31:34.982598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__WR__TE__RB__DST.16f83be87b, now test.dfb_data.no_nulls_in_dim_dfb)
[0m11:31:34.986853 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m11:31:35.027581 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m11:31:35.027581 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m11:31:35.027581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:37.099257 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 2.0 seconds
[0m11:31:37.108652 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m11:31:37.108652 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 11:31:34.988721 => 11:31:37.108652
[0m11:31:37.115170 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m11:31:37.117555 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m11:31:37.128572 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m11:31:37.131098 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m11:31:37.804150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:31:37.821032 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 11:31:37.117555 => 11:31:37.821032
[0m11:31:37.821032 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m11:31:38.431212 [error] [Thread-1 (]: 2 of 6 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 3.46s]
[0m11:31:38.443226 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m11:31:38.443226 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m11:31:38.443226 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m11:31:38.454629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m11:31:38.457066 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m11:31:38.480503 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m11:31:38.484256 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 11:31:38.458030 => 11:31:38.484256
[0m11:31:38.484256 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m11:31:38.495608 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m11:31:38.502765 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m11:31:38.502765 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m11:31:38.502765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:40.185932 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:31:40.195538 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 11:31:38.484256 => 11:31:40.195538
[0m11:31:40.195538 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m11:31:40.384937 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.94s]
[0m11:31:40.384937 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m11:31:40.384937 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m11:31:40.384937 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m11:31:40.399692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m11:31:40.402675 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m11:31:40.416677 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m11:31:40.423755 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 11:31:40.404126 => 11:31:40.423086
[0m11:31:40.424480 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m11:31:40.437982 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m11:31:40.437982 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m11:31:40.437982 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m11:31:40.437982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:41.880812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:31:41.880812 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 11:31:40.424480 => 11:31:41.880812
[0m11:31:41.880812 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m11:31:42.259045 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.87s]
[0m11:31:42.259045 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m11:31:42.259045 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_in dfb
[0m11:31:42.259045 [info ] [Thread-1 (]: 5 of 6 START test positive_value_in dfb ........................................ [RUN]
[0m11:31:42.275680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_in dfb)
[0m11:31:42.275680 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_in dfb
[0m11:31:42.290371 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_in dfb"
[0m11:31:42.298814 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (compile): 11:31:42.280435 => 11:31:42.295895
[0m11:31:42.298814 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_in dfb
[0m11:31:42.308871 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_in dfb"
[0m11:31:42.312921 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_in dfb"
[0m11:31:42.312921 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_in dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 1

      
    ) dbt_internal_test
[0m11:31:42.312921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:44.115998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:31:44.115998 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (execute): 11:31:42.298814 => 11:31:44.115998
[0m11:31:44.115998 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: Close
[0m11:31:44.586552 [error] [Thread-1 (]: 5 of 6 FAIL 928 positive_value_in dfb .......................................... [[31mFAIL 928[0m in 2.31s]
[0m11:31:44.586552 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_in dfb
[0m11:31:44.602258 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m11:31:44.602258 [info ] [Thread-1 (]: 6 of 6 START test t_ppg_value .................................................. [RUN]
[0m11:31:44.610394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_in dfb, now test.dfb_data.t_ppg_value)
[0m11:31:44.610394 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m11:31:44.626455 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m11:31:44.630451 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 11:31:44.613932 => 11:31:44.626455
[0m11:31:44.631014 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m11:31:44.644314 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m11:31:44.650503 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m11:31:44.650503 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m11:31:44.650503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:46.964540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:31:46.980190 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 11:31:44.634431 => 11:31:46.964540
[0m11:31:46.980190 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m11:31:47.154384 [info ] [Thread-1 (]: 6 of 6 PASS t_ppg_value ........................................................ [[32mPASS[0m in 2.55s]
[0m11:31:47.154384 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m11:31:47.165696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:47.165696 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m11:31:47.172878 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m11:31:47.174203 [info ] [MainThread]: 
[0m11:31:47.174203 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 17.71 seconds (17.71s).
[0m11:31:47.181425 [debug] [MainThread]: Command end result
[0m11:31:47.229947 [info ] [MainThread]: 
[0m11:31:47.234001 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:31:47.237870 [info ] [MainThread]: 
[0m11:31:47.240056 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m11:31:47.241926 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m11:31:47.242655 [info ] [MainThread]: 
[0m11:31:47.242655 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m11:31:47.242655 [info ] [MainThread]: 
[0m11:31:47.246778 [error] [MainThread]: [31mFailure in test positive_value_in dfb (tests\positive_value_in dfb.sql)[0m
[0m11:31:47.247722 [error] [MainThread]:   Got 928 results, configured to fail if != 0
[0m11:31:47.249254 [info ] [MainThread]: 
[0m11:31:47.252722 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\positive_value_in dfb.sql
[0m11:31:47.254562 [info ] [MainThread]: 
[0m11:31:47.257017 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m11:31:47.258383 [debug] [MainThread]: Command `dbt test` failed at 11:31:47.258383 after 28.35 seconds
[0m11:31:47.258383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029223DEE910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002921CEF1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029223229A90>]}
[0m11:31:47.261026 [debug] [MainThread]: Flushing usage events
[0m11:37:47.561659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E79B2D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7ACBEF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7ACBE090>]}


============================== 11:37:47.573165 | 0126735a-cc92-488c-90a7-c85e17205c60 ==============================
[0m11:37:47.573165 [info ] [MainThread]: Running with dbt=1.7.18
[0m11:37:47.573165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:37:48.261376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0126735a-cc92-488c-90a7-c85e17205c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7C860B90>]}
[0m11:37:48.413130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0126735a-cc92-488c-90a7-c85e17205c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7C88A950>]}
[0m11:37:48.413130 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:37:48.459976 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m11:37:48.932821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:37:48.932821 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m11:37:48.932821 [debug] [MainThread]: Partial parsing: updated file: dfb_data://macros\positive_value.sql
[0m11:37:49.675271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0126735a-cc92-488c-90a7-c85e17205c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7D11D390>]}
[0m11:37:49.706535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0126735a-cc92-488c-90a7-c85e17205c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7CA05CD0>]}
[0m11:37:49.706535 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m11:37:49.706535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0126735a-cc92-488c-90a7-c85e17205c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7B811F10>]}
[0m11:37:49.706535 [info ] [MainThread]: 
[0m11:37:49.706535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:49.706535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m11:37:49.752262 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m11:37:49.752262 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m11:37:49.752262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:51.371644 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m11:37:51.371644 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m11:37:51.989900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0126735a-cc92-488c-90a7-c85e17205c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7CDAF250>]}
[0m11:37:51.989900 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:52.005420 [info ] [MainThread]: 
[0m11:37:52.005420 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m11:37:52.005420 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST  [RUN]
[0m11:37:52.023266 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5'
[0m11:37:52.025557 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m11:37:52.048250 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m11:37:52.048250 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5 (compile): 11:37:52.026309 => 11:37:52.048250
[0m11:37:52.048250 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m11:37:52.075703 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m11:37:52.075703 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m11:37:52.075703 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'DST'
)



      
    ) dbt_internal_test
[0m11:37:52.088385 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:37:54.263343 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82be5-0102-2c47-0006-b1e600036db6
[0m11:37:54.271869 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 30 at position 23 near '<EOF>'.
syntax error line 24 at position 38 unexpected 'DST'.
[0m11:37:54.271869 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5 (execute): 11:37:52.048250 => 11:37:54.271869
[0m11:37:54.279103 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5: Close
[0m11:37:54.794650 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST (models\schema.yml)
  001003 (42000): SQL compilation error:
  parse error line 30 at position 23 near '<EOF>'.
  syntax error line 24 at position 38 unexpected 'DST'.
  compiled Code at target\run\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_2d9c950a402e72c1e5c1842ac521121f.sql
[0m11:37:54.794650 [error] [Thread-1 (]: 1 of 6 ERROR accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST  [[31mERROR[0m in 2.79s]
[0m11:37:54.794650 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m11:37:54.794650 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m11:37:54.813582 [info ] [Thread-1 (]: 2 of 6 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m11:37:54.814939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5, now test.dfb_data.no_nulls_in_dim_dfb)
[0m11:37:54.818606 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m11:37:54.840478 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m11:37:54.840478 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m11:37:54.840478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:56.788108 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 2.0 seconds
[0m11:37:56.788108 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m11:37:56.806331 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 11:37:54.820435 => 11:37:56.805795
[0m11:37:56.807299 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m11:37:56.807299 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m11:37:56.820883 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m11:37:56.820883 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m11:37:56.959465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:37:56.980526 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 11:37:56.807299 => 11:37:56.980526
[0m11:37:56.980526 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m11:37:57.132221 [error] [Thread-1 (]: 2 of 6 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 2.32s]
[0m11:37:57.132221 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m11:37:57.132221 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m11:37:57.132221 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m11:37:57.144569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m11:37:57.147583 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m11:37:57.169483 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m11:37:57.169483 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 11:37:57.147687 => 11:37:57.169483
[0m11:37:57.169483 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m11:37:57.183863 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m11:37:57.183863 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m11:37:57.183863 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m11:37:57.183863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:58.262168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:37:58.282339 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 11:37:57.169483 => 11:37:58.277818
[0m11:37:58.282339 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m11:37:58.559569 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.43s]
[0m11:37:58.559569 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m11:37:58.559569 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m11:37:58.574097 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m11:37:58.580223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m11:37:58.582634 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m11:37:58.599106 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m11:37:58.605171 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 11:37:58.585642 => 11:37:58.599106
[0m11:37:58.607129 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m11:37:58.617503 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m11:37:58.622574 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m11:37:58.625642 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m11:37:58.625722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:00.169052 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:38:00.184567 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 11:37:58.607129 => 11:38:00.184567
[0m11:38:00.184567 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m11:38:00.795428 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.22s]
[0m11:38:00.795428 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m11:38:00.795428 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_in dfb
[0m11:38:00.811080 [info ] [Thread-1 (]: 5 of 6 START test positive_value_in dfb ........................................ [RUN]
[0m11:38:00.816604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_in dfb)
[0m11:38:00.819399 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_in dfb
[0m11:38:00.827901 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_in dfb"
[0m11:38:00.827901 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (compile): 11:38:00.822009 => 11:38:00.827901
[0m11:38:00.827901 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_in dfb
[0m11:38:00.845124 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_in dfb"
[0m11:38:00.856624 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_in dfb"
[0m11:38:00.857565 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_in dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 0

      
    ) dbt_internal_test
[0m11:38:00.857565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:02.798998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:38:02.814650 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (execute): 11:38:00.843033 => 11:38:02.814650
[0m11:38:02.814650 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: Close
[0m11:38:03.273891 [error] [Thread-1 (]: 5 of 6 FAIL 11 positive_value_in dfb ........................................... [[31mFAIL 11[0m in 2.46s]
[0m11:38:03.289542 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_in dfb
[0m11:38:03.292561 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m11:38:03.292561 [info ] [Thread-1 (]: 6 of 6 START test t_ppg_value .................................................. [RUN]
[0m11:38:03.299488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_in dfb, now test.dfb_data.t_ppg_value)
[0m11:38:03.301568 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m11:38:03.310358 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m11:38:03.315884 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 11:38:03.303596 => 11:38:03.315884
[0m11:38:03.320192 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m11:38:03.332014 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m11:38:03.336319 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m11:38:03.339856 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m11:38:03.339856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:04.811922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:38:04.827599 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 11:38:03.323059 => 11:38:04.827599
[0m11:38:04.827599 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m11:38:05.115430 [info ] [Thread-1 (]: 6 of 6 PASS t_ppg_value ........................................................ [[32mPASS[0m in 1.82s]
[0m11:38:05.125011 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m11:38:05.130531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:05.133348 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m11:38:05.134088 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m11:38:05.136163 [info ] [MainThread]: 
[0m11:38:05.138699 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 15.43 seconds (15.43s).
[0m11:38:05.138699 [debug] [MainThread]: Command end result
[0m11:38:05.248269 [info ] [MainThread]: 
[0m11:38:05.248269 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:38:05.248269 [info ] [MainThread]: 
[0m11:38:05.256260 [error] [MainThread]:   Database Error in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST (models\schema.yml)
  001003 (42000): SQL compilation error:
  parse error line 30 at position 23 near '<EOF>'.
  syntax error line 24 at position 38 unexpected 'DST'.
  compiled Code at target\run\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_2d9c950a402e72c1e5c1842ac521121f.sql
[0m11:38:05.257852 [info ] [MainThread]: 
[0m11:38:05.259960 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m11:38:05.262463 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m11:38:05.263026 [info ] [MainThread]: 
[0m11:38:05.265562 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m11:38:05.266562 [info ] [MainThread]: 
[0m11:38:05.266562 [error] [MainThread]: [31mFailure in test positive_value_in dfb (tests\positive_value_in dfb.sql)[0m
[0m11:38:05.266562 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m11:38:05.270859 [info ] [MainThread]: 
[0m11:38:05.270859 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\positive_value_in dfb.sql
[0m11:38:05.273368 [info ] [MainThread]: 
[0m11:38:05.275311 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m11:38:05.278187 [debug] [MainThread]: Command `dbt test` failed at 11:38:05.278187 after 17.84 seconds
[0m11:38:05.278187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E73E11F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7ACBF410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7ACBFC90>]}
[0m11:38:05.278187 [debug] [MainThread]: Flushing usage events
[0m11:43:47.276859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132BB1AB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132BB19A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132BB199D10>]}


============================== 11:43:47.291403 | 77c85bb9-71c4-4568-98a9-db8b0f712931 ==============================
[0m11:43:47.291403 [info ] [MainThread]: Running with dbt=1.7.18
[0m11:43:47.291403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:47.868897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77c85bb9-71c4-4568-98a9-db8b0f712931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132BCCE4190>]}
[0m11:43:48.029472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77c85bb9-71c4-4568-98a9-db8b0f712931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132BCD6B490>]}
[0m11:43:48.041565 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:43:48.089669 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m11:43:48.463926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:43:48.463926 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\dim\dfb_nfl_cleansed.sql
[0m11:43:48.764549 [error] [MainThread]: Encountered an error:
Compilation Error in model dfb_nfl_cleansed (models\dim\dfb_nfl_cleansed.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
[0m11:43:48.764549 [debug] [MainThread]: Command `dbt run` failed at 11:43:48.764549 after 1.57 seconds
[0m11:43:48.764549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132B9B12590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132B42E1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132BB19AA50>]}
[0m11:43:48.764549 [debug] [MainThread]: Flushing usage events
[0m11:44:10.450216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD55CDF8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD55D57410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD55CDFD90>]}


============================== 11:44:10.450216 | 5d1b17e9-92a9-4d48-bf81-8549be7f5786 ==============================
[0m11:44:10.450216 [info ] [MainThread]: Running with dbt=1.7.18
[0m11:44:10.450216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:44:11.039219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d1b17e9-92a9-4d48-bf81-8549be7f5786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD57918C90>]}
[0m11:44:11.165753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d1b17e9-92a9-4d48-bf81-8549be7f5786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD5784F7D0>]}
[0m11:44:11.165753 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:44:11.222059 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m11:44:11.477303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:44:11.477303 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\dim\dfb_nfl_cleansed.sql
[0m11:44:11.857235 [error] [MainThread]: Encountered an error:
Compilation Error in model dfb_nfl_cleansed (models\dim\dfb_nfl_cleansed.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
[0m11:44:11.872908 [debug] [MainThread]: Command `dbt run` failed at 11:44:11.872285 after 1.52 seconds
[0m11:44:11.872908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD551129D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD557CBD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD4EE01FD0>]}
[0m11:44:11.872908 [debug] [MainThread]: Flushing usage events
[0m11:44:25.680131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB64829D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB645C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB645C8D0>]}


============================== 11:44:25.680131 | 78096bf1-1f49-488a-bbd4-041aea8b5e85 ==============================
[0m11:44:25.680131 [info ] [MainThread]: Running with dbt=1.7.18
[0m11:44:25.680131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:44:26.430881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB8038C90>]}
[0m11:44:26.531366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB645FCD0>]}
[0m11:44:26.531366 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:44:26.573133 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m11:44:26.917715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:44:26.917715 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\dim\dfb_nfl_cleansed.sql
[0m11:44:27.314239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB8162090>]}
[0m11:44:27.330410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB8296A90>]}
[0m11:44:27.330410 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m11:44:27.330410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB8075F10>]}
[0m11:44:27.330410 [info ] [MainThread]: 
[0m11:44:27.330410 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:44:27.330410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m11:44:27.354464 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m11:44:27.354464 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m11:44:27.354464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:28.879075 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m11:44:28.879075 [debug] [ThreadPool]: On list_storage: Close
[0m11:44:29.123181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m11:44:29.150182 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m11:44:29.150182 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m11:44:29.150182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:30.248975 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m11:44:30.252745 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m11:44:30.453927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB88DDE10>]}
[0m11:44:30.453927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:44:30.469577 [info ] [MainThread]: 
[0m11:44:30.469577 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m11:44:30.469577 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m11:44:30.469577 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m11:44:30.493760 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m11:44:30.493760 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 11:44:30.469577 => 11:44:30.493760
[0m11:44:30.509967 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m11:44:30.509967 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m11:44:30.516635 [info ] [Thread-1 (]: 1 of 6 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m11:44:30.518932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m11:44:30.518932 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m11:44:30.528216 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m11:44:30.560521 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 11:44:30.518932 => 11:44:30.560521
[0m11:44:30.560521 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m11:44:30.646630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m11:44:30.662259 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m11:44:30.662259 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m11:44:30.662259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:44:32.690297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:44:32.751925 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 11:44:30.574906 => 11:44:32.736212
[0m11:44:32.751925 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m11:44:33.296989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB82ABB10>]}
[0m11:44:33.296989 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 2.78s]
[0m11:44:33.296989 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m11:44:33.312458 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m11:44:33.312458 [info ] [Thread-1 (]: 2 of 6 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m11:44:33.312458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m11:44:33.321564 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m11:44:33.369341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m11:44:33.369341 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 11:44:33.324216 => 11:44:33.369341
[0m11:44:33.373552 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m11:44:33.386073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m11:44:33.390363 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m11:44:33.391342 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Player_ID
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
  );
[0m11:44:33.391342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:35.486435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:44:35.486435 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 11:44:33.373552 => 11:44:35.486435
[0m11:44:35.502074 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m11:44:35.852159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB89F3410>]}
[0m11:44:35.852159 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.54s]
[0m11:44:35.852159 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m11:44:35.852159 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m11:44:35.852159 [info ] [Thread-1 (]: 3 of 6 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m11:44:35.865380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m11:44:35.867365 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m11:44:35.873731 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m11:44:35.873731 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 11:44:35.868045 => 11:44:35.873731
[0m11:44:35.873731 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m11:44:35.883473 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m11:44:35.885379 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m11:44:35.885379 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m11:44:35.889941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:37.901953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:44:37.917370 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 11:44:35.873731 => 11:44:37.917370
[0m11:44:37.917370 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m11:44:38.221452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB82B1D90>]}
[0m11:44:38.221452 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 2.36s]
[0m11:44:38.221452 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m11:44:38.221452 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m11:44:38.237080 [info ] [Thread-1 (]: 4 of 6 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m11:44:38.241387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m11:44:38.243906 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m11:44:38.291923 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m11:44:38.326464 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 11:44:38.245506 => 11:44:38.326464
[0m11:44:38.326464 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m11:44:38.389035 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m11:44:38.389035 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m11:44:38.404694 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m11:44:38.404694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:47.532638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 9.0 seconds
[0m11:44:47.532638 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 11:44:38.326464 => 11:44:47.532638
[0m11:44:47.547222 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m11:44:48.142782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB88F4B10>]}
[0m11:44:48.142782 [info ] [Thread-1 (]: 4 of 6 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 9.90s]
[0m11:44:48.158432 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m11:44:48.158432 [debug] [Thread-1 (]: Began running node model.dfb_data.dfb_nfl_cleansed
[0m11:44:48.158432 [info ] [Thread-1 (]: 5 of 6 START sql table model dfb.dfb_nfl_cleansed .............................. [RUN]
[0m11:44:48.164000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.dfb_nfl_cleansed)
[0m11:44:48.169766 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dfb_nfl_cleansed
[0m11:44:48.184163 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dfb_nfl_cleansed"
[0m11:44:48.187747 [debug] [Thread-1 (]: Timing info for model.dfb_data.dfb_nfl_cleansed (compile): 11:44:48.169766 => 11:44:48.187747
[0m11:44:48.192264 [debug] [Thread-1 (]: Began executing node model.dfb_data.dfb_nfl_cleansed
[0m11:44:48.201610 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dfb_nfl_cleansed"
[0m11:44:48.201610 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dfb_nfl_cleansed"
[0m11:44:48.201610 [debug] [Thread-1 (]: On model.dfb_data.dfb_nfl_cleansed: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dfb_nfl_cleansed"} */
create or replace transient table storage.dfb.dfb_nfl_cleansed
         as
        (
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from storage.dfb.dim_dfb_nfl_data
where PPG > 1
        );
[0m11:44:48.201610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:50.459800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:44:50.464834 [debug] [Thread-1 (]: Timing info for model.dfb_data.dfb_nfl_cleansed (execute): 11:44:48.192264 => 11:44:50.464834
[0m11:44:50.465879 [debug] [Thread-1 (]: On model.dfb_data.dfb_nfl_cleansed: Close
[0m11:44:50.908603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB8A2C550>]}
[0m11:44:50.908603 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dfb.dfb_nfl_cleansed ......................... [[32mSUCCESS 1[0m in 2.74s]
[0m11:44:50.908603 [debug] [Thread-1 (]: Finished running node model.dfb_data.dfb_nfl_cleansed
[0m11:44:50.921695 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m11:44:50.923637 [info ] [Thread-1 (]: 6 of 6 START python table model dfb.py_nfl_data ................................ [RUN]
[0m11:44:50.926325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dfb_nfl_cleansed, now model.dfb_data.py_nfl_data)
[0m11:44:50.926325 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m11:44:50.929834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m11:44:50.956228 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 11:44:50.926325 => 11:44:50.954038
[0m11:44:50.958689 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m11:44:50.974220 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m11:44:50.979436 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m11:44:50.979436 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m11:44:50.979436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:54.792661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m11:44:54.808331 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 11:44:50.958689 => 11:44:54.808331
[0m11:44:54.808331 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m11:44:55.411700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78096bf1-1f49-488a-bbd4-041aea8b5e85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB82AA490>]}
[0m11:44:55.426223 [info ] [Thread-1 (]: 6 of 6 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 4.49s]
[0m11:44:55.428010 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m11:44:55.428010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:55.428010 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m11:44:55.428010 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m11:44:55.441167 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m11:44:55.442195 [info ] [MainThread]: 
[0m11:44:55.446990 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 28.11 seconds (28.11s).
[0m11:44:55.457652 [debug] [MainThread]: Command end result
[0m11:44:55.499715 [info ] [MainThread]: 
[0m11:44:55.504043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:55.504043 [info ] [MainThread]: 
[0m11:44:55.505960 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:44:55.511270 [debug] [MainThread]: Command `dbt run` succeeded at 11:44:55.511270 after 29.92 seconds
[0m11:44:55.513401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BAF591FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BAF870BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BAF864C10>]}
[0m11:44:55.515464 [debug] [MainThread]: Flushing usage events
[0m12:07:55.068861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025492469C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549221A610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549363F150>]}


============================== 12:07:55.073877 | 6b25e6e7-c60f-4194-b20e-3135df5baede ==============================
[0m12:07:55.073877 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:07:55.074872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:56.663098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025493603310>]}
[0m12:07:56.798963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025493054910>]}
[0m12:07:56.802298 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:07:57.018737 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:08:02.960889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:08:02.961898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:08:02.970896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549363C050>]}
[0m12:08:03.025512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025495375850>]}
[0m12:08:03.027513 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m12:08:03.035507 [info ] [MainThread]: 
[0m12:08:03.038511 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:08:03.043509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:08:03.063507 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:08:03.064566 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:08:03.065576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:04.832680 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:08:04.838684 [debug] [ThreadPool]: On list_storage: Close
[0m12:08:05.800485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:08:05.824438 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:08:05.825439 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:08:05.827437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:07.633423 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m12:08:07.641659 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:08:08.355548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549369E610>]}
[0m12:08:08.359552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:08.362565 [info ] [MainThread]: 
[0m12:08:08.372771 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:08:08.375771 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:08:08.377771 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:08:08.408445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:08:08.412453 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:08:08.379774 => 12:08:08.411512
[0m12:08:08.416449 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:08:08.419449 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m12:08:08.422449 [info ] [Thread-1 (]: 1 of 13 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m12:08:08.425445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m12:08:08.426496 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m12:08:08.428445 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 12:08:08.427509 => 12:08:08.427509
[0m12:08:08.429507 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m12:08:08.555005 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:08:08.556004 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m12:08:08.557005 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:08:10.109493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:08:10.112445 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:08:10.113508 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m12:08:10.723014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:08:10.724013 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:08:10.725013 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m12:08:11.133373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:08:11.172425 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:08:11.174417 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m12:08:11.338355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:08:11.342399 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:08:11.343393 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m12:08:11.932967 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 1.0 seconds
[0m12:08:11.935024 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m12:08:11.936959 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m12:08:12.548468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:08:12.566530 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m12:08:12.706468 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 12:08:08.430446 => 12:08:12.706468
[0m12:08:12.708464 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m12:08:13.165548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254958A9710>]}
[0m12:08:13.167552 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file dfb.seed_nfl_teams ................................. [[32mINSERT 31[0m in 4.74s]
[0m12:08:13.171601 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m12:08:13.172569 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:08:13.175801 [info ] [Thread-1 (]: 2 of 13 START sql view model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m12:08:13.178809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m12:08:13.180813 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:08:13.248441 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:08:13.254441 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:08:13.181805 => 12:08:13.254441
[0m12:08:13.255451 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:08:13.281702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:08:13.284123 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:08:13.285200 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Player_ID
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
  );
[0m12:08:13.285200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:15.632867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:08:15.648921 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:08:13.258439 => 12:08:15.647929
[0m12:08:15.650921 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:08:16.545488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025495544A50>]}
[0m12:08:16.548552 [info ] [Thread-1 (]: 2 of 13 OK created sql view model dfb.dim_dfb_nfl_data ......................... [[32mSUCCESS 1[0m in 3.37s]
[0m12:08:16.552489 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:08:16.554489 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m12:08:16.557493 [info ] [Thread-1 (]: 3 of 13 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m12:08:16.561491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m12:08:16.564508 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m12:08:16.579505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m12:08:16.583492 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 12:08:16.565489 => 12:08:16.582490
[0m12:08:16.584490 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m12:08:16.599772 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m12:08:16.606299 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m12:08:16.607315 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m12:08:16.610314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:18.404674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:08:18.412307 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 12:08:16.585717 => 12:08:18.412307
[0m12:08:18.414317 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m12:08:18.612540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002549599FF10>]}
[0m12:08:18.614542 [info ] [Thread-1 (]: 3 of 13 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 2.05s]
[0m12:08:18.617532 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m12:08:18.619526 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m12:08:18.621725 [info ] [Thread-1 (]: 4 of 13 START sql view model dfb.stg_nfl_teams ................................. [RUN]
[0m12:08:18.626746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m12:08:18.628748 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m12:08:18.639744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m12:08:18.646144 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 12:08:18.629754 => 12:08:18.644145
[0m12:08:18.648144 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m12:08:18.662140 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m12:08:18.665136 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m12:08:18.666138 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m12:08:18.668137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:20.545766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:08:20.553818 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 12:08:18.650142 => 12:08:20.552819
[0m12:08:20.555773 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m12:08:20.914498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254958A9710>]}
[0m12:08:20.918506 [info ] [Thread-1 (]: 4 of 13 OK created sql view model dfb.stg_nfl_teams ............................ [[32mSUCCESS 1[0m in 2.29s]
[0m12:08:20.921517 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m12:08:20.924506 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:08:20.927505 [info ] [Thread-1 (]: 5 of 13 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST  [RUN]
[0m12:08:20.932004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5)
[0m12:08:20.935026 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:08:20.977452 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:08:20.980414 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5 (compile): 12:08:20.937031 => 12:08:20.979422
[0m12:08:20.981407 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:08:21.008691 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:08:21.011200 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:08:21.012210 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'DST'
)



      
    ) dbt_internal_test
[0m12:08:21.013221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:23.266634 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82c04-0102-2c47-0006-b1e600036e36
[0m12:08:23.268635 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 30 at position 23 near '<EOF>'.
syntax error line 24 at position 38 unexpected 'DST'.
[0m12:08:23.271684 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5 (execute): 12:08:20.982608 => 12:08:23.270685
[0m12:08:23.272692 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5: Close
[0m12:08:23.663433 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST (models\schema.yml)
  001003 (42000): SQL compilation error:
  parse error line 30 at position 23 near '<EOF>'.
  syntax error line 24 at position 38 unexpected 'DST'.
  compiled Code at target\run\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_2d9c950a402e72c1e5c1842ac521121f.sql
[0m12:08:23.665434 [error] [Thread-1 (]: 5 of 13 ERROR accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST  [[31mERROR[0m in 2.73s]
[0m12:08:23.668438 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:08:23.670436 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:08:23.671437 [info ] [Thread-1 (]: 6 of 13 START test no_nulls_in_dim_dfb ......................................... [RUN]
[0m12:08:23.675987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5, now test.dfb_data.no_nulls_in_dim_dfb)
[0m12:08:23.679012 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m12:08:23.706012 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:08:23.707005 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m12:08:23.707005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:25.188311 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 1.0 seconds
[0m12:08:25.195406 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:08:25.199311 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 12:08:23.682008 => 12:08:25.198314
[0m12:08:25.201328 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m12:08:25.211339 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:08:25.217125 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:08:25.219116 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m12:08:25.659110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:08:25.668123 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 12:08:25.202327 => 12:08:25.667120
[0m12:08:25.670131 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m12:08:26.377637 [error] [Thread-1 (]: 6 of 13 FAIL 123 no_nulls_in_dim_dfb ........................................... [[31mFAIL 123[0m in 2.70s]
[0m12:08:26.381631 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:08:26.382632 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:08:26.385017 [info ] [Thread-1 (]: 7 of 13 START test not_null_dim_dfb_nfl_data_date .............................. [RUN]
[0m12:08:26.389016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:08:26.391017 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:08:26.416786 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:08:26.421743 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:08:26.392010 => 12:08:26.419752
[0m12:08:26.424741 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:08:26.438178 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:08:26.442174 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:08:26.443212 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:08:26.444194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:28.215552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:08:28.225080 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:08:26.427193 => 12:08:28.223079
[0m12:08:28.227078 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:08:28.926147 [info ] [Thread-1 (]: 7 of 13 PASS not_null_dim_dfb_nfl_data_date .................................... [[32mPASS[0m in 2.54s]
[0m12:08:28.929143 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:08:28.931302 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:08:28.933433 [info ] [Thread-1 (]: 8 of 13 START test not_null_dim_dfb_nfl_data_name .............................. [RUN]
[0m12:08:28.936455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:08:28.939517 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:08:28.951504 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:08:28.953448 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:08:28.941536 => 12:08:28.952517
[0m12:08:28.954447 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:08:28.965518 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:08:28.969454 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:08:28.971454 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:08:28.974455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:31.186100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:08:31.195114 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:08:28.955491 => 12:08:31.194115
[0m12:08:31.197101 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:08:31.802179 [info ] [Thread-1 (]: 8 of 13 PASS not_null_dim_dfb_nfl_data_name .................................... [[32mPASS[0m in 2.87s]
[0m12:08:31.805198 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:08:31.807196 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_in dfb
[0m12:08:31.809217 [info ] [Thread-1 (]: 9 of 13 START test positive_value_in dfb ....................................... [RUN]
[0m12:08:31.813198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_in dfb)
[0m12:08:31.815208 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_in dfb
[0m12:08:31.827800 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_in dfb"
[0m12:08:31.833764 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (compile): 12:08:31.816201 => 12:08:31.832753
[0m12:08:31.836753 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_in dfb
[0m12:08:31.848193 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_in dfb"
[0m12:08:31.855415 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_in dfb"
[0m12:08:31.856412 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_in dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 0

      
    ) dbt_internal_test
[0m12:08:31.858399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:34.786693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:08:34.790184 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (execute): 12:08:31.837751 => 12:08:34.789103
[0m12:08:34.790184 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: Close
[0m12:08:35.693893 [error] [Thread-1 (]: 9 of 13 FAIL 11 positive_value_in dfb .......................................... [[31mFAIL 11[0m in 3.88s]
[0m12:08:35.695881 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_in dfb
[0m12:08:35.696876 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m12:08:35.698885 [info ] [Thread-1 (]: 10 of 13 START test t_ppg_value ................................................ [RUN]
[0m12:08:35.702885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_in dfb, now test.dfb_data.t_ppg_value)
[0m12:08:35.704878 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m12:08:35.724166 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m12:08:35.728164 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 12:08:35.706883 => 12:08:35.727164
[0m12:08:35.732162 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m12:08:35.746158 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m12:08:35.750157 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m12:08:35.751155 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m12:08:35.751155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:38.252769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:08:38.259755 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 12:08:35.734169 => 12:08:38.258756
[0m12:08:38.261753 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m12:08:38.411654 [info ] [Thread-1 (]: 10 of 13 PASS t_ppg_value ...................................................... [[32mPASS[0m in 2.71s]
[0m12:08:38.414492 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m12:08:38.417478 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m12:08:38.419491 [info ] [Thread-1 (]: 11 of 13 START python table model dfb.py_nfl_data .............................. [RUN]
[0m12:08:38.423667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.t_ppg_value, now model.dfb_data.py_nfl_data)
[0m12:08:38.424662 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m12:08:38.492507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m12:08:38.496510 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 12:08:38.427207 => 12:08:38.495506
[0m12:08:38.498510 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m12:08:38.571312 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m12:08:38.575243 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m12:08:38.576244 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m12:08:38.577245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:47.262694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 9.0 seconds
[0m12:08:47.269165 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 12:08:38.500507 => 12:08:47.268148
[0m12:08:47.269165 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m12:08:47.571929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254959B9DD0>]}
[0m12:08:47.574928 [info ] [Thread-1 (]: 11 of 13 OK created python table model dfb.py_nfl_data ......................... [[32mSUCCESS 1[0m in 9.15s]
[0m12:08:47.578932 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m12:08:47.580928 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m12:08:47.582931 [info ] [Thread-1 (]: 12 of 13 START python table model dfb.fct_nfl_teams ............................ [RUN]
[0m12:08:47.587941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m12:08:47.590942 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m12:08:47.610938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m12:08:47.614940 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 12:08:47.593941 => 12:08:47.613936
[0m12:08:47.615936 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m12:08:47.623942 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m12:08:47.626942 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m12:08:47.627946 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m12:08:47.628944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:51.685775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m12:08:51.695775 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 12:08:47.616934 => 12:08:51.694778
[0m12:08:51.696774 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m12:08:51.891773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b25e6e7-c60f-4194-b20e-3135df5baede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025495A55790>]}
[0m12:08:51.893772 [info ] [Thread-1 (]: 12 of 13 OK created python table model dfb.fct_nfl_teams ....................... [[32mSUCCESS 1[0m in 4.30s]
[0m12:08:51.897835 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m12:08:51.899772 [debug] [Thread-1 (]: Began running node model.dfb_data.dfb_nfl_cleansed
[0m12:08:51.900785 [info ] [Thread-1 (]: 13 of 13 SKIP relation dfb.dfb_nfl_cleansed .................................... [[33mSKIP[0m]
[0m12:08:51.904415 [debug] [Thread-1 (]: Finished running node model.dfb_data.dfb_nfl_cleansed
[0m12:08:51.913416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:51.915415 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:08:51.917437 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:08:51.918411 [debug] [MainThread]: Connection 'model.dfb_data.fct_nfl_teams' was properly closed.
[0m12:08:51.921415 [info ] [MainThread]: 
[0m12:08:51.926438 [info ] [MainThread]: Finished running 1 seed, 3 view models, 6 tests, 3 table models in 0 hours 0 minutes and 48.88 seconds (48.88s).
[0m12:08:51.938431 [debug] [MainThread]: Command end result
[0m12:08:51.966973 [info ] [MainThread]: 
[0m12:08:51.968960 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:08:51.969959 [info ] [MainThread]: 
[0m12:08:51.971963 [error] [MainThread]:   Database Error in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST (models\schema.yml)
  001003 (42000): SQL compilation error:
  parse error line 30 at position 23 near '<EOF>'.
  syntax error line 24 at position 38 unexpected 'DST'.
  compiled Code at target\run\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_2d9c950a402e72c1e5c1842ac521121f.sql
[0m12:08:51.973961 [info ] [MainThread]: 
[0m12:08:51.975960 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m12:08:51.976996 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m12:08:51.977960 [info ] [MainThread]: 
[0m12:08:51.978966 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m12:08:51.981060 [info ] [MainThread]: 
[0m12:08:51.982066 [error] [MainThread]: [31mFailure in test positive_value_in dfb (tests\positive_value_in dfb.sql)[0m
[0m12:08:51.983106 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m12:08:51.984066 [info ] [MainThread]: 
[0m12:08:51.985079 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\positive_value_in dfb.sql
[0m12:08:51.987374 [info ] [MainThread]: 
[0m12:08:51.989384 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=3 SKIP=1 TOTAL=13
[0m12:08:51.992389 [debug] [MainThread]: Command `dbt build` failed at 12:08:51.992389 after 57.26 seconds
[0m12:08:51.993385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002548C7A1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025493673290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254936704D0>]}
[0m12:08:51.994387 [debug] [MainThread]: Flushing usage events
[0m12:10:21.898420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC319C9ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC32DFC750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC32DFC450>]}


============================== 12:10:21.903419 | a08707c3-3f2e-4a31-9fc7-a997599537ab ==============================
[0m12:10:21.903419 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:10:21.905416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'send_anonymous_usage_stats': 'True'}
[0m12:10:22.639305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a08707c3-3f2e-4a31-9fc7-a997599537ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC349C7210>]}
[0m12:10:22.785604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a08707c3-3f2e-4a31-9fc7-a997599537ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC34947910>]}
[0m12:10:22.787610 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:10:22.817750 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:10:23.130709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:23.132651 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\dim_dfb_nfl_data.sql
[0m12:10:23.921351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a08707c3-3f2e-4a31-9fc7-a997599537ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC34FB7690>]}
[0m12:10:23.944889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a08707c3-3f2e-4a31-9fc7-a997599537ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC35063250>]}
[0m12:10:23.945888 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m12:10:23.947588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a08707c3-3f2e-4a31-9fc7-a997599537ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC34A27110>]}
[0m12:10:23.950232 [info ] [MainThread]: 
[0m12:10:23.952658 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:10:23.956669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:10:23.975729 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:10:23.975729 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:10:23.976730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:28.064880 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 4.0 seconds
[0m12:10:28.070826 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:10:28.258846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a08707c3-3f2e-4a31-9fc7-a997599537ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC34F14A50>]}
[0m12:10:28.261840 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:28.264832 [info ] [MainThread]: 
[0m12:10:28.275328 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:10:28.277331 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST  [RUN]
[0m12:10:28.281585 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5'
[0m12:10:28.284671 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:10:28.314729 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:10:28.317683 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5 (compile): 12:10:28.288673 => 12:10:28.316666
[0m12:10:28.318676 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:10:28.370251 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:10:28.374198 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:10:28.376200 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'DST'
)



      
    ) dbt_internal_test
[0m12:10:28.377229 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:10:29.619689 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82c06-0102-2c49-0006-b1e60003815a
[0m12:10:29.621699 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 30 at position 23 near '<EOF>'.
syntax error line 24 at position 38 unexpected 'DST'.
[0m12:10:29.623634 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5 (execute): 12:10:28.320684 => 12:10:29.623634
[0m12:10:29.626633 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5: Close
[0m12:10:30.462268 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST (models\schema.yml)
  001003 (42000): SQL compilation error:
  parse error line 30 at position 23 near '<EOF>'.
  syntax error line 24 at position 38 unexpected 'DST'.
  compiled Code at target\run\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_2d9c950a402e72c1e5c1842ac521121f.sql
[0m12:10:30.464262 [error] [Thread-1 (]: 1 of 6 ERROR accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST  [[31mERROR[0m in 2.18s]
[0m12:10:30.468451 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:10:30.470450 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:10:30.475355 [info ] [Thread-1 (]: 2 of 6 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m12:10:30.478355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5, now test.dfb_data.no_nulls_in_dim_dfb)
[0m12:10:30.480355 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m12:10:30.525425 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:10:30.527418 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m12:10:30.531373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:32.074477 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 2.0 seconds
[0m12:10:32.082477 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:10:32.086468 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 12:10:30.482358 => 12:10:32.085468
[0m12:10:32.088470 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m12:10:32.098530 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:10:32.102462 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:10:32.104523 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m12:10:32.210137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:10:32.235144 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 12:10:32.090479 => 12:10:32.233141
[0m12:10:32.237679 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m12:10:32.449963 [error] [Thread-1 (]: 2 of 6 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 1.97s]
[0m12:10:32.453966 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:10:32.455993 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:10:32.457963 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:10:32.462132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:10:32.464979 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:10:32.492442 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:10:32.495428 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:10:32.467408 => 12:10:32.495428
[0m12:10:32.497426 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:10:32.504429 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:10:32.506423 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:10:32.507423 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:10:32.508423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:33.965218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:33.973232 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:10:32.499424 => 12:10:33.972231
[0m12:10:33.975231 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:10:34.455354 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 2.00s]
[0m12:10:34.459273 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:10:34.461287 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:10:34.463273 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:10:34.468288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:10:34.471275 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:10:34.488331 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:10:34.491271 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:10:34.472285 => 12:10:34.491271
[0m12:10:34.493285 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:10:34.505359 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:10:34.510283 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:10:34.512281 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:10:34.516283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:35.909243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:35.916305 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:10:34.494327 => 12:10:35.915297
[0m12:10:35.918244 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:10:36.252439 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.79s]
[0m12:10:36.256457 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:10:36.258519 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_in dfb
[0m12:10:36.260452 [info ] [Thread-1 (]: 5 of 6 START test positive_value_in dfb ........................................ [RUN]
[0m12:10:36.264441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_in dfb)
[0m12:10:36.266445 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_in dfb
[0m12:10:36.283444 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_in dfb"
[0m12:10:36.288444 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (compile): 12:10:36.267445 => 12:10:36.287442
[0m12:10:36.290438 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_in dfb
[0m12:10:36.301665 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_in dfb"
[0m12:10:36.303675 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_in dfb"
[0m12:10:36.305677 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_in dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 0

      
    ) dbt_internal_test
[0m12:10:36.305677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:37.854189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:10:37.859189 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (execute): 12:10:36.291438 => 12:10:37.858190
[0m12:10:37.861180 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: Close
[0m12:10:38.471539 [error] [Thread-1 (]: 5 of 6 FAIL 11 positive_value_in dfb ........................................... [[31mFAIL 11[0m in 2.21s]
[0m12:10:38.475825 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_in dfb
[0m12:10:38.477877 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m12:10:38.478888 [info ] [Thread-1 (]: 6 of 6 START test t_ppg_value .................................................. [RUN]
[0m12:10:38.483164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_in dfb, now test.dfb_data.t_ppg_value)
[0m12:10:38.487170 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m12:10:38.501218 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m12:10:38.505170 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 12:10:38.489170 => 12:10:38.504168
[0m12:10:38.508172 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m12:10:38.518178 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m12:10:38.523177 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m12:10:38.526165 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m12:10:38.527255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:39.949415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:39.956262 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 12:10:38.509189 => 12:10:39.955280
[0m12:10:39.957247 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m12:10:40.130474 [info ] [Thread-1 (]: 6 of 6 PASS t_ppg_value ........................................................ [[32mPASS[0m in 1.65s]
[0m12:10:40.134485 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m12:10:40.144020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:40.146020 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:10:40.148019 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m12:10:40.150020 [info ] [MainThread]: 
[0m12:10:40.152070 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 16.20 seconds (16.20s).
[0m12:10:40.158082 [debug] [MainThread]: Command end result
[0m12:10:40.199018 [info ] [MainThread]: 
[0m12:10:40.201424 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:10:40.202148 [info ] [MainThread]: 
[0m12:10:40.203097 [error] [MainThread]:   Database Error in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST (models\schema.yml)
  001003 (42000): SQL compilation error:
  parse error line 30 at position 23 near '<EOF>'.
  syntax error line 24 at position 38 unexpected 'DST'.
  compiled Code at target\run\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_2d9c950a402e72c1e5c1842ac521121f.sql
[0m12:10:40.204125 [info ] [MainThread]: 
[0m12:10:40.205133 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m12:10:40.207167 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m12:10:40.208136 [info ] [MainThread]: 
[0m12:10:40.209138 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m12:10:40.209138 [info ] [MainThread]: 
[0m12:10:40.210134 [error] [MainThread]: [31mFailure in test positive_value_in dfb (tests\positive_value_in dfb.sql)[0m
[0m12:10:40.211133 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m12:10:40.215136 [info ] [MainThread]: 
[0m12:10:40.217136 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\positive_value_in dfb.sql
[0m12:10:40.218522 [info ] [MainThread]: 
[0m12:10:40.219534 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m12:10:40.222528 [debug] [MainThread]: Command `dbt test` failed at 12:10:40.221531 after 18.41 seconds
[0m12:10:40.222528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2BEE1F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC32E2B150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC2C1B0C50>]}
[0m12:10:40.223535 [debug] [MainThread]: Flushing usage events
[0m12:11:16.543498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579C90C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579CE791D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579CE7A2D0>]}


============================== 12:11:16.548499 | c2759318-6e1f-4333-a39e-78b9e4465fac ==============================
[0m12:11:16.548499 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:11:16.549495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:17.209478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2759318-6e1f-4333-a39e-78b9e4465fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579E9A3F90>]}
[0m12:11:17.386529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2759318-6e1f-4333-a39e-78b9e4465fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579CE2C5D0>]}
[0m12:11:17.390523 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:11:17.450548 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:11:17.776609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:17.777610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:17.787135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2759318-6e1f-4333-a39e-78b9e4465fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579ED40490>]}
[0m12:11:17.809135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2759318-6e1f-4333-a39e-78b9e4465fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579EB858D0>]}
[0m12:11:17.810135 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m12:11:17.811284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2759318-6e1f-4333-a39e-78b9e4465fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579EB35990>]}
[0m12:11:17.813314 [info ] [MainThread]: 
[0m12:11:17.815580 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:17.818542 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:11:17.837542 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:11:17.838559 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:11:17.839602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:19.322047 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m12:11:19.330064 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:11:19.952841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2759318-6e1f-4333-a39e-78b9e4465fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579EA993D0>]}
[0m12:11:19.964630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:19.967697 [info ] [MainThread]: 
[0m12:11:19.975679 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:11:19.977656 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST  [RUN]
[0m12:11:19.982973 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5'
[0m12:11:19.985967 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:11:20.046009 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:11:20.051030 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5 (compile): 12:11:19.986975 => 12:11:20.049041
[0m12:11:20.053030 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:11:20.100787 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:11:20.103732 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:11:20.104740 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'DST'
)



      
    ) dbt_internal_test
[0m12:11:20.105740 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:11:21.595649 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82c07-0102-2c49-0006-b1e60003816a
[0m12:11:21.597649 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 30 at position 23 near '<EOF>'.
syntax error line 24 at position 38 unexpected 'DST'.
[0m12:11:21.599648 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5 (execute): 12:11:20.054027 => 12:11:21.598649
[0m12:11:21.601649 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5: Close
[0m12:11:22.217064 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST (models\schema.yml)
  001003 (42000): SQL compilation error:
  parse error line 30 at position 23 near '<EOF>'.
  syntax error line 24 at position 38 unexpected 'DST'.
  compiled Code at target\run\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_2d9c950a402e72c1e5c1842ac521121f.sql
[0m12:11:22.220072 [error] [Thread-1 (]: 1 of 6 ERROR accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST  [[31mERROR[0m in 2.24s]
[0m12:11:22.223298 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:11:22.225321 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:11:22.229330 [info ] [Thread-1 (]: 2 of 6 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m12:11:22.233646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5, now test.dfb_data.no_nulls_in_dim_dfb)
[0m12:11:22.235643 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m12:11:22.282714 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:11:22.284227 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m12:11:22.286243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:24.453282 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 2.0 seconds
[0m12:11:24.464283 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:11:24.469453 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 12:11:22.238649 => 12:11:24.468433
[0m12:11:24.472479 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m12:11:24.481487 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:11:24.485526 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:11:24.487095 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m12:11:24.759077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:11:24.779514 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 12:11:24.473492 => 12:11:24.778510
[0m12:11:24.782500 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m12:11:25.374400 [error] [Thread-1 (]: 2 of 6 FAIL 123 no_nulls_in_dim_dfb ............................................ [[31mFAIL 123[0m in 3.14s]
[0m12:11:25.377397 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:11:25.379816 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:11:25.381810 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:11:25.385807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:11:25.388364 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:11:25.416350 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:11:25.421349 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:11:25.390349 => 12:11:25.420348
[0m12:11:25.423364 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:11:25.439354 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:11:25.442354 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:11:25.443351 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:11:25.445346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:26.522253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:26.528256 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:11:25.424358 => 12:11:26.527255
[0m12:11:26.530242 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:11:26.723610 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.34s]
[0m12:11:26.727662 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:11:26.728671 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:11:26.730620 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:11:26.734612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:11:26.736612 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:11:26.752612 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:11:26.758612 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:11:26.737612 => 12:11:26.757624
[0m12:11:26.761756 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:11:26.776710 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:11:26.780119 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:11:26.781117 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:11:26.782124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:27.948615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:27.955627 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:11:26.762756 => 12:11:27.954675
[0m12:11:27.957624 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:11:28.409288 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.68s]
[0m12:11:28.412285 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:11:28.413293 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_in dfb
[0m12:11:28.414282 [info ] [Thread-1 (]: 5 of 6 START test positive_value_in dfb ........................................ [RUN]
[0m12:11:28.416328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_in dfb)
[0m12:11:28.417304 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_in dfb
[0m12:11:28.427285 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_in dfb"
[0m12:11:28.429306 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (compile): 12:11:28.418296 => 12:11:28.429306
[0m12:11:28.430297 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_in dfb
[0m12:11:28.437713 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_in dfb"
[0m12:11:28.440990 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_in dfb"
[0m12:11:28.442084 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_in dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 0

      
    ) dbt_internal_test
[0m12:11:28.442993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:30.387930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:11:30.397458 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (execute): 12:11:28.430297 => 12:11:30.396456
[0m12:11:30.399454 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: Close
[0m12:11:31.003486 [error] [Thread-1 (]: 5 of 6 FAIL 11 positive_value_in dfb ........................................... [[31mFAIL 11[0m in 2.59s]
[0m12:11:31.006474 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_in dfb
[0m12:11:31.009423 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m12:11:31.010693 [info ] [Thread-1 (]: 6 of 6 START test t_ppg_value .................................................. [RUN]
[0m12:11:31.015674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_in dfb, now test.dfb_data.t_ppg_value)
[0m12:11:31.017687 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m12:11:31.034727 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m12:11:31.039085 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 12:11:31.020688 => 12:11:31.037674
[0m12:11:31.041104 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m12:11:31.056158 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m12:11:31.061159 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m12:11:31.063107 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m12:11:31.066575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:32.272373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:11:32.280386 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 12:11:31.042165 => 12:11:32.279368
[0m12:11:32.283389 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m12:11:32.661867 [info ] [Thread-1 (]: 6 of 6 PASS t_ppg_value ........................................................ [[32mPASS[0m in 1.65s]
[0m12:11:32.664863 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m12:11:32.670214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:32.672205 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:11:32.676206 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m12:11:32.678204 [info ] [MainThread]: 
[0m12:11:32.681244 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 14.86 seconds (14.86s).
[0m12:11:32.686271 [debug] [MainThread]: Command end result
[0m12:11:32.721798 [info ] [MainThread]: 
[0m12:11:32.724274 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:11:32.725284 [info ] [MainThread]: 
[0m12:11:32.726288 [error] [MainThread]:   Database Error in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST (models\schema.yml)
  001003 (42000): SQL compilation error:
  parse error line 30 at position 23 near '<EOF>'.
  syntax error line 24 at position 38 unexpected 'DST'.
  compiled Code at target\run\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_2d9c950a402e72c1e5c1842ac521121f.sql
[0m12:11:32.728284 [info ] [MainThread]: 
[0m12:11:32.730284 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m12:11:32.731285 [error] [MainThread]:   Got 123 results, configured to fail if != 0
[0m12:11:32.733290 [info ] [MainThread]: 
[0m12:11:32.735343 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m12:11:32.736284 [info ] [MainThread]: 
[0m12:11:32.737284 [error] [MainThread]: [31mFailure in test positive_value_in dfb (tests\positive_value_in dfb.sql)[0m
[0m12:11:32.738284 [error] [MainThread]:   Got 11 results, configured to fail if != 0
[0m12:11:32.739283 [info ] [MainThread]: 
[0m12:11:32.740367 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\positive_value_in dfb.sql
[0m12:11:32.741368 [info ] [MainThread]: 
[0m12:11:32.742055 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m12:11:32.744069 [debug] [MainThread]: Command `dbt test` failed at 12:11:32.744069 after 16.30 seconds
[0m12:11:32.746071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025795F61F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579CE1E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579CE1CF10>]}
[0m12:11:32.747068 [debug] [MainThread]: Flushing usage events
[0m12:16:04.769286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018950A2A550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018950605C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189509CE090>]}


============================== 12:16:04.772677 | 08f6f03d-e1bb-4020-94a3-0cc320c921bf ==============================
[0m12:16:04.772677 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:16:04.772677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:05.575929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018950A6F950>]}
[0m12:16:05.738407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018950A1B690>]}
[0m12:16:05.738407 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:16:05.774940 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:16:06.083915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:06.083915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:06.083915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189526E6050>]}
[0m12:16:06.115157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018952753190>]}
[0m12:16:06.115157 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m12:16:06.115157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895265E650>]}
[0m12:16:06.115157 [info ] [MainThread]: 
[0m12:16:06.130084 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:06.131956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:16:06.154318 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:16:06.159156 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:16:06.160957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:08.307960 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:16:08.307960 [debug] [ThreadPool]: On list_storage: Close
[0m12:16:08.731850 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:16:08.764487 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:16:08.764487 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:16:08.764487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:09.980273 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m12:16:09.980273 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:16:10.169135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895263CD10>]}
[0m12:16:10.169135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:10.169135 [info ] [MainThread]: 
[0m12:16:10.189916 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:16:10.195630 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:16:10.195630 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:16:10.217819 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:16:10.223324 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:16:10.199748 => 12:16:10.217819
[0m12:16:10.227953 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:16:10.227953 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m12:16:10.227953 [info ] [Thread-1 (]: 1 of 6 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m12:16:10.227953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m12:16:10.227953 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m12:16:10.247059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m12:16:10.247059 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 12:16:10.227953 => 12:16:10.247059
[0m12:16:10.250137 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m12:16:10.282566 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m12:16:10.282566 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m12:16:10.282566 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m12:16:10.282566 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:16:11.904828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:16:11.950591 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 12:16:10.251697 => 12:16:11.950591
[0m12:16:11.952098 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m12:16:12.624222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189527CBB90>]}
[0m12:16:12.624222 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 2.40s]
[0m12:16:12.624222 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m12:16:12.624222 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:16:12.642492 [info ] [Thread-1 (]: 2 of 6 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:16:12.647396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m12:16:12.647396 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:16:12.712089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:16:12.712089 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:16:12.647396 => 12:16:12.712089
[0m12:16:12.722185 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:16:12.726006 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:16:12.736001 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:16:12.736001 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Player_ID
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m12:16:12.736001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:14.982504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:16:14.987156 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:16:12.723458 => 12:16:14.987156
[0m12:16:14.987156 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:16:15.188709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018952675310>]}
[0m12:16:15.189836 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.54s]
[0m12:16:15.195461 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:16:15.195461 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m12:16:15.199441 [info ] [Thread-1 (]: 3 of 6 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m12:16:15.204120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m12:16:15.206274 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m12:16:15.210868 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m12:16:15.221600 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 12:16:15.208471 => 12:16:15.221600
[0m12:16:15.221600 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m12:16:15.229709 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m12:16:15.229709 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m12:16:15.229709 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m12:16:15.229709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:16.617692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:16.617692 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 12:16:15.224802 => 12:16:16.617692
[0m12:16:16.634756 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m12:16:17.008194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018952798E90>]}
[0m12:16:17.008194 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.81s]
[0m12:16:17.008194 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m12:16:17.008194 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m12:16:17.021032 [info ] [Thread-1 (]: 4 of 6 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m12:16:17.025534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m12:16:17.027434 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m12:16:17.092571 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m12:16:17.092571 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 12:16:17.027634 => 12:16:17.092571
[0m12:16:17.092571 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m12:16:17.133119 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m12:16:17.133119 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m12:16:17.133119 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m12:16:17.148739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:20.387827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:16:20.387827 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 12:16:17.100866 => 12:16:20.387827
[0m12:16:20.387827 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m12:16:20.771111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018952CDEDD0>]}
[0m12:16:20.771111 [info ] [Thread-1 (]: 4 of 6 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 3.75s]
[0m12:16:20.771111 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m12:16:20.786808 [debug] [Thread-1 (]: Began running node model.dfb_data.dfb_nfl_cleansed
[0m12:16:20.786808 [info ] [Thread-1 (]: 5 of 6 START sql table model dfb.dfb_nfl_cleansed .............................. [RUN]
[0m12:16:20.793816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.dfb_nfl_cleansed)
[0m12:16:20.796000 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dfb_nfl_cleansed
[0m12:16:20.798419 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dfb_nfl_cleansed"
[0m12:16:20.810936 [debug] [Thread-1 (]: Timing info for model.dfb_data.dfb_nfl_cleansed (compile): 12:16:20.797596 => 12:16:20.798419
[0m12:16:20.812554 [debug] [Thread-1 (]: Began executing node model.dfb_data.dfb_nfl_cleansed
[0m12:16:20.822188 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dfb_nfl_cleansed"
[0m12:16:20.822188 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dfb_nfl_cleansed"
[0m12:16:20.835213 [debug] [Thread-1 (]: On model.dfb_data.dfb_nfl_cleansed: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dfb_nfl_cleansed"} */
create or replace transient table storage.dfb.dfb_nfl_cleansed
         as
        (
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from storage.dfb.dim_dfb_nfl_data
where PPG > 1
        );
[0m12:16:20.838251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:22.548281 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:16:22.563758 [debug] [Thread-1 (]: Timing info for model.dfb_data.dfb_nfl_cleansed (execute): 12:16:20.812554 => 12:16:22.563758
[0m12:16:22.563758 [debug] [Thread-1 (]: On model.dfb_data.dfb_nfl_cleansed: Close
[0m12:16:22.762698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018952675310>]}
[0m12:16:22.762698 [info ] [Thread-1 (]: 5 of 6 OK created sql table model dfb.dfb_nfl_cleansed ......................... [[32mSUCCESS 1[0m in 1.97s]
[0m12:16:22.772227 [debug] [Thread-1 (]: Finished running node model.dfb_data.dfb_nfl_cleansed
[0m12:16:22.772227 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m12:16:22.772227 [info ] [Thread-1 (]: 6 of 6 START python table model dfb.py_nfl_data ................................ [RUN]
[0m12:16:22.781571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dfb_nfl_cleansed, now model.dfb_data.py_nfl_data)
[0m12:16:22.783692 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m12:16:22.794770 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m12:16:22.806437 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 12:16:22.785227 => 12:16:22.805523
[0m12:16:22.807018 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m12:16:22.820659 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m12:16:22.820659 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m12:16:22.829738 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m12:16:22.834076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:26.946147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m12:16:26.961602 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 12:16:22.807018 => 12:16:26.961602
[0m12:16:26.961602 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m12:16:27.166322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f6f03d-e1bb-4020-94a3-0cc320c921bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018952CE1B10>]}
[0m12:16:27.166322 [info ] [Thread-1 (]: 6 of 6 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 4.39s]
[0m12:16:27.166322 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m12:16:27.166322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:27.183435 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:16:27.185996 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:16:27.188810 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m12:16:27.192241 [info ] [MainThread]: 
[0m12:16:27.195337 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 21.07 seconds (21.07s).
[0m12:16:27.196143 [debug] [MainThread]: Command end result
[0m12:16:27.243654 [info ] [MainThread]: 
[0m12:16:27.243654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:27.243654 [info ] [MainThread]: 
[0m12:16:27.243654 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:16:27.243654 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:27.243654 after 22.66 seconds
[0m12:16:27.256186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018950A4C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018949B01FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018950424990>]}
[0m12:16:27.259072 [debug] [MainThread]: Flushing usage events
[0m12:16:43.546996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382EB10590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382EB10E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382EAF11D0>]}


============================== 12:16:43.546996 | 478c6d04-938c-489a-a81d-3a35ff68c1aa ==============================
[0m12:16:43.546996 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:16:43.546996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:16:44.265023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '478c6d04-938c-489a-a81d-3a35ff68c1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382F663D90>]}
[0m12:16:44.421216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '478c6d04-938c-489a-a81d-3a35ff68c1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382F69B350>]}
[0m12:16:44.421216 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:16:44.453828 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:16:44.755283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:44.755283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:44.770918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '478c6d04-938c-489a-a81d-3a35ff68c1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382F676A90>]}
[0m12:16:44.786610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '478c6d04-938c-489a-a81d-3a35ff68c1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002383082EDD0>]}
[0m12:16:44.786610 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m12:16:44.786610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '478c6d04-938c-489a-a81d-3a35ff68c1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023830754C90>]}
[0m12:16:44.799232 [info ] [MainThread]: 
[0m12:16:44.804949 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:44.810354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:16:44.827501 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:16:44.827501 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:16:44.827501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:46.811544 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m12:16:46.811544 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:16:47.041647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '478c6d04-938c-489a-a81d-3a35ff68c1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023830CF6850>]}
[0m12:16:47.041647 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:47.041647 [info ] [MainThread]: 
[0m12:16:47.057308 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:16:47.060216 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST  [RUN]
[0m12:16:47.064729 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5'
[0m12:16:47.065012 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:16:47.126886 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:16:47.129904 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5 (compile): 12:16:47.069501 => 12:16:47.129904
[0m12:16:47.134244 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:16:47.186653 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:16:47.186653 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"
[0m12:16:47.186653 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX'DST'
)



      
    ) dbt_internal_test
[0m12:16:47.190238 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:16:48.372836 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82c0c-0102-2c47-0006-b1e600036e92
[0m12:16:48.372836 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
parse error line 30 at position 23 near '<EOF>'.
syntax error line 24 at position 38 unexpected 'DST'.
[0m12:16:48.372836 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5 (execute): 12:16:47.134244 => 12:16:48.372836
[0m12:16:48.372836 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5: Close
[0m12:16:48.574866 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST (models\schema.yml)
  001003 (42000): SQL compilation error:
  parse error line 30 at position 23 near '<EOF>'.
  syntax error line 24 at position 38 unexpected 'DST'.
  compiled Code at target\run\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_2d9c950a402e72c1e5c1842ac521121f.sql
[0m12:16:48.592736 [error] [Thread-1 (]: 1 of 6 ERROR accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST  [[31mERROR[0m in 1.53s]
[0m12:16:48.592736 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5
[0m12:16:48.592736 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:16:48.592736 [info ] [Thread-1 (]: 2 of 6 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m12:16:48.605434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST.eb169f48a5, now test.dfb_data.no_nulls_in_dim_dfb)
[0m12:16:48.606851 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m12:16:48.646802 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:16:48.646802 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m12:16:48.646802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:50.481606 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 2.0 seconds
[0m12:16:50.498560 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:16:50.498560 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 12:16:48.610743 => 12:16:50.498560
[0m12:16:50.505852 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m12:16:50.513432 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:16:50.513432 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:16:50.513432 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m12:16:50.804742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:16:50.834256 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 12:16:50.505852 => 12:16:50.834256
[0m12:16:50.836270 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m12:16:51.414450 [error] [Thread-1 (]: 2 of 6 FAIL 100 no_nulls_in_dim_dfb ............................................ [[31mFAIL 100[0m in 2.82s]
[0m12:16:51.414450 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:16:51.425750 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:16:51.425750 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:16:51.432693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:16:51.435727 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:16:51.461061 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:16:51.461061 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:16:51.438286 => 12:16:51.461061
[0m12:16:51.467687 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:16:51.473390 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:16:51.473390 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:16:51.484919 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:16:51.486891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:53.065606 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:16:53.082609 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:16:51.470148 => 12:16:53.080625
[0m12:16:53.082609 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:16:53.272859 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.84s]
[0m12:16:53.283946 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:16:53.283946 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:16:53.286964 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:16:53.292483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:16:53.295200 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:16:53.310409 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:16:53.317556 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:16:53.297057 => 12:16:53.316790
[0m12:16:53.318655 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:16:53.329418 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:16:53.329418 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:16:53.337990 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:16:53.337990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:54.641213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:54.641213 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:16:53.318655 => 12:16:54.641213
[0m12:16:54.657297 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:16:54.816837 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 1.53s]
[0m12:16:54.816837 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:16:54.816837 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_in dfb
[0m12:16:54.828387 [info ] [Thread-1 (]: 5 of 6 START test positive_value_in dfb ........................................ [RUN]
[0m12:16:54.834134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_in dfb)
[0m12:16:54.836361 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_in dfb
[0m12:16:54.848033 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_in dfb"
[0m12:16:54.853381 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (compile): 12:16:54.836361 => 12:16:54.853381
[0m12:16:54.856401 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_in dfb
[0m12:16:54.863482 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_in dfb"
[0m12:16:54.873045 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_in dfb"
[0m12:16:54.874968 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_in dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 0

      
    ) dbt_internal_test
[0m12:16:54.877873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:56.845971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:16:56.845971 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (execute): 12:16:54.856401 => 12:16:56.845971
[0m12:16:56.845971 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: Close
[0m12:16:57.458542 [info ] [Thread-1 (]: 5 of 6 PASS positive_value_in dfb .............................................. [[32mPASS[0m in 2.63s]
[0m12:16:57.458542 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_in dfb
[0m12:16:57.458542 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m12:16:57.458542 [info ] [Thread-1 (]: 6 of 6 START test t_ppg_value .................................................. [RUN]
[0m12:16:57.472426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_in dfb, now test.dfb_data.t_ppg_value)
[0m12:16:57.474816 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m12:16:57.482660 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m12:16:57.491209 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 12:16:57.476341 => 12:16:57.489753
[0m12:16:57.492175 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m12:16:57.505405 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m12:16:57.505405 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m12:16:57.505405 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m12:16:57.505405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:59.008094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:16:59.008094 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 12:16:57.492175 => 12:16:59.008094
[0m12:16:59.023114 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m12:16:59.610751 [info ] [Thread-1 (]: 6 of 6 PASS t_ppg_value ........................................................ [[32mPASS[0m in 2.15s]
[0m12:16:59.610751 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m12:16:59.628037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:59.628037 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:16:59.628037 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m12:16:59.628037 [info ] [MainThread]: 
[0m12:16:59.628037 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 14.83 seconds (14.83s).
[0m12:16:59.642697 [debug] [MainThread]: Command end result
[0m12:16:59.691809 [info ] [MainThread]: 
[0m12:16:59.696254 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:16:59.698602 [info ] [MainThread]: 
[0m12:16:59.698602 [error] [MainThread]:   Database Error in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX_DST (models\schema.yml)
  001003 (42000): SQL compilation error:
  parse error line 30 at position 23 near '<EOF>'.
  syntax error line 24 at position 38 unexpected 'DST'.
  compiled Code at target\run\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_2d9c950a402e72c1e5c1842ac521121f.sql
[0m12:16:59.703350 [info ] [MainThread]: 
[0m12:16:59.703350 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m12:16:59.703350 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m12:16:59.711366 [info ] [MainThread]: 
[0m12:16:59.713735 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m12:16:59.713735 [info ] [MainThread]: 
[0m12:16:59.716618 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m12:16:59.717545 [debug] [MainThread]: Command `dbt test` failed at 12:16:59.717545 after 16.28 seconds
[0m12:16:59.717545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382EAC3510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023827C11F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002382E711F90>]}
[0m12:16:59.721100 [debug] [MainThread]: Flushing usage events
[0m12:17:45.442380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B5B59E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B5BC78D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B5795ED0>]}


============================== 12:17:45.442380 | 23a13d2e-5a52-4513-bfd0-b239eb2a7f50 ==============================
[0m12:17:45.442380 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:17:45.447386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:17:46.133083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23a13d2e-5a52-4513-bfd0-b239eb2a7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B6687610>]}
[0m12:17:46.227599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23a13d2e-5a52-4513-bfd0-b239eb2a7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B5B4D190>]}
[0m12:17:46.243251 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:17:46.275995 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:17:46.634188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:17:46.649198 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m12:17:47.330490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23a13d2e-5a52-4513-bfd0-b239eb2a7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B7C755D0>]}
[0m12:17:47.362172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23a13d2e-5a52-4513-bfd0-b239eb2a7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B7A8D490>]}
[0m12:17:47.362172 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m12:17:47.362172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23a13d2e-5a52-4513-bfd0-b239eb2a7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B7AA8250>]}
[0m12:17:47.362172 [info ] [MainThread]: 
[0m12:17:47.362172 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:17:47.362172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:17:47.394925 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:17:47.396613 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:17:47.396613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:49.035346 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m12:17:49.035346 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:17:49.654313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23a13d2e-5a52-4513-bfd0-b239eb2a7f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B7A8CE50>]}
[0m12:17:49.661557 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:17:49.661557 [info ] [MainThread]: 
[0m12:17:49.661557 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74
[0m12:17:49.661557 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST  [RUN]
[0m12:17:49.677768 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74'
[0m12:17:49.679872 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74
[0m12:17:49.712460 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74"
[0m12:17:49.712460 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74 (compile): 12:17:49.681402 => 12:17:49.712460
[0m12:17:49.712460 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74
[0m12:17:49.773656 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74"
[0m12:17:49.773656 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74"
[0m12:17:49.778702 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'TE/FLEX','QB','WR/FLEX','RB/FLEX','DST'
)



      
    ) dbt_internal_test
[0m12:17:49.778702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:17:51.615164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:17:51.646798 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74 (execute): 12:17:49.712460 => 12:17:51.646798
[0m12:17:51.646798 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74: Close
[0m12:17:52.240648 [error] [Thread-1 (]: 1 of 6 FAIL 3 accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST  [[31mFAIL 3[0m in 2.56s]
[0m12:17:52.240648 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74
[0m12:17:52.240648 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:17:52.240648 [info ] [Thread-1 (]: 2 of 6 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m12:17:52.258992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST.94cf825f74, now test.dfb_data.no_nulls_in_dim_dfb)
[0m12:17:52.258992 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m12:17:52.294888 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:17:52.294888 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m12:17:52.294888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:53.997737 [debug] [Thread-1 (]: SQL status: SUCCESS 12 in 2.0 seconds
[0m12:17:54.012750 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:17:54.012750 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 12:17:52.258992 => 12:17:54.012750
[0m12:17:54.012750 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m12:17:54.012750 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:17:54.028391 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:17:54.028391 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 PLAYER_ID IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m12:17:54.202756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:17:54.218270 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 12:17:54.012750 => 12:17:54.218270
[0m12:17:54.218270 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m12:17:54.520589 [error] [Thread-1 (]: 2 of 6 FAIL 100 no_nulls_in_dim_dfb ............................................ [[31mFAIL 100[0m in 2.26s]
[0m12:17:54.520589 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:17:54.520589 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:17:54.520589 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:17:54.534265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:17:54.536597 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:17:54.564202 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:17:54.571453 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:17:54.538548 => 12:17:54.569221
[0m12:17:54.571453 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:17:54.574895 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:17:54.587547 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:17:54.587547 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:17:54.587547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:56.336522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:17:56.336522 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:17:54.574895 => 12:17:56.336522
[0m12:17:56.336522 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:17:56.955609 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 2.44s]
[0m12:17:56.958237 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:17:56.959219 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:17:56.959219 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:17:56.965030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:17:56.966546 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:17:56.983319 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:17:56.983319 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:17:56.968202 => 12:17:56.983319
[0m12:17:56.983319 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:17:56.997390 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:17:56.997390 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:17:56.997390 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:17:56.997390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:58.787827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:17:58.804777 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:17:56.983319 => 12:17:58.803557
[0m12:17:58.804777 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:17:59.217448 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.25s]
[0m12:17:59.217448 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:17:59.233855 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_in dfb
[0m12:17:59.233855 [info ] [Thread-1 (]: 5 of 6 START test positive_value_in dfb ........................................ [RUN]
[0m12:17:59.239869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_in dfb)
[0m12:17:59.242848 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_in dfb
[0m12:17:59.249872 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_in dfb"
[0m12:17:59.249872 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (compile): 12:17:59.242848 => 12:17:59.249872
[0m12:17:59.249872 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_in dfb
[0m12:17:59.274040 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_in dfb"
[0m12:17:59.274040 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_in dfb"
[0m12:17:59.274040 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_in dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 0

      
    ) dbt_internal_test
[0m12:17:59.286108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:00.778412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:18:00.795349 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (execute): 12:17:59.264697 => 12:18:00.795349
[0m12:18:00.795349 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: Close
[0m12:18:01.178752 [info ] [Thread-1 (]: 5 of 6 PASS positive_value_in dfb .............................................. [[32mPASS[0m in 1.94s]
[0m12:18:01.183683 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_in dfb
[0m12:18:01.183683 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m12:18:01.183683 [info ] [Thread-1 (]: 6 of 6 START test t_ppg_value .................................................. [RUN]
[0m12:18:01.192859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_in dfb, now test.dfb_data.t_ppg_value)
[0m12:18:01.193983 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m12:18:01.202782 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m12:18:01.202782 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 12:18:01.197354 => 12:18:01.202782
[0m12:18:01.202782 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m12:18:01.220750 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m12:18:01.224261 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m12:18:01.224387 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m12:18:01.224387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:03.709492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:18:03.709492 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 12:18:01.202782 => 12:18:03.709492
[0m12:18:03.709492 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m12:18:04.315804 [info ] [Thread-1 (]: 6 of 6 PASS t_ppg_value ........................................................ [[32mPASS[0m in 3.12s]
[0m12:18:04.331242 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m12:18:04.331242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:04.331242 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:18:04.331242 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m12:18:04.331242 [info ] [MainThread]: 
[0m12:18:04.349365 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 16.97 seconds (16.97s).
[0m12:18:04.355016 [debug] [MainThread]: Command end result
[0m12:18:04.399719 [info ] [MainThread]: 
[0m12:18:04.399719 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:18:04.399719 [info ] [MainThread]: 
[0m12:18:04.411950 [error] [MainThread]: [31mFailure in test accepted_values_dim_dfb_nfl_data_position__TE_FLEX__QB__WR_FLEX__RB_FLEX__DST (models\schema.yml)[0m
[0m12:18:04.413986 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m12:18:04.418322 [info ] [MainThread]: 
[0m12:18:04.421296 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\models\schema.yml\accepted_values_dim_dfb_nfl_da_8d0156fbcb48dd5006555d50d1d7df7a.sql
[0m12:18:04.423619 [info ] [MainThread]: 
[0m12:18:04.424129 [error] [MainThread]: [31mFailure in test no_nulls_in_dim_dfb (tests\no_nulls_in_dim_dfb.sql)[0m
[0m12:18:04.430768 [error] [MainThread]:   Got 100 results, configured to fail if != 0
[0m12:18:04.433656 [info ] [MainThread]: 
[0m12:18:04.433656 [info ] [MainThread]:   compiled Code at target\compiled\dfb_data\tests\no_nulls_in_dim_dfb.sql
[0m12:18:04.433656 [info ] [MainThread]: 
[0m12:18:04.433656 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m12:18:04.433656 [debug] [MainThread]: Command `dbt test` failed at 12:18:04.433656 after 19.09 seconds
[0m12:18:04.441670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AEC91F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AECD7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0AECD6A10>]}
[0m12:18:04.441670 [debug] [MainThread]: Flushing usage events
[0m12:34:52.074631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FAE6B510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FAE0E090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FAE4FC90>]}


============================== 12:34:52.074631 | 80a0891b-6aee-4e6e-9789-6279710921c1 ==============================
[0m12:34:52.074631 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:34:52.074631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:34:52.880816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FB9620D0>]}
[0m12:34:53.055677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FC98FF50>]}
[0m12:34:53.055677 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:34:53.084197 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:34:53.556025 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m12:34:53.560295 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\schema.yml
[0m12:34:53.561363 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://models\dim\dfb_nfl_cleansed.sql
[0m12:34:53.561363 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\dim_dfb_nfl_data.sql
[0m12:34:54.295315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FCF66550>]}
[0m12:34:54.327559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FCF5A150>]}
[0m12:34:54.327559 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m12:34:54.329014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FCEFEC90>]}
[0m12:34:54.329014 [info ] [MainThread]: 
[0m12:34:54.335888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:34:54.339381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m12:34:54.360979 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m12:34:54.360979 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m12:34:54.360979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:56.666768 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:34:56.672849 [debug] [ThreadPool]: On list_storage: Close
[0m12:34:57.080199 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:34:57.095841 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:34:57.095841 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:34:57.095841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:58.813710 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m12:34:58.830778 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:34:59.454230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FD1D8610>]}
[0m12:34:59.454230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:34:59.454230 [info ] [MainThread]: 
[0m12:34:59.466803 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m12:34:59.470378 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m12:34:59.470378 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m12:34:59.487109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m12:34:59.487109 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 12:34:59.477305 => 12:34:59.487109
[0m12:34:59.502748 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m12:34:59.502748 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m12:34:59.512146 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m12:34:59.516587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m12:34:59.516587 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m12:34:59.516587 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m12:34:59.516587 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 12:34:59.516587 => 12:34:59.516587
[0m12:34:59.516587 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m12:34:59.563063 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m12:34:59.563063 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m12:34:59.567144 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m12:34:59.567144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:35:01.281859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:35:01.360858 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 12:34:59.516587 => 12:35:01.360858
[0m12:35:01.360858 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m12:35:01.596909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FCF66150>]}
[0m12:35:01.596909 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 2.08s]
[0m12:35:01.596909 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m12:35:01.612536 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m12:35:01.612536 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m12:35:01.619445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m12:35:01.621363 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m12:35:01.647769 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:35:01.647769 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 12:35:01.622685 => 12:35:01.647769
[0m12:35:01.662170 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m12:35:01.671510 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m12:35:01.679735 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m12:35:01.679735 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m12:35:01.679735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:03.621714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:35:03.637214 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 12:35:01.663485 => 12:35:03.637214
[0m12:35:03.637214 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m12:35:04.266335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FD125210>]}
[0m12:35:04.266335 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.65s]
[0m12:35:04.266335 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m12:35:04.266335 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m12:35:04.281987 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m12:35:04.287862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m12:35:04.288798 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m12:35:04.299776 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m12:35:04.308084 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 12:35:04.288798 => 12:35:04.306293
[0m12:35:04.310443 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m12:35:04.325115 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m12:35:04.325115 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m12:35:04.325115 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m12:35:04.325115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:06.296970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:35:06.305013 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 12:35:04.310443 => 12:35:06.296970
[0m12:35:06.305013 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m12:35:06.843450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FD3F7F90>]}
[0m12:35:06.843450 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 2.56s]
[0m12:35:06.843450 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m12:35:06.859089 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m12:35:06.862622 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m12:35:06.867956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m12:35:06.870038 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m12:35:06.930023 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m12:35:06.930023 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 12:35:06.871943 => 12:35:06.930023
[0m12:35:06.930023 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m12:35:06.962959 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m12:35:06.966628 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m12:35:06.966628 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m12:35:06.969270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:16.334836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 9.0 seconds
[0m12:35:16.339921 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 12:35:06.930023 => 12:35:16.339921
[0m12:35:16.339921 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m12:35:16.888814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FD348090>]}
[0m12:35:16.888814 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 10.03s]
[0m12:35:16.888814 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m12:35:16.888814 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m12:35:16.888814 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m12:35:16.904813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m12:35:16.907555 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m12:35:16.920549 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m12:35:16.928247 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 12:35:16.909685 => 12:35:16.926806
[0m12:35:16.928247 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m12:35:16.941709 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m12:35:16.947885 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m12:35:16.950454 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m12:35:16.950454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:21.048441 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m12:35:21.063962 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 12:35:16.928247 => 12:35:21.063962
[0m12:35:21.063962 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m12:35:21.253208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a0891b-6aee-4e6e-9789-6279710921c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FD59CE50>]}
[0m12:35:21.268691 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 4.35s]
[0m12:35:21.268691 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m12:35:21.268691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:21.268691 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m12:35:21.268691 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:35:21.268691 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m12:35:21.284299 [info ] [MainThread]: 
[0m12:35:21.288073 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 26.96 seconds (26.96s).
[0m12:35:21.291590 [debug] [MainThread]: Command end result
[0m12:35:21.331765 [info ] [MainThread]: 
[0m12:35:21.331765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:21.331765 [info ] [MainThread]: 
[0m12:35:21.331765 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:35:21.337519 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:21.337519 after 29.38 seconds
[0m12:35:21.337519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F3F11FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192FA9E9E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192F41E7D90>]}
[0m12:35:21.337519 [debug] [MainThread]: Flushing usage events
[0m12:35:51.696990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001392F1CFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001392F1CF490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001392F1CD510>]}


============================== 12:35:51.699001 | 4e0e1824-d57c-4ba2-bf87-4fb9dd312763 ==============================
[0m12:35:51.699001 [info ] [MainThread]: Running with dbt=1.7.18
[0m12:35:51.699001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select dim_dfb_nfl_data', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:52.497610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e0e1824-d57c-4ba2-bf87-4fb9dd312763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013930E298D0>]}
[0m12:35:52.688192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e0e1824-d57c-4ba2-bf87-4fb9dd312763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001392F937950>]}
[0m12:35:52.688192 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:35:52.740335 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m12:35:53.120387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:53.120387 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:53.120387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e0e1824-d57c-4ba2-bf87-4fb9dd312763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139310611D0>]}
[0m12:35:53.167703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e0e1824-d57c-4ba2-bf87-4fb9dd312763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013930F4F150>]}
[0m12:35:53.167703 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m12:35:53.167703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e0e1824-d57c-4ba2-bf87-4fb9dd312763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013930EC6610>]}
[0m12:35:53.167703 [info ] [MainThread]: 
[0m12:35:53.182003 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:53.189174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m12:35:53.207649 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m12:35:53.223186 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m12:35:53.223186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:55.164165 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m12:35:55.170686 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m12:35:55.370927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e0e1824-d57c-4ba2-bf87-4fb9dd312763', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001392ACE75D0>]}
[0m12:35:55.370927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:55.370927 [info ] [MainThread]: 
[0m12:35:55.381778 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56
[0m12:35:55.381778 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST  [RUN]
[0m12:35:55.391384 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56'
[0m12:35:55.393048 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56
[0m12:35:55.463017 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56"
[0m12:35:55.463017 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56 (compile): 12:35:55.393048 => 12:35:55.463017
[0m12:35:55.463017 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56
[0m12:35:55.494788 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56"
[0m12:35:55.504328 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56"
[0m12:35:55.504328 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'QB','RB','WR','TE','WR/FLEX','RB/FLEX','TE/FLEX','DST'
)



      
    ) dbt_internal_test
[0m12:35:55.504328 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:35:57.379171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:35:57.394929 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56 (execute): 12:35:55.463017 => 12:35:57.394929
[0m12:35:57.394929 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56: Close
[0m12:35:58.011149 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST  [[32mPASS[0m in 2.63s]
[0m12:35:58.011149 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56
[0m12:35:58.011149 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:35:58.011149 [info ] [Thread-1 (]: 2 of 6 START test no_nulls_in_dim_dfb .......................................... [RUN]
[0m12:35:58.022147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56, now test.dfb_data.no_nulls_in_dim_dfb)
[0m12:35:58.025019 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m12:35:58.040304 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:35:58.040304 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m12:35:58.040304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:00.344024 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 2.0 seconds
[0m12:36:00.344024 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:36:00.344024 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 12:35:58.025505 => 12:36:00.344024
[0m12:36:00.359537 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m12:36:00.359537 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:36:00.359537 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m12:36:00.359537 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m12:36:00.586360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:36:00.597901 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 12:36:00.359537 => 12:36:00.597901
[0m12:36:00.597901 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m12:36:01.121131 [info ] [Thread-1 (]: 2 of 6 PASS no_nulls_in_dim_dfb ................................................ [[32mPASS[0m in 3.11s]
[0m12:36:01.121131 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m12:36:01.121131 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:36:01.121131 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_dfb_nfl_data_date ............................... [RUN]
[0m12:36:01.134883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m12:36:01.137496 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:36:01.157753 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:36:01.166810 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 12:36:01.138310 => 12:36:01.165768
[0m12:36:01.166810 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:36:01.171969 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:36:01.171969 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m12:36:01.171969 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m12:36:01.180401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:02.543611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:36:02.543611 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 12:36:01.166810 => 12:36:02.543611
[0m12:36:02.543611 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m12:36:02.932162 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_dfb_nfl_data_date ..................................... [[32mPASS[0m in 1.81s]
[0m12:36:02.947814 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m12:36:02.947814 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:36:02.947814 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_dfb_nfl_data_name ............................... [RUN]
[0m12:36:02.955859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m12:36:02.957470 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:36:02.972442 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:36:02.982528 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 12:36:02.958226 => 12:36:02.980463
[0m12:36:02.986920 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:36:02.999187 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:36:03.006244 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m12:36:03.006244 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m12:36:03.006244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:05.064591 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:36:05.080128 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 12:36:02.989246 => 12:36:05.080128
[0m12:36:05.080128 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m12:36:05.481502 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_dfb_nfl_data_name ..................................... [[32mPASS[0m in 2.53s]
[0m12:36:05.491020 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m12:36:05.491020 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_in dfb
[0m12:36:05.491020 [info ] [Thread-1 (]: 5 of 6 START test positive_value_in dfb ........................................ [RUN]
[0m12:36:05.496033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_in dfb)
[0m12:36:05.497318 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_in dfb
[0m12:36:05.507477 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_in dfb"
[0m12:36:05.511634 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (compile): 12:36:05.498359 => 12:36:05.507477
[0m12:36:05.512237 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_in dfb
[0m12:36:05.525482 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_in dfb"
[0m12:36:05.530380 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_in dfb"
[0m12:36:05.531446 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_in dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 0

      
    ) dbt_internal_test
[0m12:36:05.531446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:07.540016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:36:07.555667 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (execute): 12:36:05.512237 => 12:36:07.555667
[0m12:36:07.555667 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: Close
[0m12:36:07.761684 [info ] [Thread-1 (]: 5 of 6 PASS positive_value_in dfb .............................................. [[32mPASS[0m in 2.27s]
[0m12:36:07.761684 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_in dfb
[0m12:36:07.761684 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m12:36:07.761684 [info ] [Thread-1 (]: 6 of 6 START test t_ppg_value .................................................. [RUN]
[0m12:36:07.774783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_in dfb, now test.dfb_data.t_ppg_value)
[0m12:36:07.778897 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m12:36:07.783259 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m12:36:07.797008 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 12:36:07.779038 => 12:36:07.783259
[0m12:36:07.798378 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m12:36:07.814464 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m12:36:07.818237 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m12:36:07.818237 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m12:36:07.823177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:09.287747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:36:09.287747 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 12:36:07.798378 => 12:36:09.287747
[0m12:36:09.298763 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m12:36:09.498827 [info ] [Thread-1 (]: 6 of 6 PASS t_ppg_value ........................................................ [[32mPASS[0m in 1.73s]
[0m12:36:09.498827 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m12:36:09.507846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:09.513700 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m12:36:09.516731 [debug] [MainThread]: Connection 'test.dfb_data.t_ppg_value' was properly closed.
[0m12:36:09.516731 [info ] [MainThread]: 
[0m12:36:09.522599 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 16.35 seconds (16.35s).
[0m12:36:09.524114 [debug] [MainThread]: Command end result
[0m12:36:09.558248 [info ] [MainThread]: 
[0m12:36:09.558248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:09.558248 [info ] [MainThread]: 
[0m12:36:09.570229 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:36:09.574215 [debug] [MainThread]: Command `dbt test` succeeded at 12:36:09.574215 after 17.97 seconds
[0m12:36:09.578851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013928301F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001392EE321D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139285D0C10>]}
[0m12:36:09.579894 [debug] [MainThread]: Flushing usage events
[0m16:12:04.474569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228718DB310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287135C6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228718CB3D0>]}


============================== 16:12:04.526726 | 8098af0a-c45a-4319-8d58-f62f9b1c992c ==============================
[0m16:12:04.526726 [info ] [MainThread]: Running with dbt=1.7.18
[0m16:12:04.526726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:12:08.203352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022873468A10>]}
[0m16:12:08.390531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228734C3ED0>]}
[0m16:12:08.390531 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:12:08.478135 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m16:12:09.593986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:12:09.593986 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\py_nfl_data.py
[0m16:12:09.859924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228739ACB10>]}
[0m16:12:09.929596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022873764390>]}
[0m16:12:09.929596 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m16:12:09.929596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228734D9210>]}
[0m16:12:09.938207 [info ] [MainThread]: 
[0m16:12:09.946696 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:12:09.953104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m16:12:09.992498 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m16:12:09.992498 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m16:12:09.992498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:13.214690 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m16:12:13.214690 [debug] [ThreadPool]: On list_storage: Close
[0m16:12:13.632676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m16:12:13.664732 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m16:12:13.664732 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m16:12:13.668768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:15.058214 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m16:12:15.058214 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m16:12:15.229241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022873A53990>]}
[0m16:12:15.240766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:12:15.244333 [info ] [MainThread]: 
[0m16:12:15.340671 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m16:12:15.340671 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m16:12:15.345830 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m16:12:15.361466 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m16:12:15.372788 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 16:12:15.345830 => 16:12:15.361466
[0m16:12:15.373646 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m16:12:15.377166 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m16:12:15.377166 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m16:12:15.377166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m16:12:15.377166 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m16:12:15.384848 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m16:12:15.410604 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 16:12:15.384848 => 16:12:15.410604
[0m16:12:15.410604 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m16:12:15.473547 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m16:12:15.483113 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m16:12:15.483113 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m16:12:15.483113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:12:17.494668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:12:17.557300 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 16:12:15.410604 => 16:12:17.557300
[0m16:12:17.557300 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m16:12:18.115717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022873C57890>]}
[0m16:12:18.124386 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 2.74s]
[0m16:12:18.124386 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m16:12:18.131410 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m16:12:18.134815 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m16:12:18.141183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m16:12:18.141183 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m16:12:18.212582 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:12:18.212582 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 16:12:18.145220 => 16:12:18.212582
[0m16:12:18.212582 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m16:12:18.221023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:12:18.229643 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m16:12:18.229643 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m16:12:18.231214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:19.970750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:12:19.986254 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 16:12:18.220010 => 16:12:19.986254
[0m16:12:19.986254 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m16:12:20.175975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228739C7390>]}
[0m16:12:20.175975 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.04s]
[0m16:12:20.191631 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m16:12:20.191631 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m16:12:20.191631 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m16:12:20.202629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m16:12:20.204634 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m16:12:20.221015 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m16:12:20.224647 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 16:12:20.206646 => 16:12:20.221015
[0m16:12:20.227270 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m16:12:20.235279 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m16:12:20.284160 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m16:12:20.284160 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m16:12:20.284160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:22.310816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:12:22.325836 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 16:12:20.227270 => 16:12:22.310816
[0m16:12:22.327550 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m16:12:22.916190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228739C7FD0>]}
[0m16:12:22.931901 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 2.72s]
[0m16:12:22.931901 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m16:12:22.931901 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m16:12:22.931901 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m16:12:22.943883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m16:12:22.946146 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m16:12:23.007192 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m16:12:23.007192 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 16:12:22.947866 => 16:12:23.007192
[0m16:12:23.015204 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m16:12:23.039533 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m16:12:23.039533 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m16:12:23.039533 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m16:12:23.048126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:32.138914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 9.0 seconds
[0m16:12:32.153497 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 16:12:23.017774 => 16:12:32.153497
[0m16:12:32.153497 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m16:12:32.753609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022873D35610>]}
[0m16:12:32.753609 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 9.82s]
[0m16:12:32.768962 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m16:12:32.768962 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m16:12:32.768962 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m16:12:32.777607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m16:12:32.779365 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m16:12:32.793625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m16:12:32.799991 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 16:12:32.780203 => 16:12:32.799334
[0m16:12:32.801601 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m16:12:32.812848 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m16:12:32.824648 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m16:12:32.827945 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    data_df.drop('ID',axis=1)
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m16:12:32.827945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:36.001309 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82cf8-0102-2c47-0006-b1e600036f0a
[0m16:12:36.001309 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 98, in main
    df = model(dbt, session)
  File "_udf_code.py", line 13, in model
    data_df.drop('ID',axis=1)
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 238, in wrap
    r = func(*args, **kwargs)
TypeError: drop() got an unexpected keyword argument 'axis'
 in function PY_NFL_DATA__DBT_SP with handler main
[0m16:12:36.016973 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 16:12:32.801601 => 16:12:36.016973
[0m16:12:36.016973 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m16:12:36.529810 [debug] [Thread-1 (]: Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 98, in main
      df = model(dbt, session)
    File "_udf_code.py", line 13, in model
      data_df.drop('ID',axis=1)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 238, in wrap
      r = func(*args, **kwargs)
  TypeError: drop() got an unexpected keyword argument 'axis'
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m16:12:36.529810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8098af0a-c45a-4319-8d58-f62f9b1c992c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022873D2C410>]}
[0m16:12:36.529810 [error] [Thread-1 (]: 5 of 5 ERROR creating python table model dfb.py_nfl_data ....................... [[31mERROR[0m in 3.76s]
[0m16:12:36.529810 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m16:12:36.529810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:36.547009 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m16:12:36.548112 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m16:12:36.553633 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m16:12:36.553633 [info ] [MainThread]: 
[0m16:12:36.553633 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 26.62 seconds (26.62s).
[0m16:12:36.561658 [debug] [MainThread]: Command end result
[0m16:12:36.607063 [info ] [MainThread]: 
[0m16:12:36.613872 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:12:36.617256 [info ] [MainThread]: 
[0m16:12:36.619503 [error] [MainThread]:   Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 98, in main
      df = model(dbt, session)
    File "_udf_code.py", line 13, in model
      data_df.drop('ID',axis=1)
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/_internal/telemetry.py", line 238, in wrap
      r = func(*args, **kwargs)
  TypeError: drop() got an unexpected keyword argument 'axis'
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m16:12:36.623433 [info ] [MainThread]: 
[0m16:12:36.626739 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m16:12:36.630042 [debug] [MainThread]: Command `dbt run` failed at 16:12:36.630042 after 32.45 seconds
[0m16:12:36.630042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002286A9F1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228718CB3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228718CA750>]}
[0m16:12:36.632549 [debug] [MainThread]: Flushing usage events
[0m16:13:28.837329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BCF5BDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B9F07110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BD4F87D0>]}


============================== 16:13:28.841343 | 4e1a9bf9-4b19-4bac-af4a-2c651ff039bc ==============================
[0m16:13:28.841343 [info ] [MainThread]: Running with dbt=1.7.18
[0m16:13:28.841343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:13:29.509587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BEFFFC10>]}
[0m16:13:29.619690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BF037D10>]}
[0m16:13:29.619690 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:13:29.644905 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m16:13:29.995494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:13:29.995494 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\py_nfl_data.py
[0m16:13:30.342510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BF215910>]}
[0m16:13:30.358089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BF3647D0>]}
[0m16:13:30.358089 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m16:13:30.358089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BF08D650>]}
[0m16:13:30.368165 [info ] [MainThread]: 
[0m16:13:30.368165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:30.375275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m16:13:30.385454 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m16:13:30.385454 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m16:13:30.385454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:32.177954 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:13:32.184972 [debug] [ThreadPool]: On list_storage: Close
[0m16:13:32.774413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m16:13:32.774413 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m16:13:32.774413 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m16:13:32.774413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:34.411705 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m16:13:34.411705 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m16:13:35.017764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BF591110>]}
[0m16:13:35.031813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:13:35.033256 [info ] [MainThread]: 
[0m16:13:35.037643 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m16:13:35.037643 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m16:13:35.047674 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m16:13:35.069882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m16:13:35.069882 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 16:13:35.047674 => 16:13:35.069882
[0m16:13:35.075673 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m16:13:35.075673 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m16:13:35.079018 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m16:13:35.079018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m16:13:35.081372 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m16:13:35.083846 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m16:13:35.083846 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 16:13:35.082876 => 16:13:35.083846
[0m16:13:35.083846 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m16:13:35.123298 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m16:13:35.123298 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m16:13:35.126267 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m16:13:35.126267 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:13:37.062539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:13:37.126633 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 16:13:35.089936 => 16:13:37.126633
[0m16:13:37.126633 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m16:13:37.681268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BF90BE90>]}
[0m16:13:37.681268 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 2.60s]
[0m16:13:37.689785 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m16:13:37.691588 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m16:13:37.691588 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m16:13:37.698362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m16:13:37.698362 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m16:13:37.727457 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:13:37.739370 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 16:13:37.703100 => 16:13:37.727457
[0m16:13:37.740172 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m16:13:37.742929 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:13:37.742929 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m16:13:37.742929 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m16:13:37.742929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:39.479752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:13:39.495204 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 16:13:37.741028 => 16:13:39.495204
[0m16:13:39.495204 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m16:13:40.141875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BF225450>]}
[0m16:13:40.141875 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.45s]
[0m16:13:40.141875 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m16:13:40.156395 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m16:13:40.158325 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m16:13:40.159475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m16:13:40.164690 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m16:13:40.173142 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m16:13:40.173142 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 16:13:40.165679 => 16:13:40.173142
[0m16:13:40.173142 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m16:13:40.189283 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m16:13:40.193156 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m16:13:40.193156 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m16:13:40.193156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:42.304769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:13:42.321397 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 16:13:40.180660 => 16:13:42.319789
[0m16:13:42.321397 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m16:13:42.504637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BF5C5910>]}
[0m16:13:42.504637 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 2.35s]
[0m16:13:42.521302 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m16:13:42.521302 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m16:13:42.521302 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m16:13:42.521302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m16:13:42.534165 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m16:13:42.603882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m16:13:42.609008 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 16:13:42.534901 => 16:13:42.609008
[0m16:13:42.609008 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m16:13:42.670019 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m16:13:42.673913 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m16:13:42.675453 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m16:13:42.678931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:47.326634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m16:13:47.333649 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 16:13:42.612019 => 16:13:47.333649
[0m16:13:47.333649 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m16:13:47.474023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BFA77E90>]}
[0m16:13:47.474023 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 4.95s]
[0m16:13:47.485838 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m16:13:47.486931 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m16:13:47.486931 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m16:13:47.493535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m16:13:47.495886 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m16:13:47.512205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m16:13:47.516409 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 16:13:47.496149 => 16:13:47.515249
[0m16:13:47.518134 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m16:13:47.529005 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m16:13:47.540588 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m16:13:47.543618 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    data_df.drop('ID')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m16:13:47.545045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:51.606989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:13:51.606989 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 16:13:47.518134 => 16:13:51.606989
[0m16:13:51.606989 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m16:13:51.907578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e1a9bf9-4b19-4bac-af4a-2c651ff039bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BFA5F610>]}
[0m16:13:51.907578 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 4.42s]
[0m16:13:51.923100 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m16:13:51.923100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:51.923100 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m16:13:51.923100 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m16:13:51.923100 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m16:13:51.923100 [info ] [MainThread]: 
[0m16:13:51.939237 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 21.55 seconds (21.55s).
[0m16:13:51.949296 [debug] [MainThread]: Command end result
[0m16:13:51.992054 [info ] [MainThread]: 
[0m16:13:51.994433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:51.998152 [info ] [MainThread]: 
[0m16:13:51.998152 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:13:52.001530 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:52.001530 after 23.25 seconds
[0m16:13:52.001530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B65F1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8BD0D2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B68C4C10>]}
[0m16:13:52.004110 [debug] [MainThread]: Flushing usage events
[0m16:19:11.515765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF46892D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF466D350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF466E1D0>]}


============================== 16:19:11.515765 | b250ef80-649b-4142-9b59-f046956bebdb ==============================
[0m16:19:11.515765 [info ] [MainThread]: Running with dbt=1.7.18
[0m16:19:11.515765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:19:12.162912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF46D6550>]}
[0m16:19:12.270256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF61DE690>]}
[0m16:19:12.270256 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:19:12.303022 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m16:19:12.590686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:19:12.590686 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\py_nfl_data.py
[0m16:19:12.842945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF678A7D0>]}
[0m16:19:12.873180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF6521090>]}
[0m16:19:12.873180 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m16:19:12.873180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF61AF250>]}
[0m16:19:12.873180 [info ] [MainThread]: 
[0m16:19:12.873180 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:19:12.888043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m16:19:12.897383 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m16:19:12.897383 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m16:19:12.897383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:14.889499 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:19:14.889499 [debug] [ThreadPool]: On list_storage: Close
[0m16:19:15.915669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m16:19:15.947669 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m16:19:15.947669 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m16:19:15.947669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:17.873691 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m16:19:17.884105 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m16:19:18.091495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF63E1610>]}
[0m16:19:18.091495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:18.091495 [info ] [MainThread]: 
[0m16:19:18.108639 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m16:19:18.112274 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m16:19:18.113078 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m16:19:18.137677 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m16:19:18.142606 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 16:19:18.118410 => 16:19:18.137677
[0m16:19:18.144928 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m16:19:18.144928 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m16:19:18.148396 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m16:19:18.152730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m16:19:18.152730 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m16:19:18.152730 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m16:19:18.152730 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 16:19:18.152730 => 16:19:18.152730
[0m16:19:18.163748 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m16:19:18.219071 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m16:19:18.219071 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m16:19:18.219071 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m16:19:18.219071 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:19:19.277966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:19:19.296108 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 16:19:18.167654 => 16:19:19.296108
[0m16:19:19.296108 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m16:19:19.438474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF64B72D0>]}
[0m16:19:19.449080 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.29s]
[0m16:19:19.450088 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m16:19:19.451087 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m16:19:19.452086 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m16:19:19.454092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m16:19:19.455089 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m16:19:19.475735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:19:19.475735 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 16:19:19.455089 => 16:19:19.475735
[0m16:19:19.482438 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m16:19:19.483930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:19:19.483930 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m16:19:19.483930 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m16:19:19.483930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:20.477310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:19:20.477310 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 16:19:19.483740 => 16:19:20.477310
[0m16:19:20.477310 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m16:19:20.627087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF6AFB6D0>]}
[0m16:19:20.627087 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.17s]
[0m16:19:20.627087 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m16:19:20.627087 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m16:19:20.627087 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m16:19:20.642721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m16:19:20.643552 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m16:19:20.651149 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m16:19:20.653485 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 16:19:20.643552 => 16:19:20.653485
[0m16:19:20.654551 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m16:19:20.657686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m16:19:20.657686 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m16:19:20.657686 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m16:19:20.657686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:21.755097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:19:21.755097 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 16:19:20.654551 => 16:19:21.755097
[0m16:19:21.755097 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m16:19:21.897655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF6774C10>]}
[0m16:19:21.912232 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.27s]
[0m16:19:21.912232 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m16:19:21.912232 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m16:19:21.912232 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m16:19:21.919955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m16:19:21.921409 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m16:19:21.950976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m16:19:21.950976 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 16:19:21.921409 => 16:19:21.950976
[0m16:19:21.950976 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m16:19:21.985507 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m16:19:21.988470 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m16:19:21.989749 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m16:19:21.989749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:25.099487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:19:25.099487 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 16:19:21.950976 => 16:19:25.099487
[0m16:19:25.099487 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m16:19:25.551304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF6C324D0>]}
[0m16:19:25.551304 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 3.64s]
[0m16:19:25.551304 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m16:19:25.551304 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m16:19:25.551304 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m16:19:25.551304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m16:19:25.551304 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m16:19:25.551304 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m16:19:25.567968 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 16:19:25.551304 => 16:19:25.567968
[0m16:19:25.569706 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m16:19:25.573838 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m16:19:25.573838 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m16:19:25.573838 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    data_df.drop('ID')
    data_df = datadf.loc[ data_df['PPG'] > 1 ]
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m16:19:25.573838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:28.482689 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82cff-0102-2c47-0006-b1e600036f32
[0m16:19:28.498197 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 99, in main
    df = model(dbt, session)
  File "_udf_code.py", line 14, in model
    data_df = datadf.loc[ data_df['PPG'] > 1 ]
NameError: name 'datadf' is not defined
 in function PY_NFL_DATA__DBT_SP with handler main
[0m16:19:28.498197 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 16:19:25.569706 => 16:19:28.498197
[0m16:19:28.498197 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m16:19:28.654512 [debug] [Thread-1 (]: Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 99, in main
      df = model(dbt, session)
    File "_udf_code.py", line 14, in model
      data_df = datadf.loc[ data_df['PPG'] > 1 ]
  NameError: name 'datadf' is not defined
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m16:19:28.654512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b250ef80-649b-4142-9b59-f046956bebdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF6AB8050>]}
[0m16:19:28.654512 [error] [Thread-1 (]: 5 of 5 ERROR creating python table model dfb.py_nfl_data ....................... [[31mERROR[0m in 3.10s]
[0m16:19:28.654512 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m16:19:28.654512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:28.654512 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m16:19:28.654512 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m16:19:28.654512 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m16:19:28.654512 [info ] [MainThread]: 
[0m16:19:28.668608 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 15.78 seconds (15.78s).
[0m16:19:28.671304 [debug] [MainThread]: Command end result
[0m16:19:28.690941 [info ] [MainThread]: 
[0m16:19:28.694242 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:19:28.695291 [info ] [MainThread]: 
[0m16:19:28.696551 [error] [MainThread]:   Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 99, in main
      df = model(dbt, session)
    File "_udf_code.py", line 14, in model
      data_df = datadf.loc[ data_df['PPG'] > 1 ]
  NameError: name 'datadf' is not defined
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m16:19:28.700562 [info ] [MainThread]: 
[0m16:19:28.702515 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m16:19:28.705567 [debug] [MainThread]: Command `dbt run` failed at 16:19:28.705567 after 17.27 seconds
[0m16:19:28.706575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CED741FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF462D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF462CA50>]}
[0m16:19:28.706635 [debug] [MainThread]: Flushing usage events
[0m16:21:02.381373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CBE4A2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CBE4A0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CBE43EB10>]}


============================== 16:21:02.381373 | abfd539e-f3fc-41a1-914b-82ce93c28c0d ==============================
[0m16:21:02.381373 [info ] [MainThread]: Running with dbt=1.7.18
[0m16:21:02.381373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:21:02.929505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CBFFD5DD0>]}
[0m16:21:03.024278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC009BED0>]}
[0m16:21:03.024278 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:21:03.063150 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m16:21:03.307302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:21:03.307302 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\py_nfl_data.py
[0m16:21:03.509392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC02BA090>]}
[0m16:21:03.525474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC02BA010>]}
[0m16:21:03.525474 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m16:21:03.525474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC004EBD0>]}
[0m16:21:03.525474 [info ] [MainThread]: 
[0m16:21:03.525474 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:21:03.525474 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m16:21:03.554912 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m16:21:03.555907 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m16:21:03.556858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:04.561521 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:21:04.577042 [debug] [ThreadPool]: On list_storage: Close
[0m16:21:04.721123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m16:21:04.721123 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m16:21:04.721123 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m16:21:04.721123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:05.440069 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m16:21:05.455591 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m16:21:05.596764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CBE4EA290>]}
[0m16:21:05.612228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:05.612228 [info ] [MainThread]: 
[0m16:21:05.612228 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m16:21:05.612228 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m16:21:05.623301 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m16:21:05.635461 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m16:21:05.637474 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 16:21:05.623301 => 16:21:05.636514
[0m16:21:05.638468 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m16:21:05.639542 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m16:21:05.640720 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m16:21:05.640720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m16:21:05.640720 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m16:21:05.640720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m16:21:05.640720 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 16:21:05.640720 => 16:21:05.640720
[0m16:21:05.640720 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m16:21:05.728728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m16:21:05.730689 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m16:21:05.730689 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m16:21:05.731689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:21:06.552609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:21:06.593968 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 16:21:05.640720 => 16:21:06.593968
[0m16:21:06.594958 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m16:21:06.741584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC0903B50>]}
[0m16:21:06.741584 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.10s]
[0m16:21:06.741584 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m16:21:06.741584 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m16:21:06.741584 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m16:21:06.755923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m16:21:06.757332 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m16:21:06.774495 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:21:06.784862 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 16:21:06.757403 => 16:21:06.784622
[0m16:21:06.784862 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m16:21:06.784862 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:21:06.784862 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m16:21:06.784862 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m16:21:06.784862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:07.775990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:21:07.775990 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 16:21:06.784862 => 16:21:07.775990
[0m16:21:07.775990 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m16:21:07.933024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC0826990>]}
[0m16:21:07.933024 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.19s]
[0m16:21:07.933024 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m16:21:07.933024 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m16:21:07.933024 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m16:21:07.933024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m16:21:07.949902 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m16:21:07.955597 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m16:21:07.955597 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 16:21:07.950913 => 16:21:07.955597
[0m16:21:07.955597 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m16:21:07.955597 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m16:21:07.955597 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m16:21:07.955597 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m16:21:07.965766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:08.998906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:21:09.014493 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 16:21:07.955597 => 16:21:09.014493
[0m16:21:09.014493 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m16:21:09.235984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC08BB090>]}
[0m16:21:09.236980 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.30s]
[0m16:21:09.239918 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m16:21:09.239918 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m16:21:09.240955 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m16:21:09.242973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m16:21:09.243915 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m16:21:09.269288 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m16:21:09.271245 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 16:21:09.243915 => 16:21:09.270285
[0m16:21:09.271245 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m16:21:09.284914 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m16:21:09.301873 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m16:21:09.301873 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m16:21:09.301873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:12.120754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:21:12.120754 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 16:21:09.272251 => 16:21:12.120754
[0m16:21:12.120754 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m16:21:12.262758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC0A424D0>]}
[0m16:21:12.262758 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 3.02s]
[0m16:21:12.262758 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m16:21:12.262758 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m16:21:12.262758 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m16:21:12.262758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m16:21:12.278240 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m16:21:12.284639 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m16:21:12.284639 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 16:21:12.278240 => 16:21:12.284639
[0m16:21:12.284639 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m16:21:12.284639 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m16:21:12.284639 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m16:21:12.284639 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    data_df.drop('ID')
    data_df = data_df.loc[data_df['PPG'] > 1]
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m16:21:12.284639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:14.409187 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b82d01-0102-2c47-0006-b1e600036f5a
[0m16:21:14.409187 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100357 (P0000): Python Interpreter Error:
Traceback (most recent call last):
  File "_udf_code.py", line 99, in main
    df = model(dbt, session)
  File "_udf_code.py", line 14, in model
    data_df = data_df.loc[data_df['PPG'] > 1]
  File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe.py", line 1046, in __getattr__
    raise AttributeError(
AttributeError: Table object has no attribute loc
 in function PY_NFL_DATA__DBT_SP with handler main
[0m16:21:14.409187 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 16:21:12.284639 => 16:21:14.409187
[0m16:21:14.409187 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m16:21:14.847531 [debug] [Thread-1 (]: Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 99, in main
      df = model(dbt, session)
    File "_udf_code.py", line 14, in model
      data_df = data_df.loc[data_df['PPG'] > 1]
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe.py", line 1046, in __getattr__
      raise AttributeError(
  AttributeError: Table object has no attribute loc
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m16:21:14.847531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abfd539e-f3fc-41a1-914b-82ce93c28c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC08F7D90>]}
[0m16:21:14.847531 [error] [Thread-1 (]: 5 of 5 ERROR creating python table model dfb.py_nfl_data ....................... [[31mERROR[0m in 2.58s]
[0m16:21:14.847531 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m16:21:14.847531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:14.847531 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m16:21:14.847531 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m16:21:14.847531 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m16:21:14.847531 [info ] [MainThread]: 
[0m16:21:14.847531 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 11.32 seconds (11.32s).
[0m16:21:14.865677 [debug] [MainThread]: Command end result
[0m16:21:14.883573 [info ] [MainThread]: 
[0m16:21:14.884898 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:21:14.884898 [info ] [MainThread]: 
[0m16:21:14.884898 [error] [MainThread]:   Database Error in model py_nfl_data (models\dim\py_nfl_data.py)
  100357 (P0000): Python Interpreter Error:
  Traceback (most recent call last):
    File "_udf_code.py", line 99, in main
      df = model(dbt, session)
    File "_udf_code.py", line 14, in model
      data_df = data_df.loc[data_df['PPG'] > 1]
    File "/usr/lib/python_udf/4ce67a08ddbbc7aaad6c5f16bf5a8fb8af3c34b0e6269a1aaec2409f6b1f50e8/lib/python3.8/site-packages/snowflake/snowpark/dataframe.py", line 1046, in __getattr__
      raise AttributeError(
  AttributeError: Table object has no attribute loc
   in function PY_NFL_DATA__DBT_SP with handler main
  compiled Code at target\run\dfb_data\models\dim\py_nfl_data.py
[0m16:21:14.891548 [info ] [MainThread]: 
[0m16:21:14.892893 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m16:21:14.894906 [debug] [MainThread]: Command `dbt run` failed at 16:21:14.894906 after 12.60 seconds
[0m16:21:14.895945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CBE43CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CB7591FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CC0078250>]}
[0m16:21:14.895945 [debug] [MainThread]: Flushing usage events
[0m16:23:59.739676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4686308D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4686478D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46860C790>]}


============================== 16:23:59.747681 | 49e57296-28fd-4858-b3ee-dcf16eb5c422 ==============================
[0m16:23:59.747681 [info ] [MainThread]: Running with dbt=1.7.18
[0m16:23:59.747681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:00.295525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4691AE890>]}
[0m16:24:00.389880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46860FED0>]}
[0m16:24:00.389880 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:24:00.427531 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m16:24:00.688845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:24:00.688845 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\py_nfl_data.py
[0m16:24:00.892698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46A2FF490>]}
[0m16:24:00.908323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46A500710>]}
[0m16:24:00.908323 [info ] [MainThread]: Found 6 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m16:24:00.908323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4691588D0>]}
[0m16:24:00.908323 [info ] [MainThread]: 
[0m16:24:00.908323 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:24:00.908323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m16:24:00.936476 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m16:24:00.937989 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m16:24:00.939004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:01.895716 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:24:01.895716 [debug] [ThreadPool]: On list_storage: Close
[0m16:24:02.039888 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m16:24:02.053451 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m16:24:02.053451 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m16:24:02.053451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:02.851842 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m16:24:02.851842 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m16:24:03.043429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46915A4D0>]}
[0m16:24:03.043429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:03.043429 [info ] [MainThread]: 
[0m16:24:03.043429 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m16:24:03.043429 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m16:24:03.043429 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m16:24:03.062048 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m16:24:03.062048 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 16:24:03.043429 => 16:24:03.062048
[0m16:24:03.067650 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m16:24:03.068610 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m16:24:03.070274 [info ] [Thread-1 (]: 1 of 5 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m16:24:03.072405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m16:24:03.072405 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m16:24:03.074492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m16:24:03.074492 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 16:24:03.073404 => 16:24:03.074492
[0m16:24:03.074492 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m16:24:03.108673 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m16:24:03.108673 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m16:24:03.108673 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m16:24:03.108673 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:24:03.933353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:24:03.949367 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 16:24:03.074492 => 16:24:03.949367
[0m16:24:03.949367 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m16:24:04.090629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46A977450>]}
[0m16:24:04.090629 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.02s]
[0m16:24:04.090629 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m16:24:04.090629 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m16:24:04.090629 [info ] [Thread-1 (]: 2 of 5 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m16:24:04.090629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m16:24:04.090629 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m16:24:04.124975 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:24:04.124975 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 16:24:04.090629 => 16:24:04.124975
[0m16:24:04.132554 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m16:24:04.134822 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:24:04.134822 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m16:24:04.134822 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m16:24:04.134822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:05.126279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:24:05.148271 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 16:24:04.134564 => 16:24:05.148271
[0m16:24:05.148271 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m16:24:05.297962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46A7E4E50>]}
[0m16:24:05.297962 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.21s]
[0m16:24:05.297962 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m16:24:05.297962 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m16:24:05.297962 [info ] [Thread-1 (]: 3 of 5 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m16:24:05.297962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m16:24:05.297962 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m16:24:05.297962 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m16:24:05.297962 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 16:24:05.297962 => 16:24:05.297962
[0m16:24:05.313620 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m16:24:05.318652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m16:24:05.320653 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m16:24:05.320653 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m16:24:05.321652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:06.333060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:24:06.350697 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 16:24:05.314626 => 16:24:06.348689
[0m16:24:06.350697 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m16:24:06.490609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46A51DB10>]}
[0m16:24:06.490609 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.19s]
[0m16:24:06.506243 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m16:24:06.506243 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m16:24:06.506243 [info ] [Thread-1 (]: 4 of 5 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m16:24:06.506243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m16:24:06.506243 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m16:24:06.537972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m16:24:06.539213 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 16:24:06.506243 => 16:24:06.539213
[0m16:24:06.539213 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m16:24:06.567715 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m16:24:06.567715 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m16:24:06.567715 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m16:24:06.567715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:09.641905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:24:09.641905 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 16:24:06.539213 => 16:24:09.641905
[0m16:24:09.641905 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m16:24:09.768042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46A519410>]}
[0m16:24:09.768042 [info ] [Thread-1 (]: 4 of 5 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 3.26s]
[0m16:24:09.783719 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m16:24:09.783719 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m16:24:09.783719 [info ] [Thread-1 (]: 5 of 5 START python table model dfb.py_nfl_data ................................ [RUN]
[0m16:24:09.783719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m16:24:09.783719 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m16:24:09.783719 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m16:24:09.783719 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 16:24:09.783719 => 16:24:09.783719
[0m16:24:09.783719 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m16:24:09.802937 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m16:24:09.805735 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m16:24:09.805735 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    data_df.drop('ID')
    data_df = data_df.filter(data_df['PPG'] > 1)
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m16:24:09.805735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:12.291874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:24:12.307310 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 16:24:09.783719 => 16:24:12.307310
[0m16:24:12.307310 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m16:24:12.417174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e57296-28fd-4858-b3ee-dcf16eb5c422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D46AA8BB90>]}
[0m16:24:12.417174 [info ] [Thread-1 (]: 5 of 5 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 2.63s]
[0m16:24:12.417174 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m16:24:12.417174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:12.432628 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m16:24:12.432628 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m16:24:12.432628 [debug] [MainThread]: Connection 'model.dfb_data.py_nfl_data' was properly closed.
[0m16:24:12.432628 [info ] [MainThread]: 
[0m16:24:12.432628 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 11.52 seconds (11.52s).
[0m16:24:12.438853 [debug] [MainThread]: Command end result
[0m16:24:12.456771 [info ] [MainThread]: 
[0m16:24:12.457766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:12.458774 [info ] [MainThread]: 
[0m16:24:12.458774 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:24:12.463455 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:12.463455 after 12.80 seconds
[0m16:24:12.464413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4685F3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4616C1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D461997D90>]}
[0m16:24:12.464413 [debug] [MainThread]: Flushing usage events
[0m16:51:24.430444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54A35D290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54A35F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54A35D4D0>]}


============================== 16:51:24.461699 | 70be2463-4ecf-4046-9aa6-140261fd70bc ==============================
[0m16:51:24.461699 [info ] [MainThread]: Running with dbt=1.7.18
[0m16:51:24.461699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:51:28.381415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54BF48D50>]}
[0m16:51:28.475653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54AEBDD50>]}
[0m16:51:28.475653 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:51:28.573614 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m16:51:31.425045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:51:31.425045 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\dim\dim_dfb_nfl_teams_data.py
[0m16:51:31.628414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C4AF310>]}
[0m16:51:31.725446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C291850>]}
[0m16:51:31.725446 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m16:51:31.725446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C4AD0D0>]}
[0m16:51:31.737953 [info ] [MainThread]: 
[0m16:51:31.737953 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:51:31.737953 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m16:51:31.757733 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m16:51:31.757733 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m16:51:31.758732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:33.854437 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m16:51:33.854437 [debug] [ThreadPool]: On list_storage: Close
[0m16:51:34.030566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m16:51:34.030566 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m16:51:34.030566 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m16:51:34.043136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:34.842614 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m16:51:34.842614 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m16:51:35.015343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C4E5450>]}
[0m16:51:35.030855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:51:35.030855 [info ] [MainThread]: 
[0m16:51:35.076348 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m16:51:35.076348 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m16:51:35.076348 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m16:51:35.091351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m16:51:35.093309 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 16:51:35.076348 => 16:51:35.092304
[0m16:51:35.094317 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m16:51:35.095316 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m16:51:35.096394 [info ] [Thread-1 (]: 1 of 6 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m16:51:35.098645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m16:51:35.099649 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m16:51:35.102647 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m16:51:35.104603 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 16:51:35.099649 => 16:51:35.103649
[0m16:51:35.104603 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m16:51:35.134006 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m16:51:35.139288 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m16:51:35.140342 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m16:51:35.141364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:51:36.035566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:51:36.064830 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 16:51:35.105673 => 16:51:36.064830
[0m16:51:36.064830 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m16:51:36.206210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C7F5450>]}
[0m16:51:36.206210 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.11s]
[0m16:51:36.206210 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m16:51:36.206210 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m16:51:36.221734 [info ] [Thread-1 (]: 2 of 6 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m16:51:36.221734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m16:51:36.221734 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m16:51:36.245037 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:51:36.293244 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 16:51:36.221734 => 16:51:36.293244
[0m16:51:36.293244 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m16:51:36.309024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:51:36.312027 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m16:51:36.312027 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m16:51:36.313027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:37.491538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:51:37.491538 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 16:51:36.293244 => 16:51:37.491538
[0m16:51:37.491538 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m16:51:37.649726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C7F06D0>]}
[0m16:51:37.649726 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.43s]
[0m16:51:37.649726 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m16:51:37.649726 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m16:51:37.649726 [info ] [Thread-1 (]: 3 of 6 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m16:51:37.649726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m16:51:37.662446 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m16:51:37.667457 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m16:51:37.803610 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 16:51:37.662826 => 16:51:37.803610
[0m16:51:37.803610 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m16:51:37.803610 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m16:51:37.803610 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m16:51:37.803610 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m16:51:37.803610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:38.700224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:51:38.700224 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 16:51:37.803610 => 16:51:38.700224
[0m16:51:38.700224 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m16:51:38.857122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C2661D0>]}
[0m16:51:38.857122 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.21s]
[0m16:51:38.872681 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m16:51:38.872681 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m16:51:38.872681 [info ] [Thread-1 (]: 4 of 6 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m16:51:38.880228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m16:51:38.881550 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m16:51:38.905986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m16:51:38.908571 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 16:51:38.881550 => 16:51:38.908571
[0m16:51:38.909617 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m16:51:38.924620 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m16:51:38.924620 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m16:51:38.924620 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m16:51:38.939293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:46.886472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 8.0 seconds
[0m16:51:46.901918 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 16:51:38.909617 => 16:51:46.901918
[0m16:51:46.901918 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m16:51:47.045527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C960150>]}
[0m16:51:47.057563 [info ] [Thread-1 (]: 4 of 6 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 8.17s]
[0m16:51:47.060102 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m16:51:47.061102 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m16:51:47.062102 [info ] [Thread-1 (]: 5 of 6 START python table model dfb.py_nfl_data ................................ [RUN]
[0m16:51:47.064671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m16:51:47.065701 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m16:51:47.071042 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m16:51:47.074547 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 16:51:47.065962 => 16:51:47.073636
[0m16:51:47.075591 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m16:51:47.080645 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m16:51:47.080900 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m16:51:47.080900 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    data_df.drop('ID')
    data_df = data_df.filter(data_df['PPG'] > 1)
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m16:51:47.080900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:49.927395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:51:49.942865 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 16:51:47.076662 => 16:51:49.942865
[0m16:51:49.942865 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m16:51:50.085034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C0A4CD0>]}
[0m16:51:50.085034 [info ] [Thread-1 (]: 5 of 6 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 3.02s]
[0m16:51:50.100445 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m16:51:50.100445 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:51:50.100445 [info ] [Thread-1 (]: 6 of 6 START python table model dfb.dim_dfb_nfl_teams_data ..................... [RUN]
[0m16:51:50.100445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.dim_dfb_nfl_teams_data)
[0m16:51:50.100445 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:51:50.100445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_teams_data"
[0m16:51:50.100445 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_teams_data (compile): 16:51:50.100445 => 16:51:50.100445
[0m16:51:50.100445 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:51:50.117431 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.dim_dfb_nfl_teams_data"
[0m16:51:50.121141 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_teams_data"
[0m16:51:50.122123 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_teams_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_teams_data"} */
WITH dim_dfb_nfl_teams_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    df = dbt.ref('py_nfl_data')
    df1 = dbt.ref('fct_nfl_teams')
    data_df = df.join(df1, df['Game_Info'] == df1['abbrev'])
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"fct_nfl_teams": "storage.dfb.fct_nfl_teams", "py_nfl_data": "storage.dfb.py_nfl_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "dim_dfb_nfl_teams_data"
    
    def __repr__(self):
        return 'storage.dfb.dim_dfb_nfl_teams_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.dim_dfb_nfl_teams_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL dim_dfb_nfl_teams_data__dbt_sp();
[0m16:51:50.123079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:52.937786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:51:52.937786 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_teams_data (execute): 16:51:50.100445 => 16:51:52.937786
[0m16:51:52.937786 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_teams_data: Close
[0m16:51:53.079614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70be2463-4ecf-4046-9aa6-140261fd70bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C7F6410>]}
[0m16:51:53.079614 [info ] [Thread-1 (]: 6 of 6 OK created python table model dfb.dim_dfb_nfl_teams_data ................ [[32mSUCCESS 1[0m in 2.98s]
[0m16:51:53.079614 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:51:53.079614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:53.079614 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m16:51:53.079614 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m16:51:53.079614 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_teams_data' was properly closed.
[0m16:51:53.079614 [info ] [MainThread]: 
[0m16:51:53.079614 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 21.34 seconds (21.34s).
[0m16:51:53.095857 [debug] [MainThread]: Command end result
[0m16:51:53.114433 [info ] [MainThread]: 
[0m16:51:53.114433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:51:53.114433 [info ] [MainThread]: 
[0m16:51:53.114433 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:51:53.121483 [debug] [MainThread]: Command `dbt run` succeeded at 16:51:53.121483 after 28.96 seconds
[0m16:51:53.122490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C543471FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C546DFF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C543747D90>]}
[0m16:51:53.122490 [debug] [MainThread]: Flushing usage events
[0m16:53:21.570741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17EFC3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17EFBA450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17EFB9850>]}


============================== 16:53:21.570741 | a898f37b-9d0e-449d-8112-98d395a35a99 ==============================
[0m16:53:21.570741 [info ] [MainThread]: Running with dbt=1.7.18
[0m16:53:21.570741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:53:22.151827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17FB0FB10>]}
[0m16:53:22.245543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17EFD7E50>]}
[0m16:53:22.245543 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:53:22.277417 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m16:53:22.524849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:22.529908 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\py_nfl_data.py
[0m16:53:22.731853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1010D0150>]}
[0m16:53:22.763777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17FEBD050>]}
[0m16:53:22.763777 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m16:53:22.763777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17FBD6D10>]}
[0m16:53:22.763777 [info ] [MainThread]: 
[0m16:53:22.763777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:53:22.763777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m16:53:22.785308 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m16:53:22.789356 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m16:53:22.791268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:23.719332 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:53:23.719332 [debug] [ThreadPool]: On list_storage: Close
[0m16:53:23.929177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m16:53:23.940277 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m16:53:23.940277 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m16:53:23.940277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:24.785252 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m16:53:24.800760 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m16:53:24.972562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17FECF510>]}
[0m16:53:24.972562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:24.972562 [info ] [MainThread]: 
[0m16:53:24.972562 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m16:53:24.972562 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m16:53:24.972562 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m16:53:24.990197 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m16:53:24.992494 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 16:53:24.972562 => 16:53:24.991979
[0m16:53:24.994546 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m16:53:24.995703 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m16:53:24.996791 [info ] [Thread-1 (]: 1 of 6 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m16:53:24.999214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m16:53:25.000289 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m16:53:25.003281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m16:53:25.004381 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 16:53:25.000289 => 16:53:25.004381
[0m16:53:25.005935 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m16:53:25.041372 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m16:53:25.043676 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m16:53:25.043676 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m16:53:25.043676 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:53:25.852745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:53:25.868195 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 16:53:25.007946 => 16:53:25.868195
[0m16:53:25.868195 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m16:53:26.041209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10142CC50>]}
[0m16:53:26.041209 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.04s]
[0m16:53:26.041209 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m16:53:26.041209 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m16:53:26.041209 [info ] [Thread-1 (]: 2 of 6 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m16:53:26.041209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m16:53:26.041209 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m16:53:26.081651 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:53:26.082895 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 16:53:26.056899 => 16:53:26.082895
[0m16:53:26.082895 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m16:53:26.082895 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:53:26.091588 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m16:53:26.091588 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m16:53:26.091588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:27.106993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:53:27.122430 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 16:53:26.082895 => 16:53:27.122430
[0m16:53:27.122430 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m16:53:27.264380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C101198C10>]}
[0m16:53:27.264380 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.22s]
[0m16:53:27.264380 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m16:53:27.264380 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m16:53:27.264380 [info ] [Thread-1 (]: 3 of 6 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m16:53:27.264380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m16:53:27.264380 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m16:53:27.286314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m16:53:27.286314 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 16:53:27.279912 => 16:53:27.286314
[0m16:53:27.286314 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m16:53:27.294326 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m16:53:27.296323 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m16:53:27.296323 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m16:53:27.297570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:28.454957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:53:28.470669 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 16:53:27.289303 => 16:53:28.470669
[0m16:53:28.470669 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m16:53:28.595939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17FE80E10>]}
[0m16:53:28.595939 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.33s]
[0m16:53:28.595939 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m16:53:28.611456 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m16:53:28.611456 [info ] [Thread-1 (]: 4 of 6 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m16:53:28.611456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m16:53:28.611456 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m16:53:28.639389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m16:53:28.641873 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 16:53:28.611456 => 16:53:28.641576
[0m16:53:28.644107 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m16:53:28.674105 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m16:53:28.674105 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m16:53:28.674105 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m16:53:28.674105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:31.671965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:53:31.671965 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 16:53:28.645106 => 16:53:31.671965
[0m16:53:31.671965 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m16:53:31.812566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10157AB10>]}
[0m16:53:31.812566 [info ] [Thread-1 (]: 4 of 6 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 3.20s]
[0m16:53:31.812566 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m16:53:31.812566 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m16:53:31.812566 [info ] [Thread-1 (]: 5 of 6 START python table model dfb.py_nfl_data ................................ [RUN]
[0m16:53:31.812566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m16:53:31.812566 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m16:53:31.832464 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m16:53:31.834601 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 16:53:31.812566 => 16:53:31.833565
[0m16:53:31.834601 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m16:53:31.834601 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m16:53:31.842833 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m16:53:31.843830 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    data_df.drop('Player_ID')
    data_df = data_df.filter(data_df['PPG'] > 1)
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m16:53:31.844825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:34.556269 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:53:34.556269 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 16:53:31.834601 => 16:53:34.556269
[0m16:53:34.556269 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m16:53:34.697569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17FE35050>]}
[0m16:53:34.697569 [info ] [Thread-1 (]: 5 of 6 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 2.89s]
[0m16:53:34.697569 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m16:53:34.697569 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:53:34.697569 [info ] [Thread-1 (]: 6 of 6 START python table model dfb.dim_dfb_nfl_teams_data ..................... [RUN]
[0m16:53:34.697569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.dim_dfb_nfl_teams_data)
[0m16:53:34.697569 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:53:34.697569 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_teams_data"
[0m16:53:34.713990 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_teams_data (compile): 16:53:34.697569 => 16:53:34.713099
[0m16:53:34.715626 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:53:34.719707 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.dim_dfb_nfl_teams_data"
[0m16:53:34.724611 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_teams_data"
[0m16:53:34.725687 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_teams_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_teams_data"} */
WITH dim_dfb_nfl_teams_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    df = dbt.ref('py_nfl_data')
    df1 = dbt.ref('fct_nfl_teams')
    data_df = df.join(df1, df['Game_Info'] == df1['abbrev'])
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"fct_nfl_teams": "storage.dfb.fct_nfl_teams", "py_nfl_data": "storage.dfb.py_nfl_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "dim_dfb_nfl_teams_data"
    
    def __repr__(self):
        return 'storage.dfb.dim_dfb_nfl_teams_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.dim_dfb_nfl_teams_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL dim_dfb_nfl_teams_data__dbt_sp();
[0m16:53:34.726765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:37.722825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:53:37.722825 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_teams_data (execute): 16:53:34.715626 => 16:53:37.722825
[0m16:53:37.722825 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_teams_data: Close
[0m16:53:37.880245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a898f37b-9d0e-449d-8112-98d395a35a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C101411110>]}
[0m16:53:37.895728 [info ] [Thread-1 (]: 6 of 6 OK created python table model dfb.dim_dfb_nfl_teams_data ................ [[32mSUCCESS 1[0m in 3.18s]
[0m16:53:37.895728 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:53:37.895728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:37.895728 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m16:53:37.895728 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m16:53:37.895728 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_teams_data' was properly closed.
[0m16:53:37.895728 [info ] [MainThread]: 
[0m16:53:37.895728 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 15.13 seconds (15.13s).
[0m16:53:37.908667 [debug] [MainThread]: Command end result
[0m16:53:37.927785 [info ] [MainThread]: 
[0m16:53:37.929800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:37.930944 [info ] [MainThread]: 
[0m16:53:37.930944 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:53:37.930944 [debug] [MainThread]: Command `dbt run` succeeded at 16:53:37.930944 after 16.49 seconds
[0m16:53:37.930944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1780A1FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C17DDD9D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C178374C10>]}
[0m16:53:37.930944 [debug] [MainThread]: Flushing usage events
[0m16:59:16.086152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADD060750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADC43AC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADCAEBDD0>]}


============================== 16:59:16.086152 | bba2a144-782d-406c-96e2-a969ee7a6458 ==============================
[0m16:59:16.086152 [info ] [MainThread]: Running with dbt=1.7.18
[0m16:59:16.086152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\PycharmProjects\\pythonProject\\dbt_course\\dfb_data\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:59:16.623382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADEB7F5D0>]}
[0m16:59:16.733471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADD099DD0>]}
[0m16:59:16.733471 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m16:59:16.763795 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m16:59:17.023881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:17.024984 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\py_nfl_data.py
[0m16:59:17.324452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADEE36A10>]}
[0m16:59:17.340068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADEF3C090>]}
[0m16:59:17.340068 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m16:59:17.340068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADECBB050>]}
[0m16:59:17.340068 [info ] [MainThread]: 
[0m16:59:17.340068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:59:17.340068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m16:59:17.361714 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m16:59:17.361714 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m16:59:17.361714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:18.337148 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:59:18.340924 [debug] [ThreadPool]: On list_storage: Close
[0m16:59:18.493870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m16:59:18.503878 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m16:59:18.504880 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m16:59:18.506048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:19.222274 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m16:59:19.222274 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m16:59:19.391173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADED43B90>]}
[0m16:59:19.391173 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:19.391173 [info ] [MainThread]: 
[0m16:59:19.391173 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_Nfl_data
[0m16:59:19.391173 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_Nfl_data'
[0m16:59:19.391173 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_Nfl_data
[0m16:59:19.413474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_Nfl_data"
[0m16:59:19.413474 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_Nfl_data (compile): 16:59:19.406231 => 16:59:19.413474
[0m16:59:19.413474 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_Nfl_data
[0m16:59:19.413474 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m16:59:19.413474 [info ] [Thread-1 (]: 1 of 6 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m16:59:19.421989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_Nfl_data, now model.dfb_data.stg_nfl_teams)
[0m16:59:19.421989 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m16:59:19.427794 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m16:59:19.427794 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 16:59:19.423072 => 16:59:19.427794
[0m16:59:19.427794 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m16:59:19.458302 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m16:59:19.458302 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m16:59:19.458302 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m16:59:19.458302 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:59:20.456379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:20.489952 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 16:59:19.427794 => 16:59:20.489952
[0m16:59:20.489952 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m16:59:20.639686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADEE93E10>]}
[0m16:59:20.639686 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 1.23s]
[0m16:59:20.639686 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m16:59:20.639686 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m16:59:20.655267 [info ] [Thread-1 (]: 2 of 6 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m16:59:20.657184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m16:59:20.657184 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m16:59:20.687764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:59:20.689776 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 16:59:20.657184 => 16:59:20.688765
[0m16:59:20.690216 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m16:59:20.693243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m16:59:20.693243 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m16:59:20.693243 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_Nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m16:59:20.693243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:21.652472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:21.668014 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 16:59:20.692154 => 16:59:21.652472
[0m16:59:21.668014 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m16:59:22.139962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADF48D990>]}
[0m16:59:22.139962 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 1.48s]
[0m16:59:22.139962 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m16:59:22.139962 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m16:59:22.139962 [info ] [Thread-1 (]: 3 of 6 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m16:59:22.139962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m16:59:22.139962 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m16:59:22.158133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m16:59:22.160841 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 16:59:22.139962 => 16:59:22.159833
[0m16:59:22.161952 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m16:59:22.161952 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m16:59:22.161952 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m16:59:22.161952 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_Nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_Nfl_data

)

    select *
    from source
  );
[0m16:59:22.161952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:23.172686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:59:23.173693 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 16:59:22.161952 => 16:59:23.173693
[0m16:59:23.173693 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m16:59:23.316092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADEF52790>]}
[0m16:59:23.316092 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.18s]
[0m16:59:23.316092 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m16:59:23.316092 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m16:59:23.316092 [info ] [Thread-1 (]: 4 of 6 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m16:59:23.332359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m16:59:23.333722 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m16:59:23.358843 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m16:59:23.358843 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 16:59:23.334228 => 16:59:23.358843
[0m16:59:23.358843 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m16:59:23.391602 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m16:59:23.394608 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m16:59:23.395605 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m16:59:23.395605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:26.029637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:59:26.029637 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 16:59:23.358843 => 16:59:26.029637
[0m16:59:26.029637 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m16:59:26.202482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADF4CD750>]}
[0m16:59:26.202482 [info ] [Thread-1 (]: 4 of 6 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 2.87s]
[0m16:59:26.202482 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m16:59:26.202482 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m16:59:26.202482 [info ] [Thread-1 (]: 5 of 6 START python table model dfb.py_nfl_data ................................ [RUN]
[0m16:59:26.212911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m16:59:26.215318 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m16:59:26.218801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m16:59:26.222775 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 16:59:26.216240 => 16:59:26.222775
[0m16:59:26.224678 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m16:59:26.229806 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m16:59:26.230765 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m16:59:26.230765 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    data_df.drop('PLAYER_ID')
    data_df = data_df.filter(data_df['PPG'] > 1)
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m16:59:26.230765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:29.084623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:59:29.100087 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 16:59:26.225642 => 16:59:29.084623
[0m16:59:29.100087 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m16:59:29.210439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADED1CF10>]}
[0m16:59:29.210439 [info ] [Thread-1 (]: 5 of 6 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 3.01s]
[0m16:59:29.226079 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m16:59:29.226079 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:59:29.226079 [info ] [Thread-1 (]: 6 of 6 START python table model dfb.dim_dfb_nfl_teams_data ..................... [RUN]
[0m16:59:29.226079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.dim_dfb_nfl_teams_data)
[0m16:59:29.230276 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:59:29.235750 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_teams_data"
[0m16:59:29.239446 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_teams_data (compile): 16:59:29.231797 => 16:59:29.235750
[0m16:59:29.240462 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:59:29.246559 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.dim_dfb_nfl_teams_data"
[0m16:59:29.247693 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_teams_data"
[0m16:59:29.247693 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_teams_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_teams_data"} */
WITH dim_dfb_nfl_teams_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    df = dbt.ref('py_nfl_data')
    df1 = dbt.ref('fct_nfl_teams')
    data_df = df.join(df1, df['Game_Info'] == df1['abbrev'])
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"fct_nfl_teams": "storage.dfb.fct_nfl_teams", "py_nfl_data": "storage.dfb.py_nfl_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "dim_dfb_nfl_teams_data"
    
    def __repr__(self):
        return 'storage.dfb.dim_dfb_nfl_teams_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.dim_dfb_nfl_teams_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL dim_dfb_nfl_teams_data__dbt_sp();
[0m16:59:29.247693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:32.362601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:59:32.362601 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_teams_data (execute): 16:59:29.241581 => 16:59:32.362601
[0m16:59:32.362601 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_teams_data: Close
[0m16:59:32.487963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bba2a144-782d-406c-96e2-a969ee7a6458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADF4CFD10>]}
[0m16:59:32.487963 [info ] [Thread-1 (]: 6 of 6 OK created python table model dfb.dim_dfb_nfl_teams_data ................ [[32mSUCCESS 1[0m in 3.26s]
[0m16:59:32.487963 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_teams_data
[0m16:59:32.487963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:32.487963 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m16:59:32.487963 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m16:59:32.503412 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_teams_data' was properly closed.
[0m16:59:32.504535 [info ] [MainThread]: 
[0m16:59:32.506098 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 15.16 seconds (15.16s).
[0m16:59:32.510008 [debug] [MainThread]: Command end result
[0m16:59:32.527070 [info ] [MainThread]: 
[0m16:59:32.528072 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:32.529134 [info ] [MainThread]: 
[0m16:59:32.531526 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:59:32.533365 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:32.533365 after 16.53 seconds
[0m16:59:32.534354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADCAEBD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AD6101FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AD63E0BD0>]}
[0m16:59:32.535362 [debug] [MainThread]: Flushing usage events
[0m21:06:43.450782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170AB37C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170AA18DD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170AB37DD90>]}


============================== 21:06:43.944443 | bcfa99a9-c3f9-4e0c-a07c-a6dd26d12e30 ==============================
[0m21:06:43.944443 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:06:43.944443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\Documents\\GitHub\\Repository\\dbt_dailyfantasybuzz\\dfb_data\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:07:15.460421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcfa99a9-c3f9-4e0c-a07c-a6dd26d12e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170ACF635D0>]}
[0m21:07:15.797783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcfa99a9-c3f9-4e0c-a07c-a6dd26d12e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170ABE82350>]}
[0m21:07:15.806806 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:07:15.943355 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:07:18.154792 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m21:07:18.154792 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\mart\dim_dfb_nfl_teams_data.py
[0m21:07:18.154792 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\src\src_dfb_nfl_data.sql
[0m21:07:18.171154 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://models\src\src_dfb_Nfl_data.sql
[0m21:07:18.171154 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://models\dim\dim_dfb_nfl_teams_data.py
[0m21:07:20.244245 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dfb_data.dim_dfb_nfl_data' (models\dim\dim_dfb_nfl_data.sql) depends on a node named 'src_dfb_Nfl_data' which was not found
[0m21:07:20.259786 [debug] [MainThread]: Command `dbt build` failed at 21:07:20.259786 after 37.46 seconds
[0m21:07:20.259786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170AB36F650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170AB32B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170AB37DD90>]}
[0m21:07:20.259786 [debug] [MainThread]: Flushing usage events
[0m21:11:17.523753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150F40A9ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150F4100AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150F40A9F90>]}


============================== 21:11:17.536828 | f9e1dbaf-2b7e-48d5-899f-ec09ae49862e ==============================
[0m21:11:17.536828 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:11:17.536828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\harol\\Documents\\GitHub\\Repository\\dbt_dailyfantasybuzz\\dfb_data\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:11:18.275702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9e1dbaf-2b7e-48d5-899f-ec09ae49862e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150F4C0A210>]}
[0m21:11:18.403218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9e1dbaf-2b7e-48d5-899f-ec09ae49862e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150F3D02410>]}
[0m21:11:18.403218 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:11:18.447980 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:11:18.753471 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m21:11:18.753471 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\mart\dim_dfb_nfl_teams_data.py
[0m21:11:18.753471 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\src\src_dfb_nfl_data.sql
[0m21:11:18.753471 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://models\src\src_dfb_Nfl_data.sql
[0m21:11:18.753471 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://models\dim\dim_dfb_nfl_teams_data.py
[0m21:11:19.467259 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dfb_data.dim_dfb_nfl_data' (models\dim\dim_dfb_nfl_data.sql) depends on a node named 'src_dfb_Nfl_data' which was not found
[0m21:11:19.480273 [debug] [MainThread]: Command `dbt compile` failed at 21:11:19.480273 after 2.06 seconds
[0m21:11:19.480273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150F409E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150F409C810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150F409CBD0>]}
[0m21:11:19.480273 [debug] [MainThread]: Flushing usage events
[0m21:12:04.868128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC9F99A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA055F010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA055D350>]}


============================== 21:12:04.868128 | db03e1a5-981e-4cdb-9884-7104ac754180 ==============================
[0m21:12:04.868128 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:12:04.883787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\Documents\\GitHub\\Repository\\dbt_dailyfantasybuzz\\dfb_data\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:12:05.617907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db03e1a5-981e-4cdb-9884-7104ac754180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA21812D0>]}
[0m21:12:05.742943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db03e1a5-981e-4cdb-9884-7104ac754180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA211E7D0>]}
[0m21:12:05.753044 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:12:05.792528 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:12:06.053895 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
[0m21:12:06.053895 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\src\src_dfb_nfl_data.sql
[0m21:12:06.053895 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\mart\dim_dfb_nfl_teams_data.py
[0m21:12:06.061957 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://models\dim\dim_dfb_nfl_teams_data.py
[0m21:12:06.061957 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://models\src\src_dfb_Nfl_data.sql
[0m21:12:06.061957 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\dim_dfb_nfl_data.sql
[0m21:12:06.992972 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dfb_data.stg_dfb_data' (models\staging\stg_dfb_data.sql) depends on a node named 'src_dfb_Nfl_data' which was not found
[0m21:12:06.992972 [debug] [MainThread]: Command `dbt build` failed at 21:12:06.992972 after 2.25 seconds
[0m21:12:06.992972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA055D590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA055D450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCA055CA10>]}
[0m21:12:07.003542 [debug] [MainThread]: Flushing usage events
[0m21:13:13.737876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC479D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC428C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC361DD50>]}


============================== 21:13:13.751008 | a12d0824-a09c-462f-ae86-02dbd032aec3 ==============================
[0m21:13:13.751008 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:13:13.753520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\harol\\Documents\\GitHub\\Repository\\dbt_dailyfantasybuzz\\dfb_data\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:13:14.488688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC6300ED0>]}
[0m21:13:14.678510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC635AD50>]}
[0m21:13:14.678510 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:13:14.738892 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:13:14.964794 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m21:13:14.964794 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\mart\dim_dfb_nfl_teams_data.py
[0m21:13:14.964794 [debug] [MainThread]: Partial parsing: added file: dfb_data://models\src\src_dfb_nfl_data.sql
[0m21:13:14.964794 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://models\dim\dim_dfb_nfl_teams_data.py
[0m21:13:14.975266 [debug] [MainThread]: Partial parsing: deleted file: dfb_data://models\src\src_dfb_Nfl_data.sql
[0m21:13:14.975266 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\staging\stg_dfb_data.sql
[0m21:13:14.975266 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\dim_dfb_nfl_data.sql
[0m21:13:16.115461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC6B1BB50>]}
[0m21:13:16.371175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC66BA7D0>]}
[0m21:13:16.371175 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m21:13:16.371175 [info ] [MainThread]: 
[0m21:13:16.380743 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:13:17.018176 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:13:17.033185 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:13:17.033185 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:13:17.033185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:25.992033 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 9.0 seconds
[0m21:13:26.009169 [debug] [ThreadPool]: On list_storage: Close
[0m21:13:26.592000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:13:26.592000 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:13:26.592000 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:13:26.592000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:28.011006 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m21:13:28.011006 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:13:28.216774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC66F0B10>]}
[0m21:13:28.232337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:28.232337 [info ] [MainThread]: 
[0m21:13:28.434518 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_nfl_data
[0m21:13:28.434518 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_nfl_data'
[0m21:13:28.434518 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_nfl_data
[0m21:13:28.465219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_nfl_data"
[0m21:13:28.465219 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_nfl_data (compile): 21:13:28.449550 => 21:13:28.465219
[0m21:13:28.476741 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_nfl_data
[0m21:13:28.476741 [debug] [Thread-1 (]: Began running node seed.dfb_data.seed_nfl_teams
[0m21:13:28.481268 [info ] [Thread-1 (]: 1 of 13 START seed file dfb.seed_nfl_teams ..................................... [RUN]
[0m21:13:28.482209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_nfl_data, now seed.dfb_data.seed_nfl_teams)
[0m21:13:28.482209 [debug] [Thread-1 (]: Began compiling node seed.dfb_data.seed_nfl_teams
[0m21:13:28.482209 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (compile): 21:13:28.482209 => 21:13:28.482209
[0m21:13:28.482209 [debug] [Thread-1 (]: Began executing node seed.dfb_data.seed_nfl_teams
[0m21:13:28.551251 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:13:28.551251 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m21:13:28.551251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:13:30.248614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:13:30.248614 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:13:30.248614 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
truncate table "STORAGE"."DFB"."SEED_NFL_TEAMS"
  ;
[0m21:13:30.547972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:13:30.547972 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:13:30.547972 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m21:13:30.895240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:13:30.942127 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:13:30.942127 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
BEGIN
[0m21:13:31.036491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:13:31.036491 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:13:31.036491 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
insert into storage.dfb.seed_nfl_teams (Abbrev, Team_Name) values
            (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)...
[0m21:13:31.813249 [debug] [Thread-1 (]: SQL status: SUCCESS 31 in 1.0 seconds
[0m21:13:31.813249 [debug] [Thread-1 (]: Using snowflake connection "seed.dfb_data.seed_nfl_teams"
[0m21:13:31.813249 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "seed.dfb_data.seed_nfl_teams"} */
COMMIT
[0m21:13:32.338926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:13:32.505828 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dfb_data.seed_nfl_teams"
[0m21:13:32.528826 [debug] [Thread-1 (]: Timing info for seed.dfb_data.seed_nfl_teams (execute): 21:13:28.482209 => 21:13:32.528826
[0m21:13:32.528826 [debug] [Thread-1 (]: On seed.dfb_data.seed_nfl_teams: Close
[0m21:13:33.027366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC6DE2110>]}
[0m21:13:33.033938 [info ] [Thread-1 (]: 1 of 13 OK loaded seed file dfb.seed_nfl_teams ................................. [[32mINSERT 31[0m in 4.55s]
[0m21:13:33.033938 [debug] [Thread-1 (]: Finished running node seed.dfb_data.seed_nfl_teams
[0m21:13:33.033938 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:13:33.033938 [info ] [Thread-1 (]: 2 of 13 START sql view model dfb.dim_dfb_nfl_data .............................. [RUN]
[0m21:13:33.043858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dfb_data.seed_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m21:13:33.047319 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:13:33.080722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:13:33.085814 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:13:33.047319 => 21:13:33.084786
[0m21:13:33.085814 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:13:33.128393 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:13:33.134306 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:13:33.136814 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m21:13:33.136814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:35.564115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:13:35.579857 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:13:33.085814 => 21:13:35.579857
[0m21:13:35.579857 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:13:36.173463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC706C750>]}
[0m21:13:36.189087 [info ] [Thread-1 (]: 2 of 13 OK created sql view model dfb.dim_dfb_nfl_data ......................... [[32mSUCCESS 1[0m in 3.13s]
[0m21:13:36.192097 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:13:36.192097 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:13:36.194368 [info ] [Thread-1 (]: 3 of 13 START sql view model dfb.stg_dfb_data .................................. [RUN]
[0m21:13:36.194368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:13:36.194368 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:13:36.199192 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:13:36.205201 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:13:36.194368 => 21:13:36.205201
[0m21:13:36.205201 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:13:36.208831 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:13:36.218404 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:13:36.219199 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_nfl_data

)

    select *
    from source
  );
[0m21:13:36.219199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:37.695536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:13:37.711188 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:13:36.208176 => 21:13:37.711188
[0m21:13:37.718322 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:13:37.947976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC6E7BD90>]}
[0m21:13:37.950474 [info ] [Thread-1 (]: 3 of 13 OK created sql view model dfb.stg_dfb_data ............................. [[32mSUCCESS 1[0m in 1.75s]
[0m21:13:37.950474 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:13:37.950474 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m21:13:37.957266 [info ] [Thread-1 (]: 4 of 13 START sql view model dfb.stg_nfl_teams ................................. [RUN]
[0m21:13:37.959203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.stg_nfl_teams)
[0m21:13:37.961187 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m21:13:37.968368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m21:13:37.971238 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 21:13:37.961843 => 21:13:37.971238
[0m21:13:37.971238 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m21:13:37.985242 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m21:13:37.987701 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m21:13:37.987701 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m21:13:37.987701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:39.326997 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:13:39.330008 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 21:13:37.971238 => 21:13:39.330008
[0m21:13:39.330008 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m21:13:39.977425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC6FDF510>]}
[0m21:13:39.977425 [info ] [Thread-1 (]: 4 of 13 OK created sql view model dfb.stg_nfl_teams ............................ [[32mSUCCESS 1[0m in 2.02s]
[0m21:13:39.977425 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m21:13:39.977425 [debug] [Thread-1 (]: Began running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56
[0m21:13:39.977425 [info ] [Thread-1 (]: 5 of 13 START test accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST  [RUN]
[0m21:13:39.996670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56)
[0m21:13:39.998074 [debug] [Thread-1 (]: Began compiling node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56
[0m21:13:40.011267 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56"
[0m21:13:40.011267 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56 (compile): 21:13:39.999715 => 21:13:40.011267
[0m21:13:40.017281 [debug] [Thread-1 (]: Began executing node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56
[0m21:13:40.035564 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56"
[0m21:13:40.048975 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56"
[0m21:13:40.049654 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        position as value_field,
        count(*) as n_records

    from storage.dfb.dim_dfb_nfl_data
    group by position

)

select *
from all_values
where value_field not in (
    'QB','RB','WR','TE','WR/FLEX','RB/FLEX','TE/FLEX','DST'
)



      
    ) dbt_internal_test
[0m21:13:40.050799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:41.546452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:13:41.577772 [debug] [Thread-1 (]: Timing info for test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56 (execute): 21:13:40.017281 => 21:13:41.562072
[0m21:13:41.577772 [debug] [Thread-1 (]: On test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56: Close
[0m21:13:41.841628 [info ] [Thread-1 (]: 5 of 13 PASS accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST  [[32mPASS[0m in 1.85s]
[0m21:13:41.841628 [debug] [Thread-1 (]: Finished running node test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56
[0m21:13:41.841628 [debug] [Thread-1 (]: Began running node test.dfb_data.no_nulls_in_dim_dfb
[0m21:13:41.841628 [info ] [Thread-1 (]: 6 of 13 START test no_nulls_in_dim_dfb ......................................... [RUN]
[0m21:13:41.841628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.accepted_values_dim_dfb_nfl_data_position__QB__RB__WR__TE__WR_FLEX__RB_FLEX__TE_FLEX__DST.1038289b56, now test.dfb_data.no_nulls_in_dim_dfb)
[0m21:13:41.857170 [debug] [Thread-1 (]: Began compiling node test.dfb_data.no_nulls_in_dim_dfb
[0m21:13:41.874107 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m21:13:41.886418 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
describe table storage.dfb.dim_dfb_nfl_data
[0m21:13:41.886418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:43.550013 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 2.0 seconds
[0m21:13:43.550013 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m21:13:43.566727 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (compile): 21:13:41.857170 => 21:13:43.565498
[0m21:13:43.567479 [debug] [Thread-1 (]: Began executing node test.dfb_data.no_nulls_in_dim_dfb
[0m21:13:43.567479 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.no_nulls_in_dim_dfb"
[0m21:13:43.760536 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.no_nulls_in_dim_dfb"
[0m21:13:43.760536 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.no_nulls_in_dim_dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
 SELECT * FROM storage.dfb.dim_dfb_nfl_data WHERE
 RECORD_ID IS NULL OR
 DATE IS NULL OR
 NAME IS NULL OR
 POSITION IS NULL OR
 SALARY IS NULL OR
 SALARY_CHAR IS NULL OR
 GAME_INFO IS NULL OR
 OVER_UNDER IS NULL OR
 PPG IS NULL OR
 VALUE IS NULL OR
 PROJECTION IS NULL OR
 
 FALSE

      
    ) dbt_internal_test
[0m21:13:44.138280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:13:44.295598 [debug] [Thread-1 (]: Timing info for test.dfb_data.no_nulls_in_dim_dfb (execute): 21:13:43.567479 => 21:13:44.295598
[0m21:13:44.295598 [debug] [Thread-1 (]: On test.dfb_data.no_nulls_in_dim_dfb: Close
[0m21:13:45.085419 [info ] [Thread-1 (]: 6 of 13 PASS no_nulls_in_dim_dfb ............................................... [[32mPASS[0m in 3.24s]
[0m21:13:45.212339 [debug] [Thread-1 (]: Finished running node test.dfb_data.no_nulls_in_dim_dfb
[0m21:13:45.215543 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:13:45.215543 [info ] [Thread-1 (]: 7 of 13 START test not_null_dim_dfb_nfl_data_date .............................. [RUN]
[0m21:13:45.221078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.no_nulls_in_dim_dfb, now test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c)
[0m21:13:45.221078 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:13:45.248051 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:13:45.253184 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (compile): 21:13:45.221078 => 21:13:45.253184
[0m21:13:45.253184 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:13:45.269403 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:13:45.269403 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"
[0m21:13:45.269403 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from storage.dfb.dim_dfb_nfl_data
where date is null



      
    ) dbt_internal_test
[0m21:13:45.275663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:47.449683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:13:47.534395 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c (execute): 21:13:45.259118 => 21:13:47.534395
[0m21:13:47.534395 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c: Close
[0m21:13:48.185546 [info ] [Thread-1 (]: 7 of 13 PASS not_null_dim_dfb_nfl_data_date .................................... [[32mPASS[0m in 2.97s]
[0m21:13:48.185546 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c
[0m21:13:48.185546 [debug] [Thread-1 (]: Began running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:13:48.185546 [info ] [Thread-1 (]: 8 of 13 START test not_null_dim_dfb_nfl_data_name .............................. [RUN]
[0m21:13:48.205126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_date.6300d22d3c, now test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3)
[0m21:13:48.207039 [debug] [Thread-1 (]: Began compiling node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:13:48.217088 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:13:48.225707 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (compile): 21:13:48.209349 => 21:13:48.225707
[0m21:13:48.225707 [debug] [Thread-1 (]: Began executing node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:13:48.234929 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:13:48.242351 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"
[0m21:13:48.244533 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from storage.dfb.dim_dfb_nfl_data
where name is null



      
    ) dbt_internal_test
[0m21:13:48.244533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:50.033720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:13:50.033720 [debug] [Thread-1 (]: Timing info for test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3 (execute): 21:13:48.225707 => 21:13:50.033720
[0m21:13:50.033720 [debug] [Thread-1 (]: On test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3: Close
[0m21:13:50.240401 [info ] [Thread-1 (]: 8 of 13 PASS not_null_dim_dfb_nfl_data_name .................................... [[32mPASS[0m in 2.04s]
[0m21:13:50.253382 [debug] [Thread-1 (]: Finished running node test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3
[0m21:13:50.253382 [debug] [Thread-1 (]: Began running node test.dfb_data.positive_value_in dfb
[0m21:13:50.256541 [info ] [Thread-1 (]: 9 of 13 START test positive_value_in dfb ....................................... [RUN]
[0m21:13:50.261045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.not_null_dim_dfb_nfl_data_name.ecb11b32f3, now test.dfb_data.positive_value_in dfb)
[0m21:13:50.264060 [debug] [Thread-1 (]: Began compiling node test.dfb_data.positive_value_in dfb
[0m21:13:50.264060 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.positive_value_in dfb"
[0m21:13:50.264060 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (compile): 21:13:50.264060 => 21:13:50.264060
[0m21:13:50.264060 [debug] [Thread-1 (]: Began executing node test.dfb_data.positive_value_in dfb
[0m21:13:50.272101 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.positive_value_in dfb"
[0m21:13:50.275812 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.positive_value_in dfb"
[0m21:13:50.275812 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.positive_value_in dfb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG < 0

      
    ) dbt_internal_test
[0m21:13:50.275812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:51.858949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:13:51.858949 [debug] [Thread-1 (]: Timing info for test.dfb_data.positive_value_in dfb (execute): 21:13:50.264060 => 21:13:51.858949
[0m21:13:51.858949 [debug] [Thread-1 (]: On test.dfb_data.positive_value_in dfb: Close
[0m21:13:52.465738 [info ] [Thread-1 (]: 9 of 13 PASS positive_value_in dfb ............................................. [[32mPASS[0m in 2.21s]
[0m21:13:52.465738 [debug] [Thread-1 (]: Finished running node test.dfb_data.positive_value_in dfb
[0m21:13:52.465738 [debug] [Thread-1 (]: Began running node test.dfb_data.t_ppg_value
[0m21:13:52.465738 [info ] [Thread-1 (]: 10 of 13 START test t_ppg_value ................................................ [RUN]
[0m21:13:52.483144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.positive_value_in dfb, now test.dfb_data.t_ppg_value)
[0m21:13:52.484985 [debug] [Thread-1 (]: Began compiling node test.dfb_data.t_ppg_value
[0m21:13:52.491877 [debug] [Thread-1 (]: Writing injected SQL for node "test.dfb_data.t_ppg_value"
[0m21:13:52.498049 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (compile): 21:13:52.486957 => 21:13:52.491877
[0m21:13:52.500737 [debug] [Thread-1 (]: Began executing node test.dfb_data.t_ppg_value
[0m21:13:52.515191 [debug] [Thread-1 (]: Writing runtime sql for node "test.dfb_data.t_ppg_value"
[0m21:13:52.521389 [debug] [Thread-1 (]: Using snowflake connection "test.dfb_data.t_ppg_value"
[0m21:13:52.523967 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "test.dfb_data.t_ppg_value"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
SELECT
 *
FROM
 storage.dfb.dim_dfb_nfl_data
WHERE
 PPG > 100

      
    ) dbt_internal_test
[0m21:13:52.523967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:54.111468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:13:54.127531 [debug] [Thread-1 (]: Timing info for test.dfb_data.t_ppg_value (execute): 21:13:52.500737 => 21:13:54.127531
[0m21:13:54.127531 [debug] [Thread-1 (]: On test.dfb_data.t_ppg_value: Close
[0m21:13:54.713054 [info ] [Thread-1 (]: 10 of 13 PASS t_ppg_value ...................................................... [[32mPASS[0m in 2.23s]
[0m21:13:54.713054 [debug] [Thread-1 (]: Finished running node test.dfb_data.t_ppg_value
[0m21:13:54.725571 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:13:54.725571 [info ] [Thread-1 (]: 11 of 13 START python table model dfb.py_nfl_data .............................. [RUN]
[0m21:13:54.732870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dfb_data.t_ppg_value, now model.dfb_data.py_nfl_data)
[0m21:13:54.734206 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:13:54.786036 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:13:54.793122 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:13:54.735302 => 21:13:54.786036
[0m21:13:54.793122 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:13:54.833618 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:13:54.841623 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:13:54.843208 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    data_df.drop('PLAYER_ID')
    data_df = data_df.filter(data_df['PPG'] > 1)
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:13:54.843208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:03.142009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 8.0 seconds
[0m21:14:03.157657 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:13:54.793122 => 21:14:03.142009
[0m21:14:03.157657 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:14:03.732938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC6C2B6D0>]}
[0m21:14:03.738475 [info ] [Thread-1 (]: 11 of 13 OK created python table model dfb.py_nfl_data ......................... [[32mSUCCESS 1[0m in 9.00s]
[0m21:14:03.744063 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:14:03.744063 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m21:14:03.747583 [info ] [Thread-1 (]: 12 of 13 START python table model dfb.fct_nfl_teams ............................ [RUN]
[0m21:14:03.750281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.fct_nfl_teams)
[0m21:14:03.750281 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m21:14:03.764233 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m21:14:03.764233 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 21:14:03.750281 => 21:14:03.764233
[0m21:14:03.764233 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m21:14:03.785182 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m21:14:03.786045 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m21:14:03.792060 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m21:14:03.794181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:07.615015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m21:14:07.615015 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 21:14:03.764233 => 21:14:07.615015
[0m21:14:07.632497 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m21:14:07.935123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC6BC3C90>]}
[0m21:14:07.935123 [info ] [Thread-1 (]: 12 of 13 OK created python table model dfb.fct_nfl_teams ....................... [[32mSUCCESS 1[0m in 4.18s]
[0m21:14:07.945983 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m21:14:07.946676 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_teams_data
[0m21:14:07.951195 [info ] [Thread-1 (]: 13 of 13 START python table model dfb.dim_dfb_nfl_teams_data ................... [RUN]
[0m21:14:07.954987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.dim_dfb_nfl_teams_data)
[0m21:14:07.957647 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_teams_data
[0m21:14:07.971493 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_teams_data"
[0m21:14:07.975570 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_teams_data (compile): 21:14:07.959739 => 21:14:07.971493
[0m21:14:07.977113 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_teams_data
[0m21:14:07.977283 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.dim_dfb_nfl_teams_data"
[0m21:14:07.986011 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_teams_data"
[0m21:14:07.992256 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_teams_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_teams_data"} */
WITH dim_dfb_nfl_teams_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    df = dbt.ref('py_nfl_data')
    df1 = dbt.ref('fct_nfl_teams')
    data_df = df.join(df1, df['Game_Info'] == df1['abbrev'])
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"fct_nfl_teams": "storage.dfb.fct_nfl_teams", "py_nfl_data": "storage.dfb.py_nfl_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "dim_dfb_nfl_teams_data"
    
    def __repr__(self):
        return 'storage.dfb.dim_dfb_nfl_teams_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.dim_dfb_nfl_teams_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL dim_dfb_nfl_teams_data__dbt_sp();
[0m21:14:07.992256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:11.740086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m21:14:11.741870 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_teams_data (execute): 21:14:07.977283 => 21:14:11.741870
[0m21:14:11.741870 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_teams_data: Close
[0m21:14:11.940536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a12d0824-a09c-462f-ae86-02dbd032aec3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC643BB50>]}
[0m21:14:11.940536 [info ] [Thread-1 (]: 13 of 13 OK created python table model dfb.dim_dfb_nfl_teams_data .............. [[32mSUCCESS 1[0m in 3.99s]
[0m21:14:11.953049 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_teams_data
[0m21:14:11.956563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:11.956563 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:14:11.956563 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:14:11.956563 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_teams_data' was properly closed.
[0m21:14:11.956563 [info ] [MainThread]: 
[0m21:14:11.956563 [info ] [MainThread]: Finished running 1 seed, 3 view models, 6 tests, 3 table models in 0 hours 0 minutes and 55.58 seconds (55.58s).
[0m21:14:11.976269 [debug] [MainThread]: Command end result
[0m21:14:12.000641 [info ] [MainThread]: 
[0m21:14:12.000641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:14:12.000641 [info ] [MainThread]: 
[0m21:14:12.008604 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m21:14:12.012681 [debug] [MainThread]: Command `dbt build` succeeded at 21:14:12.010979 after 59.86 seconds
[0m21:14:12.012681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC4402350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DABDBB0C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC428BBD0>]}
[0m21:14:12.012681 [debug] [MainThread]: Flushing usage events
[0m21:18:10.057307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E256380D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E250CC090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E250CC2D0>]}


============================== 21:18:10.057307 | 2cb2434b-d98f-4585-b542-f37fd010c704 ==============================
[0m21:18:10.057307 [info ] [MainThread]: Running with dbt=1.7.18
[0m21:18:10.072322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\harol\\Documents\\GitHub\\Repository\\dbt_dailyfantasybuzz\\dfb_data\\logs', 'profiles_dir': 'C:\\Users\\harol\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:10.790827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E271F6550>]}
[0m21:18:10.909163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2715F290>]}
[0m21:18:10.909163 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:18:10.958937 [debug] [MainThread]: checksum: 7ef98830ab3f0215d011ffa635e2417c6313d5b77f40f33d534bad4eb8784f08, vars: {}, profile: , target: , version: 1.7.18
[0m21:18:11.392194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:18:11.392194 [debug] [MainThread]: Partial parsing: updated file: dfb_data://models\dim\py_nfl_data.py
[0m21:18:11.659336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E27273B50>]}
[0m21:18:11.690645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E274F2C50>]}
[0m21:18:11.690645 [info ] [MainThread]: Found 7 models, 1 seed, 6 tests, 0 sources, 0 exposures, 0 metrics, 810 macros, 0 groups, 0 semantic models
[0m21:18:11.690645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E27175210>]}
[0m21:18:11.706230 [info ] [MainThread]: 
[0m21:18:11.710291 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:11.714661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage'
[0m21:18:11.734329 [debug] [ThreadPool]: Using snowflake connection "list_storage"
[0m21:18:11.734329 [debug] [ThreadPool]: On list_storage: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage"} */
show terse schemas in database storage
    limit 10000
[0m21:18:11.734329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:13.158399 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:18:13.158399 [debug] [ThreadPool]: On list_storage: Close
[0m21:18:13.414819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_storage_dfb'
[0m21:18:13.441684 [debug] [ThreadPool]: Using snowflake connection "list_storage_dfb"
[0m21:18:13.441684 [debug] [ThreadPool]: On list_storage_dfb: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "connection_name": "list_storage_dfb"} */
show terse objects in storage.dfb limit 10000
[0m21:18:13.441684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:14.827299 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m21:18:14.827299 [debug] [ThreadPool]: On list_storage_dfb: Close
[0m21:18:15.440298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E271776D0>]}
[0m21:18:15.440298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:15.440298 [info ] [MainThread]: 
[0m21:18:15.459197 [debug] [Thread-1 (]: Began running node model.dfb_data.src_dfb_nfl_data
[0m21:18:15.464144 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dfb_data.src_dfb_nfl_data'
[0m21:18:15.464144 [debug] [Thread-1 (]: Began compiling node model.dfb_data.src_dfb_nfl_data
[0m21:18:15.473350 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.src_dfb_nfl_data"
[0m21:18:15.473350 [debug] [Thread-1 (]: Timing info for model.dfb_data.src_dfb_nfl_data (compile): 21:18:15.464144 => 21:18:15.473350
[0m21:18:15.473350 [debug] [Thread-1 (]: Finished running node model.dfb_data.src_dfb_nfl_data
[0m21:18:15.481671 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_nfl_teams
[0m21:18:15.482578 [info ] [Thread-1 (]: 1 of 6 START sql view model dfb.stg_nfl_teams .................................. [RUN]
[0m21:18:15.486802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.src_dfb_nfl_data, now model.dfb_data.stg_nfl_teams)
[0m21:18:15.486802 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_nfl_teams
[0m21:18:15.492391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_nfl_teams"
[0m21:18:15.492391 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (compile): 21:18:15.486802 => 21:18:15.492391
[0m21:18:15.492391 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_nfl_teams
[0m21:18:15.567745 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_nfl_teams"
[0m21:18:15.567745 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_nfl_teams"
[0m21:18:15.574281 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_nfl_teams"} */
create or replace   view storage.dfb.stg_nfl_teams
  
   as (
    with source as (
select * from storage.dfb.seed_nfl_teams
)select * from source
  );
[0m21:18:15.574281 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:18:16.961524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:18:17.024708 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_nfl_teams (execute): 21:18:15.500616 => 21:18:17.024708
[0m21:18:17.024708 [debug] [Thread-1 (]: On model.dfb_data.stg_nfl_teams: Close
[0m21:18:17.586580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E27A798D0>]}
[0m21:18:17.591031 [info ] [Thread-1 (]: 1 of 6 OK created sql view model dfb.stg_nfl_teams ............................. [[32mSUCCESS 1[0m in 2.10s]
[0m21:18:17.594587 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_nfl_teams
[0m21:18:17.594587 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_data
[0m21:18:17.594587 [info ] [Thread-1 (]: 2 of 6 START sql view model dfb.dim_dfb_nfl_data ............................... [RUN]
[0m21:18:17.605650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_nfl_teams, now model.dfb_data.dim_dfb_nfl_data)
[0m21:18:17.607841 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_data
[0m21:18:17.653522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:18:17.653522 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (compile): 21:18:17.608550 => 21:18:17.653522
[0m21:18:17.653522 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_data
[0m21:18:17.667671 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.dim_dfb_nfl_data"
[0m21:18:17.675651 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_data"
[0m21:18:17.675651 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_data"} */
create or replace   view storage.dfb.dim_dfb_nfl_data
  
   as (
    
WITH  __dbt__cte__src_dfb_nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), A AS (
 SELECT
 md5(cast(coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(game_info as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as record_id
, *
 FROM
 __dbt__cte__src_dfb_nfl_data
)
Select
record_id 
,Date
,Name
,Position
,Salary
,Salary_Char
,GAME_INFO
,OVER_UNDER  
,PPG
,Value
,Projection
from A
where PPG > 1
  );
[0m21:18:17.675651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:19.957012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:18:19.965031 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_data (execute): 21:18:17.653522 => 21:18:19.965031
[0m21:18:19.965031 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_data: Close
[0m21:18:20.154619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E279C41D0>]}
[0m21:18:20.154619 [info ] [Thread-1 (]: 2 of 6 OK created sql view model dfb.dim_dfb_nfl_data .......................... [[32mSUCCESS 1[0m in 2.56s]
[0m21:18:20.170202 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_data
[0m21:18:20.171655 [debug] [Thread-1 (]: Began running node model.dfb_data.stg_dfb_data
[0m21:18:20.171655 [info ] [Thread-1 (]: 3 of 6 START sql view model dfb.stg_dfb_data ................................... [RUN]
[0m21:18:20.175142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.dim_dfb_nfl_data, now model.dfb_data.stg_dfb_data)
[0m21:18:20.179684 [debug] [Thread-1 (]: Began compiling node model.dfb_data.stg_dfb_data
[0m21:18:20.190706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.stg_dfb_data"
[0m21:18:20.195263 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (compile): 21:18:20.181480 => 21:18:20.195263
[0m21:18:20.195263 [debug] [Thread-1 (]: Began executing node model.dfb_data.stg_dfb_data
[0m21:18:20.210126 [debug] [Thread-1 (]: Writing runtime sql for node "model.dfb_data.stg_dfb_data"
[0m21:18:20.210126 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.stg_dfb_data"
[0m21:18:20.217293 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.stg_dfb_data"} */
create or replace   view storage.dfb.stg_dfb_data
  
   as (
    with  __dbt__cte__src_dfb_nfl_data as (
With A as (
select 
Date
,Name
,ID as Player_ID
,ROSTER_POSITION as Position
,Salary
,Concat('$',SALARY) as Salary_Char
,GAME_INFO
,OVER_UNDER
,PPG
,Value
,Projection
from dfb.raw_dfb_nfl_data
)select * from A
), source as (
    select * from __dbt__cte__src_dfb_nfl_data

)

    select *
    from source
  );
[0m21:18:20.219748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:21.592527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:18:21.592527 [debug] [Thread-1 (]: Timing info for model.dfb_data.stg_dfb_data (execute): 21:18:20.195263 => 21:18:21.592527
[0m21:18:21.607548 [debug] [Thread-1 (]: On model.dfb_data.stg_dfb_data: Close
[0m21:18:21.763595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E27B57950>]}
[0m21:18:21.767717 [info ] [Thread-1 (]: 3 of 6 OK created sql view model dfb.stg_dfb_data .............................. [[32mSUCCESS 1[0m in 1.59s]
[0m21:18:21.770735 [debug] [Thread-1 (]: Finished running node model.dfb_data.stg_dfb_data
[0m21:18:21.770735 [debug] [Thread-1 (]: Began running node model.dfb_data.fct_nfl_teams
[0m21:18:21.774675 [info ] [Thread-1 (]: 4 of 6 START python table model dfb.fct_nfl_teams .............................. [RUN]
[0m21:18:21.778929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.stg_dfb_data, now model.dfb_data.fct_nfl_teams)
[0m21:18:21.780141 [debug] [Thread-1 (]: Began compiling node model.dfb_data.fct_nfl_teams
[0m21:18:21.839480 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.fct_nfl_teams"
[0m21:18:21.839480 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (compile): 21:18:21.780141 => 21:18:21.839480
[0m21:18:21.839480 [debug] [Thread-1 (]: Began executing node model.dfb_data.fct_nfl_teams
[0m21:18:21.867825 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.fct_nfl_teams"
[0m21:18:21.867825 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.fct_nfl_teams"
[0m21:18:21.867825 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.fct_nfl_teams"} */
WITH fct_nfl_teams__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_nfl_teams')
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_nfl_teams": "storage.dfb.stg_nfl_teams"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "fct_nfl_teams"
    
    def __repr__(self):
        return 'storage.dfb.fct_nfl_teams'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.fct_nfl_teams', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL fct_nfl_teams__dbt_sp();
[0m21:18:21.867825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:25.451936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m21:18:25.470195 [debug] [Thread-1 (]: Timing info for model.dfb_data.fct_nfl_teams (execute): 21:18:21.839480 => 21:18:25.470195
[0m21:18:25.470195 [debug] [Thread-1 (]: On model.dfb_data.fct_nfl_teams: Close
[0m21:18:26.102722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E27BD9B90>]}
[0m21:18:26.109865 [info ] [Thread-1 (]: 4 of 6 OK created python table model dfb.fct_nfl_teams ......................... [[32mSUCCESS 1[0m in 4.33s]
[0m21:18:26.112646 [debug] [Thread-1 (]: Finished running node model.dfb_data.fct_nfl_teams
[0m21:18:26.112646 [debug] [Thread-1 (]: Began running node model.dfb_data.py_nfl_data
[0m21:18:26.112646 [info ] [Thread-1 (]: 5 of 6 START python table model dfb.py_nfl_data ................................ [RUN]
[0m21:18:26.122698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.fct_nfl_teams, now model.dfb_data.py_nfl_data)
[0m21:18:26.124656 [debug] [Thread-1 (]: Began compiling node model.dfb_data.py_nfl_data
[0m21:18:26.138388 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.py_nfl_data"
[0m21:18:26.143663 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (compile): 21:18:26.126263 => 21:18:26.143663
[0m21:18:26.143663 [debug] [Thread-1 (]: Began executing node model.dfb_data.py_nfl_data
[0m21:18:26.153374 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.py_nfl_data"
[0m21:18:26.153374 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.py_nfl_data"
[0m21:18:26.153374 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.py_nfl_data"} */
WITH py_nfl_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    data_df = dbt.ref('stg_dfb_data')
    data_df = data_df.drop('PLAYER_ID')
    data_df = data_df.filter(data_df['PPG'] > 1)
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"stg_dfb_data": "storage.dfb.stg_dfb_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "py_nfl_data"
    
    def __repr__(self):
        return 'storage.dfb.py_nfl_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.py_nfl_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL py_nfl_data__dbt_sp();
[0m21:18:26.158803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:30.199629 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m21:18:30.199629 [debug] [Thread-1 (]: Timing info for model.dfb_data.py_nfl_data (execute): 21:18:26.143663 => 21:18:30.199629
[0m21:18:30.199629 [debug] [Thread-1 (]: On model.dfb_data.py_nfl_data: Close
[0m21:18:30.411650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E27733FD0>]}
[0m21:18:30.411650 [info ] [Thread-1 (]: 5 of 6 OK created python table model dfb.py_nfl_data ........................... [[32mSUCCESS 1[0m in 4.29s]
[0m21:18:30.411650 [debug] [Thread-1 (]: Finished running node model.dfb_data.py_nfl_data
[0m21:18:30.418989 [debug] [Thread-1 (]: Began running node model.dfb_data.dim_dfb_nfl_teams_data
[0m21:18:30.418989 [info ] [Thread-1 (]: 6 of 6 START python table model dfb.dim_dfb_nfl_teams_data ..................... [RUN]
[0m21:18:30.422774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dfb_data.py_nfl_data, now model.dfb_data.dim_dfb_nfl_teams_data)
[0m21:18:30.423427 [debug] [Thread-1 (]: Began compiling node model.dfb_data.dim_dfb_nfl_teams_data
[0m21:18:30.424742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dfb_data.dim_dfb_nfl_teams_data"
[0m21:18:30.431890 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_teams_data (compile): 21:18:30.424742 => 21:18:30.431890
[0m21:18:30.433946 [debug] [Thread-1 (]: Began executing node model.dfb_data.dim_dfb_nfl_teams_data
[0m21:18:30.441289 [debug] [Thread-1 (]: Writing runtime python for node "model.dfb_data.dim_dfb_nfl_teams_data"
[0m21:18:30.441289 [debug] [Thread-1 (]: Using snowflake connection "model.dfb_data.dim_dfb_nfl_teams_data"
[0m21:18:30.441289 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_teams_data: /* {"app": "dbt", "dbt_version": "1.7.18", "profile_name": "dfb_data", "target_name": "dev", "node_id": "model.dfb_data.dim_dfb_nfl_teams_data"} */
WITH dim_dfb_nfl_teams_data__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.8'
PACKAGES = ('snowflake-snowpark-python')

HANDLER = 'main'
EXECUTE AS CALLER
AS
$$

import sys
sys._xoptions['snowflake_partner_attribution'].append("dbtLabs_dbtPython")


  
    
import snowflake.snowpark.functions as F

def model(dbt, session):
    df = dbt.ref('py_nfl_data')
    df1 = dbt.ref('fct_nfl_teams')
    data_df = df.join(df1, df['Game_Info'] == df1['abbrev'])
    return data_df


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"fct_nfl_teams": "storage.dfb.fct_nfl_teams", "py_nfl_data": "storage.dfb.py_nfl_data"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "storage"
    schema = "dfb"
    identifier = "dim_dfb_nfl_teams_data"
    
    def __repr__(self):
        return 'storage.dfb.dim_dfb_nfl_teams_data'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------

# To run this in snowsight, you need to select entry point to be main
# And you may have to modify the return type to text to get the result back
# def main(session):
#     dbt = dbtObj(session.table)
#     df = model(dbt, session)
#     return df.collect()

# to run this in local notebook, you need to create a session following examples https://github.com/Snowflake-Labs/sfguide-getting-started-snowpark-python
# then you can do the following to run model
# dbt = dbtObj(session.table)
# df = model(dbt, session)


def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('storage.dfb.dim_dfb_nfl_teams_data', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL dim_dfb_nfl_teams_data__dbt_sp();
[0m21:18:30.441289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:33.727477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:18:33.737300 [debug] [Thread-1 (]: Timing info for model.dfb_data.dim_dfb_nfl_teams_data (execute): 21:18:30.435184 => 21:18:33.737300
[0m21:18:33.741816 [debug] [Thread-1 (]: On model.dfb_data.dim_dfb_nfl_teams_data: Close
[0m21:18:34.087792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cb2434b-d98f-4585-b542-f37fd010c704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E2748E3D0>]}
[0m21:18:34.087792 [info ] [Thread-1 (]: 6 of 6 OK created python table model dfb.dim_dfb_nfl_teams_data ................ [[32mSUCCESS 1[0m in 3.67s]
[0m21:18:34.092507 [debug] [Thread-1 (]: Finished running node model.dfb_data.dim_dfb_nfl_teams_data
[0m21:18:34.098323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:34.098323 [debug] [MainThread]: Connection 'list_storage' was properly closed.
[0m21:18:34.098323 [debug] [MainThread]: Connection 'list_storage_dfb' was properly closed.
[0m21:18:34.098323 [debug] [MainThread]: Connection 'model.dfb_data.dim_dfb_nfl_teams_data' was properly closed.
[0m21:18:34.109705 [info ] [MainThread]: 
[0m21:18:34.112955 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 22.40 seconds (22.40s).
[0m21:18:34.117149 [debug] [MainThread]: Command end result
[0m21:18:34.131655 [info ] [MainThread]: 
[0m21:18:34.131655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:34.140696 [info ] [MainThread]: 
[0m21:18:34.142305 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:18:34.145618 [debug] [MainThread]: Command `dbt run` succeeded at 21:18:34.145618 after 24.38 seconds
[0m21:18:34.145618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E1EA50D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E250CC390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E1E8C6A10>]}
[0m21:18:34.145618 [debug] [MainThread]: Flushing usage events
